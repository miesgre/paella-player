{"version":3,"file":"paella-core.js","sources":["../src/js/core/Events.js","../src/js/core/utils.js","../src/js/core/initFunctions.js","../src/js/core/PlayerResource.js","../src/js/core/dom.js","../src/icons/progress_indicator.js","../src/js/core/Loader.js","../src/icons/error.js","../src/js/core/ErrorContainer.js","../src/js/core/Plugin.js","../src/js/core/VideoPlugin.js","../src/js/core/PluginModule.js","../src/js/videoFormats/PaellaCoreVideoFormats.js","../src/js/videoFormats/es.upv.paella.audioVideoFormat.js","../src/js/videoFormats/es.upv.paella.htmlVideoFormat.js","../src/js/core/VideoQualityItem.js","../src/js/videoFormats/es.upv.paella.imageVideoFormat.js","../src/js/videoFormats/es.upv.paella.mp4VideoFormat.js","../src/js/captions/CaptionsPlugin.js","../src/js/captions/Captions.js","../src/js/captions/DFXPParser.js","../src/js/plugins/PaellaCorePlugins.js","../src/js/plugins/es.upv.paella.dfxpManifestCaptionsPlugin.js","../src/js/core/UserInterfacePlugin.js","../src/js/core/Localization.js","../src/js/core/ButtonPlugin.js","../src/icons/play.js","../src/icons/pause.js","../src/icons/replay.js","../src/js/plugins/es.upv.paella.playPauseButton.js","../src/js/captions/WebVTTParser.js","../src/js/plugins/es.upv.paella.vttManifestCaptionsPlugin.js","../src/js/plugins/es.upv.paella.currentTimeLabelPlugin.js","../src/js/core/VideoLayout.js","../src/js/core/CanvasButtonPlugin.js","../src/js/core/CanvasPlugin.js","../src/js/layouts/PaellaCoreLayouts.js","../src/icons/icon_switch_side.js","../src/icons/maximize.js","../src/icons/close.js","../src/icons/icon_side_by_side.js","../src/icons/icon_pip.js","../src/js/layouts/es.upv.paella.dualVideoDynamic.js","../src/icons/icon_rotate.js","../src/icons/minimize-3.js","../src/js/layouts/es.upv.paella.dualVideo.js","../src/js/layouts/es.upv.paella.dualVideoPiP.js","../src/js/layouts/es.upv.paella.singleVideo.js","../src/js/layouts/es.upv.paella.singleVideoDynamic.js","../src/js/layouts/es.upv.paella.tripleVideo.js","../src/js/canvas/es.upv.paella.audioCanvas.js","../src/js/canvas/es.upv.paella.videoCanvas.js","../src/js/core/Data.js","../src/js/data/PaellaCoreDataPlugins.js","../src/js/data/es.upv.paella.cookieDataPlugin.js","../src/js/data/es.upv.paella.localStorageDataPlugin.js","../src/js/paella_plugins.js","../src/js/core/PopUpButtonPlugin.js","../src/js/core/MenuButtonPlugin.js","../src/js/core/ButtonGroupPlugin.js","../src/js/core/plugin_tools.js","../src/js/core/StreamProvider.js","../src/js/core/VideoContainerMessage.js","../src/js/core/PlayerState.js","../src/js/core/VideoContainer.js","../src/icons/play_icon_fullscreen.js","../src/js/core/PreviewContainer.js","../src/js/core/PlaybackBarPopUp.js","../src/js/core/PlaybackBar.js","../src/js/captions/CaptionsCanvas.js","../src/js/core/EventLogPlugin.js","../src/js/core/CookieConsent.js","../src/js/core/timeline-preview.js","../src/js/core/progress-indicator.js","../src/js/core/Log.js","../src/js/default-dictionaries.js","../src/js/core/Preferences.js","../src/js/core/Skin.js","../src/js/core/ManifestParser.js","../src/js/Paella.js","../src/js/core/AudioTrackData.js"],"sourcesContent":["\nexport default Object.freeze({\n\tPLAY: \"paella:play\",\n\tPAUSE: \"paella:pause\",\n\tSTOP: \"paella:stop\",\n\tENDED: \"paella:ended\",\n\tSEEK: \"paella:seek\",\n\tFULLSCREEN_CHANGED: \"paella:fullscreenchanged\",\n\tENTER_FULLSCREEN: \"paella:enterfullscreen\",\n\tEXIT_FULLSCREEN: \"paella:exitfullscreen\",\n\tVOLUME_CHANGED: \"paella:volumeChanged\",\n\tTIMEUPDATE: \"paella:timeupdate\",\n\tTRIMMING_CHANGED: \"paella:trimmingChanged\",\n\tCAPTIONS_CHANGED: \"paella:captionsChanged\",\n\tCAPTIONS_ENABLED: \"paella:captionsEnabled\",\n\tCAPTIONS_DISABLED: \"paella:captionsDisabled\",\n\tBUTTON_PRESS: \"paella:buttonPress\",\n\tSHOW_POPUP: \"paella:showPopUp\",\n\tHIDE_POPUP: \"paella:hidePopUp\",\n\tMANIFEST_LOADED: \"paella:manifestLoaded\",\n\tSTREAM_LOADED: \"paella:streamLoaded\",\n\tPLAYER_LOADED: \"paella:playerLoaded\",\n\tPLAYER_UNLOADED: \"paella:playerUnloaded\",\n\tRESIZE: \"paella:resize\",\n\tRESIZE_END: \"paella:resizeEnd\",\n\tLAYOUT_CHANGED: \"paella:layoutChanged\",\n\tPLAYBACK_RATE_CHANGED: \"paella:playbackRateChanged\",\n\tVIDEO_QUALITY_CHANGED: \"paella:videoQualityChanged\",\n\tHIDE_UI: \"paella:hideUI\",\n\tSHOW_UI: \"paella:showUI\",\n\tCOOKIE_CONSENT_CHANGED: \"paella:cookieConsentChanged\",\n\tLOG: \"paella:log\"\n});\n\nexport function bindEvent(player, events, callback, unregisterOnUnload = true) {\n\tplayer.__eventListeners__ = player.__eventListeners__ || {};\n\tif (!Array.isArray(events)) {\n\t\tevents = [events];\n\t}\n\tevents.forEach(event => {\n\t\tplayer.__eventListeners__[event] = player.__eventListeners__[event] || [];\n\t\tplayer.__eventListeners__[event].push({\n\t\t\tcallback,\n\t\t\tunregisterOnUnload\n\t\t});\n\t})\n\treturn callback;\n}\n\nexport function triggerEvent(player, event, params = {}) {\n\tplayer.__eventListeners__ &&\n\tplayer.__eventListeners__[event] &&\n\tplayer.__eventListeners__[event].forEach(cbData => cbData.callback(params));\n}\n\nexport function triggerIfReady(player, event, params = {}) {\n\tif (player.ready) {\n\t\ttriggerEvent(player, event, params);\n\t}\n}\n\nexport function unregisterEvents(player) {\n\tif (!player.__eventListeners__) {\n\t\treturn;\n\t}\n\n\tfor (const event in player.__eventListeners__) {\n\t\tplayer.__eventListeners__[event] = player.__eventListeners__[event].filter(cbData => cbData.unregisterOnUnload == false);\n\t\tplayer.log.debug(\"Unregister event: \" + player.__eventListeners__[event]);\n\t}\n}\n","\nimport Events, { bindEvent } from './Events';\n\nexport function loadSvgIcon(url) {\n    return new Promise((resolve,reject) => {\n        fetch(url)\n            .then((icon) => {\n                return icon.text()\n            })\n            .then(svg => {\n                resolve(svg);\n            })\n            .catch(err => reject(err));\n    })\n}\n\nexport function getUrlParameter(name) {\n    const urlParams = new URLSearchParams(window.location.search);\n    return urlParams.has(name) ? urlParams.get(name) : null;\n}\n\nexport function getHashParameter(name) {\n    const search = window.location.hash.replace('#','?');\n    const urlParams = new URLSearchParams(search);\n    return urlParams.has(name) ? urlParams.get(name) : null;\n}\n\nexport function joinPath(parts, sep){\n    const separator = sep || '/';\n    parts = parts.map((part, index)=>{\n        if (index) {\n            part = part.replace(new RegExp('^' + separator), '');\n        }\n        if (index !== parts.length - 1) {\n            part = part.replace(new RegExp(separator + '$'), '');\n        }\n        return part;\n    })\n    return parts.join(separator);\n}\n\nexport function isAbsoluteUrl(src) {\n    // We consider that the URLs starting with / are absolute and local to this server\n    return new RegExp('^([a-z]+://|//)', 'i').test(src) || /^\\//.test(src);\n}\n\nexport function getUrlFileName(url) {\n    try {\n        return new URL(url).pathname.split('/').pop();\n    }\n    catch (e) {\n        return url.split('/').pop();\n    }\n}\n\nexport function removeExtension(url) {\n    return url.split('.').reduce((ac,v,i,a) => i<a.length-1 ? (ac !== \"\" ? `${ac}.${v}` : v) : ac, \"\");\n}\n\nexport function removeFileName(url) {\n    const remove = (path) => {\n        const result = path.split('/').reduce((ac,v,i,a) => i<a.length-1 ? (ac !== \"\" ? `${ac}/${v}` : v) : ac, \"\");\n        return (path[0] === '/' ? `/${result}` : result) + '/';\n    }\n\n    try {\n        const u = new URL(url);\n        return u.origin + remove(u.pathname);\n    }\n    catch (e) {\n        return remove(url);\n    }\n}\n\nexport function getFileExtension(url) {\n    const file = getUrlFileName(url);\n    return file.split('.').pop();\n}\n\n// Returns the absolute path of a video manifest resource file.\n// If the path is absolute, it returns it unchanged.\nexport function resolveResourcePath(player,src) {\n    if (isAbsoluteUrl(src)) {\n        return src;\n    }\n    else {\n        return joinPath([player.manifestUrl, src]);\n    }\n}\n\nexport function pauseAutoHideUiTimer(player) {\n    player.__hideTimerPaused__ = true;\n}\n\nexport function resumeAutoHideUiTimer(player) {\n    player.__hideTimerPaused__ = false;\n}\n\nexport function setupAutoHideUiTimer(player, hideUiTimePropertyName = \"hideUiTime\") {\n    player.__hideTimer__ = null;\n\n    const hideUserInterface = async () => {\n        //player.__hideTimer__ = null;\n        if (player.__hideTimerPaused__) {\n            player.log.debug(\"UI not hidden because the auto hide timer is paused\");\n            //setupTimer();\n            return false;\n        }\n        else if (checkFocus()) {\n            player.log.debug(\"UI not hidden because there is a focused element\");\n            //setupTimer();\n            return false;\n        }\n        await player.hideUserInterface();\n        return true;\n    }\n    \n    // Used to hide user interface when the mouse leave the player container\n    if (player.config.ui?.hideOnMouseLeave) {\n        player.containerElement.addEventListener(\"mouseleave\", () => {\n            hideUserInterface();\n        });\n    }\n\n    const checkFocus = () => {\n        const active = document.activeElement;\n        return  (player.playbackBar.element.contains(active) ||\n                player.videoContainer.element.contains(active)) &&\n                [\n                    \"input\",\n                    \"textarea\",\n                    \"button\"\n                ].find(tagName => active.tagName.toLowerCase(tagName)) !== -1;\n    }\n    \n    const setupTimer = async () => {\n        if (player.__hideTimer__) {\n            clearTimeout(player.__hideTimer__);\n        }\n        await player.showUserInterface();\n        player.__hideTimer__ = setTimeout(async () => {\n            player.__hideTimer__ = null;\n            if (!hideUserInterface()) {\n                setupTimer();\n            }\n        }, player[hideUiTimePropertyName]);\n    }\n    \n    player.containerElement.addEventListener(\"mousemove\", async (evt) => {\n        setupTimer();\n    });\n    \n    bindEvent(player, Events.PLAY, async () => {\n        setupTimer();\n    });\n    \n    bindEvent(player, Events.PAUSE, async () => {\n        await player.showUserInterface();\n    });\n    \n    bindEvent(player, Events.ENDED, async () => {\n        await player.showUserInterface();\n    });\n\n    document.addEventListener('keydown', async() => {\n        setupTimer();\n    });\n\n    //document.addEventListener('focusin', async () => {\n    //    setupTimer();\n    //});\n}\n\nexport function clearAutoHideTimer(player) {\n    if (player.__hideTimer__) {\n        clearTimeout(player.__hideTimer__);\n        delete player.__hideTimer__;\n    }\n}\n\nexport function secondsToTime(timestamp) {\n    const hours = Math.floor(timestamp / 60 / 60);\n    const minutes = Math.floor(timestamp / 60) - hours * 60;\n    const seconds = Math.floor(timestamp % 60);\n    return  (hours>0 ? hours.toString().padStart(2,'0') + \":\" : \"\") +\n            minutes.toString().padStart(2,'0') + \":\" +\n            seconds.toString().padStart(2,'0');\n}\n\nexport function timeToSeconds(timeString) {\n    const re = /^(?:(\\d+):){0,1}(\\d+):(\\d+)(\\.\\d+)?$/;\n    const result = re.exec(timeString);\n    if (result) {\n        const hours = result[1] !== undefined ? Number(result[1]) : 0;\n        const minutes = Number(result[2]);\n        const seconds = Number(result[3]);\n        return hours * 3600 + minutes * 60 + seconds;\n    }\n    return null;\n}\n\nexport function timeToMilliseconds(timeString) {\n    const re = /^(?:(\\d+):){0,1}(\\d+):(\\d+)\\.(\\d+)?$/;\n    const result = re.exec(timeString);\n    if (result) {\n        const hours = result[1] !== undefined ? Number(result[1]) : 0;\n        const minutes = Number(result[2]);\n        const seconds = Number(result[3]);\n        const milliseconds = result[4] && Number(result[4]) || 0;\n        return hours * 3600000 + minutes * 60000 + seconds * 1000 + milliseconds;\n    }\n    return null;\n}\n\nexport function setCookie(cname, cvalue, exdays = 365) {\n    let d = new Date();\n    d.setTime(d.getTime() + (exdays * 24 * 60 * 60 * 1000));\n    let expires = `expires=${d.toUTCString()}`;\n    document.cookie = `${ cname }=${ cvalue };${ expires};path=/;SameSite=None;` + (/Apple/.test(navigator.vendor) ? \"\" : \"Secure;\"); \n}\n\nexport function setCookieIfAllowed(player, type, cname, cvalue, exdays = 365) {\n    if (player.cookieConsent.getConsentForType(type)) {\n        setCookie(cname, cvalue, exdays);\n    }\n}\n\nexport function getCookie(cname) {\n    let name = cname + \"=\";\n    let decodedCookie = decodeURIComponent(document.cookie);\n    let ca = decodedCookie.split(';');\n    for(let i = 0; i <ca.length; ++i) {\n      let c = ca[i];\n      while (c.charAt(0) == ' ') {\n        c = c.substring(1);\n      }\n      if (c.indexOf(name) == 0) {\n        return c.substring(name.length, c.length);\n      }\n    }\n    return \"\";\n}\n\nexport function getNumericCookie(cname) {\n    const rawValue = getCookie(cname);\n    const numValue = Number(rawValue);\n    return (rawValue !== \"\" && !isNaN(numValue)) ? numValue : null;\n}\n\nexport function getJSONCookie(cname) {\n    try {\n        return JSON.parse(getCookie(cname));\n    }\n    catch (err) {\n        return null;\n    }\n}\n\nexport function loadStyle(url, addToHeader = true) {\n    return new Promise(resolve => {\n        const link = document.createElement('link');\n        link.setAttribute('rel','stylesheet');\n        link.setAttribute('href',url);\n        link.onload = () => resolve(link);\n        const head = document.getElementsByTagName('head')[0];\n        if (addToHeader) {\n            head.appendChild(link);\n        }\n        resolve();\n    });\n}\n\nexport function unloadStyle(link) {\n    const head = document.getElementsByTagName('head')[0];\n    head.removeChild(link);\n}\n\nexport function mergeObjects(baseData, extendData, mergeArrays = true) {\n    for (const key in extendData) {\n        const baseVal = baseData[key];\n        let extendVal = extendData[key];\n\n        if (mergeArrays && Array.isArray(baseVal) && Array.isArray(extendVal)) {\n            // Replace objects if there is an identifier property\n            baseVal.forEach(item => {\n                extendVal = extendVal.filter(extendItem => {\n                    if (typeof(item) === \"object\" &&\n                        typeof(extendItem) === \"object\" &&\n                        item.id === extendItem.id)\n                    {\n                        mergeObjects(item, extendItem, mergeArrays);\n                        return false;\n                    }\n                    return true;\n                });\n            });\n            \n            // Add objects that have not been added before\n            extendVal.forEach(extendItem => {\n                baseVal.push(extendItem);\n            });\n        }\n        else if (typeof(baseVal) == \"object\" && extendVal) {\n            mergeObjects(baseVal, extendVal, mergeArrays);\n        }\n        else {\n            baseData[key] = extendData[key];\n        }\n    }\n}\n\nexport function sanitizeHTML(html, { excludedTags = null } = {}) {\n    const div = document.createElement('div');\n    div.innerHTML = html;\n\n    const exclude = [\"script\"];\n    if (excludedTags) {\n        exclude.push(...excludedTags);\n    }\n    \n    exclude.flatMap(tag => Array.from(div.getElementsByTagName(tag)))\n        .forEach(tag => {\n            const parent = tag.parentElement;\n            parent.removeChild(tag)\n        });\n\n    return div.innerHTML;\n}\n\nlet video = null;\n\nexport function supportsVideoType(type) {\n    if (!type) return false;\n    if (!video) {\n        video = document.createElement(\"video\");\n    }\n\n    let canPlay = video.canPlayType(type);\n    if (canPlay === \"maybe\" || canPlay === \"probably\") {\n        return true;\n    }\n    else if (/video\\/mp4/i.test(type)) {\n        canPlay = video.canPlayType(\"video/mp4\");\n        return canPlay === \"maybe\" || canPlay === \"probably\";\n    }\n}\n","import { getUrlParameter, getHashParameter, joinPath } from '../core/utils';\n\nexport async function defaultLoadConfigFunction(configUrl,player) {\n    player.log.debug(\"Using default configuration loading function.\");\n    const response = await fetch(configUrl);\n    return response.json();\n}\n\nexport async function defaultGetVideoIdFunction(config, player) {\n    player.log.debug(\"Using default getVideoId function\");\n    return getHashParameter(\"id\") || getUrlParameter(\"id\") || config.fallbackId;\n}\n\nexport async function defaultGetManifestUrlFunction(repoUrl,videoId,config,player) {\n    player.log.debug(\"Using default getManifestUrl function\");\n    return joinPath([repoUrl,videoId]);\n}\n\nexport async function defaultGetManifestFileUrlFunction(manifestUrl,manifestFileName,config,player) {\n    player.log.debug(\"Using default getManifestFileUrl function\");\n    return joinPath([manifestUrl,manifestFileName]);\n}\n\nexport async function defaultLoadVideoManifestFunction(videoManifestUrl,config,player) {\n    player.log.debug(\"Using default loadVideoManifest function\");\n    const response = await fetch(videoManifestUrl);\n    if (response.ok) {\n        return await response.json();\n    }\n    else {\n        throw new Error(player.translate(\"Error loading video manifest: $1 $2\", [response.status, response.statusText]));\n    }\n}\n","\nexport default class PlayerResource {\n\n    #player = null\n\n    constructor(player) {\n        this.#player = player;\n    }\n\n    get player() { return this.#player; }\n}","\nimport PlayerResource from './PlayerResource';\n\nexport function createElement({tag='div',attributes={},children=\"\",innerText=\"\",parent=null}) {\n    const result = document.createElement(tag);\n    result.innerText = innerText;\n    for (let key in attributes) {\n        result.setAttribute(key,attributes[key]);\n    }\n    result.innerHTML = children;\n    if (parent) {\n        parent.appendChild(result);\n    }\n    return result;\n}\n\nexport function createElementWithHtmlText(htmlText,parent = null) {\n    const tmpElem = document.createElement('div');\n    tmpElem.innerHTML = htmlText;\n    const result = tmpElem.children[0];\n    if (parent) {\n        parent.appendChild(result);\n    }\n    return result;\n}\n\nexport class DomClass extends PlayerResource {\n    #element = null\n\n    constructor(player, {tag='div',attributes=[],children=\"\",parent=null}) {\n        super(player);\n        this.#element = createElement({tag,attributes,children,parent});\n\n        // Add a getter as a shortcut to the DOM element tag\n        Object.defineProperty(this, tag, {\n            get: () => this.#element\n        });\n    }\n\n    get element() {\n        return this.#element;\n    }\n\n    get parent() {\n        return this.#element.parentElement;\n    }\n    \n    hide() {\n        this.element.style.display = \"none\";\n    }\n    \n    show(showMode = \"block\") {\n        this.element.style.display = null;\n    }\n    \n    get isVisible() {\n        const style = window.getComputedStyle(this.element);\n        return  style.display !== \"none\" &&\n                style.display !== \"\";\n    }\n\n    setAttribute(name,value) {\n        this.#element.setAttribute(name,value);\n    }\n\n    removeFromParent() {\n        this.#element.parentElement?.removeChild(this.#element);\n    }\n    \n    setParent(parent) {\n        this.removeFromParent();\n        parent.appendChild(this.#element);\n    }\n}\n","export default `<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"no\"?>\n<!DOCTYPE svg PUBLIC \"-//W3C//DTD SVG 1.1//EN\" \"http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd\">\n<svg width=\"100%\" height=\"100%\" viewBox=\"0 0 256 256\" version=\"1.1\" xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\" xml:space=\"preserve\" xmlns:serif=\"http://www.serif.com/\" style=\"fill-rule:evenodd;clip-rule:evenodd;stroke-linejoin:round;stroke-miterlimit:2;\">\n    <g transform=\"matrix(1,0,0,1,3,-3.88857)\">\n        <path d=\"M128,35.819C65.633,35.819 14.999,86.453 14.999,148.82C14.999,163.127 17.663,176.817 22.549,189.403L22.475,189.447C11.612,170.791 5.889,149.588 5.889,128C5.889,60.56 60.56,5.889 128,5.889L128,35.819Z\" style=\"fill:url(#_Linear1);\"/>\n    </g>\n    <g transform=\"matrix(-1,1.22465e-16,-1.22465e-16,-1,258,251.914)\">\n        <path d=\"M128,35.819C65.633,35.819 14.999,86.453 14.999,148.82C14.999,163.127 17.663,176.817 22.549,189.403L22.475,189.447C11.612,170.791 5.889,149.588 5.889,128C5.889,60.56 60.56,5.889 128,5.889L128,35.819Z\" style=\"fill:url(#_Linear2);\"/>\n    </g>\n    <defs>\n        <linearGradient id=\"_Linear1\" x1=\"0\" y1=\"0\" x2=\"1\" y2=\"0\" gradientUnits=\"userSpaceOnUse\" gradientTransform=\"matrix(-89.3028,140.734,-140.734,-89.3028,144.417,48.7125)\"><stop offset=\"0\" style=\"stop-color:rgb(13,13,13);stop-opacity:1\"/><stop offset=\"1\" style=\"stop-color:rgb(175,175,175);stop-opacity:0.5\"/></linearGradient>\n        <linearGradient id=\"_Linear2\" x1=\"0\" y1=\"0\" x2=\"1\" y2=\"0\" gradientUnits=\"userSpaceOnUse\" gradientTransform=\"matrix(-89.3028,140.734,-140.734,-89.3028,144.417,48.7125)\"><stop offset=\"0\" style=\"stop-color:rgb(13,13,13);stop-opacity:1\"/><stop offset=\"1\" style=\"stop-color:rgb(175,175,175);stop-opacity:0.5\"/></linearGradient>\n    </defs>\n</svg>\n`;","\n\nimport { createElementWithHtmlText, DomClass } from './dom';\n\nimport ProgressIndicatorIcon from '../../icons/progress_indicator';\n\nexport default class Loader extends DomClass {\n    constructor(player) {\n        super(player, { parent: player.containerElement });\n\n        this.element.className = \"loader-container\";\n    }\n\n    async create() {\n        createElementWithHtmlText(`<i>${ProgressIndicatorIcon}</i>`, this.element);\n    }\n\n    get debug() {\n        return false;\n    }\n}\n","export default `<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"no\"?>\n<!DOCTYPE svg PUBLIC \"-//W3C//DTD SVG 1.1//EN\" \"http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd\">\n<svg width=\"100%\" height=\"100%\" viewBox=\"0 0 256 256\" version=\"1.1\" xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\" xml:space=\"preserve\" xmlns:serif=\"http://www.serif.com/\" style=\"fill-rule:evenodd;clip-rule:evenodd;stroke-linejoin:round;stroke-miterlimit:2;\">\n    <g id=\"Cancel\" transform=\"matrix(5.54545,6.8353e-32,6.8353e-32,5.54545,-2567.37,-10735.5)\">\n        <path d=\"M486.05,1937C498.192,1937 508.05,1946.86 508.05,1959C508.05,1971.14 498.192,1981 486.05,1981C473.908,1981 464.05,1971.14 464.05,1959C464.05,1946.86 473.908,1937 486.05,1937ZM478.979,1950.52L477.565,1951.93L484.636,1959L477.565,1966.07L478.979,1967.49L486.05,1960.41L493.121,1967.49L494.535,1966.07L487.464,1959L494.535,1951.93L493.121,1950.52L486.05,1957.59L478.979,1950.52Z\" style=\"fill:rgb(210,0,0);\"/>\n    </g>\n</svg>\n`;","\n\nimport { createElementWithHtmlText, DomClass } from './dom';\n\nimport ErrorIcon from '../../icons/error.js';\n\n\nexport default class ErrorContainer extends DomClass {\n    constructor(player, message = \"\") {\n        super(player, { parent: player.containerElement });\n\n        this.element.className = \"error-container\";\n        \n        createElementWithHtmlText(`\n            <div>\n                <i>${ErrorIcon}</i>\n                <p>${message}</p>\n            </div>`, this.element);\n    }\n}\n","import PlayerResource from './PlayerResource';\n\nexport default class Plugin extends PlayerResource {\n    constructor(player, name) {\n        super(player);\n        this._name = name;\n    }\n\n    getPluginModuleInstance() {\n        return null;\n    }\n\n    get config() { return this._config; }\n\n    get type() { return \"none\"; }\n\n    get order() { return this._config?.order || 0; }\n    \n    get description() { return this._config?.description || \"\"; }\n\n    get name() { return this._name; }\n\n    async isEnabled() {\n        return this.config?.enabled;\n    }\n\n    async load() {\n\n    }\n\n    async unload() {\n\n    }\n}","\n\nimport { DomClass } from './dom';\nimport Plugin from './Plugin';\nimport { loadPluginsOfType } from './plugin_tools'\nimport { getFileExtension } from './utils';\nexport default class VideoPlugin extends Plugin {\n    get type() { return \"video\"; }\n\n    get streamType() { return \"mp4\"; }\n\n    async isCompatible(/* streamData */) {\n        return false;\n    }\n\n    async getVideoInstance(/*playerContainer, isMainAudio*/) {\n        return null;\n    }\n\n    getCompatibleFileExtensions() {\n        return [];\n    }\n\n    getManifestData(fileUrls) {\n\n    }\n}\n\nconst g_enabledVideoPlugins = [];\n\nexport async function loadVideoPlugins(player) {\n    await loadPluginsOfType(player, \"video\", (plugin) => {\n        g_enabledVideoPlugins.push(plugin);\n    });\n}\n\nexport async function unloadVideoPlugins(player) {\n    g_enabledVideoPlugins.slice(0);\n}\n\nexport function getVideoPlugins(player) {\n    if (g_enabledVideoPlugins.length === 0) {\n        throw Error(\"No video plugins loaded. Note that `loadVideoPlugins()` must to be called before using `getVideoPlugins()`.\")\n    }\n    return g_enabledVideoPlugins;\n}\n\nexport function getVideoPluginWithFileUrl(player, url) {\n    const ext = getFileExtension(url);\n    const videoPlugins = getVideoPlugins(player)\n    return videoPlugins.find(p => {\n            return p.getCompatibleFileExtensions().indexOf(ext) !== -1;\n        });\n}\n\nexport async function getVideoPlugin(player, streamData) {\n    const videoPlugins = getVideoPlugins(player);\n    let plugin = null;\n    \n    for (const p of videoPlugins) {\n        if (await p.isCompatible(streamData)) {\n            plugin = p;\n            break;\n        }\n    }\n    \n    return plugin;\n}\n\nexport async function isVolumeApiAvailable() {\n    const value = await (new Promise(resolve => {\n        const audio = document.createElement('audio');\n        const resolveTimer = setTimeout(() => resolve(false), 100);\n        audio.addEventListener('volumechange', evt => {\n            clearTimeout(resolveTimer);\n            resolve(true);\n        });\n        audio.volume = 0.5;\n    }));\n    return value\n}\n\nexport class Video extends DomClass {\n    constructor(tag, player, parent) {\n        const attributes = {\n            \"class\": \"video-player\"\n        };\n        super(player, {tag, attributes, parent});\n\n        this._streamProvider = null;\n        this._streamData = null;\n        this._ready = false;\n    }\n\n    async isVolumeApiAvailable() {\n        return await isVolumeApiAvailable()\n    }\n\n    get streamData() {\n        return this._streamData;\n    }\n\n    get ready() {\n        return this._ready;\n    }\n\n    async load(streamData, streamProvider) {\n        this._streamProvider = streamProvider;\n        this._streamData = streamData;\n        const result = await this.loadStreamData(streamData);\n        return result;\n    }\n\n    get isMainAudioPlayer() {\n        return this._streamProvider.mainAudioPlayer === this;\n    }\n    \n    // The player must call _videoEndedCallback when the video is ended\n    onVideoEnded(fn) {\n        this._videoEndedCallback = fn;\n    }\n\n    // The video instance must implement the following functions and properties\n    async play() {\n        return false;\n    }\n    \n    async pause() {\n        return false;\n    }\n\n    async duration() {\n        return -1;\n    }\n    \n    get currentTimeSync() {\n        return -1;\n    }\n\n    async currentTime() {\n        return -1;\n    }\n\n    async setCurrentTime(/* t */) {\n        return false;\n    }\n\n    async volume() {\n        return -1;\n    }\n\n    async setVolume(/* v */) {\n        return false;\n    }\n\n    initVolume(v) {\n        this._initialVolume = v;\n    }\n\n    async paused() {\n        return true;\n    }\n\n    async playbackRate() {\n        return -1;\n    }\n\n    async setPlaybackRate() {\n        return false;\n    }\n\n    async getQualities() {\n        return null;\n    }\n\n    async setQuality(/* q */) {\n        return false;\n    }\n\n    get currentQuality() {\n        return null;\n    }\n\n    async getDimensions() {\n        return null;\n    }\n    \n    async supportsMultiaudio() {\n        return false;\n    }\n\n    async getAudioTracks() {\n        return null;\n    }\n\n    async setCurrentAudioTrack() {\n\n    }\n\n    get currentAudioTrack() {\n        return null;\n    }\n\n    async loadStreamData(streamData) {\n        return false;\n    }\n\n    get isEnabled() {\n        return this._enabled;\n    }\n\n    async enable() {\n        this._enabled = true;\n    }\n\n    async disable() {\n        this._enabled = false;\n    }\n}\n","\nimport PlayerResource from \"./PlayerResource\";\n\nexport default class PluginModule extends PlayerResource {\n    get moduleName() {\n        this.player.log.warn(`Incomplete player module definition: '${ __filename }.moduleName'`);\n        return \"-\";\n    }\n\n    get moduleVersion() {\n        this.player.log.warn(`Incomplete player module definition: '${ __filename }.moduleVersion'`);\n        return \"0.0.0\";\n    }\n\n    async getDictionaries() {\n        return null;\n    }\n}\n","import PluginModule from \"../core/PluginModule\";\nimport packageData from \"../../../package.json\";\n\nlet g_pluginModule = null;\n\nexport default class PaellaCoreVideoFormats extends PluginModule {\n    static Get() {\n        if (!g_pluginModule) {\n            g_pluginModule = new PaellaCoreVideoFormats();\n        }\n        return g_pluginModule;\n    }\n\n    get moduleName() {\n        return \"paella-core default video formats\";\n    }\n\n    get moduleVersion() {\n        return packageData.version;\n    }\n}","import VideoPlugin, { Video } from '../core/VideoPlugin';\nimport { resolveResourcePath } from '../core/utils';\n\nimport PaellaCoreVideoFormats from './PaellaCoreVideoFormats';\n\nfunction getAsyncImage(src) {\n    return new Promise((resolve, reject) => {\n        const img = new Image();\n        img.addEventListener(\"load\", evt => {\n            resolve(img);\n        });\n        img.addEventListener(\"error\", evt => {\n            reject(new Error(\"Could not load preview image. The preview image is required in audio only streams\"));\n        })\n        img.src = src;\n    });\n}\n\nfunction asyncLoadAudio(player, audio, src) {\n    return new Promise((resolve, reject) => {\n        audio.oncanplay = () => resolve();\n        audio.onerror = () => reject(new Error(player.translate(\"Error loading audio: $1\", [src])));\n        audio.src = resolveResourcePath(player, src);\n        resolve();\n    });\n}\n\n\nexport class AudioOnlyVideo extends Video {\n    constructor(player, parent, isMainAudio) {\n        super('audio', player, parent);\n\n        this.isMainAudio = isMainAudio;\n        this._ready = false;\n    }\n\n    get streamType() { return \"audio\"; }\n\n    waitForLoaded() {\n        return new Promise(resolve => {\n            const waitReady = () => {\n                if (this._ready) {\n                    resolve();\n                }\n                else {\n                    setTimeout(waitReady, 100);\n                }\n            }\n    \n            waitReady();\n        })\n    }\n\n    async play() {\n        await this.waitForLoaded();\n        this.audio.play();\n    }\n\n    async pause() {\n        await this.waitForLoaded();\n        this.audio.pause();\n    }\n\n    async duration() {\n        await this.waitForLoaded();\n        return this.audio.duration;\n    }\n\n    get currentTimeSync() {\n        return this.audio?.currentTime || 0;\n    }\n\n    async currentTime() {\n        await this.waitForLoaded();\n        return this.audio.currentTime;\n    }\n\n    async setCurrentTime(t) {\n        await this.waitForLoaded();\n        this.audio.currentTime = t;\n    }\n\n    async volume() {\n        await this.waitForLoaded();\n        return this.audio.volume;\n    }\n\n    async setVolume(v) {\n        await this.waitForLoaded();\n        this.audio.volume = v;\n    }\n\n    async paused() {\n        await this.waitForLoaded();\n        return this.audio.paused;\n    }\n\n    async playbackRate() {\n        await this.waitForLoaded();\n        return this.audio.playbackRate;\n    }\n\n    async setPlaybackRate(pr) {\n        await this.waitForLoaded();\n        this.audio.playbackRate = pr;\n    }\n\n    // getQualities(), setQuality(q), get currentQuality(): audio format does not support multiquality\n\n    async getDimensions() {\n        return { \n            w: this._previewImage.width, \n            h: this._previewImage.height\n        };\n    }\n\n    async loadStreamData(streamData = null) {\n        this._streamData = this._streamData || streamData;\n        this.player.log.debug(\"es.upv.paella.audioVideoFormat: loadStreamData\");\n\n        const previewSrc = this.player.videoManifest.metadata.preview;\n        if (!previewSrc || previewSrc == null) {\n            throw new Error(\"Invalid video manifest data: preview image is required\");\n        }\n        this._previewImage = await getAsyncImage(previewSrc);\n        this._imageContainer = document.createElement(\"div\");\n        this._imageContainer.className = \"image-container\";\n        this.parent.appendChild(this._imageContainer);\n        this._imageContainer.appendChild(this._previewImage);\n\n        this._source = streamData.sources.audio && streamData.sources.audio[0];\n        if (!this._source) {\n            throw new Error(\"Invalid source in audio only video stream\");\n        }\n\n        if (!this.isMainAudioPlayer) {\n            throw new Error(\"Audio only video stream must be main audio player. Check the role property at video manifest\");\n        }\n\n        await asyncLoadAudio(this.player, this.audio, this._source.src);\n\n        const fixAspectRatio = () => {\n            const parentRatio = \n                this.player.videoContainer.baseVideoRect.offsetWidth /\n                this.player.videoContainer.baseVideoRect.offsetHeight;\n            const imageRatio = this._previewImage.width / this._previewImage.height;\n            if (parentRatio > imageRatio) {\n                this._previewImage.classList.add('landscape');\n                this._previewImage.classList.remove('portrait');\n            }\n            else {\n                this._previewImage.classList.add('portrait');\n                this._previewImage.classList.remove('landscape');\n            }\n        }\n\n        if (this.player.frameList.frames.length > 0) {\n            this.audio.addEventListener(\"timeupdate\", evt => {\n                const img = this.player.frameList.getImage(evt.target.currentTime, true);\n                if (this._previewImage.src != img.url) {\n                    this._previewImage.src = img.url;\n                    this._previewImage.onload = () => fixAspectRatio();\n                }\n            });\n        }\n\n        window.addEventListener(\"resize\", evt => fixAspectRatio());\n        fixAspectRatio();\n\n        this._ready = true;\n    }\n}\n\nexport default class AudioVideoPlugin extends VideoPlugin {\n    getPluginModuleInstance() {\n        return PaellaCoreVideoFormats.Get();\n    }\n\n    get name() {\n\t\treturn super.name || \"es.upv.paella.audioVideoFormat\";\n\t}\n\n    get streamType() {\n        return \"audio\";\n    }\n\n    async isCompatible(streamData) {\n        return streamData.sources.audio != null;\n    }\n\n    async getVideoInstance(playerContainer, isMainAudio) {\n        return new AudioOnlyVideo(this.player, playerContainer, isMainAudio);\n    }\n\n    getCompatibleFileExtensions() {\n        return [\"m4a\",\"mp3\"];\n    }\n\n    getManifestData(fileUrls) {\n        return {\n            audio: fileUrls.map(url => ({\n                src: url\n            }))\n        };\n    }\n}\n\n","import { getFileExtension, resolveResourcePath, supportsVideoType } from \"../core/utils\";\nimport VideoPlugin, { Video } from \"../core/VideoPlugin\";\nimport PaellaCoreVideoFormats from \"./PaellaCoreVideoFormats\";\n\nexport class HtmlVideo extends Video {\n    constructor(player, parent, isMainAudio, config) {\n        super('video', player, parent);\n        this._config = config || {};\n\n        const crossorigin = this._config.crossOrigin ?? \"\";\n        this.element.setAttribute(\"playsinline\",\"\");\n        if (crossorigin !== false) {\n            this.element.setAttribute(\"crossorigin\",crossorigin);\n        }\n\n        this.isMainAudio = isMainAudio;\n\n        // Autoplay is required to play videos in some browsers\n        this.element.setAttribute(\"autoplay\",\"\");\n        this.element.autoplay = true;\n\n        // The video is muted by default, to allow autoplay to work\n        if (!isMainAudio) {\n            this.element.muted = true;\n        }\n\n        this._videoEnabled = true;\n    }\n\n    async play() { \n        if (this._videoEnabled) {\n            try {\n                await this.waitForLoaded();\n                return this.video.play();\n            }\n            catch (e) {\n                // Prevent AbortError exception\n            }\n        }\n        else {\n            this._disabledProperties.paused = false;\n        }\n    }\n    \n    async pause() {\n        if (this._videoEnabled) {\n            await this.waitForLoaded();\n            return this.video.pause();\n        }\n        else {\n            this._disabledProperties.paused = true;\n        }\n    }\n\n    async duration() {\n        if (this._videoEnabled) {\n            await this.waitForLoaded();\n            return this.video.duration;\n        }\n        else {\n            return this._disabledProperties.duration;\n        }\n    }\n\n    get currentTimeSync() {\n        if (this._videoEnabled) {\n            return this.ready ? this.video.currentTime : -1;\n        }\n        else {\n            return this._disabledProperties.currentTime;\n        }\n    }\n    \n    async currentTime() {\n        if (this._videoEnabled) {\n            await this.waitForLoaded();\n            return this.currentTimeSync;\n        }\n        else {\n            return this._disabledProperties.currentTime;\n        }\n    }\n\n    async setCurrentTime(t) {\n        if (this._videoEnabled) {\n            await this.waitForLoaded();\n            return this.video.currentTime = t;\n        }\n        else {\n            this._disabledProperties.currentTime = t;\n            return t;\n        }\n    }\n\n    async volume() {\n        if (this._videoEnabled) {\n            await this.waitForLoaded();\n            return this.video.volume;\n        }\n        else {\n            return this._disabledProperties.volume;\n        }\n    }\n\n    async setVolume(v) {\n        if (this._videoEnabled) {\n            await this.waitForLoaded();\n            if (v === 0) {\n                this.video.setAttribute(\"muted\", \"\");\n            }\n            else {\n                this.video.removeAttribute(\"muted\");\n            }\n            return this.video.volume = v;\n        }\n        else {\n            this._disabledProperties.volume = v;\n            return v;\n        }\n    }\n\n    async paused() {\n        if (this._videoEnabled) {\n            await this.waitForLoaded();\n            return this.video.paused;\n        }\n        else {\n            return this._disabledProperties.paused;\n        }\n    }\n\n    async playbackRate() {\n        if (this._videoEnabled) {\n            await this.waitForLoaded();\n            return await this.video.playbackRate;\n        }\n        else {\n            return this._disabledProperties.playbackRate;\n        }\n    }\n\n    async setPlaybackRate(pr) {\n        if (this._videoEnabled) {\n            await this.waitForLoaded();\n            return this.video.playbackRate = pr;\n        }\n        else {\n            this._disabledProperties.playbackRate = pr;\n            return pr;\n        }\n    }\n\n    async getQualities() {\n\n    }\n\n    async setQuality(/* q */) {\n    }\n\n    get currentQuality() {\n        return 0;\n    }\n\n    async getDimensions() {\n        if (this._videoEnabled) {\n            await this.waitForLoaded();\n            return { w: this.video.videoWidth, h: this.video.videoHeight };\n        }\n        else {\n            return { w: this._disabledProperties.videoWidth, h: this._disabledProperties.videoHeight };\n        }\n    }\n\n    saveDisabledProperties(video) {\n        this._disabledProperties = {\n            duration: video.duration,\n            volume: video.volume,\n            videoWidth: video.videoWidth,\n            videoHeight: video.videoHeight,\n            playbackRate: video.playbackRate,\n            paused: video.paused,\n            currentTime: video.currentTime\n        }\n    }\n\n    async loadStreamData(streamData = null) {\n        this._streamData = this._streamData || streamData;\n        this.player.log.debug(\"es.upv.paella.htmlVideoFormat: loadStreamData\");\n\n        this._sources = streamData.sources.html;\n        this._currentQuality = 0;\n\n        if (!this.isMainAudioPlayer) {\n            this.video.muted = true;\n        }\n\n        this._sources.forEach(({ src, mimetype }) => {\n            src = resolveResourcePath(this.player, src);\n            const source = document.createElement('source');\n            source.src = src;\n            source.type = mimetype;\n            this.video.appendChild(source);\n        });\n\n        this._endedCallback = this._endedCallback || (() => {\n            if (typeof(this._videoEndedCallback) == \"function\") {\n                this._videoEndedCallback();\n            }\n        });\n        this.video.addEventListener(\"ended\", this._endedCallback);\n\n        // It's necessary to play the video because some browsers don't update the\n        // readyState property until the video is played.\n        try {\n            await this.video.play();\n        }\n        catch (err) {\n            // Prevent AbortError exception\n        }\n        await this.waitForLoaded();\n\n        this.player.log.debug(`es.upv.paella.htmlVideoFormat (${ this.streamData.content }): video loaded and ready.`);\n        this.saveDisabledProperties(this.video);\n    }\n\n    async clearStreamData() {\n        this.video.src = \"\";\n        this.video.removeEventListener(\"ended\", this._endedCallback);\n        this.video.removeEventListener(\"loadeddata\", this._handleLoadedCallback);\n        this._ready = false;\n    }\n\n    get isEnabled() {\n        return this._videoEnabled;\n    }\n\n    async enable() {\n        this._videoEnabled = true;\n    }\n\n    async disable() {\n        if (this.isMainAudio) {\n            this.player.log.debug(\"video.disable() - the video is not disabled because it is the main audio source.\");\n        }\n        else {\n            this._videoEnabled = false;\n        }\n\n        return this._videoEnabled;\n    }\n\n    waitForLoaded() {\n        return new Promise((resolve,reject) => {\n            if (this.video.readyState>=2) {\n                this._ready = true;\n            }\n\n            if (this.ready) {\n                resolve();\n            }\n            else {\n                this._handleLoadedCallback = evt => {\n                    if (this.video.readyState>=2) {\n                        this.video.pause();\n                        this._ready = true;\n                        resolve();\n                    }\n                }\n                this.video.addEventListener(\"loadeddata\", this._handleLoadedCallback);\n            }\n        })\n    }\n}\n\nexport default class HtmlVideoPlugin extends VideoPlugin {\n    getPluginModuleInstance() {\n        return PaellaCoreVideoFormats.Get();\n    }\n    \n    get name() {\n\t\treturn super.name || \"es.upv.paella.htmlVideoFormat\";\n\t}\n\n    get streamType() {\n        return \"html\";\n    }\n\n    async isCompatible(streamData) {\n        const { html } = streamData.sources;\n        return html && html.some(videoData => supportsVideoType(videoData.mimetype));\n    }\n\n    async getVideoInstance(playerContainer, isMainAudio) {\n        return new HtmlVideo(this.player, playerContainer, isMainAudio, this.config);\n    }\n\n    getCompatibleFileExtensions() {\n        return [\"m4v\",\"mp4\",\"ogg\",\"webm\",\"ogv\"];\n    }\n\n    getManifestData(fileUrls) {\n        const getMimeType = (url) => {\n            switch (getFileExtension(url)) {\n            case 'mp4':\n            case 'm4v':\n                return 'video/mp4';\n            case 'webm':\n                return 'video/webm';\n            case 'ogg':\n            case 'ogv':\n                return 'video/ogg';\n            default:\n                return null;\n            }\n        }\n        return {\n            html: fileUrls.map(url => ({\n                src: url,\n                mimetype: getMimeType(url)\n            }))\n        }\n    }\n}","\nexport default class VideoQualityItem {\n    constructor({ label, shortLabel, isAuto = false, index = 0, src = \"\", width = -1, height = -1, bitrate = -1 }) {\n        this._label = label;\n        this._shortLabel = shortLabel;\n        this._index = index;\n        this._src = src;\n        this._res = {\n            w: width,\n            h: height\n        }\n        this._bitrate = bitrate;\n        this._isAuto = isAuto;\n    }\n\n    get label() { return this._label; }\n    get shortLabel() { return this._shortLabel; }\n    get index() { return this._index; }\n    get src() { return this._src; }\n    get res() { return this._res; }\n    get bitrate() { return this._bitrate; }\n    get isAuto() { return this._isAuto; }\n\n    get quality() {\n        if (this._res.w !== -1 && this._res.h !== -1) {\n            return this._res.w * this._res.h;\n        }\n        else {\n            return this._bitrate;\n        }\n    }\n\n    compare(other) {\n        return other.quality - this.quality;\n    }\n}\n","import VideoPlugin, { Video } from '../core/VideoPlugin';\nimport { resolveResourcePath } from '../core/utils';\nimport VideoQualityItem from '../core/VideoQualityItem';\nimport PaellaCoreVideoFormats from './PaellaCoreVideoFormats';\n\nfunction updateFrame(t) {\n\tlet frame = this._currentSource.frames[0];\n\tthis._currentSource.frames.some(f => {\n\t\tif (f.time<=this._currentTime) {\n\t\t\tframe = f;\n\t\t}\n\t\telse {\n\t\t\treturn true;\n\t\t}\n\t});\n\tthis.img.src = frame.src;\n}\n\nfunction startTimeUpdate() {\n\tthis._startTimestamp = Date.now();\n\tconst timerFunc = () => {\n\t\tthis._timer = setTimeout(timerFunc, 250);\n\t\tconst current = Date.now();\n\t\tconst interval = current - this._startTimestamp;\n\t\tthis._currentTime += interval / 1000;// * this._playbackRate;\n\t\tthis._startTimestamp = current;\n\t\tupdateFrame.apply(this, [this._currentTime]);\n\t}\n\t\n\ttimerFunc();\n}\n\nfunction stopTimeUpdate() {\n\tif (this._timer) {\n\t\tclearTimeout(this._timer);\n\t\tthis._timer = null;\n\t}\n}\n\nexport class ImageVideo extends Video {\n\tconstructor(player, parent) {\n\t\tsuper('img', player, parent);\n\t\t\n\t\tthis._currentTime = 0;\n\t\tthis._startTimesamp = 0;\n\t\tthis._playbackRate = 1;\n\t\tthis._timer = null;\n\t\t\n\t\tthis.video = this.domElement;\n\t}\n\t\n\tasync play() {\n\t\tstartTimeUpdate.apply(this);\n\t}\n\t\n\tasync pause() {\n\t\tstopTimeUpdate.apply(this);\n\t}\n\t\n\tasync duration() {\n\t\treturn this._currentSource.duration;\n\t}\n\t\n\tget currentTimeSync() {\n\t\treturn this._currentTime;\n\t}\n\t\n\tasync currentTime() {\n\t\treturn this._currentTime;\n\t}\n\t\n\tasync setCurrentTime(t) {\n\t\tthis._currentTime = t;\n\t\tupdateFrame.apply(this, [t]);\n\t}\n\t\n\tasync volume() {\n\t\treturn 0;\n\t}\n\t\n\tasync setVolume(v) {\n\t\t\n\t}\n\t\n\tasync paused() {\n\t\treturn this._timer === null;\n\t}\n\t\n\tasync playbackRate() {\n\t\treturn this._playbackRate;\n\t}\n\t\n\tasync setPlaybackRate(pr) {\n\t\tthis._playbackRate = pr;\n\t}\n\t\n\tasync getQualities() {\n\t\treturn this._qualities;\n\t}\n\t\n\tasync setQuality(/* q */) {\n\t\t// TODO: This implement this\n\t}\n\t\n\tget currentQuality() {\n\t\treturn this._currentQuality;\n\t}\n\t\n\tasync getDimensions() {\n\t\treturn this._currentSource.res;\n\t}\n\t\n\tasync loadStreamData(streamData) {\n\t\tthis._sources = streamData.sources.image;\n\t\tthis._qualities = this._sources.map(src => {\n\t\t\treturn new VideoQualityItem({\n\t\t\t\tsrc: src.frames[0].src,\n\t\t\t\tlabel: `${src.res.w}x${src.res.h}`,\n\t\t\t\tshortLabel: `${src.res.h}p`,\n\t\t\t\twidth: src.res.w,\n\t\t\t\theight: src.res.h\n\t\t\t});\n\t\t});\n\n\t\t// Select the higher quality frame, by default\n\t\tthis._currentQuality = this._qualities.length - 1;\n\t\tthis._qualities.forEach((q,i) => {\n\t\t\tconst currentQuality = this._qualities[this._currentQuality];\n\t\t\tif (currentQuality.compare(q)>0) {\n\t\t\t\tthis._currentQuality = i;\n\t\t\t}\n\t\t});\n\t\tthis._currentSource = this._sources[this._currentQuality];\n\t\t\n\t\t// Sort frames\n\t\tthis._sources.forEach(src => {\n\t\t\tsrc.frames.sort((a,b) => a.time - b.time);\n\n\t\t});\n\t\t\n\t\treturn true;\n\t}\n}\n\nexport default class ImageVideoPlugin extends VideoPlugin {\n\tgetPluginModuleInstance() {\n        return PaellaCoreVideoFormats.Get();\n    }\n\t\n\tget name() {\n\t\treturn super.name || \"es.upv.paella.imageVideoFormat\";\n\t}\n\n\tget streamType() {\n\t\treturn \"image\";\n\t}\n\n\tasync isCompatible(streamData) {\n\t\treturn streamData.sources.image != null;\n\t}\n\t\n\tasync getVideoInstance(playerContainer, isMainAudio) {\n\t\treturn new ImageVideo(this.player, playerContainer, this.config, isMainAudio);\n\t}\n}\n","import VideoPlugin, { Video } from '../core/VideoPlugin';\nimport { resolveResourcePath, supportsVideoType } from '../core/utils';\nimport PaellaCoreVideoFormats from './PaellaCoreVideoFormats';\nimport { HtmlVideo } from './es.upv.paella.htmlVideoFormat';\nexport class Mp4Video extends HtmlVideo {\n    constructor(player, parent, isMainAudio, config) {\n        super(player, parent, isMainAudio, config);\n    }\n\n    // This function is called when the player loads, and it should\n    // make everything ready for video playback to begin.\n    async loadStreamData(streamData = null) {\n        this._streamData = this._streamData || streamData;\n        this.player.log.debug(\"es.upv.paella.mp4VideoFormat: loadStreamData\");\n\n        if (!this._currentSource) {\n            this._sources = null;\n            this._currentQuality = 0;\n    \n            this._sources = streamData.sources.mp4;\n            this._sources.sort((a,b) => {\n                return Number(a.res.w) - Number(b.res.w);\n            });\n            this._currentQuality = this._sources.length - 1;\n            this._currentSource = this._sources[this._currentQuality];\n        }\n\n        if (!this.isMainAudioPlayer) {\n            this.video.muted = true;\n        }\n\n        if (this._initialVolume) {\n            this.video.volume = this._initialVolume;\n            if (this._initialVolume === 0) {\n                this.video.muted = true;\n            }\n        }\n        \n        this.video.src = resolveResourcePath(this.player, this._currentSource.src);\n        this._endedCallback = this._endedCallback || (() => {\n            if (typeof(this._videoEndedCallback) == \"function\") {\n                this._videoEndedCallback();\n            }\n        });\n        this.video.addEventListener(\"ended\", this._endedCallback);\n        \n        // It's necessary to play the video because some browsers don't update the\n        // readyState property until the video is played.\n        try {\n            await this.video.play();\n        }\n        catch (err) {\n            // Prevent AbortError exception\n        }\n        await this.waitForLoaded();\n        \n        this.player.log.debug(`es.upv.paella.mp4VideoFormat (${ this.streamData.content }): video loaded and ready.`);\n        this.saveDisabledProperties(this.video);\n    }\n}\n\nexport default class Mp4VideoPlugin extends VideoPlugin {\n    getPluginModuleInstance() {\n        return PaellaCoreVideoFormats.Get();\n    }\n    \n    get name() {\n\t\treturn super.name || \"es.upv.paella.mp4VideoFormat\";\n\t}\n\n    get streamType() {\n        return \"mp4\";\n    }\n\n    isCompatible(streamData) {\n        const { mp4 } = streamData.sources;\n        return mp4 && supportsVideoType(mp4[0]?.mimetype);\n    }\n\n    async getVideoInstance(playerContainer, isMainAudio) {\n        return new Mp4Video(this.player, playerContainer, isMainAudio, this.config);\n    }\n    \n    getCompatibleFileExtensions() {\n        return [\"m4v\",\"mp4\"];\n    }\n\n    getManifestData(fileUrls) {\n        return {\n            mp4: fileUrls.map(url => ({\n                src: url,\n                mimetype: 'video/mp4'\n            }))\n        };\n    }\n}","import Plugin from '../core/Plugin';\nimport { loadPluginsOfType } from '../core/plugin_tools';\nexport async function loadCaptionsPlugins(player) {\n    const enabledCaptionsPlugins = [];\n    await loadPluginsOfType(player, \"captions\", async (plugin) => {\n        enabledCaptionsPlugins.push(plugin);\n    });\n\n    for (let i in enabledCaptionsPlugins) {\n        const plugin = enabledCaptionsPlugins[i];\n        const captions = await plugin.getCaptions();\n        const captionsCanvas = player.captionsCanvas;\n        captions.forEach(c => captionsCanvas.addCaptions(c));\n    }\n}\n\nexport default class CaptionsPlugin extends Plugin {\n    get type() { return \"captions\"; }\n    \n    async load() {\n        this.player.log.debug(\"load captions plugin\");\n    }\n\n    async getCaptions() {\n        this.player.log.warn(`CaptionsPlugin ${this.name}: getCaptions() is not implemented.`);\n        return [];\n    }\n}\n","\nimport { timeToSeconds, secondsToTime } from '../core/utils';\n\nexport default class Captions {\n    get cues() {\n        return this._cues;\n    }\n\n    get label() {\n        return this._label;\n    }\n\n    get language() {\n        return this._lang;\n    }\n\n    set label(l) {\n        this._label = l;\n    }\n\n    set language(l) {\n        this._lang = l;\n    }\n\n    constructor(label = \"\", lang = \"\") {\n        this._cues = [];\n        this._label = label;\n        this._lang = lang;\n    }\n\n    addCue({ label = \"\", start, end, captions }) {\n        const cue = {\n            label\n        };\n\n        if (typeof(captions) === \"string\") {\n            cue.captions = [captions];\n        }\n        else if (Array.isArray(captions)) {\n            cue.captions = captions;\n        }\n        else {\n            throw Error(\"Invalid cue caption format: must be an array of strings or a string\");\n        }\n\n        if (typeof(start) === \"string\") {\n            cue.start = timeToSeconds(start);\n            cue.startString = start;\n        }\n        else if (typeof(start) === \"number\") {\n            cue.start = start;\n            cue.startString = secondsToTime(start);\n        }\n        else {\n            throw Error(\"Invalid cue timestamp format: must be a valid time string or a number of seconds\");\n        }\n\n        if (typeof(end) === \"string\") {\n            cue.end = timeToSeconds(end);\n            cue.endString = end;\n        }\n        else if (typeof(end) === \"number\") {\n            cue.end = end;\n            cue.endString = secondsToTime(end);\n        }\n        else {\n            throw Error(\"Invalid cue timestamp format: must be a valid time string or a number of seconds\");\n        }\n\n        this._cues.push(cue);\n        return cue;\n    }\n\n    getCue(instant) {\n        if (typeof(instant) === \"string\") {\n            instant = timeToSeconds(instant);\n        }\n        else if (typeof(instant) !== \"number\") {\n            throw Error(\"Invalid time instant format getting cue\");\n        }\n\n        let result = null;\n        this._cues.some(cue => {\n            if (instant>=cue.start && instant<=cue.end) {\n                result = cue;\n                return true;\n            }\n        });\n        return result;\n    }\n}\n","import Captions from \"./Captions\";\nimport { timeToMilliseconds } from \"../core/utils\";\n\nexport function parseDFXP(player, text) {\n    const captions = {};\n\n\n    const parser = new DOMParser();\n    const doc = parser.parseFromString(text, 'text/xml');\n\n    Array.from(doc.getElementsByTagName('div')).forEach(div => {\n        const lang = div.getAttribute('xml:lang') || \"unknonw\";\n        captions[lang] = captions[lang] || new Captions(player.translate(lang), lang);\n        \n        Array.from(div.getElementsByTagName('p')).forEach(p => {\n            const begin = timeToMilliseconds(p.getAttribute('begin'))\n            captions[lang].addCue({\n                label: `caption_${p.getAttribute('xml:id') || begin}`,\n                start: begin / 1000,\n                end: timeToMilliseconds(p.getAttribute('end')) / 1000,\n                captions: p.innerHTML\n            });\n        })\n    })\n    \n\n    return captions;\n}\n\nexport default class DFXPParser {\n    constructor(player, text = \"\") {\n        this.player = player;\n        this._text = text;\n        this._captions = parseDFXP(this.player, text);\n    }\n\n    get text() {\n        return this._text;\n    }\n\n    set text(text) {\n        this._text = text;\n        this._captions = parseDFXP(text);\n    }\n\n    get captions() {\n        return this._captions;\n    }\n}","import PluginModule from \"../core/PluginModule\";\nimport packageData from \"../../../package.json\";\n\nlet g_pluginModule = null;\n\nexport default class PaellaCorePlugins extends PluginModule {\n    static Get() {\n        if (!g_pluginModule) {\n            g_pluginModule = new PaellaCorePlugins();\n        }\n        return g_pluginModule;\n    }\n\n    get moduleName() {\n        return \"paella-core default plugins\";\n    }\n\n    get moduleVersion() {\n        return packageData.version;\n    }\n}","\nimport CaptionsPlugin from '../captions/CaptionsPlugin';\nimport DFXPParser from '../captions/DFXPParser';\nimport PaellaCorePlugins from './PaellaCorePlugins';\n\nimport { resolveResourcePath } from '../core/utils';\n\nexport default class DfxpManifestCaptionsPlugin extends CaptionsPlugin {\n    getPluginModuleInstance() {\n        return PaellaCorePlugins.Get();\n    }\n    \n    get name() {\n\t\treturn super.name || \"es.upv.paella.dfxpManifestCaptionsPlugin\";\n\t}\n\n    async isEnabled() {\n        const enabled = await super.isEnabled();\n        return  enabled &&\n                this.player.videoManifest.captions &&\n                this.player.videoManifest.captions.length>0;\n    }\n\n    async getCaptions() {\n        const result = [];\n        const p = [];\n        this.player.videoManifest.captions.forEach(captions => {\n            p.push(new Promise(async (resolve, reject) => {\n                if (/dfxp/i.test(captions.format)) {\n                    const fileUrl = resolveResourcePath(this.player, captions.url);\n                    const fetchResult = await fetch(fileUrl);    \n                    if (fetchResult.ok) {\n                        let text = await fetchResult.text();\n                        // fix malformed xml replacing the malformed characters with blank\n                        // Ignore no-control-regex is Ok for cleaning test per eslint docs\n                        // \"If you need to use control character pattern matching, then you should turn this rule off.\"\n                        // ref https://eslint.org/docs/latest/rules/no-control-regex\n                        // eslint-disable-next-line no-control-regex\n                        text = text.replace(/[^\\x09\\x0A\\x0D\\x20-\\xFF\\x85\\xA0-\\uD7FF\\uE000-\\uFDCF\\uFDE0-\\uFFFD]/gm, '');\n                        text = text.replace(/&\\w+;/gmi,'');\n                        text = text.replaceAll('<br>','');\n                        \n                        const parser = new DFXPParser(this.player, text);\n                        Object.entries(parser.captions).forEach(([lang,captions]) => {\n                            result.push(captions);\n                        });\n                        resolve();\n                    }\n                    else {\n                        reject();\n                    }\n                }\n                else {\n                    reject();\n                }\n            }));\n        });\n        await Promise.allSettled(p);\n        return result;\n    }\n}\n","import Plugin from './Plugin';\n\nexport default class UserInterfacePlugin extends Plugin {\n    constructor(player,config,name) {\n        super(player,config,name);\n        this.__uiPlugin = true;\n    }\n\n    async getDictionaries() {\n        return null;\n    }\n}","\nlet g_currentLang = \"en\";\nlet g_defaultLanguage = \"\";\n\nconst g_dictionaries = {\n};\n\nexport function defaultTranslateFunction(word) {\n    const dict = g_dictionaries[g_currentLang] || {}\n    const defaultDict = g_dictionaries[g_defaultLanguage] || {};\n    return dict[word] || defaultDict[word] || word;\n}\n\nexport function defaultSetLanguageFunction(lang) {\n    g_currentLang = lang;    \n}\n\nexport function defaultGetLanguageFunction() {\n    return g_currentLang;\n}\n\nexport function defaultAddDictionaryFunction(lang,dict) {\n\n    g_dictionaries[lang] = g_dictionaries[lang] || {};\n    \n    for (const key in dict) {\n        const translation = dict[key];\n        g_dictionaries[lang][key] = translation;\n    }\n}\n\nexport function defaultGetDictionariesFunction() {\n    return g_dictionaries;\n}\n\nexport function defaultGetDefaultLanguageFunction(player) {\n    return player.config.defaultLanguage || navigator.language;\n}\n\nlet g_translateFunc = defaultTranslateFunction;\n\nlet g_setLanguageFunc = defaultSetLanguageFunction;\n\nlet g_getLanguageFunc = defaultGetLanguageFunction;\n\nlet g_defaultAddDictionary = defaultAddDictionaryFunction;\n\nlet g_defaultGetDictionaries = defaultGetDictionariesFunction;\n\nlet g_defaultGetDefaultLang = defaultGetDefaultLanguageFunction;\n\nexport function translate(word, keys = null) {\n    const translated = g_translateFunc(word);\n    if (Array.isArray(keys)) {\n        let result = translated;\n        keys.forEach((key,index) => {\n            const temp = `$${index + 1}`;\n            result = result.replace(temp,key);\n        });\n        return result;\n    }\n    else {\n        return translated;\n    }\n}\n\nexport function setLanguage(lang) {\n    g_setLanguageFunc(lang);\n}\n\nexport function getLanguage() {\n    return g_getLanguageFunc();\n}\n\nexport function addDictionary(lang,dict) {\n    g_defaultAddDictionary(lang, dict);\n}\n\nexport function getDictionaries() {\n    return g_defaultGetDictionaries();\n}\n\nexport function getDefaultLanguage(player) {\n    return g_defaultGetDefaultLang(player);\n}\n\nexport function setTranslateFunction(fn) {\n    g_translateFunc = fn;\n}\n\nexport function setSetLanguageFunction(fn) {\n    g_setLanguageFunc = fn;\n}\n\nexport function setGetLanguageFunction(fn) {\n    g_getLanguageFunc = fn;\n}\n\nexport function setAddDictionaryFunction(fn) {\n    g_defaultAddDictionary = fn;\n}\n\nexport function setGetDictionariesFunction(fn) {\n    g_defaultGetDictionaries = fn;\n}\n\nexport function setGetDefaultLanguageFunction(fn) {\n    g_defaultGetDefaultLang = fn;\n}\n\nexport function setupDefaultLanguage(player) {\n    g_defaultLanguage = getDefaultLanguage(player);\n}","import UserInterfacePlugin from './UserInterfacePlugin';\nimport { getPluginsOfType } from './plugin_tools';\nimport { createElementWithHtmlText } from './dom';\nimport Events, { triggerEvent } from './Events';\nimport { translate } from './Localization';\nimport { sanitizeHTML } from './utils';\n\nexport function getButtonPlugins(player, side = \"any\", parent = \"playbackBar\") {\n\treturn getPluginsOfType(player, \"button\")\n\t\t.filter(btn => {\n\t\t\treturn (btn.side === side || side === \"any\") && btn.parent === parent\n\t\t});\n}\n\nexport function getLeftButtonPlugins(player) {\n\treturn getButtonPlugins(player, \"left\", \"playbackBar\");\n}\n\nexport function getRightButtonPlugins(player) {\n\treturn getButtonPlugins(player, \"right\", \"playbackBar\");\n}\n\nexport async function addButtonPlugin(plugin, buttonAreaElem) {\n\tconst parent = createElementWithHtmlText('<li></li>', buttonAreaElem);\n\tparent.plugin = plugin;\n\tconst ariaLabel = translate(plugin.ariaLabel);\n\tconst description = translate(plugin.description);\n\tconst fixedSizeClass = plugin.dynamicWidth ? 'dynamic-width' : 'fixed-width';\n\tconst id = plugin.id ? `id=\"${plugin.id}\" ` : \"\";\n\tconst name = plugin.buttonName ? `name=\"${plugin.buttonName}\" ` : \"\";\n\tconst tabIndex = plugin.tabIndex ? ` tabindex=\"${plugin.tabIndex}\" ` : \"\";\n\n\tif (plugin.interactive) {\n\t\tconst button = createElementWithHtmlText(`\n\t\t\t<button type=\"button\" ${id}${name}class=\"${ fixedSizeClass }\"${ tabIndex }aria-label=\"${ ariaLabel }\" title=\"${ description }\">\n\t\t\t</button>\n\t\t`, parent);\n\n\t\tif (plugin.className !== \"\") {\n\t\t\tbutton.classList.add(plugin.className);\n\t\t}\n\n\t\tplugin._button = button;\n\t\tplugin._container = parent;\n\t\tbutton._pluginData = plugin;\n\t\tparent._pluginData = plugin;\n\t\n\t\tbutton.addEventListener(\"click\", (evt) => {\n\t\t\tconst plugin = button._pluginData;\n\t\t\ttriggerEvent(plugin.player, Events.BUTTON_PRESS, {\n\t\t\t\tplugin: plugin\n\t\t\t});\n\t\t\tplugin.action(evt, null);\n\t\t\t\n\t\t\t\n\t\t\tevt.stopPropagation();\n\n\t\t\t// We remove the focus on the button click event, because otherwise the user\n\t\t\t// interface will never be hidden.\n\t\t\t// We use pageX and pageY to differentiate the origin of the click: if it was produced\n\t\t\t// by a keyboard action, then we do not remove the focus so as not to hinder accessibility.\n\t\t\tif (evt.pageX !== 0 && evt.pageY !== 0) {\n\t\t\t\tdocument.activeElement.blur();\n\t\t\t}\n\t\t});\n\n\t\tlet addHiddenTimer = null;\n\t\tconst clearHideTimer = () => {\n\t\t\tif (addHiddenTimer) {\n\t\t\t\tclearTimeout(addHiddenTimer);\n\t\t\t\taddHiddenTimer = null;\n\t\t\t}\n\t\t}\n\t\tconst addHiddenClass = () => {\n\t\t\tclearHideTimer();\n\t\t\taddHiddenTimer = setTimeout(() => {\n\t\t\t\tif (plugin.leftSideContainerPresent) {\n\t\t\t\t\tplugin.leftSideContainer.classList.add(\"hidden\");\n\t\t\t\t}\n\t\t\t\tif (plugin.rightSideContainerPresent) {\n\t\t\t\t\tplugin.rightSideContainer.classList.add(\"hidden\");\n\t\t\t\t}\n\t\t\t\taddHiddenTimer = null;\n\t\t\t}, 300);\n\t\t}\n\n\t\tconst removeHiddenClass = () => {\n\t\t\tclearHideTimer();\n\t\t\tif (plugin.leftSideContainerPresent) {\n\t\t\t\tplugin.leftSideContainer.classList.remove(\"hidden\");\n\t\t\t}\n\t\t\tif (plugin.rightSideContainerPresent) {\n\t\t\t\tplugin.rightSideContainer.classList.remove(\"hidden\");\n\t\t\t}\n\t\t}\n\n\t\tbutton.addEventListener(\"focus\", removeHiddenClass);\n\t\tbutton.addEventListener(\"mouseover\", removeHiddenClass);\n\t\tbutton.addEventListener(\"mouseout\", addHiddenClass);\n\t\tbutton.addEventListener(\"blur\", addHiddenClass);\n\n\t\tconst clickWithSpacebar = plugin.player.config.accessibility?.clickWithSpacebar !== undefined ? \n\t\t\t\tplugin.player.config.accessibility?.clickWithSpacebar: true;\n\t\tif (!clickWithSpacebar) {\n\t\t\tbutton.addEventListener(\"keyup\", evt => {\n\t\t\t\t// prevent to send the clic event with spacebar\n\t\t\t\tif (evt.keyCode == 32 ) {\n\t\t\t\t\tevt.preventDefault();\n\t\t\t\t} \n\t\t\t});\n\t\t\tbutton.addEventListener(\"keydown\", evt => {\n\t\t\t\t// prevent to send the hover event with spacebar\n\t\t\t\tif (evt.keyCode == 32 ) {\n\t\t\t\t\tevt.preventDefault();\n\t\t\t\t} \n\t\t\t});\n\t\t}\n\n\t\tif (plugin.className !== \"\") {\n\t\t\tbutton.classList.add(plugin.className);\n\t\t}\n\t}\n\telse {\n\t\tconst button = createElementWithHtmlText(`\n\t\t\t<div ${id}${name} class=\"non-interactive ${ fixedSizeClass }\" title=\"${ description }\">\n\t\t\t</div>\n\t\t`, parent);\n\n\t\tplugin._button = button;\n\t\tplugin._container = parent;\n\t\tbutton._pluginData = plugin;\n\t\tparent._pluginData = plugin;\n\n\t\tif (plugin.className !== \"\") {\n\t\t\tbutton.classList.add(plugin.className);\n\t\t}\n\t}\n}\n\nconst getSideContainer = () => {\n\tconst container = document.createElement('span');\n\tcontainer.classList.add(\"side-container\");\n\tcontainer.classList.add(\"hidden\");\n\treturn container;\n}\n\n\nexport class ButtonPluginObserver {\n\tonIconChanged(plugin,prevIcon,newIcon) {}\n\tonTitleChanged(plugin,prevTitle,newTitle) {}\n\tonStateChanged(plugin,prevText,newText,prevIcon,newIcon) {}\n}\n\nexport default class ButtonPlugin extends UserInterfacePlugin {\n\tget type() { return \"button\" }\n\t\n\t// _container and _button are loaded in PlaybackBar\n\tget container() { return this._container; }\n\tget button() { return this._button; }\n\tget interactive() { return true; }\n\tget dynamicWidth() { return false; }\n\t\n\tgetId() {\n\t\treturn null;\n\t}\n\n\tget id() { return this.config.id || this.getId(); }\n\n\tgetButtonName() {\n\t\treturn null;\n\t}\n\n\tget buttonName() { return this.config.name || this.getButtonName() || this.name; }\n\n\tget ariaLabel() {\n\t\treturn this.config.ariaLabel || this.getAriaLabel();\n\t}\n\n\tgetAriaLabel() {\n\t\treturn \"\";\n\t}\n\n\tget tabIndex() {\n\t\treturn this.config.tabIndex || this.getTabIndex();\n\t}\n\n\tgetTabIndex() {\n\t\treturn null;\n\t}\n\n\tgetDescription() {\n\t\treturn \"\";\n\t}\n\n\tget description() {\n\t\treturn this.config.description || this.getDescription();\n\t}\n\n\tget minContainerSize() {\n\t\treturn this.config.minContainerSize || this.getMinContainerSize();\n\t}\n\n\tgetMinContainerSize() {\n\t\treturn 0;\n\t}\n\n\tsetObserver(observer) {\n\t\tif (observer instanceof ButtonPluginObserver) {\n\t\t\tthis._observer = observer;\n\t\t}\n\t\telse if (typeof observer.onIconChanged === \"function\" ||\n\t\t\ttypeof observer.onTitleChanged === \"function\" ||\n\t\t\ttypeof observer.onStateChanged === \"function\")\n\t\t{\n\t\t\tthis._observer = observer;\n\t\t}\n\t\telse {\n\t\t\tthrow new Error(\"Invalid observer for ButtonPlugin\");\n\t\t}\n\t}\n\t\n\tget icon() {\n\t\tif (!this._icon) {\n\t\t\tthis._icon = \"\";\n\t\t}\n\t\treturn this._icon;\n\t}\n\t\n\tset icon(icon) {\n\t\tif (typeof icon === \"string\") {\n\t\t\ticon = sanitizeHTML(icon);\n\t\t}\n\n\t\tthis._icon = icon;\n\t\tif (icon && this._button instanceof HTMLElement) {\n\t\t\tconst cur = this._button.querySelector('i') || createElementWithHtmlText(`<i></i>`, this._button);\n\t\t\tcur.innerHTML = icon;\n\t\t}\n\t\telse if (this._button instanceof HTMLElement){\n\t\t\tconst cur = this._button.querySelector('i');\n\t\t\tif (cur) {\n\t\t\t\tthis._button.removeChild(cur);\n\t\t\t}\n\t\t}\n\n\t\tif (this._observer?.onIconChanged) {\n\t\t\tthis._observer.onIconChanged(this, this._icon, icon);\n\t\t}\n\t}\n\n\tget title() {\n\t\treturn this._title || \"\";\n\t}\n\n\tset title(t) {\n\t\tthis._title = t;\n\t\tif (t && this._button instanceof HTMLElement) {\n\t\t\tconst cur = this._button.querySelector('span') || createElementWithHtmlText(`<span class=\"button-title-${ this.titleSize }\"></span>`, this._button);\n\t\t\tcur.innerHTML = t;\n\t\t}\n\t\telse if (this._button instanceof HTMLElement){\n\t\t\tconst cur = this._button.querySelector('span');\n\t\t\tif (cur) {\n\t\t\t\tthis._button.removeChild(cur);\n\t\t\t}\n\t\t}\n\n\t\tif (this._observer?.onTitleChanged) {\n\t\t\tthis._observer.onTitleChanged(this, this._title, t);\n\t\t}\n\t}\n\n\t// \"small\", \"medium\", \"large\"\n\tget titleSize() {\n\t\treturn \"medium\";\n\t}\n\t\n\t// \"left\" or \"right\"\n\tget side() {\n\t\tconst side = this.config?.side;\n\t\treturn side || \"left\";\n\t}\n\n\tget closePopUps() {\n\t\treturn this.config.closePopUps || this.getClosePopUps();\n\t}\n\n\tgetClosePopUps() {\n\t\treturn true;\n\t}\n\n\t// \"playbackBar\" or \"videoContainer\"\n\tget parentContainer() {\n\t\tconst parent = this.config?.parentContainer;\n\t\treturn parent || \"playbackBar\";\n\t}\n\t\n\tget className() { return \"\"; }\n\n\tenable() {\n\t\tthis._enabled = true;\n\t\tthis.show();\n\t}\n\n\tdisable() {\n\t\tthis._enabled = false;\n\t\tthis.hide();\n\t}\n\t\n\thide() {\n\t\tif (this._button) {\n\t\t\tthis._button.style.display = \"none\";\n\t\t}\n\t}\n\t\n\tshow() {\n\t\tif (this._enabled === false) {\n\t\t\treturn;\n\t\t}\n\t\tconst { width } = this.player.playbackBar.containerSize;\n\t\tif (this._button && (width > this.minContainerSize || this.parentContainer !== \"playbackBar\")) {\n\t\t\tthis._button.style.display = null;\n\t\t}\n\t}\n\n\t#leftSideContainer = null;\n\tget leftSideContainer() {\n\t\tif (!this.#leftSideContainer) {\n\t\t\tthis.#leftSideContainer = getSideContainer();\n\t\t\tthis.container.appendChild(this.#leftSideContainer);\n\t\t}\n\t\treturn this.#leftSideContainer;\n\t}\n\n\tget leftSideContainerPresent() {\n\t\treturn this.#leftSideContainer !== null;\n\t}\n\n\t#rightSideContainer = null;\n\tget rightSideContainer() {\n\t\tif (!this.#rightSideContainer) {\n\t\t\tthis.#rightSideContainer = getSideContainer();0\n\t\t\tthis.container.appendChild(this.#rightSideContainer);\n\t\t}\n\t\treturn this.#rightSideContainer;\n\t}\n\n\tget rightSideContainerPresent() {\n\t\treturn this.#rightSideContainer !== null;\n\t}\n\n\tget stateText() {\n\t\treturn null;\n\t}\n\n\tget stateIcon() {\n\t\treturn null;\n\t}\n\n\tsetState({ text = null, icon = null } = {}) {\n\t\tconst prevText = this._statusText;\n\t\tconst prevIcon = this._statusIcon;\n\t\tthis._statusText = text;\n\t\tthis._statusIcon = icon;\n\t\tthis.#updateStateCallbacks.forEach(cb => cb(this));\n\t\tif (this._statusIcon) {\n\t\t\tthis.icon = this._statusIcon;\n\t\t}\n\t\tif (this._statusText) {\n\t\t\tthis.title = this._statusText;\n\t\t}\n\n\t\tthis._observer?.onStateChanged?.(this, prevText, text, prevIcon, icon);\n\t}\n\n\t#updateStateCallbacks = [];\n\n\tonStateChange(cb) {\n\t\tif (typeof cb === \"function\") {\n\t\t\tthis.#updateStateCallbacks.push(cb);\n\t\t}\n\t\telse {\n\t\t\tthis.player.log.warn(\"Invalid callback for ButtonPlugin.onStateChange\");\n\t\t}\n\t}\n\n\tasync action(event, callerContainer = null) {\n\t}\n\n\tonResize({ width, height }) {\n\t\tif (width < this.minContainerSize) {\n\t\t\tthis.hide();\n\t\t}\n\t\telse {\n\t\t\tthis.show();\n\t\t}\n\t}\n\n\tfocus() {\n\t\tthis.button?.focus();\n\t}\n\n\tblur() {\n\t\tthis.button?.blur();\n\t}\n\n\tisFocus() {\n\t\treturn this.button === document.activeElement;\n\t}\n}\n","export default `<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"no\"?>\n<!DOCTYPE svg PUBLIC \"-//W3C//DTD SVG 1.1//EN\" \"http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd\">\n<svg width=\"100%\" height=\"100%\" viewBox=\"0 0 23 24\" version=\"1.1\" xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\" xml:space=\"preserve\" xmlns:serif=\"http://www.serif.com/\" style=\"fill-rule:evenodd;clip-rule:evenodd;stroke-linejoin:round;stroke-miterlimit:1.41421;\">\n    <g id=\"play\" transform=\"matrix(1.36051e-16,0.480277,-0.550439,1.55927e-16,74.9184,-144.269)\">\n        <path d=\"M325.373,94.327L350.358,136.107L300.387,136.107L325.373,94.327Z\"/>\n    </g>\n</svg>\n`;","export default `<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"no\"?>\n<!DOCTYPE svg PUBLIC \"-//W3C//DTD SVG 1.1//EN\" \"http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd\">\n<svg width=\"100%\" height=\"100%\" viewBox=\"0 0 24 22\" version=\"1.1\" xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\" xml:space=\"preserve\" xmlns:serif=\"http://www.serif.com/\" style=\"fill-rule:evenodd;clip-rule:evenodd;stroke-linejoin:round;stroke-miterlimit:1.41421;\">\n    <g id=\"pause\" transform=\"matrix(1,0,0,0.956522,-48,-7.65217)\">\n        <path d=\"M64,8L72,8L72,31L64,31L64,8ZM48,8L56,8L56,31L48,31L48,8Z\"/>\n    </g>\n</svg>\n`;","export default `<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"no\"?>\n<!DOCTYPE svg PUBLIC \"-//W3C//DTD SVG 1.1//EN\" \"http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd\">\n<svg width=\"100%\" height=\"100%\" viewBox=\"0 0 40 42\" version=\"1.1\" xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\" xml:space=\"preserve\" xmlns:serif=\"http://www.serif.com/\" style=\"fill-rule:evenodd;clip-rule:evenodd;stroke-linejoin:round;stroke-miterlimit:2;\">\n    <g transform=\"matrix(1.94013e-16,0.689169,-0.784942,2.23746e-16,110.436,-203.562)\">\n        <g id=\"play\">\n            <path d=\"M304.588,115.214C304.588,105.205 313.901,97.079 325.373,97.079C336.844,97.079 346.157,105.205 346.157,115.214C346.157,125.223 336.844,133.349 325.373,133.349L325.373,128.287C333.642,128.287 340.356,122.43 340.356,115.214C340.356,107.999 333.642,102.141 325.373,102.141C317.103,102.141 310.39,107.999 310.39,115.214L304.588,115.214Z\"/>\n            <g transform=\"matrix(-2.33361,-6.00363e-16,1.21708e-15,-2.59724,320.246,134.358)\">\n                <path d=\"M5.454,3.35L9.398,7.505L1.511,7.505L5.454,3.35Z\"/>\n            </g>\n        </g>\n    </g>\n</svg>\n`;","import ButtonPlugin from '../core/ButtonPlugin';\nimport Events, { bindEvent } from '../core/Events';\n\nimport defaultPlayIcon from '../../icons/play';\nimport defaultPauseIcon from '../../icons/pause';\nimport defaultReplayIcon from '../../icons/replay';\n\nimport PaellaCorePlugins from './PaellaCorePlugins';\n\nexport default class PlayButtonPlugin extends ButtonPlugin {\n\tgetPluginModuleInstance() {\n        return PaellaCorePlugins.Get();\n    }\n\t\n\tget name() {\n\t\treturn super.name || \"es.upv.paella.playPauseButton\";\n\t}\n\n\tasync load() {\n\t\tconst playIcon = this.player.getCustomPluginIcon(this.name,\"play\") || defaultPlayIcon;\n\t\tconst pauseIcon = this.player.getCustomPluginIcon(this.name,\"pause\") || defaultPauseIcon;\n\t\tconst replayIcon = this.player.getCustomPluginIcon(this.name,\"replay\") || defaultReplayIcon;\n\t\tthis.icon = playIcon;\n\t\tconst titlePause = this.player.translate(this.config.ariaLabelPause || \"pause\");\n\t\tconst titlePlay = this.player.translate(this.config.ariaLabelPlay || \"play\");\n\t\tbindEvent(this.player, Events.PLAY, () => {\n\t\t\tthis.icon = pauseIcon;\n\t\t\tthis.button.ariaLabel = titlePlay;\n\t\t\tthis.button.title = this.config.ariaLabelPause || titlePlay;\n\t\t});\n\t\tbindEvent(this.player, Events.PAUSE, () => {\n\t\t\tthis.icon = playIcon;\n\t\t\tthis.button.ariaLabel = titlePlay;\n\t\t\tthis.button.title = this.config.ariaLabelPause || titlePlay;\n\t\t});\n\t\tbindEvent(this.player, Events.ENDED, () => {\n\t\t\tthis.icon = replayIcon;\n\t\t\tthis.button.ariaLabel = titlePlay;\n\t\t\tthis.button.title = this.config.ariaLabelPause || titlePlay;\n\t\t});\n\t\tbindEvent(this.player, Events.STOP, () => {\n\t\t\tthis.icon = playIcon;\n\t\t\tthis.button.ariaLabel = titlePlay;\n\t\t\tthis.button.title = this.config.ariaLabelPause || titlePlay;\n\t\t});\n\t}\n\t\n\tasync action() {\n\t\tif (await this.player.paused()) {\n\t\t\tawait this.player.videoContainer.play();\n\t\t}\n\t\telse {\n\t\t\tawait this.player.videoContainer.pause();\n\t\t}\n\t}\n}","\nimport Captions from './Captions';\n\nconst TIMESTAMP = \"(?:\\\\d*:){1,2}\\\\d*(?:\\\\.\\\\d+)?\";\nconst CUE_TIMING = `(${TIMESTAMP})\\\\s*\\\\-\\\\->\\\\s*(${TIMESTAMP})`;\n\nconst re = {\n    cueTiming: new RegExp(CUE_TIMING)\n};\n\nconst parseCue = (captions,line,i,lines) => {\n    const result = re.cueTiming.exec(line);\n    if (result) {\n        const label = lines[i - 1];\n        const cap = [];\n        for (let j = 1; i+j<lines.length && lines[i+j] !== ''; ++j) {\n            cap.push(lines[i+j]);\n        }\n        captions.addCue({\n            label: label,\n            start: result[1],\n            end: result[2],\n            captions: cap\n        });\n    }\n}\n\nexport function parseWebVTT(text) {\n    const captions = new Captions();\n    \n    if (text !== \"\") {\n        text = text.replace(/\\r\\n/gm,\"\\n\");\n        text = text.replace(/\\r/gm,\"\\n\");\n\n        text.split(/\\n/).forEach((line,i,lines) => {\n            parseCue(captions,line,i,lines);\n        })\n    }\n\n    return captions;\n}\n\nexport default class WebVTTParser {\n    constructor(text = \"\") {\n        this._text = text;\n        this._captions = parseWebVTT(text);\n    }\n\n    get text() {\n        return this._text;\n    }\n\n    set text(text) {\n        this._text = text;\n        this._captions = parseWebVTT(text);\n    }\n\n    get captions() {\n        return this._captions;\n    }\n}\n\n","\nimport CaptionsPlugin from '../captions/CaptionsPlugin';\nimport WebVTTParser from '../captions/WebVTTParser';\nimport PaellaCorePlugins from './PaellaCorePlugins';\n\nimport { resolveResourcePath } from '../core/utils';\n\nexport default class VttManifestCaptionsPlugin extends CaptionsPlugin {\n    getPluginModuleInstance() {\n        return PaellaCorePlugins.Get();\n    }\n    \n    get name() {\n\t\treturn super.name || \"es.upv.paella.vttManifestCaptionsPlugin\";\n\t}\n\n    async isEnabled() {\n        const enabled = await super.isEnabled();\n        return  enabled &&\n                this.player.videoManifest.captions &&\n                this.player.videoManifest.captions.length>0;\n    }\n\n    async getCaptions() {\n        const result = [];\n        const p = [];\n        this.player.videoManifest.captions.forEach(captions => {\n            p.push(new Promise(async (resolve, reject) => {\n                if (/vtt/i.test(captions.format)) {\n                    const fileUrl = resolveResourcePath(this.player, captions.url);\n                    const fetchResult = await fetch(fileUrl)    \n                    if (fetchResult.ok) {\n                        const text = await fetchResult.text();\n                        const parser = new WebVTTParser(text);\n                        parser.captions.label = captions.text;\n                        parser.captions.language = captions.lang;\n                        result.push(parser.captions);\n                        resolve();\n                    }\n                    else {\n                        reject();\n                    }                    \n                }\n                else {\n                    reject();\n                }\n            }));\n        });\n        await Promise.allSettled(p);\n        return result;\n    }\n}","import ButtonPlugin from '../core/ButtonPlugin.js';\nimport PaellaCorePlugins from './PaellaCorePlugins.js';\nimport { secondsToTime } from '../core/utils.js';\nimport Events from '../core/Events.js';\n\nexport default class CurrentTimeLabelPlugin extends ButtonPlugin {\n    getPluginModuleInstance() {\n        return PaellaCorePlugins.Get();\n    }\n\n    get name() {\n        return \"es.upv.paella.currentTimeLabel\";\n    }\n    \n    async load() {\n        this.title = secondsToTime(0);\n\n        const updateTitle = async () => {\n            const currentTime = await this.player.videoContainer.currentTime();\n            let newTitle = secondsToTime(currentTime);\n\n            if (this.config.showTotalTime) {\n                const duration = await this.player.videoContainer.duration();\n                newTitle += ` / ${secondsToTime(duration)}`;\n            }\n\n            this.title = newTitle;\n        }\n\n        this.player.bindEvent(Events.TIMEUPDATE, () => updateTitle());\n        this.player.bindEvent(Events.TRIMMING_CHANGED, () => updateTitle());\n        this.player.bindEvent(Events.SEEK, () => updateTitle());\n    }\n\n    get interactive() {\n        return false;\n    }\n\n    get dynamicWidth() {\n        return true;\n    }\n}\n","\nimport { getPluginsOfType } from './plugin_tools';\nimport UserInterfacePlugin from \"./UserInterfacePlugin\";\n\n\nexport function getValidLayouts(player, streamData) {\n    // Find the valid layouts that matches the streamData content\n    const result = getPluginsOfType(player, \"layout\")\n        .filter(layout => layout.config && layout.config.enabled && layout.canApply(streamData));\n    return result;\n}\n\nexport function getLayoutWithId(player, layoutId) {\n    const result = getPluginsOfType(player, \"layout\");\n    result.find(layout => {\n        player.log.debug(layout);\n        return layout.identifier === layoutId\n    });\n    return result;\n\n}\n\nexport function getValidContentIds(player, streamData) {\n    const validLayouts = getValidLayouts(player, streamData);\n    const result = [];\n    validLayouts.forEach(lo => {\n        result.push(...lo.getValidContentIds(streamData));\n    });\n    return result;\n}\n\n// Return the available content ids from configuration for the provided number of streams\nexport function getAvailableContentIds(player, numberOfStreams) {\n    const result = [];\n    getPluginsOfType(player, \"layout\")\n        .filter(layout => {\n            if (layout.config?.enabled && layout.config?.validContent) {\n                return layout.config.validContent.every(cntItem => cntItem.content.length === numberOfStreams);\n            }\n        })\n        .forEach(layout => layout.config.validContent.forEach(c => result.push(c.content)));\n    return result;\n}\n\nexport function getLayoutWithContentId(player, streamData, contentId) {\n    const layouts = getValidLayouts(player, streamData);\n    let result = null;\n    layouts.some(layout => {\n        if (layout.getValidContentIds(streamData).indexOf(contentId) !== -1) {\n            result = layout;\n            return true;\n        }\n    });\n    return result;\n}\n\nexport function getValidContentSettings(player, streamData) {\n    const validLayouts = getValidLayouts(player, streamData);\n    const validIds = getValidContentIds(player, streamData)\n    let result = []\n    validLayouts.forEach(lo => {\n        result = [...result,...lo.config.validContent];\n    });\n    \n    return result.filter(cfg => {\n        return validIds.indexOf(cfg.id) !== -1\n    });\n}\n\nexport function getLayoutStructure(player, streamData, contentId, mainContent = null) {\n    const selectedLayout = getLayoutWithContentId(player, streamData, contentId);\n    if (selectedLayout) {\n        const structure = selectedLayout.getLayoutStructure(streamData, contentId, mainContent);\n        structure.plugin = selectedLayout;\n        return structure;\n    }\n    return null;\n}\n\nexport default class VideoLayout extends UserInterfacePlugin {\n    \n    get type() { return \"layout\"; }\n\n    get layoutType() {\n        return \"static\";    // or \"dynamic\"\n    }\n\n    getTabIndexStart() {\n        return 10;\n    }\n\n    get tabIndexStart() {\n        return this.config?.tabIndexStart || this.getTabIndexStart();\n    }\n\n    // Return the layout identifier, for example, presenter-presentation\n    get identifier() { return \"default\"; }\n\n    get icon() { return \"icon.png\"; }\n\n    // Return the array of valid content in the configuration of the plugin\n    get validContent() {\n        return this.config?.validContent || [];\n    }\n\n    get validContentIds() {\n        const result = [];\n        this.validContent.forEach(c => result.push(c.id));\n        return result;\n    }\n\n    // Gets the valid content ids that matches the streamData\n    getValidContentIds(streamData) {\n        const contentIds = [];\n        this.validContent.forEach(validContent => {\n            if (validContent.content.every(c => {\n                return streamData.some(sd => c === sd.content)\n            })) {\n                contentIds.push(validContent.id);\n            }\n        });\n\n        return contentIds;\n    }\n\n    // Get the valid stream data combination, according to the plugin configuration\n    // The result of this function must be an array of arrays with all the possible\n    // combinations. For example, for a dual stream layout and three elements in\n    // streamData that matches the valid content, the resulting valid streams must be:\n    // [\n    //      [streamA, streamB],\n    //      [streamA, streamC],\n    //      [streamC, streamB]   \n    // ]\n    getValidStreams(streamData) {\n        const validStreams = [];\n        this.validContent.forEach(validContent => {\n            let validStreamCombination = [];\n            if (validContent.content.every(c => {\n                return streamData.some(sd => {\n                    if (c === sd.content) {\n                        validStreamCombination.push(sd);\n                        return true;\n                    }\n                })\n            })) {\n                validStreams.push(validStreamCombination);\n            }\n        });\n\n        return validStreams;\n    }\n\n    canApply(streamData) {\n        return this.getValidStreams(streamData).length > 0;\n    }\n\n    getLayoutStructure(/* streamData, contentId, mainContent */) {\n        return {};\n    }\n\n    // Add buttons to videos\n    // [\n    //      icon    (required)\n    //      click   (required)\n    //      tabIndex\n    //      ariaLabel\n    //      title\n    //      className\n    //      position (CanvasButtonPosition.LEFT, CanvasButtonPosition.CENTER, CanvasButtonPosition.RIGHT)\n    //]\n    getVideoCanvasButtons(content, video, videoCanvas) {\n        return []\n    }\n}\n","import UserInterfacePlugin from \"./UserInterfacePlugin\";\nimport { CanvasButtonPosition } from \"./CanvasPlugin\";\nimport { loadPluginsOfType } from \"./plugin_tools\";\n\nexport function getNextTabIndex(player) {\n\tplayer.__tabIndex = player.__tabIndex || 0;\n\t++player.__tabIndex;\n\treturn player.__tabIndex;\n}\n\nexport function getCurrentTabIndex(player) {\n\treturn player.__tabIndex || 0;\n}\n\nexport function getCanvasButtonPlugin(plugin) {\n    return {\n        icon: plugin.icon,\n        position: plugin.position,\n        title: plugin.description,\n        ariaLabel: plugin.ariaLabel,\n        name: plugin.buttonName,\n        click: async (content) => {\n            const stream = plugin.player.videoContainer.streamProvider.streams[content];\n            await plugin.action(content, stream?.player, stream?.canvas, stream?.canvasPlugin);\n        }\n    }\n}\n\nexport async function getCanvasButtons(player, video) {\n    const result = [];\n    await loadPluginsOfType(player, \"canvasButton\",\n        async (plugin) => {\n            player.log.debug(` Canvas button plugin: ${ plugin.name }`);\n            result.push(plugin);\n        });\n\n    return result.filter(plugin => {\n            // TODO: check if this is working\n            return plugin.content.indexOf(video.content) !== -1;\n        })\n        .map(plugin => {\n            return getCanvasButtonPlugin(plugin);\n        })\n}\n\n\nexport default class CanvasButtonPlugin extends UserInterfacePlugin {\n    get type() { return \"canvasButton\" }\n\n    get content() {\n        return this._config.content || [\"presenter\"];\n    }\n\n    get ariaLabel() {\n        return this._config.ariaLabel || this.getAriaLabel();\n    }\n\n    getAriaLabel() {\n        return \"\";\n    }\n\n    get tabIndex() {\n        return this.config.tabIndex;\n    }\n    \n    get description() {\n        return this.config.description || this.getDescription();\n    }\n\n    getDescription() {\n        return \"\";\n    }\n\n    get icon() {\n        return this._icon;\n    }\n\n    set icon(icon) {\n        this._icon = icon;\n    }\n\n    get side() {\n        return this.config?.side || \"left\";\n    }\n\n    get buttonName() {\n        return this.name;   // By default, the button \"name\" property is the plugin identifier name\n    }\n\n    get position() {\n        switch (this.side) {\n        case 'left':\n            return CanvasButtonPosition.LEFT;\n        case 'center':\n            return CanvasButtonPosition.CENTER;\n        case 'right':\n            return CanvasButtonPosition.RIGHT;\n        default:\n            throw new Error(`Invalid CanvasButtonPlugin side set: ${ this.side }`);\n        }\n    }\n\n    async action(content) {\n        this.player.log.warn(`Action not implemented in canvas button plugin ${ this.name }`);\n    }\n}","import Plugin from './Plugin';\nimport { getPluginsOfType, loadPluginsOfType } from './plugin_tools';\nimport { DomClass } from './dom';\nimport { createElement, createElementWithHtmlText } from './dom';\nimport { getCanvasButtons } from './CanvasButtonPlugin';\n\n\nconst g_enabledCanvasPlugins = [];\nexport async function loadCanvasPlugins(player) {\n    await loadPluginsOfType(player, \"canvas\", (plugin) => {\n        g_enabledCanvasPlugins.push(plugin);\n    });\n}\n\nexport async function unloadCanvasPlugins(player) {\n    g_enabledCanvasPlugins.slice(0);\n}\n\nexport function getCanvasPlugin(player, stream) {\n    if (g_enabledCanvasPlugins.length === 0) {\n        throw Error(\"No canvas plugins loaded. Note that `loadCanvasPlugins()` must to be called before use `getCanvasPlugins()`\");\n    }\n    let plugin = null;\n\n    g_enabledCanvasPlugins.some(p => {\n        if (p.isCompatible(stream)) {\n            plugin = p;\n            return true;\n        }\n    });\n\n    return plugin;\n}\n\nexport const CanvasButtonPosition = Object.freeze({\n    LEFT: 'left',\n    CENTER: 'center',\n    RIGHT: 'right'\n});\n\nconst addButton = function({\n    icon,\n    tabIndex,\n    ariaLabel,\n    title,\n    className,\n    position = CanvasButtonPosition.CENTER,\n    click,\n    content,\n    name\n}) {\n    if (!icon) {\n        throw new Error(\"Error in video layout definition. getVideoCanvasButtons(): missing 'icon' attribute.\");\n    }\n    if (!click) {\n        throw new Error(\"Error in video layout definition. getVideoCanvasButtons(): missing 'click' function.\");\n    }\n    let attributes = `class=\"align-${position}${ className ? \" \" + className : \"\"}\"`;\n    if (ariaLabel) {\n        attributes += ` aria-label=\"${ariaLabel}\"`;\n    }\n    if (title) {\n        attributes += ` title=\"${title}\"`;\n    }\n    if (tabIndex !== undefined) {\n        attributes += ` tabindex=\"${tabIndex}\"`;\n    }\n    if (name !== undefined) {\n        attributes += ` name=\"${name}\"`;\n    }\n    const btn = createElementWithHtmlText(`\n        <button ${attributes}><i class=\"button-icon\" style=\"pointer-events: none\">${ icon }</i></button>\n    `);\n    this.buttonsArea.appendChild(btn);\n    btn.addEventListener('click', async (evt) => {\n        evt.stopPropagation();\n        await click(content);\n        return false;\n    });\n    return btn;\n}\n\nexport const addVideoCanvasButton = async (player, layoutStructure, canvas, video, content) => {\n    const plugin = layoutStructure.plugin;\n    let tabIndexStart = plugin.tabIndexStart;\n    const externalButtons = await getCanvasButtons(player, video);\n    const buttonElements = [];\n    const buttons = [...externalButtons,\n        ...plugin.getVideoCanvasButtons(layoutStructure, video.content, video, canvas)];\n    buttons.forEach(btnData => {\n        btnData.tabIndex = tabIndexStart++;\n        btnData.content = content;\n        const btn = addButton.apply(canvas, [btnData]);\n        buttonElements.push(btn);\n    });\n    \n    return buttonElements;\n}\n\nexport const setTabIndex = (player, layoutStructure, buttons) => {\n    let { tabIndexStart } = layoutStructure.plugin;\n    buttons.sort((b1,b2) => {\n        const b1Left = b1.getBoundingClientRect().left;\n        const b2Left = b2.getBoundingClientRect().left;\n        return b1Left - b2Left;\n    }).forEach(btn => {\n        btn.setAttribute(\"tabindex\",tabIndexStart++);\n    })\n}\n\nexport class Canvas extends DomClass {\n    constructor(tag, player, parent) {\n        super(player, { tag, parent });\n        this.element.className = \"video-canvas\";\n\n        this._userArea = null;\n\n        this._buttonsArea = createElementWithHtmlText(`\n        <div class=\"button-area\">\n        </div>\n        `, this.element);\n    }\n\n    async loadCanvas(player) {\n        throw Error(`${this.name}: loadCanvas() not implemented`);\n    }\n\n    get userArea() {\n        if (!this._userArea) {\n            this._userArea = document.createElement('div');\n            this._userArea.className = \"user-area\";\n            this.element.appendChild(this._userArea);\n        }\n        return this._userArea;\n    }\n\n    get buttonsArea() {\n        return this._buttonsArea;\n    }\n\n    showButtons() {\n        this.buttonsArea.style.display = null;\n    }\n\n    hideButtons() {\n        this.buttonsArea.style.display = \"none\";\n    }\n}\n\nexport default class CanvasPlugin extends Plugin {\n    get type() { return \"canvas\"; }\n\n    get canvasType() { return \"\"; }\n\n    isCompatible(stream) {\n        if (Array.isArray(stream?.canvas)) {\n            return stream.canvas.indexOf(this.canvasType) !== -1;\n        }\n        else {\n            return stream.canvas === this.canvasType;\n        }\n    }\n\n    getCanvasInstance(videoContainer) {\n        throw Error(`${this.name} canvas plugin: getCanvasInstance() not implemented`);\n    }\n}\n","import PluginModule from \"../core/PluginModule\";\nimport packageData from \"../../../package.json\";\n\nlet g_pluginModule = null;\n\nexport default class PaellaCoreLayouts extends PluginModule {\n    static Get() {\n        if (!g_pluginModule) {\n            g_pluginModule = new PaellaCoreLayouts();\n        }\n        return g_pluginModule;\n    }\n    \n    get moduleName() {\n        return \"paella-core default video layouts\";\n    }\n\n    get moduleVersion() {\n        return packageData.version;\n    }\n}","export default `<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"no\"?>\n<!DOCTYPE svg PUBLIC \"-//W3C//DTD SVG 1.1//EN\" \"http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd\">\n<svg width=\"100%\" height=\"100%\" viewBox=\"0 0 40 40\" version=\"1.1\" xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\" xml:space=\"preserve\" xmlns:serif=\"http://www.serif.com/\" style=\"fill-rule:evenodd;clip-rule:evenodd;stroke-linejoin:round;stroke-miterlimit:2;\">\n    <g transform=\"matrix(0.920758,0,0,0.920758,2.50561,1.21236)\">\n        <path d=\"M11.937,17.699L11.937,21.044C11.937,21.656 11.573,22.209 11.012,22.451C10.45,22.693 9.798,22.578 9.354,22.158L1.874,15.1C1.568,14.811 1.394,14.408 1.394,13.986C1.394,13.564 1.568,13.161 1.874,12.872L9.354,5.814C9.798,5.394 10.45,5.279 11.012,5.521C11.573,5.763 11.937,6.316 11.937,6.928L11.937,10.272L22.937,10.272C23.783,10.272 24.469,10.958 24.469,11.804L24.469,16.168C24.469,17.014 23.783,17.699 22.937,17.699L11.937,17.699ZM26.063,23.11L26.063,19.765C26.063,19.153 26.427,18.6 26.988,18.358C27.55,18.116 28.201,18.231 28.646,18.651L36.126,25.709C36.432,25.999 36.606,26.402 36.606,26.823C36.606,27.245 36.432,27.648 36.126,27.937L28.646,34.996C28.201,35.415 27.55,35.53 26.988,35.288C26.427,35.046 26.063,34.493 26.063,33.882L26.063,30.537L15.063,30.537C14.217,30.537 13.531,29.851 13.531,29.005L13.531,24.641C13.531,23.795 14.217,23.11 15.063,23.11L26.063,23.11Z\"/>\n    </g>\n</svg>\n`;","export default `<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"no\"?>\n<!DOCTYPE svg PUBLIC \"-//W3C//DTD SVG 1.1//EN\" \"http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd\">\n<svg width=\"100%\" height=\"100%\" viewBox=\"0 0 40 40\" version=\"1.1\" xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\" xml:space=\"preserve\" xmlns:serif=\"http://www.serif.com/\" style=\"fill-rule:evenodd;clip-rule:evenodd;stroke-linejoin:round;stroke-miterlimit:2;\">\n    <g transform=\"matrix(-0.620305,0,0,0.839332,25.2077,0.462208)\">\n        <path d=\"M-20.625,8.591C-20.625,6.174 -17.975,4.215 -14.704,4.215L31.492,4.215C34.763,4.215 37.413,6.174 37.413,8.591L37.413,35.582C37.413,37.998 34.763,39.957 31.492,39.957L-14.704,39.957C-17.975,39.957 -20.625,37.998 -20.625,35.582L-20.625,8.591ZM1.285,12.825L8.1,7.789L-15.786,7.789L-15.786,25.442L-8.972,20.406L6.737,32.016L16.994,24.435L1.285,12.825Z\" />\n    </g>\n</svg>\n`;","export default `<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"no\"?>\n<!DOCTYPE svg PUBLIC \"-//W3C//DTD SVG 1.1//EN\" \"http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd\">\n<svg width=\"100%\" height=\"100%\" viewBox=\"0 0 40 40\" version=\"1.1\" xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\" xml:space=\"preserve\" xmlns:serif=\"http://www.serif.com/\" style=\"fill-rule:evenodd;clip-rule:evenodd;stroke-linejoin:round;stroke-miterlimit:2;\">\n    <g transform=\"matrix(0.707107,0.707107,-0.707107,0.707107,20,-8.28427)\">\n        <path d=\"M23,17L23,4.998C23,4.203 22.684,3.44 22.122,2.878C21.56,2.316 20.797,2 20.002,2C20.001,2 19.999,2 19.998,2C19.203,2 18.44,2.316 17.878,2.878C17.316,3.44 17,4.203 17,4.998C17,9.375 17,17 17,17L4.998,17C4.203,17 3.44,17.316 2.878,17.878C2.316,18.44 2,19.203 2,19.998C2,19.999 2,20.001 2,20.002C2,20.797 2.316,21.56 2.878,22.122C3.44,22.684 4.203,23 4.998,23C9.375,23 17,23 17,23L17,35.002C17,35.797 17.316,36.56 17.878,37.122C18.44,37.684 19.203,38 19.998,38C19.999,38 20.001,38 20.002,38C20.797,38 21.56,37.684 22.122,37.122C22.684,36.56 23,35.797 23,35.002C23,30.625 23,23 23,23L35.002,23C35.797,23 36.56,22.684 37.122,22.122C37.684,21.56 38,20.797 38,20.002C38,20.001 38,19.999 38,19.998C38,19.203 37.684,18.44 37.122,17.878C36.56,17.316 35.797,17 35.002,17C30.625,17 23,17 23,17Z\"/>\n    </g>\n</svg>`;","export default `<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"no\"?>\n<!DOCTYPE svg PUBLIC \"-//W3C//DTD SVG 1.1//EN\" \"http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd\">\n<svg width=\"100%\" height=\"100%\" viewBox=\"0 0 40 40\" version=\"1.1\" xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\" xml:space=\"preserve\" xmlns:serif=\"http://www.serif.com/\" style=\"fill-rule:evenodd;clip-rule:evenodd;stroke-linejoin:round;stroke-miterlimit:2;\">\n    <g>\n        <path d=\"M18,13.029L18,26.971C18,27.509 17.786,28.025 17.406,28.406C17.025,28.786 16.509,29 15.971,29L3.029,29C2.491,29 1.975,28.786 1.594,28.406C1.214,28.025 1,27.509 1,26.971L1,13.029C1,12.491 1.214,11.975 1.594,11.594C1.975,11.214 2.491,11 3.029,11L15.971,11C16.509,11 17.025,11.214 17.406,11.594C17.786,11.975 18,12.491 18,13.029ZM39,13.029L39,26.971C39,27.509 38.786,28.025 38.406,28.406C38.025,28.786 37.509,29 36.971,29L24.029,29C23.491,29 22.975,28.786 22.594,28.406C22.214,28.025 22,27.509 22,26.971L22,13.029C22,12.491 22.214,11.975 22.594,11.594C22.975,11.214 23.491,11 24.029,11L36.971,11C37.509,11 38.025,11.214 38.406,11.594C38.786,11.975 39,12.491 39,13.029ZM21,7L21,33L19,33L19,7L21,7Z\"/>\n    </g>\n</svg>\n`;","export default `<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"no\"?>\n<!DOCTYPE svg PUBLIC \"-//W3C//DTD SVG 1.1//EN\" \"http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd\">\n<svg width=\"100%\" height=\"100%\" viewBox=\"0 0 40 40\" version=\"1.1\" xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\" xml:space=\"preserve\" xmlns:serif=\"http://www.serif.com/\" style=\"fill-rule:evenodd;clip-rule:evenodd;stroke-linejoin:round;stroke-miterlimit:2;\">\n    <g transform=\"matrix(-0.620305,0,0,0.839332,25.2077,0.462208)\">\n        <g transform=\"matrix(-1.61211,0,0,1.19142,40.6376,-0.550686)\">\n            <path d=\"M38.001,14.89L16.256,14.89C15.767,14.89 15.297,15.084 14.951,15.43C14.605,15.776 14.41,16.246 14.41,16.735C14.41,21.528 14.41,33.999 14.41,33.999L5.673,33.999C3.644,33.999 2,32.355 2,30.327L2,7.673C2,5.644 3.644,4 5.673,4L34.329,4C36.358,4 38.001,5.644 38.001,7.673L38.001,14.89Z\"/>\n        </g>\n        <g transform=\"matrix(-1.62701,0,0,1.19712,41.1319,-0.602464)\">\n            <path d=\"M39.174,17.858C39.174,17.501 39.032,17.158 38.781,16.906C38.529,16.653 38.188,16.511 37.833,16.511C33.587,16.511 20.516,16.511 17.043,16.511C16.816,16.511 16.598,16.602 16.438,16.763C16.278,16.924 16.188,17.142 16.188,17.37C16.188,20.366 16.188,30.369 16.188,34.019C16.188,34.376 16.329,34.719 16.581,34.971C16.832,35.224 17.173,35.366 17.529,35.366C21.597,35.366 33.765,35.366 37.833,35.366C38.188,35.366 38.529,35.224 38.781,34.971C39.032,34.719 39.174,34.376 39.174,34.019C39.174,30.548 39.174,21.329 39.174,17.858Z\"/>\n        </g>\n    </g>\n</svg>\n`;","\nimport VideoLayout from '../core/VideoLayout';\n\nimport { CanvasButtonPosition } from '../core/CanvasPlugin';\nimport PaellaCoreLayouts from './PaellaCoreLayouts';\n\nimport defaultIconRotate from '../../icons/icon_switch_side';\nimport defaultIconMaximize from '../../icons/maximize';\nimport defaultIconClose from '../../icons/close';\nimport defaultIconSideBySide from '../../icons/icon_side_by_side';\nimport defaultIconPiP from '../../icons/icon_pip';\n\nexport default class DualVideoDynamicLayout extends VideoLayout {\n    getPluginModuleInstance() {\n        return PaellaCoreLayouts.Get();\n    }\n\n    get name() {\n\t\treturn super.name || \"es.upv.paella.dualVideoDynamic\";\n\t}\n\n    get layoutType() {\n        return \"dynamic\";\n    }\n\n    async load() {\n        this.pipContentIds = this.config.pipContentIds || [];\n        this.allowSwitchSide = this.config.allowSwitchSide !== undefined ? this.config.allowSwitchSide : true;\n    }\n\n    getVideoCanvasButtons(layoutStructure, content, video, videoCanvas) {\n        const iconMaximize = this.player.getCustomPluginIcon(this.name,\"iconMaximize\") || defaultIconMaximize;\n        const iconSideBySide = this.player.getCustomPluginIcon(this.name,\"iconSideBySide\") || defaultIconSideBySide;\n        const iconSwitchSide = this.player.getCustomPluginIcon(this.name,\"iconSwitchSide\") || defaultIconRotate;\n        const iconClose = this.player.getCustomPluginIcon(this.name,\"iconClose\") || defaultIconClose;\n        const iconPiP = this.player.getCustomPluginIcon(this.name,\"iconPiP\") || defaultIconPiP;\n        const layoutData = () => this._currentContent.find(lo => lo.id === content);\n        const isMinimized = () => layoutData().size === 25;\n        const isMaximized = () => layoutData().size > 50;\n        const result = [];\n\n        if (isMinimized() || isMaximized()) {\n            result.push({\n                icon: iconSideBySide,\n                position: CanvasButtonPosition.LEFT,\n                title: this.player.translate('Dual stream 50%'),\n                ariaLabel: this.player.translate('Dual stream 50%'),\n                name: this.name + ':iconSideBySide',\n                click: async () => {\n                    this._currentContent.forEach(lo => {\n                        lo.size = 50;\n                    });\n                    await this.player.videoContainer.updateLayout();\n                }\n            });\n        }\n        else {\n            result.push({\n                icon: iconMaximize,\n                position: CanvasButtonPosition.LEFT,\n                title: this.player.translate('Maximize video'),\n                ariaLabel: this.player.translate('Maximize video'),\n                name: this.name + ':iconMaximize',\n                click: async () => {\n                    this._currentContent.forEach(lo => {\n                        lo.size = lo.id === content ? 75 : 25;\n                    });\n                    await this.player.videoContainer.updateLayout();\n                }\n            });\n        }\n\n        if (this.allowSwitchSide) {        \n            result.push({\n                icon: iconSwitchSide,\n                position: CanvasButtonPosition.LEFT,\n                title: this.player.translate('Switch side'),\n                ariaLabel: this.player.translate('Switch side'),\n                name: this.name + ':iconSwitchSide',\n                click: async () => {\n                    const ct1 = this._currentContent[0].id;\n                    const ct2 = this._currentContent[1].id;\n                    const ct1Size = this._currentContent[0].size;\n                    const ct2Size = this._currentContent[1].size;\n                    this._currentContent[0].id = ct2;\n                    this._currentContent[0].size = ct2Size;\n                    this._currentContent[1].id = ct1;\n                    this._currentContent[1].size = ct1Size;\n                    await this.player.videoContainer.updateLayout();\n                }\n            });\n        }\n\n        result.push({\n            icon: iconClose,\n            position: CanvasButtonPosition.RIGHT,\n            title: this.player.translate(\"Close video\"),\n            ariaLabel: this.player.translate(\"Close video\"),\n            name: this.name + ':iconClose',\n            click: async () => {\n                const singleStreamContentIds = this.player.videoContainer.validContentIds.filter(cid => cid.indexOf(\"-\") === -1);\n                const contentId = singleStreamContentIds.find(cid => cid != content);\n                await this.player.videoContainer.setLayout(contentId);\n            }\n        });\n\n        if (this.pipContentIds.length > 0) {\n            result.push({\n                icon: iconPiP,\n                position: CanvasButtonPosition.LEFT,\n                title: this.player.translate(\"Picture-in-picture\"),\n                ariaLabel: this.player.translate(\"Picture-in-picture\"),\n                name: this.name + ':iconPiP',\n                click: async () => {\n                    const contentId = this.player.videoContainer.validContentIds.find(cid => this.pipContentIds.indexOf(cid) !== -1);\n                    await this.player.videoContainer.setLayout(contentId,content);\n                }\n            })\n        }\n\n        return result;\n    }\n\n    getLayoutStructure(streamData, contentId, mainContent) {\n        if (!this._currentContent) {\n            const { content } = this.validContent.find(content => content.id === contentId);\n            this._currentContent = content.map(c => {\n                return {\n                    id: c,\n                    size: 50\n                }\n            });\n        }\n        return {\n            id: \"dual-dynamic\",\n            videos: [\n                {\n                    content: this._currentContent[0].id,\n                    visible: true,\n                    size: this._currentContent[0].size\n                },\n                {\n                    content: this._currentContent[1].id,\n                    visible: true,\n                    size: this._currentContent[1].size\n                }\n            ]\n        }\n    }\n}","export default `<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"no\"?>\n<!DOCTYPE svg PUBLIC \"-//W3C//DTD SVG 1.1//EN\" \"http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd\">\n<svg width=\"100%\" height=\"100%\" viewBox=\"0 0 40 40\" version=\"1.1\" xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\" xml:space=\"preserve\" xmlns:serif=\"http://www.serif.com/\" style=\"fill-rule:evenodd;clip-rule:evenodd;stroke-linejoin:round;stroke-miterlimit:2;\">\n    <g transform=\"matrix(-0.620305,0,0,0.839332,25.2077,0.462208)\">\n        <g transform=\"matrix(-1.50139,0,0,1.10483,39.8625,1.72153)\">\n            <path d=\"M22.034,28.802C22.58,28.752 23.089,28.64 23.626,28.496C28.793,27.112 31.864,21.792 30.48,16.625C30.189,15.54 29.715,14.525 29.088,13.619L31.915,8.722C33.663,10.535 34.942,12.776 35.606,15.251C37.748,23.248 32.996,31.48 24.999,33.622C24.011,33.887 23.04,34.063 22.034,34.123L22.034,40.015L13,31.5L22.034,23.015L22.034,28.802Z\" />\n        </g>\n        <g transform=\"matrix(1.50139,1.35303e-16,1.83867e-16,-1.10483,-24.8768,44.5033)\">\n            <path d=\"M22.161,28.786C22.706,28.736 23.089,28.64 23.626,28.496C28.793,27.112 31.864,21.792 30.48,16.625C30.189,15.54 29.715,14.525 29.088,13.619L31.915,8.722C33.663,10.535 34.942,12.776 35.606,15.251C37.748,23.248 32.996,31.48 24.999,33.622C24.011,33.887 23.167,34.048 22.161,34.107L22.161,40L13,31.5L22.161,23L22.161,28.786Z\" />\n        </g>\n    </g>\n</svg>\n`;","export default `<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"no\"?>\n<!DOCTYPE svg PUBLIC \"-//W3C//DTD SVG 1.1//EN\" \"http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd\">\n<svg width=\"100%\" height=\"100%\" viewBox=\"0 0 40 40\" version=\"1.1\" xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\" xml:space=\"preserve\" xmlns:serif=\"http://www.serif.com/\" style=\"fill-rule:evenodd;clip-rule:evenodd;stroke-linejoin:round;stroke-miterlimit:2;\">\n    <g transform=\"matrix(-0.620305,0,0,0.839332,25.2077,0.462208)\">\n        <g transform=\"matrix(-1.61211,0,0,1.25099,40.6376,0.938594)\">\n            <path d=\"M26,18.498C26,16.566 24.356,15 22.327,15C17.811,15 10.189,15 5.673,15C3.644,15 2,16.566 2,18.498C2,22.151 2,27.849 2,31.502C2,33.434 3.644,35 5.673,35C10.189,35 17.811,35 22.327,35C24.356,35 26,33.434 26,31.502C26,27.849 26,22.151 26,18.498Z\" />\n        </g>\n        <path d=\"M-2.889,42.341L-16.002,42.341C-17.664,42.341 -19.01,41.345 -19.01,40.117L-19.01,11.346L-15.787,13.728L-15.787,36.879C-15.787,37.695 -15.348,38.478 -14.567,39.056C-13.785,39.633 -12.726,39.958 -11.621,39.958L-2.889,39.958L-2.889,42.341ZM30.962,18.512L30.962,8.485C30.962,7.669 30.523,6.886 29.741,6.308C28.96,5.731 27.9,5.406 26.795,5.406L-4.721,5.406L-7.945,3.024L31.181,3.024C32.842,3.024 34.189,4.019 34.189,5.247L34.189,18.512L30.962,18.512Z\" />\n        <g transform=\"matrix(-0.595969,-0.440448,-1.13993,0.842464,17.4661,11.4472)\">\n            <path d=\"M18.389,14.006L18.389,18L5,11L18.389,4L18.389,7.994L36,7.994L36,14.006L18.389,14.006Z\" />\n        </g>\n    </g>\n</svg>\n`;\n","import VideoLayout from '../core/VideoLayout';\nimport { getCookie, setCookie } from '../core/utils';\nimport { CanvasButtonPosition } from '../core/CanvasPlugin';\n\nimport defaultIconRotate from '../../icons/icon_rotate';\nimport defaultIconMinimize from '../../icons/minimize-3';\nimport defaultIconSwitchSide from '../../icons/icon_switch_side';\nimport defaultIconMaximize from '../../icons/maximize';\nimport defaultIconClose from '../../icons/close';\nimport defaultIconSideBySide from '../../icons/icon_side_by_side';\nimport PaellaCoreLayouts from './PaellaCoreLayouts';\n\nlet layout = 0;\n/**\n * in pip mode, the minimized video is de second one\n */\nconst layouts = [\n    // First layout: side by side\n    {\n        id: \"side-by-side\",\n        videos: [\n            {\n                content:null,\n                rect:[\n                    {aspectRatio:\"16/9\",width:560,height:315,top:218,left:712},\n                    {aspectRatio:\"16/10\",width:560,height:350,top:206,left:712},\n                    {aspectRatio:\"4/3\",width:560,height:420,top:173,left:712},\n                    {aspectRatio:\"5/3\",width:560,height:336,top:206,left:712},\n                    {aspectRatio:\"5/4\",width:560,height:448,top:160,left:712}\n                ],\n                visible:true,\n                layer:1\n            },\n            {\n                content:null,\n                rect:[\n                    {aspectRatio:\"16/9\",width:688,height:387,top:166,left:10},\n                    {aspectRatio:\"16/10\",width:688,height:430,top:148,left:10},\n                    {aspectRatio:\"4/3\",width:688,height:516,top:111,left:10},\n                    {aspectRatio:\"5/3\",width:690,height:414,top:154,left:10},\n                    {aspectRatio:\"5/4\",width:690,height:552,top:96,left:10}\n                ],\n                visible:true,\n                layer:\"1\"\n            }\n        ],\n        buttons: []\n    },\n\n    // Second layout: PIP left\n    {\n        id: \"pip-left\",\n        videos:[\n            {\n                content:null,\n                rect:[\n                    {aspectRatio:\"16/9\",left:0,top:0,width:1280,height:720},\n                    {aspectRatio:\"16/10\",left:64,top:0,width:1152,height:720},\n                    {aspectRatio:\"5/3\",left:40,top:0,width:1200,height:720},\n                    {aspectRatio:\"5/4\",left:190,top:0,width:900,height:720},\n                    {aspectRatio:\"4/3\",left:160,top:0,width:960,height:720}\n                ],\n                visible:true,\n                layer:1\n            },\n            {\n                content:null,\n                rect:[\n                    {aspectRatio:\"16/9\",left:50,top:470,width:350,height:197},\n                    {aspectRatio:\"16/10\",left:50,top:448,width:350,height:219},\n                    {aspectRatio:\"5/3\",left:50,top:457,width:350,height:210},\n                    {aspectRatio:\"5/4\",left:50,top:387,width:350,height:280},\n                    {aspectRatio:\"4/3\",left:50,top:404,width:350,height:262}\n                ],\n                visible:true,\n                layer:2\n            }\n        ],\n        buttons: []\n    },\n\n    // Third layout: PIP right\n    {\n        id: \"pip-right\",\n        videos: [\n            {\n                content:null,\n                rect:[\n                    {aspectRatio:\"16/9\",left:0,top:0,width:1280,height:720},\n                    {aspectRatio:\"16/10\",left:64,top:0,width:1152,height:720},\n                    {aspectRatio:\"5/3\",left:40,top:0,width:1200,height:720},\n                    {aspectRatio:\"5/4\",left:190,top:0,width:900,height:720},\n                    {aspectRatio:\"4/3\",left:160,top:0,width:960,height:720}\n                ],\n                visible:true,\n                layer:1\n            },\n            {\n                content:null,\n                rect:[\n                    {aspectRatio:\"16/9\",left:880,top:470,width:350,height:197},\n                    {aspectRatio:\"16/10\",left:880,top:448,width:350,height:219},\n                    {aspectRatio:\"5/3\",left:880,top:457,width:350,height:210},\n                    {aspectRatio:\"5/4\",left:880,top:387,width:350,height:280},\n                    {aspectRatio:\"4/3\",left:880,top:404,width:350,height:262}\n                ],\n                visible:true,\n                layer:2\n            }\n        ],\n        buttons: []\n    }\n];\n\nfunction nextLayout(validContent) {\n    layout = (layout + 1) % layouts.length;\n    return currentLayout(validContent);\n}\n\nfunction setLayout(validContent, index) {\n    layout = index < layouts.length ? index : layout;\n    return currentLayout(validContent);\n}\n\nfunction currentLayout(validContent) {\n    let selectedLayout = JSON.parse(JSON.stringify(layouts[layout]));\n    selectedLayout.videos[0].content = validContent[0];\n    selectedLayout.videos[1].content = validContent[1];\n    return selectedLayout;\n}\n\nexport default class DualVideoLayout extends VideoLayout {\n    getPluginModuleInstance() {\n        return PaellaCoreLayouts.Get();\n    }\n\n    get name() {\n\t\treturn super.name || \"es.upv.paella.dualVideo\";\n\t}\n\n    get identifier() { return \"dual-video\"; }\n\n    async load() {\n        let layoutIndex = getCookie('dualVideoLayoutIndex');\n        if (layoutIndex !== \"\") {\n            layout = Number(layoutIndex);\n        }\n        this.player.log.debug(\"Dual video layout loaded\");\n    }\n\n    getValidStreams(streamData) {\n        // As this is a dual stream layout plugin, we make sure that the valid streams containis\n        // two streams. This prevents a bad configuration of the plugin\n        return super.getValidStreams(streamData)\n            .filter(stream => stream.length === 2);\n    }\n    \n    switchContent() {\n        const v0 = this._currentContent[0];\n        const v1 = this._currentContent[1];\n        this._currentContent[0] = v1;\n        this._currentContent[1] = v0;\n        \n        this.player.videoContainer.updateLayout();\n    }\n    \n    async switchMinimized() {\n        nextLayout(this._currentContent);\n        await this.player.videoContainer.updateLayout();\n    }\n\n    async minimizeVideo(content) {\n        let switchLayout = true;\n        if (content === this._currentContent[0]) {\n            const v0 = this._currentContent[0];\n            const v1 = this._currentContent[1];\n            this._currentContent[0] = v1;\n            this._currentContent[1] = v0;\n            switchLayout = false;\n        }\n        if (layout === 1 && switchLayout) {\n            setLayout(this._currentContent, 2);\n        }\n        else {\n            setLayout(this._currentContent, 1);\n        }\n        await this.player.videoContainer.updateLayout();\n    }\n\n    async maximizeVideo(content) {\n        let switchLayout = true;\n        if (content === this._currentContent[1]) {\n            const v0 = this._currentContent[0];\n            const v1 = this._currentContent[1];\n            this._currentContent[0] = v1;\n            this._currentContent[1] = v0;\n            switchLayout = false;\n        }\n        if (layout === 1 && switchLayout) {\n            setLayout(this._currentContent, 2);\n        }\n        else {\n            setLayout(this._currentContent, 1);\n        }\n        await this.player.videoContainer.updateLayout();\n    }\n\n    async setSideBySide() {\n        setLayout(this._currentContent, 0);\n        await this.player.videoContainer.updateLayout();\n    }\n\n    get minimizedContent() {\n        // See layout structure\n        if (layout === 0) {\n            return \"\";\n        }\n        else {\n            return this._currentContent[1];\n        }\n    }\n\n    async closeVideo(content) {\n        const singleStreamContentIds = this.player.videoContainer.validContentIds.filter(cid => cid.indexOf(\"-\") === -1);\n        const contentId = singleStreamContentIds.find(cid => cid != content);\n        await this.player.videoContainer.setLayout(contentId);\n    }\n\n    getVideoCanvasButtons(layoutStructure, content, video, videoCanvas) {\n        if (layoutStructure.id === \"side-by-side\") {\n            // Buttons: swap videos and minimize\n            return [\n                // Swap\n                {\n                    icon: this.player.getCustomPluginIcon(this.name,\"iconRotate\") || defaultIconRotate,\n                    position: CanvasButtonPosition.LEFT,\n                    title: this.player.translate('Swap position of the videos'),\n                    ariaLabel: this.player.translate('Swap position of the videos'),\n                    name: this.name + ':iconRotate',\n                    click: async () => {\n                        await this.switchContent();\n                    }\n                },\n\n                // Minimize\n                {\n                    icon: this.player.getCustomPluginIcon(this.name,\"iconMaximize\") || defaultIconMaximize,\n                    position: CanvasButtonPosition.LEFT,\n                    title: this.player.translate('Maximize video'),\n                    ariaLabel: this.player.translate('Maximize video'),\n                    name: this.name + ':iconMaximize',\n                    click: async () => {\n                        await this.maximizeVideo(content);\n                    }\n                },\n\n                // Close\n                {\n                    icon: this.player.getCustomPluginIcon(this.name,\"iconClose\") || defaultIconClose,\n                    position: CanvasButtonPosition.RIGHT,\n                    title: this.player.translate('Close video'),\n                    ariaLabel: this.player.translate('Close video'),\n                    name: this.name + ':iconClose',\n                    click: async () => {\n                        await this.closeVideo(content);\n                    }\n                }\n            ]\n        }\n        else {\n            const result = [];\n\n            if (content === this.minimizedContent) {\n                result.push({\n                    icon: this.player.getCustomPluginIcon(this.name,\"iconMaximize\") || defaultIconMaximize,\n                    position: CanvasButtonPosition.LEFT,\n                    title: this.player.translate('Maximize video'),\n                    ariaLabel: this.player.translate('Maximize video'),\n                    name: this.name + ':iconMaximize',\n                    click: async () => {\n                        await this.switchContent();\n                    }\n                });\n\n                result.push({\n                    icon: this.player.getCustomPluginIcon(this.name,\"iconSwitchSide\") || defaultIconSwitchSide,\n                    position: CanvasButtonPosition.LEFT,\n                    title: this.player.translate('Place the video on the other side of the screen'),\n                    ariaLabel: this.player.translate('Place the video on the other side of the screen'),\n                    name: this.name + ':iconSwitchSide',\n                    click: async () => {\n                        await this.minimizeVideo(content);\n                    }\n                });\n\n                result.push({\n                    icon: this.player.getCustomPluginIcon(this.name,\"iconClose\") || defaultIconClose,\n                    position: CanvasButtonPosition.RIGHT,\n                    title: this.player.translate('Close video'),\n                    ariaLabel: this.player.translate('Close video'),\n                    name: this.name + ':iconClose',\n                    click: async () => {\n                        await this.closeVideo(content);\n                    }\n                });\n            }\n            else {\n                result.push({\n                    icon: this.player.getCustomPluginIcon(this.name,\"iconMinimize\") || defaultIconMinimize,\n                    position: CanvasButtonPosition.LEFT,\n                    title: this.player.translate('Minimize video'),\n                    ariaLabel: this.player.translate('Minimize video'),\n                    name: this.name + ':iconMinimize',\n                    click: async () => {\n                        await this.switchContent();\n                    }\n                });\n\n                result.push({\n                    icon: this.player.getCustomPluginIcon(this.name,\"iconSideBySide\") || defaultIconSideBySide,\n                    position: CanvasButtonPosition.LEFT,\n                    title: this.player.translate('Put the videos side by side'),\n                    ariaLabel: this.player.translate('Put the videos side by side'),\n                    name: this.name + ':iconSideBySide',\n                    click: async () => {\n                        await this.setSideBySide();\n                    }\n                });\n\n                result.push({\n                    icon: this.player.getCustomPluginIcon(this.name,\"iconClose\") || defaultIconClose,\n                    position: CanvasButtonPosition.RIGHT,\n                    title: this.player.translate('Close video'),\n                    ariaLabel: this.player.translate('Close video'),\n                    name: this.name + ':iconClose',\n                    click: async () => {\n                        await this.closeVideo(content);\n                    }\n                });\n            }\n            return result;\n        }\n    }\n\n    getLayoutStructure(streamData, contentId) {\n        if (!this._currentContent || this._currentContentId!==contentId) {\n            const {content} = this.validContent.find(content => content.id === contentId);\n            this._currentContent = content;\n            this._currentContentId = contentId;\n\n            const content0 = getCookie('dualVideoLayoutContent0');\n            const content1 = getCookie('dualVideoLayoutContent1');\n            if (content0 !== \"\" && content1 !== \"\" && \n                this._currentContent.indexOf(content0) !== -1 && \n                this._currentContent.indexOf(content1) !== -1)\n            {\n                this._currentContent[0] = content0;\n                this._currentContent[1] = content1;\n            }\n        }\n        const selectedLayout = currentLayout(this._currentContent);\n\n        const result = {\n            id: selectedLayout.id,\n            player: this.player,\n            name:{es:\"Dos streams con posición dinámica\"},\n            hidden:false,\n            videos: selectedLayout.videos,\n            buttons: []\n        };\n\n        // Save layout settings\n        setCookie(\"dualVideoLayoutIndex\", layout);\n        setCookie(\"dualVideoLayoutContent0\", this._currentContent[0]);\n        setCookie(\"dualVideoLayoutContent1\", this._currentContent[1]);\n        \n        return result;\n    }\n}\n","import VideoLayout from \"../core/VideoLayout\";\n\nimport defaultIconSwitchSide from '../../icons/icon_switch_side';\nimport defaultIconMaximize from '../../icons/maximize';\nimport defaultIconClose from '../../icons/close';\nimport defaultIconSideBySide from '../../icons/icon_side_by_side';\nimport { CanvasButtonPosition } from \"../core/CanvasPlugin\";\n\nimport PaellaCoreLayouts from \"./PaellaCoreLayouts\";\n\nconst pipLeft = {\n    id: 'pip-left',\n    name: {es: \"Dos streams imagen dentro de imagen\"},\n    hidden: false,\n    videos: [\n        {\n            content: null,\n            rect:[\n                {aspectRatio:\"16/9\",left:0,top:0,width:1280,height:720},\n                {aspectRatio:\"16/10\",left:64,top:0,width:1152,height:720},\n                {aspectRatio:\"5/3\",left:40,top:0,width:1200,height:720},\n                {aspectRatio:\"5/4\",left:190,top:0,width:900,height:720},\n                {aspectRatio:\"4/3\",left:160,top:0,width:960,height:720},\n                {aspectRatio:\"9/16\",left:617,top:17,width:386,height:687}\n            ],\n            visible:true,\n            layer:1\n        },\n        {\n            content: null,\n            rect:[\n                {aspectRatio:\"16/9\",left:50,top:470,width:350,height:197},\n                {aspectRatio:\"16/10\",left:50,top:448,width:350,height:219},\n                {aspectRatio:\"5/3\",left:50,top:457,width:350,height:210},\n                {aspectRatio:\"5/4\",left:50,top:387,width:350,height:280},\n                {aspectRatio:\"4/3\",left:50,top:404,width:350,height:262},\n                {aspectRatio:\"9/16\",left:224,top:301,width:224,height:400}\n            ],\n            visible:true,\n            layer:2\n        }\n    ],\n    buttons: []\n};\n\nconst pipRight = {\n    id: \"pip-right\",\n    name: {es: \"Dos streams imagen dentro de imagen a la derecha\"},\n    hidden: false,\n    videos: [\n        {\n            content:null,\n            rect:[\n                {aspectRatio:\"16/9\",left:0,top:0,width:1280,height:720},\n                {aspectRatio:\"16/10\",left:64,top:0,width:1152,height:720},\n                {aspectRatio:\"5/3\",left:40,top:0,width:1200,height:720},\n                {aspectRatio:\"5/4\",left:190,top:0,width:900,height:720},\n                {aspectRatio:\"4/3\",left:160,top:0,width:960,height:720},\n                {aspectRatio:\"9/16\",left:242,top:17,width:386,height:687}\n            ],\n            visible:true,\n            layer:1\n        },\n        {\n            content:null,\n            rect:[\n                {aspectRatio:\"16/9\",left:880,top:470,width:350,height:197},\n                {aspectRatio:\"16/10\",left:880,top:448,width:350,height:219},\n                {aspectRatio:\"5/3\",left:880,top:457,width:350,height:210},\n                {aspectRatio:\"5/4\",left:880,top:387,width:350,height:280},\n                {aspectRatio:\"4/3\",left:880,top:404,width:350,height:262},\n                {aspectRatio:\"9/16\",left:887,top:304,width:224,height:400}\n            ],\n            visible:true,\n            layer:2\n        }\n    ],\n    buttons: []\n};\n\nexport default class DualVideoPiPLayout extends VideoLayout {\n    getPluginModuleInstance() {\n        return PaellaCoreLayouts.Get();\n    }\n    \n    get name() {\n\t\treturn super.name || \"es.upv.paella.dualVideoPiP\";\n\t}\n\n    get identifier() { return \"dual-video-pip\"; }\n\n    async load() {\n        this._currentLayout = pipLeft;\n        this.dualVideoContentIds = this.config.dualVideoContentIds || []\n    }\n\n    getValidStreams(streamData) {\n        return super.getValidStreams(streamData)\n            .filter(stream => stream.length === 2);\n    }\n\n    getVideoCanvasButtons(layoutStructure, content, video, videoCanvas) {\n        const iconClose = this.player.getCustomPluginIcon(this.name, \"iconClose\") || defaultIconClose;\n        const iconSwitchSide = this.player.getCustomPluginIcon(this.name, \"iconSwitchSide\") || defaultIconSwitchSide;\n        const iconMaximize = this.player.getCustomPluginIcon(this.name, \"iconMaximize\") || defaultIconMaximize;\n        const iconSideBySide = this.player.getCustomPluginIcon(this.name, \"iconSideBySide\") || defaultIconSideBySide;\n        const result = [\n            {\n                icon: iconClose,\n                position: CanvasButtonPosition.RIGHT,\n                title: this.player.translate(\"Close video\"),\n                ariaLabel: this.player.translate(\"Close video\"),\n                name: this.name + ':iconClose',\n                click: async () => {\n                    const singleStreamContentIds = this.player.videoContainer.validContentIds.filter(cid => cid.indexOf(\"-\") === -1);\n                    const contentId = singleStreamContentIds.find(cid => cid !== content);\n                    await this.player.videoContainer.setLayout(contentId);\n                }\n            }\n        ];\n        if (content === this._pipVideo) {\n            result.push({\n                icon: iconSwitchSide,\n                position: CanvasButtonPosition.LEFT,\n                title: this.player.translate(\"Switch side\"),\n                ariaLabel: this.player.translate(\"Switch side\"),\n                name: this.name + ':iconSwitchSide',\n                click: async () => {\n                    this.switchSide();\n                    await this.player.videoContainer.updateLayout(this._fullVideo);\n                }\n            });\n\n            result.push({\n                icon: iconMaximize,\n                position: CanvasButtonPosition.LEFT,\n                title: this.player.translate(\"Maximize video\"),\n                ariaLabel: this.player.translate(\"Maximize video\"),\n                name: this.name + ':iconMaximize',\n                click: async () => {\n                    this.switchSources();\n                    await this.player.videoContainer.updateLayout(this._fullVideo);\n                }\n            })\n        }\n        else if (this.dualVideoContentIds.length > 0) {\n            result.push({\n                icon: iconSideBySide,\n                position: CanvasButtonPosition.LEFT,\n                title: this.player.translate(\"Set side by side\"),\n                ariaLabel: this.player.translate(\"Set side by side\"),\n                name: this.name + ':iconSideBySide',\n                click: async () => {\n                    const availableContentIds = this.player.videoContainer.validContentIds;\n                    const dualVideoContentId = this.dualVideoContentIds.find(id => {\n                        return availableContentIds.indexOf(id) !== -1;\n                    });\n                    if (dualVideoContentId) {\n                        this.player.videoContainer.setLayout(dualVideoContentId);\n                    }\n                }\n            })\n        }\n        return result;\n    }\n\n    switchSide() {\n        if (this._currentLayout.id === 'pip-left') {\n            this._currentLayout = pipRight;\n        }\n        else {\n            this._currentLayout = pipLeft;\n        }\n    }\n\n    switchSources() {\n        const tmp = this._pipVideo;\n        this._pipVideo = this._fullVideo;\n        this._fullVideo = tmp;\n    }\n\n    getLayoutStructure(streamData, contentId, mainContent) {\n        const { content } = this.validContent.find(content => content.id === contentId);\n        if (mainContent && content.find(content => content === mainContent)) {\n            this._fullVideo = mainContent;\n            this._pipVideo = content.find(content => content !== mainContent);\n        }\n        else if (!this._pipVideo || !this._fullVideo) {\n            this._pipVideo = content[0];\n            this._fullVideo = content[1];\n        }\n\n        const result = JSON.parse(JSON.stringify(this._currentLayout));\n\n        result.player = this.player;\n        result.videos[0].content = this._fullVideo;\n        result.videos[1].content = this._pipVideo;\n\n        return result;\n    }\n}\n\n","import { CanvasButtonPosition } from '../core/CanvasPlugin';\nimport VideoLayout from '../core/VideoLayout';\n\nimport sideBySideIcon from \"../../icons/icon_side_by_side\";\n\nimport PaellaCoreLayouts from './PaellaCoreLayouts';\n\nexport default class SingleVideoLayout extends VideoLayout {\n    getPluginModuleInstance() {\n        return PaellaCoreLayouts.Get();\n    }\n    \n    get name() {\n\t\treturn super.name || \"es.upv.paella.singleVideo\";\n\t}\n\n    get identifier() { return \"single-video\"; }\n\n    async load() {\n        this.player.log.debug(\"Single video layout loaded\");\n        this.dualVideoContentIds = this.config.dualVideoContentIds || [\n            \"presenter-presentation-dynamic\",\n            \"presenter-2-presentation-dynamic\",\n            \"presenter-presenter-2-dynamic\",\n            \"presenter-presentation\",\n            \"presenter-2-presentation\",\n            \"presenter-presenter-2\"\n        ];\n    }\n\n    getValidStreams(streamData) {\n        // As this plugin is a single stream, we make sure that the valid streams are simple\n        // This prevents a bad configuration of the plugin\n        return super.getValidStreams(streamData)\n            .filter(stream => stream.length === 1);\n    }\n\n    getVideoCanvasButtons(layoutStructure, content, video, videoCanvas) {\n        if (this._multiStream) {\n            return [\n                {\n                    icon: this.player.getCustomPluginIcon(this.name,\"iconSideBySide\") || sideBySideIcon,\n                    position: CanvasButtonPosition.LEFT,\n                    title: this.player.translate(\"Two videos 50%\"),\n                    ariaLabel: this.player.translate(\"Two videos 50%\"),\n                    name: this.name + ':iconSideBySide',\n                    click: () => {\n                        const availableContentIds = this.player.videoContainer.validContentIds;\n                        const dualVideoContentId = this.dualVideoContentIds.find(id => {\n                            return availableContentIds.indexOf(id) !== -1;\n                        });\n                        if (dualVideoContentId) {\n                            this.player.videoContainer.setLayout(dualVideoContentId);\n                        }\n                    }\n                }\n            ]\n        }\n        else {\n            return []\n        }\n    }\n\n    getLayoutStructure(streamData, contentId) {\n        const validContent = this.validContent.find(content => content.id===contentId);\n        const layoutStructure = {\n            player: this.player,\n            name:{es:\"One stream\"},\n            hidden:false,\n            videos: [\n                {\n                    content:validContent.content[0],\n                    rect:[\n                        { aspectRatio:\"1/1\",left:280,top:0,width:720,height:720 },\n                        { aspectRatio:\"6/5\",left:208,top:0,width:864,height:720 },\n                        { aspectRatio:\"5/4\",left:190,top:0,width:900,height:720 },\n                        { aspectRatio:\"4/3\",left:160,top:0,width:960,height:720 },\n                        { aspectRatio:\"11/8\",left:145,top:0,width:990,height:720 },\n                        { aspectRatio:\"1.41/1\",left:132,top:0,width:1015,height:720 },\n                        { aspectRatio:\"1.43/1\",left:125,top:0,width:1029,height:720 },\n                        { aspectRatio:\"3/2\",left:100,top:0,width:1080,height:720 },\n                        { aspectRatio:\"16/10\",left:64,top:0,width:1152,height:720 },\n                        { aspectRatio:\"5/3\",left:40,top:0,width:1200,height:720 },\n                        { aspectRatio:\"16/9\",left:0,top:0,width:1280,height:720 },\n                        { aspectRatio:\"1.85/1\",left:0,top:14,width:1280,height:692 },\n                        { aspectRatio:\"2.35/1\",left:0,top:87,width:1280,height:544 },\n                        { aspectRatio:\"2.41/1\",left:0,top:94,width:1280,height:531 },\n                        { aspectRatio:\"2.76/1\",left:0,top:128,width:1280,height:463 }\n                    ],\n                    visible:true,\n                    layer:1\n                }\n            ],\n            background:{content:\"slide_professor_paella.jpg\",zIndex:5,rect:{left:0,top:0,width:1280,height:720},visible:true,layer:0},\n            logos:[{content:\"paella_logo.png\",zIndex:5,rect:{top:10,left:10,width:49,height:42}}],\n            buttons: [],\n            onApply: function() { }\n        }\n\n        if (streamData.length > 1) {\n            this._multiStream = true;\n        }\n\n        return layoutStructure;\n    }\n} ","\nimport VideoLayout from '../core/VideoLayout';\n\nimport { CanvasButtonPosition } from '../core/CanvasPlugin';\n\nimport defaultIconSideBySide from '../../icons/icon_side_by_side';\n\nimport PaellaCoreLayouts from './PaellaCoreLayouts';\n\nexport default class SingleVideoDynamicLayout extends VideoLayout {\n    getPluginModuleInstance() {\n        return PaellaCoreLayouts.Get();\n    }\n    \n    get name() {\n\t\treturn super.name || \"es.upv.paella.singleVideoDynamic\";\n\t}\n\n    get layoutType() {\n        return \"dynamic\";\n    }\n\n    async load() {\n        this.player.log.debug(\"Single video dynamic layout loaded\");\n        this.dualVideoContentIds = this.config.dualVideoContentIds || [\n            \"presenter-presentation-dynamic\",\n            \"presenter-2-presentation-dynamic\",\n            \"presenter-presenter-2-dynamic\",\n            \"presenter-presentation\",\n            \"presenter-2-presentation\",\n            \"presenter-presenter-2\"\n        ];\n    }\n\n    getVideoCanvasButtons(layoutStructure, content, video, videoCanvas) {\n        const iconSideBySide = this.player.getCustomPluginIcon(this.name,\"iconSideBySide\") || defaultIconSideBySide;\n\n        const result = [];\n        if (this._multiStream) {\n            result.push({\n                icon: iconSideBySide,\n                position: CanvasButtonPosition.LEFT,\n                title: this.player.translate('Dual stream 50%'),\n                ariaLabel: this.player.translate('Dual stream 50%'),\n                name: this.name + ':iconSideBySide',\n                click: async () => {\n                    const availableContentIds = this.player.videoContainer.validContentIds;\n                    const dualVideoContentId = this.dualVideoContentIds.find(id => {\n                        return availableContentIds.indexOf(id) !== -1;\n                    });\n                    if (dualVideoContentId) {\n                        this.player.videoContainer.setLayout(dualVideoContentId);\n                    }\n                }\n            });\n        }\n        return result;\n    }\n\n    getLayoutStructure(streamData, contentId, mainContent) {\n        if (streamData.length > 1) {\n            this._multiStream = true;\n        }\n        const { content } = this.validContent.find(content => content.id === contentId);\n        this._currentContent = content.map(c => {\n            return {\n                id: c,\n                size: 50\n            }\n        });\n        return {\n            id: \"single-dynamic\",\n            videos: [\n                {\n                    content: this._currentContent[0].id,\n                    visible: true,\n                    size: this._currentContent[0].size\n                }\n            ]\n        }\n    }\n}","\nimport VideoLayout from '../core/VideoLayout';\n\n\nimport iconRotate from '../../icons/icon_rotate';\n\nimport PaellaCoreLayouts from './PaellaCoreLayouts';\n\nconst layout = {\n    videos: [\n        {\n            content: {},\n            rect:[\n                { aspectRatio:\"16/9\",left:239, top:17, width:803, height:451 }\n            ],\n            visible:true,\n            layer:1\n        },\n        {\n            content: {},\n            rect:[\n                { aspectRatio:\"16/9\",left:44, top:482, width:389, height:218 }\n            ],\n            visible:true,\n            layer:1\n        },\n        {\n            content: {},\n            rect:[\n                { aspectRatio:\"16/9\",left:847, top:482, width:389, height:218 }\n            ],\n            visible:true,\n            layer:1\n        }\n    ],\n    buttons: [\n        {\n            rect: { left: 618, top: 495, width: 45, height: 45 },\n            onClick: function(event) { this.rotate(); },\n            label:\"Rotate\",\n            icon:\"icon_rotate.svg\",\n            layer: 2\n        }\n    ]\n}\n\nfunction getLayout(validContent) {\n    let selectedLayout = JSON.parse(JSON.stringify(layout));\n    selectedLayout.videos[0].content = validContent[0];\n    selectedLayout.videos[1].content = validContent[1];\n    selectedLayout.videos[2].content = validContent[2];\n    return selectedLayout;\n}\n\nexport default class TripleVideoLayout extends VideoLayout {\n    getPluginModuleInstance() {\n        return PaellaCoreLayouts.Get();\n    }\n    \n    get name() {\n\t\treturn super.name || \"es.upv.paella.tripleVideo\";\n\t}\n\n    get identifier() { return \"triple-video\"; }\n\n    async load() {\n        this.player.log.debug(\"Triple video layout loaded\");\n    }\n\n    getValidStreams(streamData) {\n        // As this is a dual stream layout plugin, we make sure that the valid streams containis\n        // two streams. This prevents a bad configuration of the plugin\n        return super.getValidStreams(streamData)\n            .filter(stream => stream.length === 3);\n    }\n    \n    switchContent() {\n        const v0 = this._currentContent[0];\n        const v1 = this._currentContent[1];\n        const v2 = this._currentContent[2];\n        this._currentContent[0] = v2;\n        this._currentContent[1] = v0;\n        this._currentContent[2] = v1;\n        \n        this.player.videoContainer.updateLayout();\n    }\n\n    getLayoutStructure(streamData, contentId) {\n        if (!this._currentContent || this._currentContentId!==contentId) {\n            this._currentContentId = contentId;\n            const {content} = this.validContent.find(content => content.id === contentId);\n            this._currentContent = content;\n        }\n        const selectedLayout = getLayout(this._currentContent);\n        \n        const result = {\n            player: this.player,\n            name:{es:\"Three streams with dynamic position\"},\n            hidden:false,\n            videos: selectedLayout.videos,\n            buttons: [\n                {\n                    rect: selectedLayout.buttons[0].rect,\n                    onClick: () => { this.switchContent(); },\n                    label:\"Switch\",\n                    icon: iconRotate,\n                    layer: 2,\n                    ariaLabel: \"Swap the position of the videos\",\n                    title: \"Swap the position of the videos\"\n                }\n            ]\n        };\n        \n        return result;\n    }\n}\n","import CanvasPlugin, { Canvas } from '../core/CanvasPlugin';\n\nexport class AudioCanvas extends Canvas {\n    constructor(player, videoContainer) {\n        super('div', player, videoContainer);\n        this.element.classList.add(\"image-canvas\");\n    }\n\n    async loadCanvas(player) {\n        player.element.style.width = \"100%\";\n        player.element.style.height= \"100%\";\n    }\n}\n\nexport default class AudioCanvasPlugin extends CanvasPlugin {\n    get name() {\n\t\treturn super.name || \"es.upv.paella.audioCanvas\";\n\t}\n\n    get canvasType() { return 'audio'; }\n\n    getCanvasInstance(videoContainer) {\n        return new AudioCanvas(this.player, videoContainer);\n    }\n}\n","import CanvasPlugin, { Canvas } from '../core/CanvasPlugin';\n\nexport class VideoCanvas extends Canvas {\n    constructor(player, videoContainer) {\n        super('div', player, videoContainer);\n    }\n\n    async loadCanvas(player) {\n        player.element.style.width = \"100%\";\n        player.element.style.height = \"100%\";\n    }\n}\n\nexport default class VideoCanvasPlugin extends CanvasPlugin {\n    get name() {\n\t\treturn super.name || \"es.upv.paella.videoCanvas\";\n\t}\n\n    get canvasType() { return \"video\"; }\n\n    async isCompatible(stream) {\n        if (!Array.isArray(stream.canvas) || stream.canvas.length === 0) {\n            // By default, the default canvas is HTML video canvas\n            return true;\n        }\n        \n        return await super.isCompatible(stream);\n    }\n\n    getCanvasInstance(videoContainer) {\n        return new VideoCanvas(this.player, videoContainer);\n    }\n}\n","import Plugin from './Plugin';\nimport { loadPluginsOfType } from './plugin_tools'\nimport PlayerResource from './PlayerResource';\n\nexport class DataPlugin extends Plugin {\n    get type() { return \"data\"; }\n\n    get context() { return this.config.context || []; }\n\n    async read(/* context, key */) {\n        throw Error(`DataPlugin.read() not implemented in data plugin '${this.name}'`);\n    }\n\n    async write(/* context, key, data */) {\n        throw Error(`DataPlugin.write() not implemented in data plugin '${this.name}'`);\n    }\n\n    async remove(/* context, key */) {\n        throw Error(`DataPlugin.remove() not implemented in data plugin '${this.name}'`);\n    }\n}\n\nexport default class Data extends PlayerResource {\n    constructor(player) {\n        super(player);\n\n        this._dataPlugins = {}\n\n        loadPluginsOfType(this.player, \"data\", async (plugin) => {\n            plugin.context?.forEach(ctx => {\n                this._dataPlugins[ctx] = this._dataPlugins[ctx] || [];\n                this._dataPlugins[ctx].push(plugin);\n            });\n        })\n    }\n\n    getDataPlugin(context) {\n        let plugin =  this._dataPlugins[context] &&\n                      this._dataPlugins[context].length > 0 &&\n                      this._dataPlugins[context][0];\n        if (!plugin) {\n            plugin = this._dataPlugins[\"default\"] &&\n                     this._dataPlugins[\"default\"].length > 0 &&\n                     this._dataPlugins[\"default\"][0];\n        }\n        if (!plugin) {\n            throw Error(`No data plugin found for context '${context}'`);\n        }\n        return plugin;\n    }\n\n    getDataPlugins(context) {\n        let plugin =  this._dataPlugins[context] &&\n                      this._dataPlugins[context].length > 0 &&\n                      this._dataPlugins[context];\n        if (!plugin) {\n            plugin = this._dataPlugins[\"default\"] &&\n                     this._dataPlugins[\"default\"].length > 0 &&\n                     this._dataPlugins[\"default\"];\n        }\n        if (!plugin) {\n            throw Error(`No data plugin found for context '${context}'`);\n        }\n        return plugin;\n    }\n\n    async read(context, key) {\n        const p = this.getDataPlugin(context);\n        const result = await p.read(context, key);\n        return result;\n    }\n\n    async write(context, key, data) {\n        const p = this.getDataPlugins(context);\n        if (Array.isArray(p)) {\n            let result = null;\n            for (let i = 0; i<p.length; ++i) {\n                result = await p[i].write(context, key, data);\n            }\n            return result;\n        }\n        else if (p) {\n            const result = await p.write(context, key, data);\n            return result;\n        }\n        else {\n            this.player.log.warn(`No such data plugin found for context '${context}'`);\n        }\n    }\n\n    async remove(context, key) {\n        const p = this.getDataPlugins(context);\n        if (p.length>1) {\n            let result = null;\n            for (let i = 0; i<p.length; ++i) {\n                result = await p[i].remove(context, key);\n            }\n            return result;\n        }\n        else {\n            const result = await p.remove(context, key);\n            return result;\n        }\n    }\n}\n\n","import PluginModule from \"../core/PluginModule\";\nimport packageData from \"../../../package.json\";\n\nlet g_pluginModule = null;\n\nexport default class PaellaCoreDataPlugins extends PluginModule {\n    static Get() {\n        if (!g_pluginModule) {\n            g_pluginModule = new PaellaCoreDataPlugins();\n        }\n        return g_pluginModule;\n    }\n    \n    get moduleName() {\n        return \"paella-core default data plugins\";\n    }\n\n    get moduleVersion() {\n        return packageData.version;\n    }\n}","import { DataPlugin } from '../core/Data';\n\nimport { setCookie, getCookie } from '../core/utils';\nimport PaellaCoreDataPlugins from './PaellaCoreDataPlugins';\n\nexport default class CookieDataPlugin extends DataPlugin {\n    getPluginModuleInstance() {\n        return PaellaCoreDataPlugins.Get();\n    }\n\n    get name() {\n        return super.name || \"es.upv.paella.cookieDataPlugin\";\n    }\n    \n    serializeKey(context,params) {\n        if (typeof(params) === \"object\") {\n            params = JSON.stringify(params);\n        }\n        return `${context}|${params}`;\n    }\n\n    async read(context, keyParams) {\n        const key = this.serializeKey(context, keyParams);\n        let value = getCookie(key);\n        try {\n            value = JSON.parse(value);\n        }\n        catch (e) {}\n        this.player.log.debug(`CookieDataPlugin.read: ${key}`);\n        return value;\n    }\n\n    async write(context, keyParams, data) {\n        const key = this.serializeKey(context, keyParams);\n        if (data && typeof(data) === \"object\") {\n            try {\n                data = JSON.stringify(data);\n            }\n            catch (e) {\n                this.player.log.warn(`CookieDataPlugin.write: ${key}: invalid data object.`);\n                data = \"\";\n            }\n        }\n        setCookie(key, data);\n        this.player.log.debug(`CookieDataPlugin.write: ${key}`);\n    }\n\n    async remove(context, keyParams) {\n        const key = this.serializeKey(context, keyParams);\n        setCookie(key, \"\");\n        this.player.log.debug(`CookieDataPlugin.remove: ${key}`);\n    }\n}\n","import { DataPlugin } from '../core/Data';\n\nimport PaellaCoreDataPlugins from './PaellaCoreDataPlugins';\n\nexport default class LocalStorageDataPlugin extends DataPlugin {\n    getPluginModuleInstance() {\n        return PaellaCoreDataPlugins.Get();\n    }\n\n    get name() {\n        return super.name || \"es.upv.paella.localStorageDataPlugin\";\n    }\n    \n    serializeKey(context,params) {\n        if (typeof(params) === \"object\") {\n            params = JSON.stringify(params);\n        }\n        return `${context}|${params}`;\n    }\n\n    async read(context, keyParams) {\n        const key = this.serializeKey(context, keyParams);\n        let value = localStorage.getItem(key);\n        try {\n            value = JSON.parse(value);\n        }\n        catch (e) {}\n        this.player.log.debug(`LocalStorageDataPlugin.read: ${key}`);\n        return value;\n    }\n\n    async write(context, keyParams, data) {\n        const key = this.serializeKey(context, keyParams);\n        if (data && typeof(data) === \"object\") {\n            try {\n                data = JSON.stringify(data);\n            }\n            catch (e) {\n                this.player.log.warn(`LocalStorageDataPlugin.write: ${key}: invalid data object.`);\n                data = \"\";\n            }\n        }\n        localStorage.setItem(key, data);\n        this.player.log.debug(`LocalStorageDataPlugin.write: ${key}`);\n    }\n\n    async remove(context, keyParams) {\n        const key = this.serializeKey(context, keyParams);\n        localStorage.setItem(key, \"\");\n        this.player.log.debug(`LocalStorageDataPlugin.remove: ${key}`);\n    }\n}\n","import AudioVideoPlugin from \"./videoFormats/es.upv.paella.audioVideoFormat\";\nimport HtmlVideoPlugin from \"./videoFormats/es.upv.paella.htmlVideoFormat\";\nimport ImageVideoPlugin from \"./videoFormats/es.upv.paella.imageVideoFormat\";\nimport Mp4VideoPlugin from \"./videoFormats/es.upv.paella.mp4VideoFormat\";\n\nimport DfxpManifestCaptionsPlugin from \"./plugins/es.upv.paella.dfxpManifestCaptionsPlugin\";\nimport PlayPauseButtonPlugin from \"./plugins/es.upv.paella.playPauseButton\";\nimport VttManifestCaptionsPlugin from \"./plugins/es.upv.paella.vttManifestCaptionsPlugin\";\nimport CurrentTimeLabelPlugin from \"./plugins/es.upv.paella.currentTimeLabelPlugin\";\n\nimport DualVideoDynamicLayout from \"./layouts/es.upv.paella.dualVideoDynamic\";\nimport DualVideoLayout from \"./layouts/es.upv.paella.dualVideo\";\nimport DualVideoPiPLayout from \"./layouts/es.upv.paella.dualVideoPiP\";\nimport SingleVideoLayout from \"./layouts/es.upv.paella.singleVideo\";\nimport SingleVideoDynamicLayout from \"./layouts/es.upv.paella.singleVideoDynamic\";\nimport TripleVideoLayout from \"./layouts/es.upv.paella.tripleVideo\";\n\nimport AudioCanvasPlugin from \"./canvas/es.upv.paella.audioCanvas\";\nimport VideoCanvasPlugin from \"./canvas/es.upv.paella.videoCanvas\";\n\nimport CookieDataPlugin from \"./data/es.upv.paella.cookieDataPlugin\";\nimport LocalStorageDataPlugin from \"./data/es.upv.paella.localStorageDataPlugin\";\n\nexport default [\n    {\n        plugin: AudioVideoPlugin,\n        config: {\n            enabled: false\n        }\n    },\n    {\n        plugin: HtmlVideoPlugin,\n        config: {\n            enabled: false\n        }\n    },\n    {\n        plugin: ImageVideoPlugin,\n        config: {\n            enabled: false\n        }\n    },\n    {\n        plugin: Mp4VideoPlugin,\n        config: {\n            enabled: false\n        }\n    },\n    {\n        plugin: DfxpManifestCaptionsPlugin,\n        config: {\n            enabled: false\n        }\n    },\n    {\n        plugin: PlayPauseButtonPlugin,\n        config: {\n            enabled: false\n        }\n    },\n    {\n        plugin: VttManifestCaptionsPlugin,\n        config: {\n            enabled: false\n        }\n    },\n    {\n        plugin: CurrentTimeLabelPlugin,\n        config: {\n            enabled: false\n        }\n    },\n    {\n        plugin: DualVideoDynamicLayout,\n        config: {\n            enabled: false\n        }\n    },\n    {\n        plugin: DualVideoLayout,\n        config: {\n            enabled: false\n        }\n    },\n    {\n        plugin: DualVideoPiPLayout,\n        config: {\n            enabled: false\n        }\n    },\n    {\n        plugin: SingleVideoLayout,\n        config: {\n            enabled: false\n        }\n    },\n    {\n        plugin: SingleVideoDynamicLayout,\n        config: {\n            enabled: false\n        }\n    },\n    {\n        plugin: DualVideoDynamicLayout,\n        config: {\n            enabled: false\n        }\n    },\n    {\n        plugin: TripleVideoLayout,\n        config: {\n            enabled: false\n        }\n    },\n    {\n        plugin: AudioCanvasPlugin,\n        config: {\n            enabled: false\n        }\n    },\n    {\n        plugin: VideoCanvasPlugin,\n        config: {\n            enabled: false\n        }\n    },\n    {\n        plugin: CookieDataPlugin,\n        config: {\n            enabled: false,\n            context: [\"default\"]\n        }\n    },\n    {\n        plugin: LocalStorageDataPlugin,\n        config: {\n            enable: true,\n            context: [\"default\"]\n        }\n    }\n]\n","import ButtonPlugin from './ButtonPlugin';\nimport { createElementWithHtmlText } from './dom';\n\nfunction resolvePopUpType() {\n\tconst types = [\"modal\",\"timeline\",\"no-modal\"];\n\tconst warnMsg = () => this.player.log.warn(`Invalid popUpType set in \"${this.name}\" plugin. Alowed types are \"modal\", \"timeline\" and \"no-modal\"`);\n\tif (types.indexOf(this.config.popUpType) !== -1) {\n\t\treturn this.config.popUpType;\n\t}\n\telse if (types.indexOf(this.popUpType) !== -1) {\n\t\tif (this.config.popUpType) {\n\t\t\twarnMsg();\n\t\t}\n\t\treturn this.popUpType;\n\t}\n\telse {\n\t\twarnMsg();\n\t\treturn \"modal\";\n\t}\n}\n\nexport default class PopUpButtonPlugin extends ButtonPlugin {\n\tconstructor() {\n\t\tsuper(...arguments);\n\n\t\tthis._refreshContent = true;\n\t}\n\n\tset refreshContent(c) { this._refreshContent = c; }\n\n\tget refreshContent() { return this._refreshContent; }\n\n\tget closeParentPopUp() { return this.config.closeParentPopUp || this.getCloseParentPopUp(); }\n\n\tgetCloseParentPopUp() {\n\t\treturn false;\n\t}\n\n\tasync action(evt, caller) {\n\t\tsuper.action(evt, caller);\n\t\tthis.parentPopUp = caller;\n\t\tawait this.showPopUp();\n\t}\n\t\n\tget parentPopUp() {\n\t\treturn this._parentPopUp;\n\t}\n\n\tset parentPopUp(p) {\n\t\tthis._parentPopUp = p;\n\t}\n\n\tget popUp() {\n\t\treturn this._popUp;\n\t}\n\n\tget menuTitle() {\n\t\treturn this.config.menuTitle || null;\n\t}\n\n\tget moveable() {\n\t\treturn this.config.moveable ?? false;\n\t}\n\n\tget resizeable() {\n\t\treturn this.config.resizeable ?? false;\n\t}\n\n\tget customPopUpClass() {\n\t\treturn this.config.customPopUpClass ?? \"\";\n\t}\n\n\tget closeActions() {\n\t\tconst clickOutside = this.config.closeActions?.clickOutside ?? true\n\t\tconst closeButton = this.config.closeActions?.closeButton ?? false;\n\t\treturn {\n\t\t\tclickOutside,\n\t\t\tcloseButton\n\t\t}\n\t}\n\n\tget currentContent() {\n\t\treturn this._currentContent;\n\t}\n\n\tasync getContent() {\n\t\tconst content = createElementWithHtmlText('<p>Pop Up Button Plugin Content</p>');\n\t\treturn content;\n\t}\n\n\tasync checkRefreshContent() {\n\t\tif (this.refreshContent) {\n\t\t\tconst content = await this.getContent();\n\t\t\tthis._currentContent.innerHTML = \"\";\n\t\t\tconst children = Array.from(content.children);\n\t\t\tchildren.forEach(child => this._currentContent.appendChild(child));\n\t\t}\n\t}\n\n\tget popUpType() {\n\t\treturn this.config.popUpType || \"modal\"; // \"timeline\" or \"no-modal\"\n\t}\n\t\n\thidePopUp() {\n\t\tif (!this.player.playbackBar.popUp.isHidden) {\n\t\t\tthis.player.playbackBar.popUp.hide();\n\t\t}\n\t}\n\t\n\tasync showPopUp() {\n\t\tif (!this._keyEventHandler) {\n\t\t\tthis._keyEventHandler = evt => {\n\t\t\t\tif (evt.key === \"Escape\") {\n\t\t\t\t\tthis.hidePopUp();\n\t\t\t\t}\n\t\t\t}\n\t\t\tthis.button.addEventListener(\"keydown\", this._keyEventHandler);\n\t\t}\n\t\tconst popUp = this.player.playbackBar.popUp;\n\t\tif (popUp.isHidden || this._contentId !== popUp.currentContentId) {\n\t\t\tconst content = await this.getContent();\n\t\t\tthis._currentContent = content;\n\t\t\tthis._contentId = popUp.show({\n\t\t\t\ttitle: this.menuTitle || this.description,\n\t\t\t\tcontent,\n\t\t\t\tattachRight: this.popUpType === \"timeline\" || this.side === \"right\",\n\t\t\t\tattachLeft: this.popUpType === \"timeline\" || this.side === \"left\",\n\t\t\t\tparent: this.parentPopUp\n\t\t\t});\n\t\t}\n\t\telse {\n\t\t\tpopUp.hide();\n\t\t}\n\t}\n}\n","\nimport PopUpButtonPlugin from './PopUpButtonPlugin';\nimport { createElementWithHtmlText } from './dom';\n\nconst titleElement = (title) => title ? `<span class=\"menu-title\">${title}</span>` : \"\";\nconst iconElement = (icon) => icon ? `<i class=\"menu-icon\">${icon}</i>` : \"\";\nconst ariaLabel = (title) => title ? `aria-label=\"${title}\"` : \"\";\nconst stateTextElement = (text) => text ? `<span class=\"state-text\">${text}</span>` : \"\";\nconst stateIconElement = (icon) => icon ? `<i class=\"state-icon\">${icon}</i>` : \"\";\nconst stateElem = (text,icon) => text || icon ? `<span class=\"button-state\">${stateTextElement(text)}${stateIconElement(icon)}</span>` : \"\";\n\nfunction getMenuItem(itemData, buttonType, container, allItems, menuName, selectedItems, itemPlugin) {\n\tconst { id = 0, title = null, icon = null, showTitle = true, stateText = null, stateIcon = null } = itemData;\n\tconst plugin = this;\n\n\tconst item = document.createElement(\"li\");\n\tconst isSelected = selectedItems[id] ?? false;\n\tconst button = createElementWithHtmlText(`\n\t\t<button class=\"menu-button-item${ isSelected ? \" selected\" : \"\"}\" ${ariaLabel(title)} data-id=\"${id}\"\" id=\"${plugin.name}_menuItem_${id}\">\n\t\t\t${ iconElement(icon) }\n\t\t\t${ showTitle ? titleElement(title) : \"\" }\n\t\t\t${ stateText || stateIcon ? stateElem(stateText, stateIcon) : \"\"}\n\t\t</button>\n\t`);\n\n\t// Save a reference to the button in the item plugin, if it exists\n\tif (itemPlugin) {\n\t\titemPlugin._button = button;\n\t}\n\n\tbutton.addEventListener(\"keydown\", evt => {\n\t\tconst captureEvent = () => {\n\t\t\tevt.stopPropagation();\n\t\t\tevt.preventDefault();\n\t\t};\n\n\t\t// Manage the tab and esc keys to cycle the elements in the menu and close it\n\t\tif (evt.key === \"ArrowUp\") {\n\t\t\tconst prev = button.dataPrev;\n\t\t\tprev?.focus();\n\t\t\tcaptureEvent();\n\t\t}\n\t\telse if (evt.key === \"ArrowDown\") {\n\t\t\tconst prev = button.dataNext\n\t\t\tprev?.focus();\n\t\t\tcaptureEvent();\n\t\t}\n\t\telse if (evt.key === \"Tab\") {\n\t\t\t// dataNext and dataPrev are set on getContent() function\n\t\t\tconst nextFocus = evt.shiftKey ? evt.target.dataPrev: evt.target.dataNext;\n\t\t\tnextFocus?.focus();\n\t\t\tcaptureEvent();\n\t\t}\n\t\telse if (evt.key === \"Escape\") {\n\t\t\tif (!this.player.playbackBar.popUp.pop()) {\n\t\t\t\tthis.focus();\n\t\t\t}\n\t\t\telse {\n\t\t\t\tplugin.button?.focus();\n\t\t\t}\n\t\t\tcaptureEvent();\n\t\t}\n\t});\n\tbutton.addEventListener(\"click\", async evt => {\n\t\tif (buttonType === \"check\") {\n\t\t\tconst item = allItems.find(item => item.id === id);\n\t\t\tselectedItems[id] = !selectedItems[id];\n\t\t\tplugin.itemSelected(item, allItems);\n\t\t}\n\t\telse if (buttonType === \"radio\") {\n\t\t\tselectedItems[id] = true;\n\t\t\tlet item = null;\n\t\t\tallItems.forEach(currentItem => {\n\t\t\t\tif (currentItem.id === id) {\n\t\t\t\t\titem = currentItem;\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\tselectedItems[currentItem.id] = false;\n\t\t\t\t}\n\t\t\t});\n\t\t\tplugin.itemSelected(item, allItems);\n\t\t}\n\t\telse {\n\t\t\tconst item = allItems.find(item => item.id === id);\n\t\t\tplugin.itemSelected(item, allItems);\n\t\t}\n\n\t\tawait plugin.checkRefreshContent();\n\t\tevt.stopPropagation();\n\t\t\n\t\tif (plugin.closeOnSelect) {\n\t\t\tplugin.closeMenu();\n\t\t\tplugin.button?.focus();\n\t\t}\n\t});\n\titem.appendChild(button);\n\tcontainer.appendChild(item);\n\treturn item;\n}\n\nexport default class MenuButtonPlugin extends PopUpButtonPlugin {\n\t\n\tget closeOnSelect() {\n\t\tif (this.config.closeOnSelect === undefined) {\n\t\t\tif (this.buttonType !== \"check\") {\n\t\t\t\tthis.config.closeOnSelect = true;\n\t\t\t}\n\t\t\telse {\n\t\t\t\tthis.config.closeOnSelect = false;\n\t\t\t}\n\t\t}\n\t\treturn this.config.closeOnSelect;\n\t}\n\n\tsetSelected(id, value) {\n\t\tif (this._selectedItems) {\n\t\t\tthis._selectedItems[id] = value;\n\t\t}\n\t}\n\n\tasync getContent() {\n\t\t// If the menu is reloaded, and there is an item that has the focus, this will restore it once it is reloaded.\n\t\tconst currentActiveElementId = document.activeElement?.id;\n\n\t\tconst content = createElementWithHtmlText(`<menu></menu>`);\n\t\tthis._content = content;\n\n\t\tconst menuItems = await this.getMenu();\n\t\tthis._menuItems = menuItems;\n\n\t\tif (!this._selectedItems) {\n\t\t\tthis._selectedItems = {};\n\t\t\t// The `selected` property of the menu items is used to set the initial state. Once initialized, the\n\t\t\t// selection value is managed by the plugin and the `selected` property is ignored.\n\t\t\tthis._menuItems.forEach(itemData => {\n\t\t\t\tif (itemData.selected !== undefined && itemData.selected !== null) {\n\t\t\t\t\tthis._selectedItems[itemData.id] = itemData.selected;\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\n\t\tconst menuName = self.crypto.randomUUID();\n\t\tconst itemElems = menuItems.map(item => getMenuItem.apply(this, [item, typeof this.buttonType === 'function' ? this.buttonType() : this.buttonType, content, menuItems, menuName, this._selectedItems, item.plugin]));\n\t\titemElems.forEach((item, i, arr) => {\n\t\t\tconst button = item.querySelector(\"button\");\n\t\t\tlet next = arr[i + 1];\n\t\t\tlet prev = arr[i - 1];\n\n\t\t\tif (i === (arr.length - 1)) {\n\t\t\t\tnext = arr[0];\n\t\t\t}\n\n\t\t\tif (i === 0) {\n\t\t\t\tprev = arr[arr.length - 1];\n\t\t\t}\n\n\t\t\tbutton.dataNext = next?.querySelector(\"button\");\n\t\t\tbutton.dataPrev = prev?.querySelector(\"button\");\n\t\t});\n\t\tthis._firstItem = itemElems[0]?.querySelector(\"button\");\n\n\t\tif (currentActiveElementId) {\n\t\t\tsetTimeout(() => {\n\t\t\t\t// If this element still exists in the DOM, it means that the menu has been redrawn. \n\t\t\t\t// In that case, we restore the focus\n\t\t\t\tdocument.getElementById(currentActiveElementId)?.focus();\n\t\t\t}, 10);\n\t\t}\n\t\treturn content;\n\t}\n\n\tget menuTitle() {\n\t\treturn this.config.menuTitle || null;\n\t}\n\t\n\tasync getMenu() {\n\t\tconst items = [\n\t\t\t{ id: 0, title: \"Option 1\" },\n\t\t\t{ id: 1, title: \"Option 2\" },\n\t\t\t{ id: 2, title: \"Option 3\" },\n\t\t\t{ id: 3, title: \"Option 4\" },\n\t\t\t{ id: 4, title: \"Option 5\" }\n\t\t];\n\t\treturn items;\n\t}\n\t\n\t// Returns the menuItems with the current menu state\n\tget menuItems() {\n\t\treturn this._menuItems;\n\t}\n\t\n\t// If showTitles is false, then the 'title' attribute of the menu\n\t// items is used only as aria-label.\n\t// If the menu item has no icon, then the `showTitles` property is ignored\n\tget showTitles() {\n\t\treturn true;\n\t}\n\t\n\tget buttonType() {\n\t\t// check, radio or button\n\t\treturn \"radio\";\t\n\t}\n\t\n\titemSelected(itemData,menuItems) {\n\t\tthis.player.log.warn(`MenuButtonPlugin (${ this.name }): itemSelected() function not implemented.`);\n\t}\n\t\n\tcloseMenu() {\n\t\tthis.player.playbackBar.popUp.hide();\n\t}\n\n\tasync showPopUp() {\n\t\t// Refresh popup content to set focus on the first menu item\n\t\tthis.refreshContent = true;\n\t\tawait super.showPopUp();\n\n\t\tif (this.player.containsFocus && this._firstItem) {\n\t\t\tthis._firstItem.focus();\n\t\t}\n\t}\n}\n","import MenuButtonPlugin from './MenuButtonPlugin';\nimport { createElementWithHtmlText } from './dom';\nimport { loadPluginsOfType } from './plugin_tools';\nimport { addButtonPlugin } from './ButtonPlugin';\nimport { translate } from './Localization';\nimport { loadSvgIcon } from './utils';\n\nexport default class ButtonGroupPlugin extends MenuButtonPlugin {\n    get closeOnSelect() {\n        return this.config.closeOnSelect ?? false;\n    }\n\n    async load() {\n        if (this._iconPath) {\n            this.icon = await loadSvgIcon(this._iconPath);\n        }\n    }\n\n    async getContent() {\n        if (!this._buttonPlugins) {\n            this._buttonPlugins = [];\n            await loadPluginsOfType(this.player,\"button\",async (plugin) => {\n                this.player.log.debug(`Load button plugins into \"${this.groupName}\" container`);\n                this._buttonPlugins.push(plugin);\n\n                plugin.setObserver(this);\n            }, async plugin => {\n                const containerName = plugin.parentContainer;\n                if (containerName === this.groupName) {\n                    return await plugin.isEnabled();\n                }\n                else {\n                    return false;\n                }\n            });\n        }\n        return await super.getContent();\n    }\n\n    onIconChanged(plugin,prevIcon,newIcon) {\n        // TODO: Change icon in menu button, if menu is open\n    }\n\n    onTitleChanged(plugin,prevTitle,newTitle) {\n        // TODO: Change text in menu button, if menu is open\n    }\n\n    onStateChanged(plugin,prevText,newText,prevIcon,newIcon) {\n        // TODO: Change text and icon in menu button, if menu is open\n    }\n\n    get groupName() {\n        return this.config?.groupName || \"buttonGroup\";\n    }\n\n    get popUpType() {\n        return \"no-modal\";\n    }\n\n    getClosePopUps() {\n        return false;\n    }\n\n    buttonType() {\n        return \"button\";\n    }\n\n    async getMenu() {\n        return this._buttonPlugins.map(plugin => {\n            return {\n                id: plugin.name,\n                title: plugin.title || plugin.description,\n                icon: plugin.icon,\n                plugin\n            }\n        });\n    }\n\n    itemSelected(itemData, menuItems) {\n        const plugin = this._buttonPlugins.find(plugin => plugin.name === itemData.id);\n        if (plugin) {\n            const event = new Event(\"menuitemselected\");\n            plugin.action(event, this.currentContent);\n        }\n    }\n\n    async showPopUp() {\n\t\tawait super.showPopUp();\n\n        setTimeout(() => {\n            if (this._firstItem) {\n                this._firstItem.focus();\n            }\n        }, 50);\n\n        this.buttons?.forEach(btn => {\n            if (btn.style.display === 'none') {\n                this.hideButtonContainer(btn);\n            }\n            else {\n                this.showButtonContainer(btn);\n            }\n        });\n\t}\n\n    get buttons() {\n        return this._content && Array.from(this._content.getElementsByClassName('button-plugin'));\n    }\n\n    hideButtonContainer(btn) {\n        const container = btn.parentNode?.parentNode;\n        if (container) {\n            container.style.display = \"none\";\n        }\n    }\n\n    showButtonContainer(btn) {\n        const container = btn.parentNode?.parentNode;\n        if (container) {\n            container.style.display = null;\n        }\n    }\n}\n","import paellaPlugins from '../paella_plugins';\nimport { loadSvgIcon, joinPath } from './utils';\nimport ButtonGroupPlugin from './ButtonGroupPlugin';\nimport { mergeObjects } from './utils';\n\nexport const createPluginInstance = (PluginClass, player, name, staticConfig = {}) => {\n    const instance = new PluginClass(player, name);\n    // The name defined by the instance has a higher priority than the name obtained through the file name\n    name = instance.name || name;\n    if (!name) {\n        player.log.warn(`The instance of the ${PluginClass.name} plugin cannot be created because it is being loaded explicitly and does not have the name property implemented.`)\n        return null;\n    }\n    else {\n        if (player.config.plugins && player.config.plugins[name]) {\n            mergeObjects(staticConfig, player.config.plugins[name], false);\n        }\n        instance._config = staticConfig;\n        return instance;\n    }\n}\n\nfunction importPlugin(player, pluginClass, pluginInstance, PluginClass, overwrite = false) {\n    const type = pluginInstance.type;\n    let currentInstance = -1;\n    if (player.__pluginData__.pluginInstances[type] &&\n        player.__pluginData__.pluginInstances[type].find((registeredPlugin,i) => {\n            if (registeredPlugin.name === pluginInstance.name) {\n                currentInstance = i;\n                return true;\n            }\n        }) &&\n        !overwrite)\n    {\n        player.log.info(`Plugin ${pluginInstance.name} of type ${type} already registered.`);\n        return;        \n    }\n    player.__pluginData__.pluginClasses[pluginClass] = PluginClass;\n    player.__pluginData__.pluginInstances[type] = player.__pluginData__.pluginInstances[type] || [];\n    if (currentInstance !== -1) {\n        player.__pluginData__.pluginInstances[type].splice(currentInstance, 1);    \n    }\n    player.__pluginData__.pluginInstances[type].push(pluginInstance);\n\n    player.__pluginModules = player.__pluginModules || [];\n    const pluginModule = pluginInstance.getPluginModuleInstance();\n    if (pluginModule) {\n        pluginModule._player = pluginModule._player || player;\n        if (!player.__pluginModules.find(module => {\n            return module.constructor.name === pluginModule.constructor.name\n        })) {\n            const name = pluginModule.moduleName;\n            const version = pluginModule.moduleVersion;\n            player.log.debug(`Plugin module imported: ${ name }: v${ version }`);\n            player.__pluginModules.push(pluginModule);\n        }\n    }\n}\n\nexport function importSinglePlugin(player,pluginData) {\n    let PluginClass = null;\n    let config = { enabled: true };\n    if (typeof(pluginData) === \"function\") {\n        PluginClass = pluginData;\n    }\n    else if (typeof(pluginData) === \"object\"\n        && typeof(pluginData.plugin) === \"function\")\n    {\n        PluginClass = pluginData.plugin;\n        config = pluginData.config;\n    }\n\n    if (!PluginClass) {\n        player.log.warn(\"Error importing plugin with explicit import API. Check the 'plugins' array at init params\");\n    }\n    else {\n        const pluginInstance = createPluginInstance(PluginClass, player, null, config);\n        if (!pluginInstance) {\n            player.log.warn(`Unable to create an instance of the plugin ${PluginClass.name}`);\n        }\n        else {\n            const className = pluginInstance.constructor.name;\n            importPlugin(player, className, pluginInstance, PluginClass, true);\n        }\n    }\n}\n\nexport function importPlugins(player,context) {\n    const config = player.config;\n    context.keys().forEach(key => {\n        const module = context(key);\n        const pluginName = key.substring(2,key.length - 3);\n        if (config.plugins[pluginName]) {\n            const PluginClass = module.default;\n            const pluginInstance = createPluginInstance(PluginClass, player, pluginName, {});\n            importPlugin(player, key, pluginInstance, PluginClass, false);\n        }\n        // Check if it is a plugin module\n        else if (/^[a-z0-9]+$/i.test(pluginName)) {\n            player.__pluginModules = player.__pluginModules || [];\n            const ModuleClass = module.default;\n            const moduleInstance = new ModuleClass(player);\n            if (!player.__pluginModules.find(module => {\n                return module.constructor.name === moduleInstance.constructor.name;\n            })) {\n                const name = moduleInstance.moduleName;\n                const version = moduleInstance.moduleVersion;\n                player.log.debug(`Plugin module imported: ${ name }: v${ version }`);\n                player.__pluginModules.push(moduleInstance);\n            }\n        }\n    });\n}\n\nexport function registerPlugins(player) {\n    const config = player.config;\n    player.__pluginData__ = player.__pluginData__ || {\n        pluginClasses: [],\n        pluginInstances: {}\n    };\n\n    // If the s_pluginClasses array is not empty, the plugins have already been registered\n    if (player.__pluginData__.pluginClasses.length !== 0) return;\n\n    // Single plugin import. The single plugin import API has higher priority than \n    // the pluginContext API. Plugins that have been loaded with this API will not be loaded\n    // with the pluginContext API.\n    [\n        ...paellaPlugins,\n        ...player.initParams.plugins\n    ].forEach(pluginData => {\n            importSinglePlugin(player, pluginData);\n        });\n\n    // Button Groups\n    const { buttonGroups } = config;\n    if (buttonGroups) {\n        buttonGroups.forEach((btnData,i) => {\n            // Create a instance of ButtonPlugin\n            const name = `button_group_${i}`;\n            const instance = createPluginInstance(ButtonGroupPlugin, player, name, btnData);\n            instance._iconPath = joinPath([player.configResourcesUrl, btnData.icon]);\n            importPlugin(player, instance.type, instance, `ButtonGroupPlugin${i}`, false);\n        }) \n    }\n\n    player.log.debug(\"Plugins have been registered:\")\n}\n\nexport function unregisterPlugins(player) {\n    delete player.__pluginData__;\n}\n\nexport function getPluginsOfType(player,type) {\n    return player.__pluginData__?.pluginInstances[type] || [];\n}\n\nexport async function loadPluginsOfType(player,type,onLoad=null,onPreload=null) {\n    if (!player.__pluginData__.pluginInstances[type]) {\n        player.log.info(`There are no defined plugins of type '${type}'`);\n        return;\n    }\n    \n    // Sort plugins\n    player.__pluginData__.pluginInstances[type].sort((a,b) => a.order - b.order);\n    player.__pluginData__.pluginInstances[type].forEach(p => player.log.debug(`type: ${type}, name: ${p.name}`));\n\n    if (typeof(onPreload) !== \"function\") {\n        onPreload = async function(plugin) {\n            return await plugin.isEnabled();\n        }\n    }\n\n    for (const i in player.__pluginData__.pluginInstances[type]) {\n        const plugin = player.__pluginData__.pluginInstances[type][i];\n        const enabled = await onPreload(plugin);\n        if (enabled) {\n            if (plugin.__uiPlugin) {\n                const dictionaries = await plugin.getDictionaries();\n                if (typeof(dictionaries) === \"object\") {\n                    for (const lang in dictionaries) {\n                        const dict = dictionaries[lang];\n                        player.addDictionary(lang,dict);\n                    }\n                }\n            }\n            \n            if (typeof(onLoad) === \"function\") {\n                await onLoad(plugin);\n            }\n            await plugin.load();\n        }\n    }\n}\n\nexport async function unloadPluginsOfType(player,type) {\n    player.__pluginData__.pluginInstances[type]?.forEach(async plugin => {\n        await plugin.unload();\n    })\n}\n","import PlayerResource from './PlayerResource';\nimport { getVideoPlugin } from './VideoPlugin';\nimport { loadCanvasPlugins, getCanvasPlugin, unloadCanvasPlugins } from './CanvasPlugin';\nimport Events, { triggerIfReady } from './Events';\n\n\nexport function checkManifestIntegrity(manifest) {\n\tconst check = (field, error) => {\n\t\tif (!field) {\n\t\t\tthrow new Error(`Invalid video manifest: ${error}`);\n\t\t}\n\t}\n\n\tcheck(manifest.streams, \"missing 'streams' object.\");\n\tcheck(manifest.streams.length>0, \"the 'streams' array is empty.\");\n\tcheck(manifest.metadata?.preview, \"the 'metadata.preview' field is required.\");\n}\n\nexport default class SteramProvider extends PlayerResource {\n\tconstructor(player, videoContainer) {\n\t\tsuper(player, videoContainer);\n\t\tthis._videoContainer = videoContainer;\n\t\tthis._streamData = null;\n\t\tthis._streams = null;\n\t\tthis._players = [];\n\t\t\n\t\tthis._mainAudioPlayer = null;\n\t\t\n\t\tthis._streamSyncTimer = null;\n\t\t\n\t\tthis._trimming = {\n\t\t\tenabled: false,\n\t\t\tstart: 100,\n\t\t\tend: 200\n\t\t}\n\t}\n\t\n\tasync load(streamData) {\n\t\tthis._streamData = streamData;\n\t\tthis._streams = {};\n\t\t\n\t\tlet mainAudioContent = this.player.config.defaultAudioStream || \"presenter\";\n\t\tif (this._streamData.length === 1) {\n\t\t\tmainAudioContent = this._streamData[0].content;\n\t\t}\n\t\tstreamData.some(s => {\n\t\t\tif (s.role === \"mainAudio\") {\n\t\t\t\tmainAudioContent = s.content;\n\t\t\t\treturn true;\n\t\t\t}\n\t\t});\n\t\n\t\t\n\t\tthis.player.log.debug(\"Finding compatible video plugins\");\n\n\t\tawait loadCanvasPlugins(this.player);\n\t\t\n\t\t// Find video plugins for each stream\n\t\tfor (const stream of this._streamData) {\n\t\t\tconst canvasPlugin = getCanvasPlugin(this.player, stream);\n\t\t\tif (!canvasPlugin) {\n\t\t\t\tthrow Error(`Canvas plugin not found: ${ stream.canvas }`);\n\t\t\t}\n\n\t\t\tconst isMainAudio = stream.content === mainAudioContent;\n\t\t\tconst videoPlugin = await getVideoPlugin(this.player, stream);\n\t\t\tif (!videoPlugin) {\n\t\t\t\tthrow Error(`Incompatible stream type: ${ stream.content }`);\n\t\t\t}\n\t\t\t\n\t\t\tthis._streams[stream.content] = {\n\t\t\t\tstream,\n\t\t\t\tisMainAudio,\n\t\t\t\tvideoPlugin,\n\t\t\t\tcanvasPlugin\n\t\t\t}\n\t\t}\n\t\t\n\t\tfor (const content in this._streams) {\n\t\t\tconst s = this._streams[content];\n\t\t\ts.canvas = await s.canvasPlugin.getCanvasInstance(this._videoContainer);\n\t\t\ts.player = await s.videoPlugin.getVideoInstance(s.canvas.element, s.isMainAudio);\n\t\t\tif (mainAudioContent===content) {\n\t\t\t\tthis._mainAudioPlayer = s.player;\n\t\t\t\ts.player.initVolume(1);\n\t\t\t}\n\t\t\telse {\n\t\t\t\ts.player.initVolume(0);\n\t\t\t}\n\t\t\t\n\t\t\tawait s.player.load(s.stream, this);\n\t\t\tawait s.canvas.loadCanvas(s.player);\t\t\n\t\t\ts.player.onVideoEnded(() => {\n\t\t\t\t// Pause all streams, to prevent other vídeos from playing, when not all the\n\t\t\t\t// streams have the same duration.\n\t\t\t\tthis.executeAction(\"pause\");\n\t\t\t\t\n\t\t\t\t// Set current time to 0 to put the video in the initial state\n\t\t\t\tthis.executeAction(\"setCurrentTime\", 0);\n\n\t\t\t\t// Trigger the ended event\n\t\t\t\ttriggerIfReady(this.player, Events.ENDED);\n\t\t\t})\n\t\t\tthis._players.push(s.player);\n\t\t}\n\n\t\tif (this.mainAudioPlayer === null) {\n\t\t\tthis.player.log.error(\"The video stream containing the audio track could not be identified. The `role` attribute must be specified in the main video stream, or the `defaultAudioStream` attribute must be set correctly in the player configuration.\");\n\t\t\tthrow new Error(\"The video stream containing the audio track could not be identified.\");\n\t\t}\n\t}\n\n\tasync unload() {\n\t\tthis.stopStreamSync();\n\t\tawait unloadCanvasPlugins(this.player);\n\t}\n\t\n\tget players() {\n\t\treturn this._players;\n\t}\n\t\n\t// This is the raw streamData loaded from the video manifest\n\tget streamData() {\n\t\treturn this._streamData;\n\t}\n\t\n\t// This property stores the available streams, indexed by the content identifier, and contains the\n\t// stream data, the video plugin and the player, for each content identifier.\n\tget streams() {\n\t\treturn this._streams;\n\t}\n\t\n\tget mainAudioPlayer() {\n\t\treturn this._mainAudioPlayer;\n\t}\n\t\n\tget isTrimEnabled() {\n\t\treturn this._trimming?.enabled &&\n\t\t\tthis._trimming?.end > this._trimming?.start;\n\t}\n\t\n\tget trimStart() {\n\t\treturn this._trimming?.start;\n\t}\n\t\n\tget trimEnd() {\n\t\treturn this._trimming?.end;\n\t}\n\t\n\tasync setTrimming({ enabled, start, end }) {\n\t\tif (start>=end) {\n\t\t\tthrow Error(`Error setting trimming: start time (${ start }) must be lower than end time ${ end }`);\n\t\t}\n\t\tthis._trimming = {\n\t\t\tenabled,\n\t\t\tstart,\n\t\t\tend\n\t\t};\n\t\tconst currentTime = await this.currentTime()\n\t\ttriggerIfReady(this.player, Events.TIMEUPDATE, { currentTime: enabled ? start + currentTime : currentTime });\n\t}\n\t\n\tstartStreamSync() {\n\t\tthis._timeSync = true;\n\t\tconst setupSyncTimer = async () => {\n\t\t\tif (!this._players.length) {\n\t\t\t\tthis.player.log.warn(\"Player not yet loaded. Waiting for video sync.\");\n\t\t\t\treturn;\n\t\t\t}\n\t\t\t\n\t\t\tlet currentTime = this.mainAudioPlayer.currentTimeSync;\n\t\t\tconst maxSync = 0.2;\n\n\t\t\tif (this.players.length>1) {\n\t\t\t\tfor (let i = 0; i<this.players.length; ++i) {\n\t\t\t\t\tconst secPlayer = this.players[i];\n\t\t\t\t\tif (secPlayer !== this.mainAudioPlayer) {\n\t\t\t\t\t\tconst playerTime = secPlayer.currentTimeSync;\n\t\t\t\t\t\tif (Math.abs(currentTime - playerTime) > maxSync) {\n\t\t\t\t\t\t\tthis.player.log.debug(\"Video synchronization triggered\");\n\t\t\t\t\t\t\tsecPlayer.setCurrentTime(currentTime);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\t\n\t\t\t// Check trimming\n\t\t\tif (this.isTrimEnabled) {\n\t\t\t\tlet trimmedCurrentTime = currentTime - this.trimStart;\n\t\t\t\tif (this.trimEnd<=currentTime) {\n\t\t\t\t\tawait this.executeAction(\"pause\");\n\t\t\t\t\tawait this.setCurrentTime(0);\n\t\t\t\t\tthis.stopStreamSync();\n\t\t\t\t\tcurrentTime = 0;\n\t\t\t\t\ttriggerIfReady(this.player, Events.ENDED, {});\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\telse if (currentTime<this.trimStart) {\n\t\t\t\t\tawait this.setCurrentTime(0);\n\t\t\t\t\tcurrentTime = this.trimStart;\n\t\t\t\t\ttrimmedCurrentTime = 0;\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\ttriggerIfReady(this.player, Events.TIMEUPDATE, { currentTime: trimmedCurrentTime });\n\t\t\t\tthis._timeupdateTimer = setTimeout(() => {\n\t\t\t\t\tif (this._timeSync) {\n\t\t\t\t\t\tsetupSyncTimer();\n\t\t\t\t\t}\n\t\t\t\t}, 250);\n\t\t\t}\n\t\t\telse if (this._timeSync) {\n\t\t\t\ttriggerIfReady(this.player, Events.TIMEUPDATE, { currentTime });\n\t\t\t\tthis._timeupdateTimer = setTimeout(() => {\n\t\t\t\t\tsetupSyncTimer();\t\n\t\t\t\t}, 250);\n\t\t\t}\n\t\t}\n\t\tsetupSyncTimer();\n\t}\n\t\n\tstopStreamSync() {\n\t\tthis._timeSync = false;\n\t\tif (this._timeupdateTimer) {\n\t\t\tclearTimeout(this._timeupdateTimer);\n\t\t}\n\t}\n\t\n\texecuteAction(fnName, params = []) {\n\t\t// Important: this implementation must be done using promises instead of async/await, due to\n\t\t// a bug in babel that causes that the resulting array may not be available when the async function\n\t\t// is completed.\n\t\tif (!Array.isArray(params)) {\n\t\t\tparams = [params];\n\t\t}\n\t\treturn new Promise((resolve) => {\n\t\t\tlet res = [];\n\t\t\tlet p = [];\n\t\t\tthis.players.forEach(player => {\n\t\t\t\tp.push(new Promise(innerResolve => {\n\t\t\t\t\tplayer[fnName](...params).then(r => {\n\t\t\t\t\t\tres.push(r);\n\t\t\t\t\t\tinnerResolve();\n\t\t\t\t\t})\n\t\t\t\t}));\n\t\t\t})\n\t\t\t\n\t\t\tPromise.allSettled(p).then(() => resolve(res));\n\t\t})\n\t}\n\n\tget isLiveStream() {\n\t\treturn this._streamData.some(sd => Array.from(Object.keys(sd.sources)).indexOf(\"hlsLive\") !== -1);\n\t}\n\t\n\tasync play() {\n\t\tthis.startStreamSync();\n\t\tconst result = await this.executeAction(\"play\");\n\t\treturn result;\n\t}\n\n\tasync pause() {\n\t\tthis.stopStreamSync();\n\t\tconst result = await this.executeAction(\"pause\");\n\t\treturn result;\n\t}\n\t\n\tasync stop() {\n\t\tthis.stopStreamSync()\n\t\tawait this.executeAction(\"pause\");\n\t\tawait this.executeAction(\"setCurrentTime\", 0);\n\t}\n\t\n\tasync paused() {\n\t\treturn (await this.executeAction(\"paused\"))[0];\n\t}\n\n\tasync setCurrentTime(t) {\n\t\tconst duration = await this.duration();\n        if (t < 0) {\n            t = 0;\n        }\n        else if (t > duration) {\n            t = duration;\n        }\n\n\t\tconst prevTime = (await this.executeAction(\"currentTime\"))[0];\n\t\tlet returnValue = null;\n\n\t\tif (this.isTrimEnabled) {\n\t\t\tt = t + this.trimStart;\n\t\t\tt = t >= this.trimEnd ? this.trimEnd : t;\n\t\t\tconst result = (await this.executeAction(\"setCurrentTime\", [t]))[0];\n\t\t\tconst newTime = (await this.executeAction(\"currentTime\"))[0];\n\t\t\treturnValue = {\n\t\t\t\tresult,\n\t\t\t\tprevTime: prevTime - this.trimStart,\n\t\t\t\tnewTime: newTime - this.trimStart\n\t\t\t}\n\t\t}\n\t\telse {\n\t\t\tconst result = (await this.executeAction(\"setCurrentTime\", [t]))[0];\n\t\t\tconst newTime = (await this.executeAction(\"currentTime\"))[0];\n\t\t\treturnValue = { result, prevTime, newTime };\n\t\t}\n\t\t\n\t\tconst currentTime = await this.currentTime();\n\t\ttriggerIfReady(this.player, Events.TIMEUPDATE, { currentTime: currentTime });\n\n\t\treturn returnValue;\n\t}\n\t\n\tasync currentTime() {\n\t\tconst currentTime = await this.mainAudioPlayer.currentTime();\n\t\tif (this.isTrimEnabled) {\n\t\t\treturn currentTime - this.trimStart;\n\t\t}\n\t\telse {\n\t\t\treturn currentTime;\n\t\t}\n\t}\n\t\n\tasync currentTimeIgnoringTrimming() {\n\t\tconst currentTime = await this.mainAudioPlayer.currentTime();\n\t\treturn currentTime;\n\t}\n\t\n\tasync volume() {\n\t\tif (this.mainAudioPlayer) {\n\t\t\treturn await this.mainAudioPlayer.volume();\n\t\t}\n\t\telse {\t\t\n\t\t\treturn (await this.executeAction(\"volume\"))[0];\n\t\t}\n\t}\n\t\n\tasync setVolume(v) {\n\t\tif (this.mainAudioPlayer) {\n\t\t\treturn await this.mainAudioPlayer.setVolume(v);\n\t\t}\n\t\telse {\n\t\t\treturn (await this.executeAction(\"setVolume\",[v]))[0];\n\t\t}\n\t}\n\t\n\tasync duration() {\n\t\tif (this.isTrimEnabled) {\n\t\t\treturn this.trimEnd - this.trimStart;\t\n\t\t}\n\t\telse {\n\t\t\treturn await this.durationIgnoringTrimming();\n\t\t}\n\t}\n\t\n\tasync durationIgnoringTrimming() {\n\t\tconst result = (await this.executeAction(\"duration\")).reduce((acc, val) => Math.min(acc, val), Number.MAX_VALUE);\n\t\treturn result;\n\t}\n\n\tasync playbackRate() {\n\t\treturn (await this.executeAction(\"playbackRate\"))[0];\n\t}\n\n\tasync setPlaybackRate(rate) {\n\t\treturn (await this.executeAction(\"setPlaybackRate\",[rate]))[0];\n\t}\n\n\tasync getQualityReferencePlayer() {\n\t\tlet player = null;\n\t\tlet referenceQualities = [];\n\t\tif (Object.keys(this.streams).length>0) {\n\t\t\tfor (const content in this.streams) {\n\t\t\t\tconst stream = this.streams[content];\n\t\t\t\tconst q = (await stream.player.getQualities()) || [];\n\t\t\t\tif (!player && q.length > referenceQualities.length) {\n\t\t\t\t\treferenceQualities = q;\n\t\t\t\t\tplayer = stream.player;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\treturn player || this.mainAudioPlayer;\n\t}\n\n\tasync getCurrentQuality() {\n\t\treturn (await this.getQualityReferencePlayer()).currentQuality;\n\t}\n\n\tasync getQualities() {\n\t\tconst player = await this.getQualityReferencePlayer();\n\t\treturn await player.getQualities();\n\t}\n\n\tasync setQuality(quality) {\n\t\tconst player = await this.getQualityReferencePlayer();\n\n\t\tconst qualities = await player.getQualities();\n\t\tconst total = qualities.length;\n\t\tlet index = -1;\n\t\tqualities.some((q,i) => {\n\t\t\tif (quality.index === q.index) {\n\t\t\t\tindex = i;\n\t\t\t}\n\t\t\treturn index !== -1;\n\t\t});\n\n\t\tif (index>=0) {\n\t\t\tconst qualityFactor = index / total;\n\t\t\tfor (const content in this.streams) {\n\t\t\t\tconst stream = this.streams[content];\n\t\t\t\tconst streamQualities = (await stream.player.getQualities()) || [];\n\t\t\t\tthis.player.log.debug(streamQualities);\n\t\t\t\tif (streamQualities.length>1) {\n\t\t\t\t\tconst qualityIndex = Math.round(streamQualities.length * qualityFactor);\n\t\t\t\t\tconst selectedQuality = streamQualities[qualityIndex];\n\t\t\t\t\tawait stream.player.setQuality(selectedQuality);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tasync supportsMultiaudio() {\n\t\treturn this.mainAudioPlayer.supportsMultiaudio();\n\t}\n\n\tasync getAudioTracks() {\n\t\treturn this.mainAudioPlayer.getAudioTracks();\n\t}\n\n\tasync setCurrentAudioTrack(track) {\n\t\treturn this.mainAudioPlayer.setCurrentAudioTrack(track);\n\t}\n\n\tget currentAudioTrack() {\n\t\treturn this.mainAudioPlayer.currentAudioTrack;\n\t}\n}","import { DomClass, createElementWithHtmlText } from \"./dom\";\n\nexport const VideoContainerMessagePosition = Object.freeze({\n    TOP_LEFT: \"topLeft\",\n    TOP_MIDDLE: \"topMiddle\",\n    TOP_RIGHT: \"topRight\",\n    CENTER_LEFT: \"centerLeft\",\n    CENTER_MIDDLE: \"centerMiddle\",\n    CENTER_RIGHT: \"centerRight\",\n    BOTTOM_LEFT: \"bottomLeft\",\n    BOTTOM_MIDDLE: \"bottomMiddle\",\n    BOTTOM_RIGHT: \"bottomRight\"\n});\n\nconst createMessageContainer = (icon, text, timeout, cssClass, parent) => {\n    cssClass = cssClass || \"\";\n    timeout = timeout || 1000;\n    const result = createElementWithHtmlText(`\n        <div class=\"message-content ${ cssClass }\">\n            ${ icon ? `<i class=\"icon\">${ icon }</i>` : \"\" }\n            ${ text ? `<p class=\"text\">${ text }</p>` : \"\" }\n        </div>\n    `);\n\n    parent.innerHTML = \"\";\n    parent.appendChild(result);\n    if (parent.timer) {\n        clearTimeout(parent.timer);\n        parent.timer = null;\n    }\n    parent.timer = setTimeout(() => {\n        parent.removeChild(result);\n    }, timeout);\n    return result;\n}\n\nexport default class VideoContainerMessage extends DomClass {\n    constructor(player, parent) {\n        const attributes = { \"class\": \"video-container-message\" };\n        super(player, { attributes, parent });\n            \n        this._topLeftContainer = createElementWithHtmlText(`<div class=\"container top-left\"></div>`, this.element);\n        this._topMiddleContainer = createElementWithHtmlText(`<div class=\"container top-middle\"></div>`, this.element);\n        this._topRightContainer = createElementWithHtmlText(`<div class=\"container top-right\"></div>`, this.element);\n        this._centerLeftContainer = createElementWithHtmlText(`<div class=\"container center-left\"></div>`, this.element);\n        this._centerMiddleContainer = createElementWithHtmlText(`<div class=\"container center-middle\"></div>`, this.element);\n        this._centerRightContainer = createElementWithHtmlText(`<div class=\"container center-right\"></div>`, this.element);\n        this._bottomLeftContainer = createElementWithHtmlText(`<div class=\"container bottom-left\"></div>`, this.element);\n        this._bottomMiddleContainer = createElementWithHtmlText(`<div class=\"container bottom-middle\"></div>`, this.element);\n        this._bottomRightContainer = createElementWithHtmlText(`<div class=\"container bottom-right\"></div>`, this.element);\n    }\n\n    show({ icon = null, text = \"\", timeout = 1000, position = VideoContainerMessagePosition.CENTER_MIDDLE, cssClass = \"\" }) {\n        switch (position) {\n        case VideoContainerMessagePosition.TOP_LEFT:\n            createMessageContainer.apply(this, [icon, text, timeout, cssClass, this._topLeftContainer]);\n            break;\n        case VideoContainerMessagePosition.TOP_MIDDLE:\n            createMessageContainer.apply(this, [icon, text, timeout, cssClass, this._topMiddleContainer]);\n            break;\n        case VideoContainerMessagePosition.TOP_RIGHT:\n            createMessageContainer.apply(this, [icon, text, timeout, cssClass, this._topRightContainer]);\n            break;\n        case VideoContainerMessagePosition.CENTER_LEFT:\n            createMessageContainer.apply(this, [icon, text, timeout, cssClass, this._centerLeftContainer]);\n            break;\n        case VideoContainerMessagePosition.CENTER_MIDDLE:\n            createMessageContainer.apply(this, [icon, text, timeout, cssClass, this._centerMiddleContainer]);\n            break;\n        case VideoContainerMessagePosition.CENTER_RIGHT:\n            createMessageContainer.apply(this, [icon, text, timeout, cssClass, this._centerRightContainer]);\n            break;\n        case VideoContainerMessagePosition.BOTTOM_LEFT:\n            createMessageContainer.apply(this, [icon, text, timeout, cssClass, this._bottomLeftContainer]);\n            break;\n        case VideoContainerMessagePosition.BOTTOM_MIDDLE:\n            createMessageContainer.apply(this, [icon, text, timeout, cssClass, this._bottomMiddleContainer]);\n            break;\n        case VideoContainerMessagePosition.BOTTOM_RIGHT:\n            createMessageContainer.apply(this, [icon, text, timeout, cssClass, this._bottomRightContainer]);\n            break;\n        }        \n    }\n}\n","\nconst PlayerState = Object.freeze({\n    UNLOADED: 0,\n    LOADING_MANIFEST: 1,\n    MANIFEST: 2,\n    LOADING_PLAYER: 3,\n    LOADED: 4,\n    UNLOADING_MANIFEST: 5,\n    UNLOADING_PLAYER: 6,\n    ERROR: 7\n});\n\nexport default PlayerState;\n\n","\nimport { DomClass, createElementWithHtmlText,createElement } from './dom';\nimport { \n    getValidLayouts, \n    getValidContentIds, \n    getLayoutStructure, \n    getLayoutWithContentId,\n    getValidContentSettings } from './VideoLayout';\nimport StreamProvider from './StreamProvider';\nimport Events, { triggerEvent } from './Events';\nimport { addButtonPlugin } from './ButtonPlugin';\nimport { translate } from './Localization';\n\nimport { loadPluginsOfType, unloadPluginsOfType } from './plugin_tools'\nimport { loadVideoPlugins, unloadVideoPlugins, getVideoPluginWithFileUrl } from './VideoPlugin';\nimport { addVideoCanvasButton, CanvasButtonPosition, setTabIndex } from './CanvasPlugin';\nimport VideoContainerMessage from './VideoContainerMessage';\nimport PlayerState from './PlayerState';\n\nexport function getSourceWithUrl(player,url) {\n    if (!Array.isArray[url]) {\n        url = [url];\n    }\n    const plugin = getVideoPluginWithFileUrl(player, url);\n    return plugin.getManifestData(url);\n}\n\nexport async function getContainerBaseSize(player) {\n    // TODO: In the future, this function can be modified to support different\n    // aspect ratios, which can be loaded from the video manifest.\n    return { w: 1280, h: 720 }\n}\n\nasync function enableVideos(layoutStructure) {\n    for (const content in this.streamProvider.streams) {\n        const isPresent = layoutStructure?.videos?.find(video => video.content === content) != null;\n        const video = this.streamProvider.streams[content];\n        \n        if (isPresent && !video.player.isEnabled) {\n            await video.player.enable();\n        }\n        else if (!isPresent && video.player.isEnabled) {\n            await video.player.disable();\n        }\n    }\n}\n\nfunction hideAllVideoPlayers() {\n    // Hide all video players\n    \n    for (const key in this.streamProvider.streams) {\n        const videoData = this.streamProvider.streams[key];\n        videoData.canvas.element.style.display = \"none\";\n        this._hiddenVideos.appendChild(videoData.canvas.element);\n    }\n}\n\nasync function updateLayoutStatic() {\n    const layoutStructure = getLayoutStructure(this.player, this.streamProvider.streamData, this._layoutId, this._mainLayoutContent);\n\n    await enableVideos.apply(this, [ layoutStructure ]);\n\n    hideAllVideoPlayers.apply(this);\n\n    // Conversion factors for video rect\n    const baseSize = await getContainerBaseSize(this.player);\n    const wFactor = 100 / baseSize.w;\n    const hFactor = 100 / baseSize.h;\n    this.baseVideoRect.classList.remove(\"dynamic\");\n    this.baseVideoRect.classList.add(\"static\");\n\n\n    if (layoutStructure?.videos?.length) {\n        const buttonElements = [];\n        for (const video of layoutStructure.videos) {\n            const videoData = this.streamProvider.streams[video.content];\n            const { stream, player, canvas } = videoData;\n            const res = await player.getDimensions();\n            const videoAspectRatio = res.w / res.h;\n            let difference = Number.MAX_VALUE;\n            let resultRect = null;\n\n            canvas.buttonsArea.innerHTML = \"\";\n            buttonElements.push(await addVideoCanvasButton(this.player, layoutStructure, canvas, video, video.content));\n            \n            video.rect.forEach((videoRect) => {\n                const aspectRatioData = /^(\\d+.?\\d*)\\/(\\d+.?\\d*)$/.exec(videoRect.aspectRatio);\n                const rectAspectRatio = aspectRatioData ? Number(aspectRatioData[1]) / Number(aspectRatioData[2]) : 1;\n                const d = Math.abs(videoAspectRatio - rectAspectRatio);\n                if (d < difference) {\n                    resultRect = videoRect;\n                    difference = d;\n                }\n            });\n\n            canvas.element.style.display = \"block\";\n            canvas.element.style.position = \"absolute\";\n            canvas.element.style.left = `${ resultRect?.left * wFactor }%`;\n            canvas.element.style.top = `${ resultRect?.top * hFactor }%`;\n            canvas.element.style.width = `${ resultRect?.width * wFactor }%`;\n            canvas.element.style.height = `${ resultRect?.height * hFactor }%`;\n            canvas.element.style.zIndex = video.layer;\n\n            this.baseVideoRect.appendChild(canvas.element);\n        }\n\n        setTimeout(() => {\n            setTabIndex(this.player, layoutStructure, buttonElements.flat());\n        }, 100);\n    }\n    \n    const prevButtons = this.baseVideoRect.getElementsByClassName('video-layout-button');\n    Array.from(prevButtons).forEach(btn => this.baseVideoRect.removeChild(btn));\n    layoutStructure?.buttons?.forEach(buttonData => {\n        const button = createElement({\n            tag: 'button',\n            attributes: {\n                \"class\": \"video-layout-button\",\n                \"aria-label\": translate(buttonData.ariaLabel),\n                \"title\": translate(buttonData.title),\n                style: `\n                    left: ${buttonData.rect.left * wFactor}%;\n                    top: ${buttonData.rect.top * hFactor}%;\n                    width: ${buttonData.rect.width * wFactor}%;\n                    height: ${buttonData.rect.height * hFactor}%;\n                    z-index: ${ buttonData.layer };\n                `\n            },\n            parent: this.baseVideoRect,\n            children: buttonData.icon\n        });\n        button.layout = layoutStructure;\n        button.buttonAction = buttonData.onClick;\n        button.addEventListener(\"click\", async (evt) => {\n            triggerEvent(this.player, Events.BUTTON_PRESS, {\n                plugin: layoutStructure.plugin,\n                layoutStructure: layoutStructure\n            });\n            await evt.target.buttonAction.apply(evt.target.layout);\n            evt.stopPropagation();\n        });\n        this._layoutButtons.push(button);\n    });\n\n    return true;\n}\n\nasync function updateLayoutDynamic() {\n    const layoutStructure = getLayoutStructure(this.player, this.streamProvider.streamData, this._layoutId, this._mainLayoutContent);\n\n    await enableVideos.apply(this, [ layoutStructure ]);\n\n    hideAllVideoPlayers.apply(this);\n\n    this.baseVideoRect.classList.add(\"dynamic\");\n    this.baseVideoRect.classList.remove(\"static\");\n    this.baseVideoRect.innerHTML = \"\";\n\n\n    const videoContainerWidth = this.element.clientWidth;\n    const videoContainerHeight = this.element.clientHeight;\n    const isLandscape = videoContainerWidth > videoContainerHeight;\n    this.baseVideoRect.classList.remove(\"align-center\");\n    this.baseVideoRect.classList.remove(\"align-top\");\n    this.baseVideoRect.classList.remove(\"align-bottom\");\n    this.baseVideoRect.classList.remove(\"align-left\");\n    this.baseVideoRect.classList.remove(\"align-right\");\n\n    if (isLandscape) {\n        const videoCanvasAlign = this.player.config.videoContainer?.dynamicLayout?.landscapeVerticalAlignment || \"align-center\";\n        this.baseVideoRect.classList.remove(\"portrait\");\n        this.baseVideoRect.classList.add(\"landscape\");\n        this.baseVideoRect.classList.add(videoCanvasAlign);\n    }\n    else {\n        const videoCanvasAlign = this.player.config.videoContainer?.dynamicLayout?.portraitHorizontalAlignment || \"align-center\";\n        this.baseVideoRect.classList.add(\"portrait\");\n        this.baseVideoRect.classList.remove(\"landscape\");\n        this.baseVideoRect.classList.add(videoCanvasAlign);\n    }\n    const width = this.baseVideoRect.clientWidth;\n    const height = this.element.clientHeight;\n\n    if (layoutStructure?.videos?.length === 1) {\n        const canvasElements = [];\n        const buttonElements = [];\n        const video = layoutStructure.videos[0];\n        const videoData = this.streamProvider.streams[video.content];\n        const { player, canvas } = videoData;\n\n        canvas.buttonsArea.innerHTML = \"\";\n        buttonElements.push(await addVideoCanvasButton(this.player, layoutStructure, canvas, video, video.content));\n\n        canvas.element.style = {};\n        canvas.element.style.display = \"block\";\n        canvas.element.style.width = \"100%\";\n        canvas.element.style.height = \"100%\";\n        canvas.element.style.overflow = \"hidden\";\n        canvas.element.style.position = \"relative\";\n        canvasElements.push(canvas.element);\n        canvas.element.sortIndex = 0;\n        canvasElements.forEach(e => this.baseVideoRect.appendChild(e));\n        setTimeout(() => {\n            setTabIndex(this.player, layoutStructure, buttonElements.flat());\n        }, 100);\n    }\n    else if (layoutStructure?.videos?.length) {\n        let i = 0;\n        const canvasElements = [];\n        const buttonElements = [];\n        for (const video of layoutStructure.videos) {\n            const videoData = this.streamProvider.streams[video.content];\n            const { player, canvas } = videoData;\n            const res = await player.getDimensions();\n            const videoAspectRatio = res.w / res.h;\n            const maxWidth = width;\n            const maxHeight = height;\n            const baseSize = (isLandscape ? maxWidth : maxHeight) * video.size / 100;\n            let videoWidth = Math.round(isLandscape ? baseSize : baseSize * videoAspectRatio);\n            let videoHeight = Math.round(isLandscape ? baseSize / videoAspectRatio : baseSize);\n            if (videoWidth>maxWidth) {\n                videoWidth = maxWidth;\n                videoHeight = Math.round(videoWidth / videoAspectRatio);\n            }\n            if (videoHeight>maxHeight) {\n                videoHeight = maxHeight;\n                videoWidth = Math.round(videoHeight * videoAspectRatio);\n            }\n            \n\n            canvas.buttonsArea.innerHTML = \"\";\n            buttonElements.push(await addVideoCanvasButton(this.player, layoutStructure, canvas, video, video.content));\n\n            canvas.element.style = {};\n            canvas.element.style.display = \"block\";\n            canvas.element.style.width = `${videoWidth}px`;\n            canvas.element.style.height = `${videoHeight}px`;\n            canvas.element.style.overflow = \"hidden\";\n            canvas.element.style.position = \"relative\";\n            canvas.element.sortIndex = i++;\n            canvasElements.push(canvas.element);\n        }\n        if (isLandscape) {\n            const landscapeContainer = createElementWithHtmlText(`<div class=\"landscape-container\"></div>`, this.baseVideoRect);\n            canvasElements.forEach(e => landscapeContainer.appendChild(e));\n        }\n        else {\n            canvasElements.forEach(e => this.baseVideoRect.appendChild(e));\n        }\n        setTimeout(() => {\n            setTabIndex(this.player, layoutStructure, buttonElements.flat());\n        }, 100);\n    }\n\n    return true;\n}\n\nexport default class VideoContainer extends DomClass {\n\n    constructor(player, parent) {\n        const baseVideoRectClass = \"base-video-rect\";\n\n        const attributes = {\n            \"class\": \"video-container\"\n        };\n\n        if (player.config.videoContainer?.overPlaybackBar) {\n            attributes.class += \" over-playback-bar\"\n        }\n\n        const children = `\n            <div class=\"${ baseVideoRectClass }\"></div>\n            <div class=\"hidden-videos-container\" style=\"display: none\"></div>\n        `\n        super(player, {attributes, children, parent});\n\n        this._hiddenVideos = this.element.getElementsByClassName(\"hidden-videos-container\")[0];\n        this._baseVideoRect = this.element.getElementsByClassName(baseVideoRectClass)[0];\n        this.element.addEventListener(\"click\", async () => {\n            if (await this.paused()) {\n                await this.play();\n            }\n            else {\n                await this.pause();\n            }\n        });\n\n        this._ready = false;\n\n        this._players = [];\n        \n        this._streamProvider = new StreamProvider(this.player, this.baseVideoRect);\n    }\n\n    get layoutId() {\n        return this._layoutId;\n    }\n\n    get mainLayoutContent() {\n        return this._mainLayoutContent;\n    }\n    \n    async setLayout(layoutId,mainContent = null) {\n        if (this.validContentIds.indexOf(layoutId) === -1) {\n            return false;\n        }\n        else {\n            const global = this.player.config.videoContainer?.restoreVideoLayout?.global;\n            await this.player.preferences.set('videoLayout', layoutId, { global });\n            await this.player.preferences.set('videoLayoutMainContent', mainContent, { global });\n            const prevLayout = this._layoutId;\n            this._layoutId = layoutId;\n            this._mainLayoutContent = mainContent;\n            await this.updateLayout();\n            if (prevLayout !== layoutId) {\n                triggerEvent(this.player, Events.LAYOUT_CHANGED, { prevLayout, layoutId });\n            }\n        }\n    }\n    \n    get validContentIds() {\n        return this._validContentIds;\n    }\n    \n    get validContentSettings() {\n        return this._validContentSettings;\n    }\n\n    get validLayouts() {\n        return getValidLayouts(this.player, this.streamData);\n    }\n\n    get streamData() {\n        return this._streamData;\n    }\n\n    get baseVideoRect() {\n        return this._baseVideoRect;\n    }\n    \n    get streamProvider() {\n        return this._streamProvider;\n    }\n    \n    async create() {\n        this._baseVideoRect.style.display = \"none\";\n\n        await loadPluginsOfType(this.player, \"layout\");\n\n        await loadVideoPlugins(this.player);\n    }\n\n    async load(streamData) {\n        this._streamData = streamData;\n\n        if (this.player.config.videoContainer?.restoreVideoLayout?.enabled) {\n            const global = this.player.config.videoContainer?.restoreVideoLayout?.global;\n            this._layoutId = await this.player.preferences.get(\"videoLayout\", { global }) || this.player.config.defaultLayout;\n            this._mainLayoutContent = await this.player.preferences.get(\"videoLayoutMainContent\", { global }) || null;\n        }\n        else {\n            this._layoutId = this.player.config.defaultLayout;\n            this._mainLayoutContent = null;\n        }\n\n\n        await this.streamProvider.load(streamData);\n        \n        // Find the content identifiers that are compatible with the stream data\n        this._validContentIds = getValidContentIds(this.player, streamData);\n        \n        this._validContentSettings = getValidContentSettings(this.player, streamData);\n        \n        // Load video layout\n        await this.updateLayout(null, true);\n\n        const leftSideButtons = createElementWithHtmlText(\n            `<div class=\"button-plugins left-side\"></div>`, this.element\n        );\n        const rightSideButtons = createElementWithHtmlText(\n            `<div class=\"button-plugins right-side\"></div>`, this.element\n        );\n        this._buttonPlugins = [ leftSideButtons, rightSideButtons ];\n\n        // Load videoContainer plugins\n        this.player.log.debug(\"Loading videoContainer button plugins\");\n        await loadPluginsOfType(this.player,\"button\",async (plugin) => {\n            this.player.log.debug(` Button plugin: ${ plugin.name }`);\n            if (plugin.side === \"left\") {\n                await addButtonPlugin(plugin, leftSideButtons);\n            }\n            else if (plugin.side === \"right\") {\n                await addButtonPlugin(plugin, rightSideButtons);\n            }\n        }, async plugin => {\n            if (plugin.parentContainer === \"videoContainer\") {\n                return await plugin.isEnabled();\n            }\n            else {\n                return false;\n            }\n        });\n        \n        this._baseVideoRect.style.display = \"\";\n\n        // Restore volume and playback rate\n        const storedVolume = await this.player.preferences.get(\"volume\", { global: true });\n        const playbackRate = await this.player.preferences.get(\"playbackRate\", { global: true });\n        const lastKnownTime = await this.player.preferences.get(\"lastKnownTime\", { global: false });\n\n        if (this.player.config.videoContainer?.restoreVolume && storedVolume !== null && storedVolume !== undefined) {\n            await this.streamProvider.setVolume(storedVolume);\n        }\n        if (this.player.config.videoContainer?.restorePlaybackRate && playbackRate !== null && playbackRate !== undefined) {\n            await this.streamProvider.setPlaybackRate(playbackRate);\n        }\n        \n        if (this.player.videoManifest.trimming) {\n            await this.player.videoContainer.setTrimming(this.player.videoManifest.trimming);\n        }\n\n        if (this.player.config.videoContainer?.restoreLastTime?.enabled && !this.streamProvider.isLiveStream)\n        {\n            const saveCurrentTime = async () => {\n                const paused = await this.paused();\n                if (!paused) {\n                    const currentTime = await this.currentTime();\n                    await this.player.preferences.set(\"lastKnownTime\", currentTime, { global: false });\n                }\n                setTimeout(saveCurrentTime, 1000);\n            }\n\n            if (lastKnownTime) {\n                const time = await this.player.preferences.get('lastKnownTime', { global: false });\n                const duration = await this.duration();\n                const remainingSeconds = this.player.config.videoContainer?.restoreLastTime?.remainingSeconds;\n                if ((duration - time) > remainingSeconds) {\n                    await this.setCurrentTime(time);\n                }\n            }\n\n            saveCurrentTime();\n        }\n\n        this._messageContainer = new VideoContainerMessage(this.player, this.element);\n\n        this._ready = true;\n    }\n\n    async unload() {\n        this.removeFromParent();\n\n        // Button plugins are unloaded in PlaybackBar\n\n        await unloadPluginsOfType(this.player, \"layout\");\n\n        await unloadVideoPlugins(this.player);\n\n        await this.streamProvider.unload();\n    }\n\n    // Return true if the layout this.layoutId is compatible with the current stream data.\n    async updateLayout(mainContent = null) {\n        // The second argument in this function is for internal use only\n        const ignorePlayerState = arguments[1];\n\n        if (mainContent) {\n            this._mainLayoutContent = mainContent;\n        }\n        if (!ignorePlayerState && this.player.state !== PlayerState.LOADED) {\n            return;\n        }\n\n        if (this._updateInProgress) {\n            this.player.log.warn(\"Recursive update layout detected\");\n            return false;\n        }\n        this._updateInProgress = true;\n\n        let status = true;\n        \n        this._layoutButtons = [];\n        \n        // Current layout: if not selected, or the selected layout is not compatible, load de default layout\n        if (!this._layoutId || this._validContentIds.indexOf(this._layoutId) === -1) {\n            this._layoutId = this.player.config.defaultLayout;\n            this._mainLayoutContent = null;\n\n            // Check if the default layout is compatible\n            if (this._validContentIds.indexOf(this._layoutId) === -1) {\n                this._layoutId = this._validContentIds[0];\n            }\n            status = false;\n        }\n\n        const layoutPlugin = getLayoutWithContentId(this.player, this.streamProvider.streamData, this._layoutId);\n        if (layoutPlugin.layoutType === \"static\") {\n            status = updateLayoutStatic.apply(this);\n        }\n        else if (layoutPlugin.layoutType === \"dynamic\") {\n            status = updateLayoutDynamic.apply(this);\n        }\n\n        this._updateInProgress = false;\n        return status;\n    }\n    \n    hideUserInterface() {\n        if (this._layoutButtons && this._buttonPlugins) {\n            this.player.log.debug(\"Hide video container user interface\");\n            const hideFunc = button => {\n                button._prevDisplay = button.style.display;\n                button.style.display = \"none\";\n            }\n            this._layoutButtons.forEach(hideFunc);\n            this._buttonPlugins.forEach(hideFunc);\n            for (const content in this.streamProvider.streams) {\n                const stream = this.streamProvider.streams[content];\n                stream.canvas.hideButtons();\n            }\n        }\n    }\n    \n    showUserInterface() {\n        if (this._layoutButtons && this._buttonPlugins) {\n            const showFunc = button => button.style.display = button._prevDisplay || \"block\";\n            this._layoutButtons.forEach(showFunc);\n            this._buttonPlugins.forEach(showFunc);\n            for (const content in this.streamProvider.streams) {\n                const stream = this.streamProvider.streams[content];\n                stream.canvas.showButtons();\n            }\n        }\n    }\n\n    get message() {\n        return this._messageContainer;\n    }\n\n    get elementSize() {\n        return { w: this.element.offsetWidth, h: this.element.offsetHeight };\n    }\n\n    get ready() {\n        return this._ready;\n    }\n\n    get isLiveStream() {\n        return this.streamProvider.isLiveStream;\n    }\n\n    async play() {\n        const result = await this.streamProvider.play();\n        triggerEvent(this.player, Events.PLAY);\n        return result;\n    }\n\n    async pause() {\n        const result = await this.streamProvider.pause();\n        triggerEvent(this.player, Events.PAUSE);\n        return result;\n    }\n    \n    async stop() {\n        this.streamProvider.stop();\n        triggerEvent(this.player, Events.STOP);\n    }\n    \n    async paused() {\n        return this.streamProvider.paused();\n    }\n\n    async setCurrentTime(t) {\n        const result = await this.streamProvider.setCurrentTime(t);\n        triggerEvent(this.player, Events.SEEK, { prevTime: result.prevTime, newTime: result.newTime });\n        return result.result;\n    }\n    \n    async currentTime() {\n        return this.streamProvider.currentTime();\n    }\n    \n    async volume() {\n        return this.streamProvider.volume();\n    }\n    \n    async setVolume(v) {\n        const result = await this.streamProvider.setVolume(v);\n        triggerEvent(this.player, Events.VOLUME_CHANGED, { volume: v });\n        await this.player.preferences.set(\"volume\", v, { global: true });\n        return result;\n    }\n    \n    async duration() {\n        return await this.streamProvider.duration();\n    }\n\n    async playbackRate() {\n        return await this.streamProvider.playbackRate();\n    }\n\n    async setPlaybackRate(r) {\n        const result = await this.streamProvider.setPlaybackRate(r);\n        triggerEvent(this.player, Events.PLAYBACK_RATE_CHANGED, { newPlaybackRate: r });\n        await this.player.preferences.set(\"playbackRate\", r, { global: true });\n        return result;\n    }\n\n    get isTrimEnabled() {\n        return this.streamProvider.isTrimEnabled;\n    }\n\n    get trimStart() {\n        return this.streamProvider.trimStart;\n    }\n\n    get trimEnd() {\n        return this.streamProvider.trimEnd;\n    }\n\n    async setTrimming({ enabled, start, end }) {\n        const result = await this.streamProvider.setTrimming({\n            enabled,\n            start,\n            end\n        });\n        triggerEvent(this.player, Events.TRIMMING_CHANGED, { \n            enabled, \n            start, \n            end \n        });\n        return result;\n    }\n\n    getVideoRect(target = null) {\n        let element = this.baseVideoRect;\n        if (typeof(target) === \"string\") {\n            element = this.streamProvider.streams[target]?.canvas.element;\n\n            if (!element) {\n                this.player.log.warn(`videoContainer.getVideoRect: Invalid target '${target}'. Valid targets are: ${Object.keys(this.streamProvider.streams).join(\", \")}`);\n                this.player.log.warn(\"Please, configure a valid target in the 'targetContent' property of the configuration file, or provide a valid target in the 'frameList.targetContent' property of the video manifest\");\n                return null;\n            }\n        }\n        else if (target === 0) {\n            element = this.streamProvider.streams[Object.keys(this.streamProvider.streams)[0]]?.canvas.element;\n        }\n        \n        return {\n            x: element?.offsetLeft, \n            y: element?.offsetTop, \n            width: element?.offsetWidth, \n            height: element?.offsetHeight,            \n            element\n        };\n    }\n\n    appendChild(element, rect = null, zIndex = 1) {\n        if (rect) {\n            const { width, height } = this.getVideoRect();\n            rect.x = rect.x * 100 / width;\n            rect.width = rect.width * 100 / width;\n            rect.y = rect.y * 100 / height;\n            rect.height = rect.height * 100 / height;\n            element.style.position = \"absolute\";\n            element.style.left = `${ rect.x }%`;\n            element.style.top = `${ rect.y }%`;\n            element.style.width = `${ rect.width }%`;\n            element.style.height = `${ rect.height }%`;\n            if (zIndex!==null) element.style.zIndex = zIndex;\n        }\n        this.baseVideoRect.appendChild(element);\n        return element;\n    }\n\n    removeChild(element) {\n        this.baseVideoRect.removeChild(element);\n    }\n}\n\n","export default `<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"no\"?>\n<!DOCTYPE svg PUBLIC \"-//W3C//DTD SVG 1.1//EN\" \"http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd\">\n<svg width=\"100%\" height=\"100%\" viewBox=\"0 0 300 300\" version=\"1.1\" xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\" xml:space=\"preserve\" xmlns:serif=\"http://www.serif.com/\" style=\"fill-rule:evenodd;clip-rule:evenodd;stroke-linejoin:round;stroke-miterlimit:2;\">\n    <rect id=\"Play\" x=\"0\" y=\"0\" width=\"300\" height=\"300\" style=\"fill:none;\"/>\n    <g id=\"Play1\" serif:id=\"Play\">\n        <g transform=\"matrix(1.21457,0,0,1.21457,-55.8704,-35.2227)\">\n            <circle cx=\"169.5\" cy=\"152.5\" r=\"123.5\" style=\"fill:rgb(128,128,128);\"/>\n            <path d=\"M169.5,29C237.662,29 293,84.338 293,152.5C293,220.662 237.662,276 169.5,276C101.338,276 46,220.662 46,152.5C46,84.338 101.338,29 169.5,29ZM169.5,37.233C233.117,37.233 284.767,88.883 284.767,152.5C284.767,216.117 233.117,267.767 169.5,267.767C105.883,267.767 54.233,216.117 54.233,152.5C54.233,88.883 105.883,37.233 169.5,37.233Z\" style=\"fill:rgb(235,235,235);\"/>\n        </g>\n        <g transform=\"matrix(6.12323e-17,1,-1,6.12323e-17,347,-59)\">\n            <path d=\"M209,82L317,253L101,253L209,82Z\" style=\"fill:rgb(235,235,235);\"/>\n        </g>\n    </g>\n</svg>\n`;","\nimport { DomClass, createElementWithHtmlText } from './dom';\n\nconst g_style = `\n    background-color: #e4e4e4;\n    width: 100%;\n    height: 100%;\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    cursor: pointer;\n    position: absolute;\n    top: 50%;\n    transform: translateY(-50%); \n`\nconst g_imgStyle = `\n    width: 100%;\n`;\n\nconst g_iconContainerStyle = `\n    position: absolute; \n    top: 0px; \n    left: 0px; \n    right: 0px; \n    bottom: 0px; \n    display: flex;\n    align-content: center;\n    justify-content: center;\n    align-items: center;\n`;\n\nconst g_iconStyle = `\n    pointer-events: none;\n    width: 20%;\n    max-width: 400px;\n    min-width: 100px;\n    opacity: 0.6;\n`;\n\nconst g_buttonStyle = `\n    display: block;\n    width: 20%;\n    background: none;\n    border: none;\n    cursor: pointer;\n`;\n\nimport PlayIcon from '../../icons/play_icon_fullscreen';\n\nexport default class PreviewContainer extends DomClass {\n    constructor(player, parentElement,backgroundImage,backgroundImagePortrait) {\n        const attributes = {\n            \"class\": \"preview-container\",\n            \"style\": g_style,\n            \"role\": \"button\",\n            \"aria-label\": \"Play video\"\n        };\n        super(player, {attributes, parent: parentElement});\n\n        this._img = createElementWithHtmlText(`\n        <div style=\"${g_imgStyle}\">\n            ${ backgroundImage ? `<img style=\"${g_imgStyle}\" src=\"${backgroundImage}\" class=\"preview-image-landscape\" alt=\"\"/>` : \"\" }\n            ${ backgroundImagePortrait ? `<img style=\"${g_imgStyle}\" src=\"${backgroundImagePortrait}\" class=\"preview-image-portrait\" alt=\"\"/>` : \"\" }\n            <div style=\"${ g_iconContainerStyle }\">\n                <button style=\"${g_buttonStyle}\" role=\"button\" aria-label=\"Play video\">\n                    <i class=\"preview-play-icon\" style=\"${ g_iconStyle }\">${ PlayIcon }</i>\n                </button>\n            </div>\n        </div>\n        `, this.element);\n\n        this.element.setAttribute('id','playerContainerClickArea');\n        this.element.addEventListener(\"click\", (evt) => {\n            player.play();\n        });\n\n        const mustCheckOrientation = backgroundImage && backgroundImagePortrait;\n        const checkOrientation = () => {\n            if (mustCheckOrientation) {\n                const aspectRatio = this.element.clientWidth / this.element.clientHeight;\n                const landscapeElements = Array.from(this.element.getElementsByClassName('preview-image-landscape'));\n                const portraitElements = Array.from(this.element.getElementsByClassName('preview-image-portrait'));\n                if (aspectRatio>=1) {\n                    landscapeElements.forEach(e => e.style.display = \"\");\n                    portraitElements.forEach(e => e.style.display = \"none\");\n                }\n                else {\n                    landscapeElements.forEach(e => e.style.display = \"none\");\n                    portraitElements.forEach(e => e.style.display = \"\");\n                }\n            }\n        }\n\n        window.addEventListener(\"resize\", () => {\n            checkOrientation();\n        });\n\n        checkOrientation();\n    }\n\n    loadBackgroundImage(src) {\n        this._img.setAttribute(\"src\",src);\n    }\n}\n","\n\nconst buildSectionContainer = (parent) => {\n    const section = document.createElement('section');\n    section.classList.add('pop-up');\n\n\n    // TODO: Title bar, pop navigator button\n    section.innerHTML = `\n        <header class=\"pop-up-title\">\n            <button class=\"action-back\">\n                <svg width=\"44\" height=\"44\" viewBox=\"0 0 24 24\" stroke-width=\"1.5\" fill=\"none\" stroke-linecap=\"round\" stroke-linejoin=\"round\">\n                    <path stroke=\"none\" d=\"M0 0h24v24H0z\" fill=\"none\"/>\n                    <path d=\"M15 6l-6 6l6 6\" />\n                </svg>\n            </button>\n            <h2>title</h2>\n        </header>\n        <div class=\"pop-up-content\">\n        </div>\n    `;\n    parent.appendChild(section);\n\n    section.setTitle = (title) => {\n        section.querySelector('header.pop-up-title h2').textContent = title;\n    };\n\n    section.popButton = () => section.querySelector('header.pop-up-title button');\n\n    section.onPopClicked = (callback) => {\n        if (section._clickCallback) {\n            section.popButton().removeEventListener('click', section._clickCallback);\n        }\n        section._clickCallback = callback;\n        section.popButton().addEventListener('click', callback);\n    };\n\n    section.hidePopButton = () => section.popButton().style.display = 'none';\n\n    section.showPopButton = () => section.popButton().style.display = '';\n\n    section.setContent = (content) => {\n        section.querySelector('div.pop-up-content').innerHTML = '';\n        section.querySelector('div.pop-up-content').appendChild(content);\n    };\n\n    return section;\n}\n\nlet g_popUpId = 0;\nfunction getPopUpId() {\n    return ++g_popUpId;\n}\n\nexport default class PlaybackBarPopUp {\n    #playbackBar = null;\n    #element = null;\n    #content = [];\n    #title = \"\";\n\n    constructor(playbackBar) {\n        this.#playbackBar = playbackBar;\n        this.#element = document.createElement('div');\n        this.#element.className = 'pop-up-wrapper';\n        playbackBar.element.prepend(this.#element);\n        this.#element.classList.add('hidden');\n        this.#element.addEventListener('click', evt => evt.stopPropagation());\n        this.#playbackBar.element.addEventListener('click', (evt) => {\n            evt.stopPropagation();\n            this.hide();\n        });\n    }\n\n    get title() {\n        return this.#title;\n    }\n\n    set title(title) {\n        this.#title = title;\n        \n    }\n\n    get currentContent() {\n        return this.#content.length && this.#content[this.#content.length - 1];\n    }\n\n    get currentContentId() {\n        return this.currentContent?.dataContentId ?? -1;\n    }\n\n    show({ content, title = \"\", parent = null, attachLeft = false, attachRight = false }) {\n        if (!content) {\n            throw new Error('PlaybackBarPopUp.show(): No content provided.');\n        }\n\n        content.setAttribute(\"data-pop-up-content-id\", getPopUpId());\n        content.dataContentId = content.getAttribute(\"data-pop-up-content-id\");\n        const currentContent = this.#content.length && this.#content[this.#content.length - 1];\n        const parentId = parent && parent.getAttribute(\"data-pop-up-content-id\");\n\n        if (currentContent && currentContent.getAttribute(\"data-pop-up-content-id\") !== parentId) {\n            // Clear content\n            this.#element.innerHTML = \"\";\n            this.#content = [];\n        }\n        else if (currentContent) {\n            currentContent.container.classList.add('out');\n        }\n        ;\n        this.#content.push(content);\n\n        this.#playbackBar.element.classList.add('pop-up-active');\n        this.#element.classList.remove('hidden');\n\n        const container = buildSectionContainer(this.#element);\n        container.setTitle(title);\n        content.container = container;\n\n        if (attachLeft === true) {\n            this.#element.classList.add('left');\n        }\n        else {\n            this.#element.classList.remove('left');\n        }\n\n        if (attachRight === true) {\n            this.#element.classList.add('right');\n        }\n        else {\n            this.#element.classList.remove('right');\n        }\n        container.setContent(content);\n        if (this.#content.length > 1) {\n            container.onPopClicked(() => {\n                this.#content.pop();\n                this.#content[this.#content.length - 1].container.classList.remove('out');\n                this.#element.removeChild(container);\n            });\n        }\n        else {\n            container.hidePopButton();\n        }\n        \n        this.title = title;\n        \n        return content.dataContentId;\n    }\n\n    pop() {\n        if (this.#element.querySelectorAll(\".pop-up\").length === 1) {\n            this.hide();\n            return false;\n        }\n\n        const clickEvent = new Event('click');\n        const backButton = this.#element.querySelector('.pop-up:not(.out) .action-back');\n        backButton.dispatchEvent(clickEvent);\n        return true;\n    }\n    \n    hide() {\n        this.#playbackBar.element.classList.remove('pop-up-active');\n        this.#element.classList.add('hidden');\n    }\n\n    get isHidden() {\n        return this.#element.classList.contains('hidden');\n    }\n}\n","import { DomClass, createElementWithHtmlText } from './dom';\n\nimport { loadPluginsOfType, unloadPluginsOfType } from './plugin_tools'\nimport { addButtonPlugin } from './ButtonPlugin';\nimport { pauseAutoHideUiTimer, resumeAutoHideUiTimer } from './utils';\nimport PlaybackBarPopUp from './PlaybackBarPopUp.js';\n\nexport default class PlaybackBar extends DomClass {\n\t#popUp = null\n\t#playbackBarContainer = null\n\t#topContainer = null\n\t#navContainer = null\n\t#buttonPluginsLeft = null\n\t#centerContainer = null\n\t#buttonPluginsRight = null\n\t#progressIndicator = null\n\t#enabled = true\n\t#enabledPlugins = []\n\n\tconstructor(player,parent) {\n\t\tconst inlineMode = player.config.progressIndicator?.inlineMode ?? false;\n\t\tconst attributes = { \"class\": \"playback-bar-container\" };\n\t\tsuper(player, { attributes, parent });\n\n\t\tthis.#popUp = new PlaybackBarPopUp(this);\n\n\t\tthis.element.addEventListener('mouseenter', () => pauseAutoHideUiTimer(player));\n\t\tthis.element.addEventListener('mouseleave', () => resumeAutoHideUiTimer(player));\n\n\t\t\n\t\tthis.#playbackBarContainer = createElementWithHtmlText('<section class=\"playback-bar\"></section>', this.element);\n\t\tthis.#topContainer = createElementWithHtmlText(`<div></div>`);\n\t\tthis.#navContainer = createElementWithHtmlText('<nav></nav>');\n\n\t\tthis.#buttonPluginsLeft = createElementWithHtmlText(`<ul></ul>`, this.#navContainer);\n\t\tthis.#centerContainer = createElementWithHtmlText(`<div></div>`, this.#navContainer);\n\t\tthis.#buttonPluginsRight = createElementWithHtmlText(`<ul></ul>`, this.#navContainer);\n\t\t\n\t\tconst createProgressIndicator = player._initParams.getProgressIndicator;\n\n\t\tconst duration = 1000;\n\t\tconst currentTime = 0;\n\t\tconst precision = 100;\n\t\tif (inlineMode) {\n\t\t\tthis.#progressIndicator = createProgressIndicator({ container: this.#centerContainer, player, duration, currentTime, precision });\n\t\t}\n\t\telse {\n\t\t\tthis.#playbackBarContainer.appendChild(this.#topContainer);\n\t\t\tthis.#progressIndicator = createProgressIndicator({ container: this.#topContainer, player, duration, currentTime, precision });\n\t\t}\n\t\tthis.#progressIndicator.onChange(async (currentTime) => {\n\t\t\tawait player.videoContainer.setCurrentTime(currentTime);\n\t\t});\n\n\t\tthis.#playbackBarContainer.appendChild(this.#navContainer);\n\t}\n\n\tget popUp() {\n\t\treturn this.#popUp;\n\t}\n\n\tget enabled() {\n\t\treturn this.#enabled;\n\t}\n\n\tset enabled(e) {\n\t\tthis.#enabled = e;\n\t\tif (!this.#enabled) {\n\t\t\tthis.hide();\n\t\t}\n\t\telse {\n\t\t\tthis.showUserInterface();\n\t\t}\n\t}\n\t\n\tasync load() {\n\t\tthis.#enabledPlugins = [];\n\t\t\n\t\tthis.player.log.debug(\"Loading button plugins\");\n\t\tawait loadPluginsOfType(this.player,\"button\",async (plugin) => {\n\t\t\tthis.player.log.debug(` Button plugin: ${ plugin.name }`);\n\t\t\tthis.#enabledPlugins.push(plugin);\n\t\t\tif (plugin.side === \"left\") {\n\t\t\t\tawait addButtonPlugin(plugin, this.buttonPluginsLeft);\n\t\t\t}\n\t\t\telse if (plugin.side === \"right\") {\n\t\t\t\tawait addButtonPlugin(plugin, this.buttonPluginsRight);\n\t\t\t}\n\t\t}, async plugin => {\n\t\t\tif (plugin.parentContainer === \"playbackBar\") {\n\t\t\t\treturn await plugin.isEnabled();\n\t\t\t}\n\t\t\telse {\n\t\t\t\treturn false;\n\t\t\t}\n\t\t});\n\n\t\tconst duration = await this.player.videoContainer.duration();\n\t\tthis.#progressIndicator.setDuration(duration);\n\n\t\tthis.player.frameList.frames.forEach((frameData, i, allFrames) => {\n\t\t\tconst nextFrame = allFrames[i + 1];\n\t\t\tconst frameDuration = nextFrame ? nextFrame.time - frameData.time : duration - frameData.time;\n\t\t\tthis.#progressIndicator.addMarker({ time: frameData.time, duration, frameDuration });\n\n\t\t});\n\n\t\tthis.player.bindEvent([this.player.Events.TIMEUPDATE, this.player.Events.SEEK], (event) => {\n\t\t\tthis.#progressIndicator.setCurrentTime(event.newTime ?? event.currentTime);\n\t\t});\n\n\t\tthis.player.bindEvent(this.player.Events.TRIMMING_CHANGED, async (event) => {\n\t\t\tconst newDuration = event.end - event.start;\n\t\t\tthis.#progressIndicator.setDuration(newDuration);\n\t\t\tconst currentTime = await this.player.videoContainer.currentTime();\n\t\t\tthis.#progressIndicator.setCurrentTime(currentTime);\n\t\t});\n\n\t\tthis.onResize();\n\t}\n\n\tasync unload() {\n\t\t// Remove elements from parent\n\t\tthis.removeFromParent();\n\n\t\t// Unload plugins\n\t\tawait unloadPluginsOfType(this.player, \"button\");\n\t\tthis.#buttonPluginsLeft.innerHTML = \"\"\n\t\tthis.#buttonPluginsRight.innerHTML = \"\";\n\t}\n\t\n\thideUserInterface() {\n\t\tthis.player.log.debug(\"Hide playback bar user interface\");\n\t\tthis.hide();\n\t}\n\t\n\tshowUserInterface() {\n\t\tif (this.#enabled) {\n\t\t\tconst inlineMode = this.player.config.progressIndicator?.inlineMode ?? false;\n\t\t\tconst showMode = inlineMode ? 'flex' : 'block';\n\t\t\tthis.show(showMode);\n\t\t\tthis.onResize();\n\t\t}\n\t}\n\t\n\tget buttonPluginsRight() {\n\t\treturn this.#buttonPluginsRight;\n\t}\n\t\n\tget buttonPluginsLeft() {\n\t\treturn this.#buttonPluginsLeft;\n\t}\n\t\n\tget progressIndicator() {\n\t\treturn this.#progressIndicator;\n\t}\n\n\tget containerSize() {\n\t\tconst width = this.element.clientWidth;\n\t\tconst height = this.element.clientHeight;\n\t\treturn { width, height } \n\t}\n\t\n\tonResize() {\n\t\tconst { containerSize } = this;\n\t\tthis.#enabledPlugins.forEach(plugin => plugin.onResize(containerSize));\n\t}\n}","\nimport { DomClass, createElementWithHtmlText } from '../core/dom';\nimport { loadCaptionsPlugins } from './CaptionsPlugin';\nimport Events, { bindEvent, triggerEvent } from '../core/Events';\n\nconst containerSizeClasses = [\n    { maxWidth: 400, className: 'size-s' },\n    { maxWidth: 600, className: 'size-m' },\n    { maxWidth: 900, className: 'size-l' },\n    { maxWidth: 1100, className: 'size-xl' },\n    { className: 'size-xxl' }\n];\nconst getContainerSizeClass = (size) => {\n    return containerSizeClasses\n        .find(item => item.maxWidth && item.maxWidth>=size || item.maxWidth === undefined).className\n}\n\nexport default class CaptionCanvas extends DomClass {\n    constructor(player,parent) {\n        const attributes = {\n            \"class\": \"captions-canvas visible-ui\"\n        };\n        super(player, { tag: 'div', attributes, parent });\n\n        this._captionsContainer = createElementWithHtmlText(`\n            <div class=\"text-container\">\n            </div>\n        `, this.element);\n        \n        this._captions = [];\n\n        this.hide();\n\n        this._currentCaptions = null;\n\n        const timeChanged = async evt => {\n            const offset = player.videoContainer.isTrimEnabled ? player.videoContainer.trimStart : 0;\n            const time = offset + (evt.currentTime || evt.newTime || 0);\n            if (this._currentCaptions) {\n                const cue = this._currentCaptions.getCue(time);\n                this._captionsContainer.innerHTML = \"\";\n                cue && cue.captions.forEach(c => {\n                    this._captionsContainer.innerHTML += c;\n                    this._captionsContainer.innerHTML += '<br/>';\n                });\n                cue ? this._captionsContainer.style.display = null : this._captionsContainer.style.display = 'none';\n                this.resize();\n            }\n        };\n\n        bindEvent(this.player, Events.TIMEUPDATE, timeChanged);\n        bindEvent(this.player, Events.SEEK, timeChanged);\n        bindEvent(this.player, Events.RESIZE, () => this.resize());\n        bindEvent(this.player, Events.SHOW_UI, () => this.element.classList.add('visible-ui'));\n        bindEvent(this.player, Events.HIDE_UI, () => this.element.classList.remove('visible-ui'));\n    }\n\n    async load() {\n        await loadCaptionsPlugins(this.player);\n    }\n\n    unload() {        \n    }\n\n    resize() {\n        const sizeClass = getContainerSizeClass(this._captionsContainer.clientWidth);\n        containerSizeClasses.forEach(c => this.element.classList.remove(c.className));\n        this.element.classList.add(sizeClass);\n    }\n\n    addCaptions(captions) {\n        this._captions.push(captions);\n        triggerEvent(this.player, Events.CAPTIONS_CHANGED, { captions: this._captions });\n    }\n\n    get captions() {\n        return this._captions;\n    }\n\n    get currentCaptions() {\n        return this._currentCaptions;\n    }\n\n    getCaptions({ label, index, lang }) {\n        if (label === undefined && index === undefined && lang === undefined) {\n            throw Error(\"Could not find captions: you must specify the label, the index or the language\");\n        }\n\n        if (index !== undefined) {\n            return this._captions[index];\n        }\n        else {\n            return this._captions.find(c => {\n                if (label !== undefined) {\n                    return c.label === label;\n                }\n                else if (lang !== undefined) {\n                    return c.language === lang;\n                }\n            });\n        }\n    }\n\n    enableCaptions(searchOptions) {\n        const requestedCaptions = this.getCaptions(searchOptions);\n        if (requestedCaptions !== this._currentCaptions) {\n            this._currentCaptions = requestedCaptions;\n            if (this.currentCaptions) {\n                const { language, label } = this.currentCaptions;\n                triggerEvent(this.player, Events.CAPTIONS_ENABLED, { language, label })\n            }\n        }\n        this.show();\n    }\n\n    disableCaptions() {\n        if (this.currentCaptions) {\n            triggerEvent(this.player, Events.CAPTIONS_DISABLED);\n        }\n        this._currentCaptions = null;\n        this.hide();\n    }\n}\n","import Plugin from './Plugin';\nimport { bindEvent } from './Events';\n\nimport { loadPluginsOfType } from './plugin_tools'\n\nexport async function loadLogEventPlugins(player) {\n    await loadPluginsOfType(player, \"eventLog\", async (plugin) => {\n        plugin.events.forEach(event => {\n            bindEvent(player, event, async (params) => {\n                await plugin.onEvent(event, params);\n            })\n        })\n    });\n}\n\nexport async function unloadLogEventPlugins(player) {\n    \n}\n\nexport default class EventLogPlugin extends Plugin {\n    get type() { return \"eventLog\"; }\n\n    get events() {\n        return [];\n    }\n\n    async onEvent(event, params) {\n        this.player.log.warn(`${this.name}: onEvent() function is not overwritten.`)\n    }\n}\n","\nimport Events, { triggerEvent } from \"./Events\";\n\nexport const defaultGetCookieConsentCallback = (type) => {\n    return false;\n}\n\nexport const defaultGetCookieDescriptionCallback = (cookieObject) => {\n    return cookieObject.description;\n}\n\nexport default class CookieConsent {\n    constructor(player,initCallbacks) {\n        this._player = player;\n\n        this._cookieConsentData = player.config.cookieConsent || [];\n\n        this._getConsentCallback = initCallbacks.getConsent || defaultGetCookieConsentCallback;\n        this._getDescriptionCallback = initCallbacks.getDescription || defaultGetCookieDescriptionCallback;\n\n        this._cookieConsentData.forEach(consentObject => {\n            consentObject.description = this._getDescriptionCallback(consentObject);\n        });\n\n        this.updateConsentData();\n    }\n\n    updateConsentData() {\n        this._cookieConsentData.forEach(consentElement => {\n            consentElement.value = this._getConsentCallback(consentElement.type) || consentElement.required;\n        });\n        triggerEvent(this._player, Events.COOKIE_CONSENT_CHANGED, { cookieConsent: this } );\n    }\n\n    getConsentForType(type) {\n        const object = this._cookieConsentData.find(c => c.type === type);\n        return object?.value || false;\n    }\n}\n","\nexport function createTimeLinePreview({ container }) {\n    container.innerHTML = `\n        <div class=\"timeline-preview hidden\">\n            <img src=\"\" alt=\"\" />\n            <p></p>\n        </div>\n    `;\n\n    const image = container.querySelector('img');\n    const text = container.querySelector('p');\n    const previewBox = container.querySelector('.timeline-preview');\n\n    const timeLinePreview = {\n        setImage(src,alt) {\n            if (src !== image.src) {\n                image.src = src;\n                image.alt = alt;\n            }\n        },\n    \n        setText(txt) {\n            text.innerText = txt;\n        },\n\n        setPosition(normalizedX) {\n            if (normalizedX > 0.5) {\n                previewBox.style.left = \"\";\n                previewBox.style.right = `${100 - normalizedX * 100}%`;\n            }\n            else {\n                previewBox.style.right = \"\";\n                previewBox.style.left = `${normalizedX * 100}%`;\n            }\n        },\n\n        show() {\n            previewBox.classList.remove('hidden');\n        },\n\n        hide() {\n            previewBox.classList.add('hidden');\n        }\n    }\n\n    return timeLinePreview;\n}\n\n","import { createTimeLinePreview } from \"./timeline-preview.js\";\nimport { createElementWithHtmlText } from \"./dom.js\";\nimport * as utils from \"./utils.js\";\n\nexport function createProgressIndicator({ container, player, duration = 100, currentTime = 0, precision = 100}) {\n    container.classList.add('progress-indicator');\n    container.classList.add('custom-progress-indicator');\n    container.innerHTML = `\n        <div class=\"range-container\">\n            <div class=\"timeline-preview-container\"></div>\n            <div class=\"elapsed\"></div>\n            <div class=\"remaining\"></div>\n            <input type=\"range\" min=\"0\" max=\"${duration * precision}\" value=\"${currentTime * precision}\" tabindex=\"0\" role=\"slider\" class=\"slider\">\n            <ul class=\"markers-container\"></ul>\n        </div>\n    `;\n\n    const elapsed = container.querySelector('.elapsed');\n    const remaining = container.querySelector('.remaining');\n    const range = container.querySelector('.slider');\n\n    const timeLinePreviewContainer = container.querySelector('.timeline-preview-container');\n    const timeLinePreview = createTimeLinePreview({ container: timeLinePreviewContainer });\n\n    // Controls if the user is seeking the range element. In this case, we must avoid\n    // to update the range value via the setCurrentTime method.\n    let seeking = false;\n\n    let onChangeCallback = null;\n    const markers = [];\n    const getMarker = (time) => markers.find(marker => marker.time < time && marker.time + marker.frameDuration >= time)?.marker;\n    const progressIndicator = {\n        player,\n        elapsed,\n        remaining,\n        range,\n        timeLinePreview,\n\n        markersContainer: container.querySelector('.markers-container'),\n\n        addMarker({ time, duration, frameDuration }) {\n            const marker = createElementWithHtmlText(`<li>\n                <div class=\"elapsed\"></div>\n                <div class=\"remaining\"></div>\n            </li>`);\n            marker.style.left = `${time / duration * 100}%`;\n            marker.style.width = `calc(${frameDuration / duration * 100}% - 4px)`;\n            this.markersContainer.appendChild(marker);\n            markers.push({\n                marker,\n                time,\n                frameDuration\n            })\n        },\n\n        updateRemaining() {\n            const position = this.range.value / this.range.max * 100;\n            this.elapsed.style.width = `${position}%`;\n            this.remaining.style.width = `${100 - position}%`;\n\n            const currentMarker = getMarker(this.range.value / precision);\n            const currentIndex = markers.findIndex(marker => marker.marker === currentMarker);\n            markers.forEach((marker, index) => {\n                if (index < currentIndex) {\n                    marker.marker.querySelector(\".elapsed\").style.width = \"100%\";\n                    marker.marker.querySelector(\".remaining\").style.width = \"0%\";\n                }\n                else if (index === currentIndex) {\n                    const elapsed = (this.range.value / precision - marker.time) / marker.frameDuration * 100;\n                    marker.marker.querySelector(\".elapsed\").style.width = `${elapsed}%`;\n                    marker.marker.querySelector(\".remaining\").style.width = `${100 - elapsed}%`;\n                }\n                else {\n                    marker.marker.querySelector(\".elapsed\").style.width = \"0%\";\n                    marker.marker.querySelector(\".remaining\").style.width = \"100%\";\n                }\n            });\n        },\n\n        setDuration(duration) {\n            if (!seeking) {\n                this.range.max = duration * precision;\n                this.updateRemaining();\n            }\n        },\n\n        setCurrentTime(currentTime) {\n            if (!seeking) {\n                this.range.value = currentTime * precision;\n                this.updateRemaining();\n            }\n        },\n\n        onChange(callback) {\n            onChangeCallback = callback;\n        }\n    };\n\n    range.addEventListener('pointerdown', () => {\n        seeking = true;\n    });\n\n    let prevMarker = null;\n    range.addEventListener('mousemove', async (event) => {\n        const frameList = player.frameList?.frames || [];\n        if (frameList && frameList.length) {\n            const duration = await player.videoContainer.duration();\n            const width = event.target.clientWidth;\n            const position = event.layerX;\n            const normalizedPosition = position / width;\n            const time = normalizedPosition * duration;\n            const frame = frameList.filter(frame => frame.time <= time).pop();\n            const url = frame && (frame.thumb || frame.url);\n            const text = frame && utils.secondsToTime(duration * normalizedPosition);\n            const marker = getMarker(time);\n            if (marker !== prevMarker && prevMarker !== null) {\n                prevMarker.classList.remove('active');\n            }\n            marker && marker.classList.add('active');\n            prevMarker = marker;\n            \n            timeLinePreview.setImage(url, text);\n            timeLinePreview.setText(text);\n            timeLinePreview.setPosition(normalizedPosition);\n\n            timeLinePreview.show();\n        }\n    });\n\n    range.addEventListener('mouseleave', () => {\n        timeLinePreview.hide();\n        prevMarker && prevMarker.classList.remove('active');\n    });\n\n    range.addEventListener('pointerup', () => {\n        seeking = false;\n        if (typeof(onChangeCallback) === 'function') {\n            onChangeCallback(range.value / precision);\n        }\n    });\n\n    range.addEventListener('input', () => {\n        progressIndicator.updateRemaining();\n    });\n\n    const seekSeconds = async (seconds) => {\n        const currentTime = await player.videoContainer.currentTime();\n        await player.videoContainer.setCurrentTime(currentTime + seconds);\n    }\n\n    range.addEventListener('keydown', evt => {\n        if (evt.key === 'ArrowLeft') {\n            seekSeconds(-10);        \n            evt.preventDefault();\n            evt.stopPropagation();\n        }\n        else if (evt.key === 'ArrowRight') {\n            seekSeconds(10);\n            evt.preventDefault();\n            evt.stopPropagation();\n        }\n\n    });\n\n    progressIndicator.updateRemaining();\n\n    return progressIndicator;\n}","/* eslint-disable no-console */\n\nexport const LOG_LEVEL = Object.freeze({\n    DISABLED: 0,\n    ERROR: 1,\n    WARN: 2,\n    INFO: 3,\n    DEBUG: 4,\n    VERBOSE: 5\n});\n\nimport Events, { triggerEvent } from \"./Events\";\n\nlet g_globalLogLevel = LOG_LEVEL.INFO;\n\nexport const setLogLevel = (l,player = null) => {\n    const level = typeof(l) === \"string\" ? LOG_LEVEL[l.toUpperCase()] : l;\n\n    if (level<LOG_LEVEL.DISABLED || level>LOG_LEVEL.VERBOSE) {\n        throw Error(`setLogLevel: invalid log level ${ level }`);\n    }\n    if (player) {\n        player.__logSettings = player.__logSettings || {};\n        player.__logSettings.logLevel = level;\n    }\n    else {\n        g_globalLogLevel = level;\n    }\n}\n\nexport const currentLogLevel = (player = null) => {\n    return player ? player.__logSettings.logLevel : g_globalLogLevel;\n}\n\nexport const printMessage = ({\n    msg,\n    level = LOG_LEVEL.INFO, \n    player = null,\n    context = 'paella-core'\n}) => {\n    if (player && !player.__logSettings) {\n        setLogLevel(player, LOG_LEVEL.INFO);\n    }\n\n    const current = currentLogLevel(player);\n    if (level<LOG_LEVEL.DISABLED) {\n        throw Error(`printMessage: invalid log level ${ level }`);\n    }\n\n    if (player) {\n        triggerEvent(player, Events.LOG, { severity: level, context, message: msg, currentLogLevel: current });\n    }\n\n    if (level<=current) {\n        switch (level) {\n        case LOG_LEVEL.ERROR:\n            console.error(`${ context } - Error: ${msg}`);\n            break;\n        case LOG_LEVEL.WARN:\n            console.warn(`${ context } - Warning: ${msg}`);\n            break;\n        case LOG_LEVEL.INFO:\n            console.info(`${ context } - Info: ${msg}`);\n            break;\n        case LOG_LEVEL.DEBUG:\n            console.debug(`${ context } - Debug: ${msg}`);\n            break;\n        case LOG_LEVEL.VERBOSE:\n            console.log(`${ context } - Verbose: ${msg}`);\n            break;\n        }\n    }\n};\n\nexport const log = {\n    setLevel: (level, player = null) => {\n        setLogLevel(level, player);\n    },\n\n    currentLevel: (player = null) => {\n        return currentLogLevel(player);\n    },\n\n    error: (msg, player = null, context = 'paella-core') => {\n        printMessage({\n            msg, \n            level: LOG_LEVEL.ERROR, \n            player, \n            context \n        });\n    },\n\n    warn: (msg, player = null, context = 'paella-core') => {\n        printMessage({\n            msg, \n            level: LOG_LEVEL.WARN, \n            player, \n            context \n        });\n    },\n\n    info: (msg, player = null, context = 'paella-core') => {\n        printMessage({\n            msg, \n            level: LOG_LEVEL.INFO, \n            player, \n            context \n        });\n    },\n\n    debug: (msg, player = null, context = 'paella-core') => {\n        printMessage({\n            msg, \n            level: LOG_LEVEL.DEBUG, \n            player, \n            context \n        });\n    },\n\n    verbose: (msg, player = null, context = 'paella-core') => {\n        printMessage({\n            msg, \n            level: LOG_LEVEL.VERBOSE, \n            player, \n            context \n        });\n    }\n}\n\n\nexport default class Log {\n    constructor(player, context = \"paella-core\") {\n        this._player = player;\n        this._context = context;\n    }\n\n    get context() {\n        return this._context;\n    }\n\n    get player() {\n        return this._player;\n    }\n\n    setLevel(level) {\n        log.setLevel(level, this._player);\n    }\n\n    currentLevel() {\n        return log.currentLevel(this._player);\n    }\n\n    error(msg, context = null) {\n        log.error(msg, this._player, context || this._context);\n    }\n\n    warn(msg, context = null) {\n        log.warn(msg, this._player, context || this._context);\n    }\n\n    info(msg, context = null) {\n        log.info(msg, this._player, context || this._context);\n    }\n\n    debug(msg, context = null) {\n        log.debug(msg, this._player, context || this._context);\n    }\n\n    verbose(msg, context = null) {\n        log.verbose(msg, this._player, context || this._context);\n    }\n}\n","\nconst defaultDictionaries = {};\n\n/*\nconst dictionaries = require.context('../i18n/', true, /\\.json$/);\ndictionaries.keys().forEach(k => {\n    const reResult = /([a-z-]+[A-Z_]+)\\.json/.exec(k);\n    const localization = reResult && reResult[1];\n    \n    if (localization) {\n        const dict = dictionaries(k);\n        defaultDictionaries[localization] = dict;\n        \n        const lang = localization.substr(0,2);\n        if (!(lang in defaultDictionaries)) {\n            defaultDictionaries[lang] = dict;\n        }\n    }\n});\n*/\nexport default defaultDictionaries;","\nimport PlayerResource from \"./PlayerResource\";\nimport { setCookieIfAllowed, getCookie } from \"./utils\";\n\nconst g_defaultPreferences = '{ \"global\": {}, \"videos\": {} }';\n\nasync function load() {\n    switch (this.source.name) {\n    case \"cookie\":\n        try {\n            return JSON.parse(getCookie(\"preferences\"));\n        }\n        catch (err) {\n            return JSON.parse(g_defaultPreferences);\n        }\n    case \"dataPlugin\":\n        try {\n            const data = await this.player.data.read(this.source.context, {});\n            return data || JSON.parse(g_defaultPreferences);\n        }\n        catch (err) {\n            return JSON.parse(g_defaultPreferences);\n        }\n    }\n}\n\nasync function save(data) {\n    switch (this.source.name) {\n    case \"cookie\":\n        setCookieIfAllowed(this.player, this.source.consentType, \"preferences\", JSON.stringify(data));\n        break;\n    case \"dataPlugin\":\n        await this.player.data.write(this.source.context, {}, data);\n        break;\n    }\n}\n\nexport default class Preferences extends PlayerResource {\n    constructor(player) {\n        super(player);\n        const { currentSource, sources } = player.config.preferences || {\n            currentSource: \"cookie\",\n            sources: {\n                cookie: {\n                    consentType: \"necessary\"\n                }\n            }\n        };\n        this.source = sources[currentSource];\n        this.source.name = currentSource;\n        this._loaded = false;\n\n        if (!this.source) {\n            throw Error(\"Invalid configuration in preferences. Check the configuration file.\");\n        }\n    }\n\n    async set(key, value, { global = false } = {}) {\n        const data = await load.apply(this);\n        if (global) {\n            data.global[key] = value; \n        }\n        else {\n            data.videos[this.player.videoId] = data.videos[this.player.videoId] || {};\n            data.videos[this.player.videoId][key] = value;\n        }\n        await save.apply(this, [data]);\n    }\n\n    async get(key, { global = false } = {}) {\n        const data = await load.apply(this);\n        if (global) {\n            return data.global[key];\n        }\n        else {\n            return data.videos[this.player.videoId] && data.videos[this.player.videoId][key] || undefined;\n        }\n    }\n}","import { mergeObjects, unloadStyle } from \"./utils\";\nimport PlayerState from \"./PlayerState\";\nimport { removeFileName } from \"./utils\";\nimport { joinPath } from \"./utils\";\nimport { loadStyle } from \"./utils\";\n\n// The following functions should be called only by a paella-core instance\nexport function overrideSkinConfig(config) {\n    if (this._skinData?.configOverrides) {\n        mergeObjects(config, this._skinData.configOverrides);\n    }\n}\n\nasync function checkLoadSkinStyleSheets() {\n    if (this._skinData?.styleSheets) {\n        const p = [];\n        this._skinData.styleSheets.forEach(css => {\n            if (/\\{.*/.test(css)) {\n            }\n            else if (this._externalResourcesAllowed) {\n                const cssPath = joinPath([this._skinUrl, css]);\n                p.push(new Promise(async resolve => {\n                    await loadStyle(cssPath, false);\n                    resolve();\n                }));\n            }\n            else {\n                throw new Error(\"No external resources allowed loading skin object\");\n            }\n        });\n        await Promise.allSettled(p);\n    }\n}\n\nexport async function loadSkinStyleSheets() {\n    this.player.__skinStyleSheets__ = this.player.__skinStyleSheets__ || [];\n    if (this._skinData?.styleSheets) {\n        const p = [];\n        this._skinData.styleSheets.forEach(css => {\n            if (/\\{.*/.test(css)) {\n                p.push(new Promise(resolve => {\n                    const style = document.createElement('style');\n                    style.innerHTML = css;\n                    this.player.__skinStyleSheets__.push(style);\n                    document.head.appendChild(style);\n                    resolve();\n                }))\n            }\n            else {\n                const cssPath = joinPath([this._skinUrl, css]);\n                p.push(new Promise(async resolve => {\n                    const link = await loadStyle(cssPath);\n                    this.player.__skinStyleSheets__.push(link);\n                    resolve();\n                }))\n            }\n        });\n        await Promise.allSettled(p);\n    }\n}\n\nexport function unloadSkinStyleSheets() {\n    this.player.__skinStyleSheets__ = this.player.__skinStyleSheets__ || [];\n    this.player.__skinStyleSheets__.forEach(link => {\n        unloadStyle(link);\n    });\n    this.player.__skinStyleSheets__ = [];\n}\n\nexport async function checkLoadSkinIcons() {\n    if (Array.isArray(this._skinData?.icons)) {\n        await Promise.all(this._skinData.icons.map(({ plugin, identifier, icon }) => {\n            return new Promise(async (resolve,reject) => {\n                const div = document.createElement('div');\n                div.innerHTML = icon;\n                if (div.children[0] && div.children[0].tagName === 'svg') {\n                    // Embedded icon\n                    resolve();   \n                }\n                else if (this._externalResourcesAllowed) {\n                    const iconFullUrl = joinPath([this._skinUrl, icon]);\n                    const req = await fetch(iconFullUrl);\n                    if (req.ok) {\n                        resolve();\n                    }\n                    else {\n                        reject(new Error(`Skin icon not found at URL '${ iconFullUrl }'`));\n                    }\n                }\n                else {\n                    throw new Error(\"No external resources allowed loading skin object\");\n                }\n            })\n        }))\n    }\n}\n\nexport async function loadSkinIcons() {\n    if (Array.isArray(this._skinData?.icons)) {\n        await Promise.all(this._skinData.icons.map(({ plugin, identifier, icon }) => {\n            return new Promise(async (resolve,reject) => {\n                const div = document.createElement('div');\n                div.innerHTML = icon;\n                if (div.children[0] && div.children[0].tagName === 'svg') {\n                    this.player.addCustomPluginIcon(plugin, identifier, icon);\n                    resolve();\n                }\n                else {\n                    const iconFullUrl = joinPath([this._skinUrl, icon]);\n                    const req = await fetch(iconFullUrl);\n                    if (req.ok) {\n                        const iconData = await req.text();\n                        this.player.addCustomPluginIcon(plugin, identifier, iconData);\n                        resolve();\n                    }\n                    else {\n                        reject(new Error(`Skin icon not found at URL '${ iconFullUrl }'`));\n                    }\n                }\n            })\n        }));\n    }\n}\n\n\nexport default class Skin {\n    constructor(player) {\n        this._player = player;\n    }\n\n    get player() {\n        return this._player;\n    }\n\n    async loadSkin(skinParam) {\n        if (typeof(skinParam) === \"string\") {\n            // load skin data from url to this._skinData\n            this._skinUrl = removeFileName(skinParam);\n            this._externalResourcesAllowed = true;\n            const req = await fetch(skinParam);\n            if (!req.ok) {\n                throw new Error(`Error loading skin from URL ${skinParam}`);\n            }\n            this._skinData = await req.json();\n        }\n        else if (typeof(skinParam) === \"object\") {\n            this._skinUrl = \"\";\n            this._externalResourcesAllowed = false;\n            this._skinData = skinParam;\n        }\n\n        try {\n            // check skinData object\n            await checkLoadSkinStyleSheets.apply(this);\n            await checkLoadSkinIcons.apply(this);\n            \n            // If the player status is loaded, reload the player\n            if (this._player.state === PlayerState.LOADED ||\n                this._player.state === PlayerState.MANIFEST)\n            {\n                await this._player.reload();\n            }\n        }\n        catch (err) {\n            this._skinUrl = \"\";\n            this._externalResourcesAllowed = true;\n            this._skinData = {};\n            throw err;\n        }\n    }\n\n    unloadSkin() {\n        // Unload custom icons\n        if (Array.isArray(this._skinData?.icons)) {\n            this._skinData?.icons.forEach(({ plugin, identifier }) => {\n                this.player.removeCustomPluginIcon(plugin, identifier);\n            });\n        }\n\n        this._skinUrl = null;\n        this._skinData = {};\n\n        if (this._player.state === PlayerState.LOADED ||\n            this._player.state === PlayerState.MANIFEST)\n        {\n            this._player.reload();\n        }\n    }\n}","\nexport default class ManifestParser {\n    constructor(manifestData, player) {\n        this._player = player;\n        this._videoManifest = JSON.parse(JSON.stringify(manifestData));\n\n        this._metadata = this._videoManifest.metadata || {};\n        this._streams = {};\n        this._frameList = {};\n        this._trimming = this._videoManifest.trimming;\n        this._captions = this._videoManifest.captions;\n        this._visibleTimeLine = this._videoManifest.visibleTimeLine;\n\n        function getNativeSource() {\n            if (this.streams.length !== 1) {\n                return null;\n            }\n            if (this.isAudioOnly) {\n                return this.audioOnlySource.src;\n            }\n            const stream = this.streams[0];\n            const source = stream.sources.mp4 || stream.sources.hls || stream.sources.hlsLive;\n            if (!source) {\n                return null;\n            }\n            const video = document.createElement('video');\n            if (stream.sources.mp4 && \n                stream.sources.mp4.length &&\n                video.canPlayType(stream.sources.mp4[0].mimetype || \"video/mp4\") === \"probably\"\n                )\n            {\n                return stream.sources.mp4[0].src;\n            }\n            const hls = stream.sources.hls || stream.sources.hlsLive;\n            if (hls &&\n                hls.length &&\n                video.canPlayType(hls[0].mimetype || \"application/vnd.apple.mpegurl\") !== \"\" &&\n                /safari/i.test(navigator.userAgent))    // HLS native only on Safari\n            {\n                return hls[0].src;\n            }\n            return null;\n        }\n\n        this._streams = {\n            streams: this._videoManifest.streams,\n            get contents() {\n                return this.streams.map(s => s.content);\n            },\n            getStream(content) {\n                return this.streams.find(s => s.content === content);\n            },\n            getSourceTypes(content) {\n                const stream = this.getStream(content);\n                return stream && Object.keys(stream.sources) || null;\n            },\n            getCanvasTypes(content) {\n                const stream = this.getStream(content);\n                return stream ? stream.canvas || [\"video\"] : null;\n            },\n            get isAudioOnly() {\n                // Check if the manifest only contains audio streams\n                const content = this.contents.length === 1 && this.contents[0];\n                const canvasTypes = content && this.getCanvasTypes(content) || [];\n                const streams = this.getStream(content);\n                return canvasTypes.length === 1 && \n                    canvasTypes[0] === \"audio\" &&\n                    streams.sources.audio && streams.sources.audio.length > 0;\n            },\n            get audioOnlySource() {\n                if (!this.isAudioOnly) {\n                    return null;\n                }\n                return this.getStream(this.contents[0]).sources.audio[0];\n            },\n            get isNativelyPlayable() {\n                return getNativeSource.apply(this) !== null;\n            },\n            get nativeSource() {\n                return getNativeSource.apply(this);\n            },\n            get nativeType() {\n                if (!this.isNativelyPlayable) {\n                    return null;\n                }\n                return this.isAudioOnly ? 'audio' : 'video';\n            },\n            get nativePlayer() {\n                const type = this.nativeType;\n                if (type) {\n                    const player = document.createElement(type);\n                    player.src = this.nativeSource;\n                    return player;\n                }\n                else {\n                    return null;\n                }\n            }\n        };\n\n        if (this._videoManifest.frameList &&\n            !Array.isArray(this._videoManifest.frameList) &&\n            typeof(this._videoManifest.frameList) === \"object\" &&\n            typeof(this._videoManifest.frameList.targetContent) === \"string\" &&\n            Array.isArray(this._videoManifest.frameList.frames)) \n        {\n            this._frameList = this._videoManifest.frameList;\n        }\n        else if (Array.isArray(this._videoManifest.frameList)) {\n            this._frameList = {\n                targetContent: null,\n                frames: this._videoManifest.frameList\n            }\n        }\n        else {\n            this._frameList = {\n                targetContent: null,\n                frames: []\n            }\n        }\n\n        this._frameList.frames.sort((a,b) => a.time - b.time);\n\n        this._frameList.getImage = (time, ignoreTrimming = false) => {\n            if (this._player?.videoContainer && this._player._videoContainer.isTrimEnabled && !ignoreTrimming) {\n                time += this._player.videoContainer.trimStart;\n            }\n            else if (!this._player?._videoContainer && !ignoreTrimming) {\n                console.warn(\"frameList.getImage(): player instance is null. The trimming information will be ignored.\");\n            }\n\n            return [...this._frameList.frames]\n                .sort((a,b) => b.time - a.time)\n                .find(f => f.time < time)\n        }\n\n        Object.defineProperty(this._frameList, \"isEmpty\", {\n            get() {\n                return Array.isArray(manifestData.frameList) && manifestData.frameList.length === 0 ||\n                        !manifestData.frameList;\n            }\n        });\n\n\n        Object.freeze(this._metadata);\n        Object.freeze(this._streams);\n        Object.freeze(this._trimming);\n        Object.freeze(this._captions);\n    }\n\n    get metadata() {\n        return this._metadata;\n    }\n\n    get streams() {\n        return this._streams;\n    }\n\n    get frameList() {\n        return this._frameList;\n    }\n\n    get captions() {\n        return this._captions;\n    }\n\n    get trimming() {\n        return this._trimming;\n    }\n\n    get visibleTimeLine() {\n        return this._visibleTimeLine;\n    }\n}","import {\n    defaultLoadConfigFunction,\n    defaultGetVideoIdFunction,\n    defaultGetManifestUrlFunction,\n    defaultGetManifestFileUrlFunction,\n    defaultLoadVideoManifestFunction\n} from './core/initFunctions';\nimport { \n    resolveResourcePath,\n    setupAutoHideUiTimer,\n    clearAutoHideTimer,\n    getUrlFileName,\n    removeExtension,\n    removeFileName\n} from './core/utils';\nimport Loader from \"./core/Loader\";\nimport ErrorContainer from \"./core/ErrorContainer\";\nimport { registerPlugins, unregisterPlugins } from './core/plugin_tools';\nimport VideoContainer, {\n    getSourceWithUrl\n} from './core/VideoContainer';\nimport PreviewContainer from './core/PreviewContainer';\nimport PlaybackBar from './core/PlaybackBar';\nimport Events, { bindEvent, triggerEvent, unregisterEvents } from './core/Events';\nimport Data from './core/Data';\nimport CaptionCanvas from './captions/CaptionsCanvas';\nimport { loadLogEventPlugins, unloadLogEventPlugins } from \"./core/EventLogPlugin\";\nimport { checkManifestIntegrity } from \"./core/StreamProvider\";\nimport CookieConsent, {\n    defaultGetCookieConsentCallback,\n    defaultGetCookieDescriptionCallback\n} from \"./core/CookieConsent\";\nimport { getAvailableContentIds } from \"./core/VideoLayout\";\nimport { createProgressIndicator } from \"./core/progress-indicator.js\";\n\nimport {\n    defaultTranslateFunction,\n    defaultSetLanguageFunction,\n    defaultAddDictionaryFunction,\n    setTranslateFunction,\n    setGetLanguageFunction,\n    setSetLanguageFunction,\n    setAddDictionaryFunction,\n    setGetDefaultLanguageFunction,\n    addDictionary,\n    getDictionaries,\n    translate,\n    setLanguage,\n    getLanguage,\n    getDefaultLanguage,\n    defaultGetDictionariesFunction,\n    setGetDictionariesFunction,\n    defaultGetDefaultLanguageFunction,\n    setupDefaultLanguage\n} from \"./core/Localization\";\n\nimport { defaultGetLanguageFunction } from \"./core/Localization\";\n\nimport Log, { LOG_LEVEL } from \"./core/Log\";\n\nimport defaultDictionaries from \"./default-dictionaries.js\";\n\nimport Preferences from \"./core/Preferences\";\n\nimport Skin, { overrideSkinConfig, loadSkinStyleSheets, loadSkinIcons, unloadSkinStyleSheets } from \"./core/Skin\";\n\nimport PlayerState from \"./core/PlayerState\";\n\nexport const PlayerStateNames = Object.freeze([\n    'UNLOADED',\n    'LOADING_MANIFEST',\n    'MANIFEST',\n    'LOADING_PLAYER',\n    'LOADED',\n    'UNLOADING_MANIFEST',\n    'UNLOADING_PLAYER',\n    'ERROR'\n]);\n\nfunction buildPreview() {\n    const preview = (this.videoManifest?.metadata?.preview && resolveResourcePath(this, this.videoManifest?.metadata?.preview)) || this.defaultVideoPreview;\n    const previewPortrait = (this.videoManifest?.metadata?.previewPortrait && resolveResourcePath(this, this.videoManifest?.metadata?.previewPortrait)) || this.defaultVideoPreviewPortrait;\n    this._previewContainer = new PreviewContainer(this, this._containerElement, preview, previewPortrait);\n}\n\nimport packageData from \"../../package.json\";\nimport ManifestParser from \"./core/ManifestParser\";\n\n// Used in the first step of loadManifest and loadUrl\nasync function preLoadPlayer() {\n    this._playerState = PlayerState.LOADING_MANIFEST;\n    this._manifestLoaded = true;\n\n    this.log.debug(\"Loading paella player\");\n    this._config = await this.initParams.loadConfig(this.configUrl,this);\n\n    // Override config.json options from skin\n    overrideSkinConfig.apply(this.skin, [this._config]);\n\n    setupDefaultLanguage(this);\n\n    this._defaultVideoPreview = this._config.defaultVideoPreview || this._initParams.defaultVideoPreview || \"\";\n    this._defaultVideoPreviewPortrait = this._config.defaultVideoPreviewPortrait || this._initParams.defaultVideoPreviewPortrait || \"\";\n\n    this._cookieConsent = new CookieConsent(this, {\n        getConsent: this._initParams.getCookieConsentFunction, \n        getDescription: this._initParams.getCookieDescriptionFunction\n    });\n\n    this._preferences = new Preferences(this);\n\n    const urlSearch = new URLSearchParams(window.location.search);\n    const caseInsensitiveParams = new URLSearchParams();\n    for (const [name, value] of urlSearch) {\n        caseInsensitiveParams.append(name.toLowerCase(), value);\n    }\n    const urlParamLogLevel = caseInsensitiveParams.get(\"loglevel\");\n    const logLevel = (urlParamLogLevel && Array.from(Object.keys(LOG_LEVEL)).indexOf(urlParamLogLevel.toUpperCase()) !== -1) ?\n        urlParamLogLevel :\n        this._config.logLevel || \"INFO\";\n    this._log.setLevel(logLevel);\n\n    // Load localization dictionaries\n    await this._initParams.loadDictionaries(this);\n\n    registerPlugins(this);\n\n    // EventLogPlugin plugins are loaded first, so that all lifecycle events can be captured.\n    await loadLogEventPlugins(this);\n\n    // Create video container.\n    this._videoContainer = new VideoContainer(this, this._containerElement);\n\n    // This function will load the video plugins\n    await this.videoContainer.create();\n\n    // Load plugin modules dictionaries\n    for (const module of this.pluginModules) {\n        const dict = module.getDictionaries && await module.getDictionaries();\n        if (dict) {\n            for (const lang in dict) {\n                addDictionary(lang, dict[lang]);\n            }\n        }\n    }\n}\n\n// Used in the last step of loadManifest and loadUrl\nasync function postLoadPlayer() {\n    this.log.debug(\"Video manifest loaded:\");\n    this.log.debug(this.videoManifest);\n\n    // Load data plugins\n    this._data = new Data(this);\n\n    // Load default dictionaries\n    for (const lang in defaultDictionaries) {\n        const dict = defaultDictionaries[lang];\n        addDictionary(lang, dict);\n    }\n\n    this._playerState = PlayerState.MANIFEST;\n    triggerEvent(this, Events.MANIFEST_LOADED);\n\n    // The video preview is required\n    if (!this.videoManifest?.metadata?.preview) {\n        throw new Error(\"No preview image found in video manifest, and no default preview image defined.\");\n    }\n    else {\n        buildPreview.apply(this);\n    }\n\n    checkManifestIntegrity(this._videoManifest);\n}\n\nexport default class Paella {\n\n    constructor(containerElement, initParams = {}) {\n        this._log = new Log(this);\n\n        this._packageData = packageData;\n\n        // The default log level before loading the configuration is\n        // VERBOSE, to ensure that all previous messages are displayed\n        this._log.setLevel(LOG_LEVEL.VERBOSE);\n\n        // Debug: create an array of all paella player instances\n        window.__paella_instances__ = window.__paella_instances__ || [];\n        window.__paella_instances__.push(this);\n\n        this.log.debug(\"New paella player instance\");\n        \n        \n        if (typeof(containerElement) === \"string\") {\n            containerElement = document.getElementById(containerElement);\n        }\n        \n        containerElement.classList.add(\"player-container\");\n\n        this.log.debug(\"Loading skin manager\");\n        this._skin = new Skin(this);\n        \n        this._containerElement = containerElement;\n        this._initParams = initParams;\n        \n        // Default initParams values:\n        this._initParams.manifestFileName = this._initParams.manifestFileName || \"data.json\";\n        this._initParams.loadConfig = this._initParams.loadConfig || defaultLoadConfigFunction;\n        this._initParams.getVideoId = this._initParams.getVideoId || defaultGetVideoIdFunction;\n        this._initParams.getManifestUrl = this._initParams.getManifestUrl || defaultGetManifestUrlFunction;\n        this._initParams.getManifestFileUrl = this._initParams.getManifestFileUrl || defaultGetManifestFileUrlFunction;\n        this._initParams.loadVideoManifest = this._initParams.loadVideoManifest || defaultLoadVideoManifestFunction;\n        this._initParams.customPluginContext = this._initParams.customPluginContext || [];\n        this._initParams.translateFunction = this._initParams.translateFunction || defaultTranslateFunction;\n        this._initParams.getLanguageFunction = this._initParams.getLanguageFunction || defaultGetLanguageFunction;\n        this._initParams.setLanguageFunction = this._initParams.setLanguageFunction || defaultSetLanguageFunction;\n        this._initParams.addDictionaryFunction = this._initParams.addDictionaryFunction || defaultAddDictionaryFunction;\n        this._initParams.getDictionariesFunction = this._initParams.getDictionariesFunction || defaultGetDictionariesFunction;\n        this._initParams.getDefaultLanguageFunction = this._initParams.getDefaultLanguageFunction || defaultGetDefaultLanguageFunction;\n        this._initParams.Loader = this._initParams.customLoader || Loader;\n        this._initParams.getCookieConsentFunction = this._initParams.getCookieConsentFunction || defaultGetCookieConsentCallback;\n        this._initParams.getCookieDescriptionFunction = this._initParams.getCookieDescriptionFunction || defaultGetCookieDescriptionCallback;\n        this._initParams.getProgressIndicator = this._initParams.getProgressIndicator || createProgressIndicator;\n\n        this._initParams.loadDictionaries = this._initParams.loadDictionaries || async function(player) {\n            addDictionary(\"en\", {\n                \"Hello\": \"Hello\",\n                \"World\": \"World\"\n            });\n\n            addDictionary(\"es\", {\n                \"Hello\": \"Hola\",\n                \"World\": \"Mundo\"\n            });\n\n            setLanguage(navigator.language.substring(0,2));\n        }\n\n        const userPlugins = this._initParams.plugins || [];\n        this._initParams.plugins = [\n            ...userPlugins\n        ]\n\n        setTranslateFunction(this._initParams.translateFunction);\n        setSetLanguageFunction(this._initParams.setLanguageFunction);\n        setGetLanguageFunction(this._initParams.getLanguageFunction);\n        setAddDictionaryFunction(this._initParams.addDictionaryFunction);\n        setGetDictionariesFunction(this._initParams.getDictionariesFunction);\n        setGetDefaultLanguageFunction(this._initParams.getDefaultLanguageFunction);\n\n        this._config = null;\n        this._defaultVideoPreview = \"\";\n        this._defaultVideoPreviewPortrait = \"\";\n        this._videoId = null;\n        this._manifestUrl = null;\n        this._manifestFileUrl = null;\n        this._manifestData = null;\n        this._videoManifest = null;\n\n        // Load status flags\n        this._playerLoaded = false;\n\n        const resize = () => {\n            this.resize();\n        }\n        window.addEventListener(\"resize\", resize);\n        \n        this.containerElement.addEventListener(\"fullscreenchange\", () => {\n            triggerEvent(this, Events.FULLSCREEN_CHANGED, { status: this.isFullscreen });\n            this.isFullscreen ? triggerEvent(this, Events.ENTER_FULLSCREEN) : triggerEvent(this, Events.EXIT_FULLSCREEN);\n        });\n\n        this._playerState = PlayerState.UNLOADED;\n\n        this._customPluginIcons = {};\n    }\n\n    get version() {\n        return this._packageData.version;\n    }\n\n    get pluginModules() {\n        return this.__pluginModules || [];\n    }\n\n    get log() {\n        return this._log;\n    }\n\n    get ready() {\n        return this._playerState === PlayerState.LOADED;\n    }\n\n    get state() {\n        return this._playerState;\n    }\n\n    get stateText() {\n        return PlayerStateNames[this.state];\n    }\n\n    get Events() {\n        return Events;\n    }\n\n    get preferences() {\n        return this._preferences;\n    }\n\n    get skin() {\n        return this._skin;\n    }\n\n    get containsFocus() {\n        return this.containerElement.contains(document.activeElement);\n    }\n\n    translate(word, keys = null) {\n        return translate(word, keys);\n    }\n\n    setLanguage(lang) {\n        setLanguage(lang);\n    }\n\n    getLanguage() {\n        return getLanguage();\n    }\n\n    addDictionary(lang,dict) {\n        addDictionary(lang,dict);\n    }\n\n    getDictionaries() {\n        return getDictionaries();\n    }\n\n    getDefaultLanguage() {\n        return getDefaultLanguage(this);\n    }\n\n    bindEvent(eventName, fn, unregisterOnUnload = true) {\n        bindEvent(this, eventName, data => fn(data), unregisterOnUnload);\n    }\n\n    getShortcuts() {\n        return getShortcuts(this);\n    }\n\n    pauseCaptureShortcuts() {\n        return pauseCaptureShortcuts(this);\n    }\n\n    resumeCaptureShortcuts() {\n        return resumeCaptureShortcuts(this);\n    }\n\n    getPlugin(name, type = null) {\n        if (type) {\n            const plugins = this.__pluginData__.pluginInstances[type];\n            if (plugins) {\n                return plugins.find(p => {\n                    if (p.name === name) {\n                        return p;\n                    }\n                });\n            }\n        }\n        else {\n            const result = {};\n            for (const t in this.__pluginData__.pluginInstances) {\n                const instances = this.__pluginData__.pluginInstances[t];\n                const p = instances.find(p => {\n                    if (p.name === name) {\n                        return p;\n                    }\n                });\n                if (p) {\n                    result[t] = p;\n                }\n            }\n            return result;\n        }\n    }\n\n    get hideUiTime() {\n        return this._hideUiTime;\n    }\n\n    set hideUiTime(val) {\n        this._hideUiTime = val;\n    }\n    \n    get containerSize() { return { w: this._containerElement.offsetWidth, h: this._containerElement.offsetHeight }; }\n    \n    get containerElement() { return this._containerElement; }\n\n    get initParams() { return this._initParams; }\n\n    get cookieConsent() { return this._cookieConsent; }\n\n    // Status flags getters\n    // The configuration is loaded\n    get configLoaded() {\n        return this.configUrl !== null;\n    }\n\n    // The video manifest file is loaded\n    get videoManifestLoaded() {\n        return this.videoManifest !== null;\n    }\n\n    // The video streams are loaded\n    get videoLoaded() {\n        return this.videoContainer?.ready || false;\n    }\n\n    // The player user interface is loaded\n    get playerLoaded() {\n        return this._playerLoaded;\n    }\n\n    get configResourcesUrl() {\n        return this._initParams?.configResourcesUrl || 'config/';\n    }\n    \n    get configUrl() {\n        return this._initParams?.configUrl || 'config/config.json';\n    }\n\n    get config() {\n        return this._config;\n    }\n\n    get defaultVideoPreview() {\n        return this._defaultVideoPreview;\n    }\n\n    get defaultVideoPreviewPortrait() {\n        return this._defaultVideoPreviewPortrait;\n    }\n\n    get videoId() {\n        return this._videoId;\n    }\n\n    // Base URL where the video repository is located, for example \"repository/\"\n    get repositoryUrl() {\n        return this._initParams?.repositoryUrl || this.config?.repositoryUrl || \"\";\n    }\n\n    // Base URL where the video manifest file is located, for example \"repository/[video_id]\"\n    get manifestUrl() {\n        return this._manifestUrl;\n    }\n\n    // Video manifest file name, for example \"data.json\"\n    get manifestFileName() {\n        return this.config?.manifestFileName || this._initParams?.manifestFileName || \"\";\n    }\n\n    // Full path of the video manifest, for example \"repository/[video_id]/data.json\"\n    get manifestFileUrl() {\n        return this._manifestFileUrl;\n    }\n\n    // Video manifest file content (data.json)\n    get videoManifest() {\n        return this._videoManifest;\n    }\n\n    get previewContainer() {\n        return this._previewContainer;\n    }\n\n    get videoContainer() {\n        return this._videoContainer;\n    }\n\n    get playbackBar() {\n        return this._playbackBar;\n    }\n\n    get captionsCanvas() {\n        return this._captionsCanvas;\n    }\n\n    get data() {\n        return this._data;\n    }\n\n    get PlayerState() {\n        return PlayerState;\n    }\n\n    get PlayerStateNames() {\n        return PlayerStateNames;\n    }\n\n    // Manifest query functions\n    get metadata() {\n        return this._manifestParser?.metadata || {};\n    }\n\n    get streams() {\n        return this._manifestParser?.streams || [];\n    }\n\n    get frameList() {\n        return this._manifestParser?.frameList || {};\n    }\n\n    get captions() {\n        return this._manifestParser?.captions || [];\n    }\n\n    get trimming() {\n        return this._manifestParser?.trimming || {};\n    }\n\n    get visibleTimeLine() {\n        return this._manifestParser?.visibleTimeLine || true;\n    }\n\n    waitState(state) {\n        return new Promise((resolve, reject) => {\n            const checkState = () => {\n                if (this.state === state) {\n                    resolve();\n                }\n                else {\n                    setTimeout(checkState, 50);\n                }\n            }\n            if (typeof(state) === 'string') {\n                state = PlayerState[state];\n            }\n            \n            if (state<0 || state>Object.values(PlayerState).length) {\n                reject(Error(`Invalid player state '${state}'`));\n            }\n    \n            checkState();\n        })\n    }\n\n    async loadUrl(url, { title, duration, preview, previewPortrait } = {}) {\n        if (this._playerState !== PlayerState.UNLOADED) {\n            throw new Error(this.translate(\"loadUrl(): Invalid current player state: $1\", [PlayerStateNames[this._playerState]]));\n        }\n        if (this._manifestLoaded) {\n            throw new Error(this.translate(\"loadUrl(): Invalid current player state: $1\", [PlayerStateNames[this._playerState]]));\n        }\n        if (!url) {\n            throw new Error(this.translate(\"loadUrl(): No URL specified.\"));\n        }\n\n        if (!Array.isArray(url)) {\n            url = [url];\n        }\n\n        if (!title) {\n            title = getUrlFileName(url[0]);\n            this.log.warn(\"Paella.loadUrl(): no title specified. Using URL file name as video name.\");\n        }\n\n        try {\n            await preLoadPlayer.apply(this);\n\n            if (!preview && (this.defaultVideoPreview !== \"\" || this.defaultVideoPreviewPortrait !== \"\")) {\n                preview = this.defaultVideoPreview;\n                previewPortrait = this.defaultVideoPreviewPortrait;\n                this.log.warn(\"Paella.loadUrl(): no preview image specified. Using default preview image.\");\n            }\n            else if (!preview && !previewPortrait) {\n                throw new Error(\"Paella.loadUrl(): no preview image specified and no default preview image configured.\");\n            }\n\n            this._videoId = removeExtension(getUrlFileName(url[0]));\n            \n            this._manifestUrl = removeFileName(url[0]);\n            this._manifestFileUrl = url[0];\n\n            this.log.debug(`Loading video with identifier '${this.videoId}' from URL '${this.manifestFileUrl}'`);\n\n            const validContents = getAvailableContentIds(this, url.length)[0];\n            this._videoManifest = {\n                metadata: {\n                    duration,\n                    title,\n                    preview,\n                    previewPortrait\n                },\n\n                streams: url.map((u,i) => {\n                    const sources = getSourceWithUrl(this, u);\n                    return {\n                        sources,\n                        content: validContents[i],\n                        role: i === 0 ? 'mainAudio' : null\n                    };\n                })\n            };\n\n            await postLoadPlayer.apply(this);\n        }\n        catch (err) {\n            this._playerState = PlayerState.ERROR;\n            this.log.error(err);\n            this._errorContainer = new ErrorContainer(this, this.translate(err.message));\n            throw err;\n        }\n    }\n\n    async loadManifest() {\n        if (this._playerState !== PlayerState.UNLOADED) {\n            throw new Error(this.translate(\"loadManifest(): Invalid current player state: $1\", [PlayerStateNames[this._playerState]]));\n        }\n        if (this._manifestLoaded) return;\n\n        try {\n            await preLoadPlayer.apply(this);\n    \n            this._videoId = await this.initParams.getVideoId(this._config, this);\n            if (this.videoId === null) {\n                throw new Error('No video identifier specified');\n            }\n    \n            this._manifestUrl = await this.initParams.getManifestUrl(this.repositoryUrl,this.videoId,this._config,this);\n            \n            this._manifestFileUrl = await this.initParams.getManifestFileUrl(this._manifestUrl, this.manifestFileName,this._config,this);\n    \n            this.log.debug(`Loading video with identifier '${this.videoId}' from URL '${this.manifestFileUrl}'`);\n    \n            this._videoManifest = await this.initParams.loadVideoManifest(this.manifestFileUrl,this._config,this);\n            this._videoManifest.metadata = this._videoManifest.metadata || {};\n            if (!this._videoManifest.metadata.preview && (this.defaultVideoPreview !== \"\" || this.defaultVideoPreviewPortrait !== \"\")) {\n                this._videoManifest.metadata.preview = this.defaultVideoPreview;\n                this._videoManifest.metadata.previewPortrait = this.defaultVideoPreviewPortrait;\n                this.log.warn(\"Paella.loadUrl(): no preview image specified. Using default preview image.\");\n            }\n\n            this._manifestParser = new ManifestParser(this.videoManifest, this);\n    \n            // Load custom icons from skin\n            unloadSkinStyleSheets.apply(this.skin);\n            await loadSkinIcons.apply(this.skin);\n\n            // Load custom style sheets\n            await loadSkinStyleSheets.apply(this.skin);\n\n            await postLoadPlayer.apply(this);\n        }\n        catch (err) {\n            this._playerState = PlayerState.ERROR;\n            this.log.error(err);\n            this._errorContainer = new ErrorContainer(this, this.translate(err.message));\n            throw err;\n        }\n    }\n\n    async loadPlayer() {\n        try {\n            this._captionsCanvas = new CaptionCanvas(this, this._containerElement);\n\n            if (this._playerState !== PlayerState.MANIFEST) {\n                throw new Error(this.translate(\"loadPlayer(): Invalid current player state: $1\", [PlayerStateNames[this._playerState]]));\n            }\n    \n            this._playerState = PlayerState.LOADING_PLAYER;\n    \n            this._previewContainer?.removeFromParent();\n    \n            this._loader = new this.initParams.Loader(this);\n            await this._loader.create();\n    \n            await this.videoContainer.load(this.videoManifest?.streams);\n    \n            triggerEvent(this, Events.STREAM_LOADED);\n            \n            this._playbackBar = new PlaybackBar(this, this.containerElement);\n            \n            await this._playbackBar.load();\n            \n            // UI hide timer\n            this._hideUiTime = this.config.ui?.hideUITimer ?? 5000;\n            setupAutoHideUiTimer(this);\n            \n            this._captionsCanvas.load();\n    \n            this._playerState = PlayerState.LOADED;\n    \n            // Reload the video layout once the playback bar is loaded\n            await this.videoContainer.updateLayout();\n\n            triggerEvent(this, Events.PLAYER_LOADED);\n    \n            const hideTimeLine = !(this.videoManifest.metadata.visibleTimeLine ?? true);\n            if (hideTimeLine) {\n                this.playbackBar.progressIndicator.hideTimeLine();\n            }\n            \n            if (!this._loader.debug) {\n                this._loader.removeFromParent();\n                this._loader = null;\n            }\n                \n        }\n        catch (err) {\n            this._playerState = PlayerState.ERROR;\n            if (this._loader) {\n                this._loader.removeFromParent();\n                this._loader = null;\n            }\n            this._errorContainer = new ErrorContainer(this, err.message);\n            throw err;\n        }\n    }\n\n    async load() {\n        switch (this.state) {\n        case PlayerState.UNLOADED:\n            await this.loadManifest();\n            await this.loadPlayer();\n            break;\n        case PlayerState.MANIFEST:\n            await this.loadPlayer();\n            break;\n        case PlayerState.LOADED:\n            break;\n        default:\n            throw new Error(this.translate(\"Could not load player: state transition in progress: $1\", [PlayerStateNames[this.state]]));\n        }\n    }\n\n    async unload() {\n        switch (this.state) {\n        case PlayerState.UNLOADED:\n            break;\n        case PlayerState.MANIFEST:\n            await this.unloadManifest();\n            break;\n        case PlayerState.LOADED:\n        case PlayerState.ERROR:\n            await this.unloadPlayer();\n            await this.unloadManifest();\n            break;\n        default:\n            throw new Error(this.translate(\"Could not unload player: state transition in progress: $1\", [PlayerStateNames[this.state]]));\n        }\n    }\n    \n    async unloadManifest() {\n        if (this._playerState !== PlayerState.MANIFEST && this._playerState !== PlayerState.ERROR) {\n            throw new Error(this.translate(\"unloadManifest(): Invalid current player state: $1\", [PlayerStateNames[this._playerState]]));\n        }\n        if (this._errorContainer) {\n            this._errorContainer.removeFromParent();\n            this._errorContainer = null;\n        }\n        this._playerState = PlayerState.UNLOADING_MANIFEST;\n        \n        this.log.debug(\"Unloading paella player\");\n        \n        // EventLogPlugin plugins are loaded first, so that all lifecycle events can be captured.\n        await unloadLogEventPlugins(this);\n        \n        await unregisterPlugins(this);\n        \n        this._manifestLoaded = false;\n        this._previewContainer?.removeFromParent();\n        this._preferences = null;\n        this._playerState = PlayerState.UNLOADED;\n\n        // Unload skin style sheets\n        unloadSkinStyleSheets.apply(this.skin);\n    }\n\n    async unloadPlayer() {\n        if (this._playerState !== PlayerState.LOADED && this._playerState !== PlayerState.ERROR) {\n            throw new Error(this.translate(\"unloadManifest(): Invalid current player state: $1\", [PlayerStateNames[this._playerState]]));\n        }\n        if (this._errorContainer) {\n            this._errorContainer.removeFromParent();\n            this._errorContainer = null;\n        }\n        this._playerState = PlayerState.UNLOADING_PLAYER;\n        \n        await this._videoContainer?.unload();\n        this._videoContainer = null;\n        \n        await this._playbackBar?.unload();\n        this._playbackBar = null;\n        \n        this._captionsCanvas?.unload();\n        this._captionsCanvas = null;\n        \n        clearAutoHideTimer(this);\n        \n        triggerEvent(this, Events.PLAYER_UNLOADED);\n        \n        if (this.videoManifest?.metadata?.preview) {\n            buildPreview.apply(this);\n        }\n        \n        unregisterEvents(this);\n        this._playerState = PlayerState.MANIFEST;\n    }\n\n    async reload(onUnloadFn = null) {\n        switch (this.state) {\n        case PlayerState.UNLOADED:\n            break;\n        case PlayerState.MANIFEST:\n            await this.unloadManifest();\n            break;\n        case PlayerState.LOADED:\n            await this.unload();\n            break;\n        }\n        \n        if (typeof(onUnloadFn) === \"function\") {\n            await onUnloadFn();\n        }\n        await this.load();\n    }\n\n    async resize() {\n        this.videoContainer?.updateLayout();\n        this.playbackBar?.onResize();\n\n        if (this.videoContainer) {    \n            const getSize = () => {\n                return {\n                    w: this.videoContainer.element.offsetWidth,\n                    h: this.videoContainer.element.offsetHeight\n                }\n            };\n            triggerEvent(this, Events.RESIZE, { size: getSize() });\n\n            if (this._resizeEndTimer) {\n                clearTimeout(this._resizeEndTimer);\n            }\n\n            this._resizeEndTimer = setTimeout(() => {\n                triggerEvent(this, Events.RESIZE_END, { size: getSize() });\n            }, 1000);\n        }\n    }\n    \n    async hideUserInterface() {\n        if (!(await this.videoContainer?.paused())) {\n            this._uiHidden = true;\n            this.videoContainer?.hideUserInterface();\n            this.playbackBar?.hideUserInterface();\n            triggerEvent(this, Events.HIDE_UI);\n        }\n    }\n    \n    async showUserInterface() {\n        this.videoContainer?.showUserInterface();\n        this.playbackBar?.showUserInterface();\n        this._uiHidden && triggerEvent(this, Events.SHOW_UI);\n        this._uiHidden = false;\n    }\n\n    // Playback functions\n    async play() {\n        if (!this.videoContainer.ready) {\n            await this.loadPlayer();\n        }\n\n        await this.videoContainer.play();\n    }\n\n    async pause() {\n        await this.videoContainer?.pause();\n    }\n\n    async paused() {\n        if (!this.videoContainer) {\n            return true;\n        }\n        else {\n            return this.videoContainer.paused();\n        }\n    }\n\n    async stop() {\n        await this.videoContainer?.stop();\n    }\n    \n    isFullScreenSupported() {\n        return this.containerElement.requestFullscreen ||\n            this.containerElement.webkitRequestFullScreen;\n    }\n    \n    async enterFullscreen() {\n        let result = null;\n        if (this.containerElement.requestFullscreen) {\n            result = this.containerElement.requestFullscreen();\n        }\n        else if (this.containerElement.webkitRequestFullScreen) {\n            this.log.debug(\"Safari enter fullscreen\");\n            result = this.containerElement.webkitRequestFullScreen();\n        }\n        setTimeout(() => this.resize(), 500);\n        return result;\n    } \n\n    async exitFullscreen() {\n        if (document.exitFullscreen && this.isFullscreen) {\n            return document.exitFullscreen();\n        }\n        else if (document.webkitCancelFullScreen && this.isFullscreen) {\n            this.log.debug(\"Safari exit fullscreen\");\n            return document.webkitCancelFullScreen();\n        }\n    }\n    \n    get isFullscreen() {\n        return  document.fullscreenElement === this.containerElement ||\n                document.webkitFullscreenElement === this.containerElement;\n    }\n\n    addCustomPluginIcon(pluginName, iconName, svgData) {\n        this._customPluginIcons[`${pluginName}-${iconName}`] = svgData;\n    }\n\n    removeCustomPluginIcon(pluginName, iconName) {\n        this._customPluginIcons[`${pluginName}-${iconName}`] = null;\n    }\n\n    getCustomPluginIcon(pluginName, iconName) {\n        this._requestedCustomIcons = this._requestedCustomIcons || [];\n        if (!this._requestedCustomIcons.find(item => item.pluginName === pluginName && item.iconName === iconName)) {\n            this._requestedCustomIcons.push({\n                pluginName,\n                iconName\n            });\n        }\n        return this._customPluginIcons[`${pluginName}-${iconName}`];\n    }\n\n    get requestedCustomIcons() {\n        return this._requestedCustomIcons || [];\n    }\n}\n","\nexport default class AudioTrackData {\n    constructor({\n        id, \n        name,\n        groupId = \"\", \n        language = \"\",\n        selected = false\n    }) {\n        this._id = id;\n        this._name = name;\n        this._groupId = groupId;\n        this._lang = language;\n        this._selected = selected;\n    }\n\n    get id() {\n        return this._id;\n    }\n\n    get name() {\n        return this._name;\n    }\n\n    get groupId() {\n        return this._groupId;\n    }\n\n    get language() {\n        return this._lang;\n    }\n\n    get selected() {\n        return this._selected;\n    }\n\n    set selected(s) {\n        this._selected = s;\n    }\n}\n"],"names":["Events","bindEvent","player","events","callback","unregisterOnUnload","event","triggerEvent","params","cbData","triggerIfReady","unregisterEvents","loadSvgIcon","url","resolve","reject","icon","svg","err","getUrlParameter","name","urlParams","getHashParameter","search","joinPath","parts","sep","separator","part","index","isAbsoluteUrl","src","getUrlFileName","removeExtension","ac","v","a","removeFileName","remove","path","result","i","u","getFileExtension","resolveResourcePath","pauseAutoHideUiTimer","resumeAutoHideUiTimer","setupAutoHideUiTimer","hideUiTimePropertyName","_a","hideUserInterface","checkFocus","active","tagName","setupTimer","evt","clearAutoHideTimer","secondsToTime","timestamp","hours","minutes","seconds","timeToSeconds","timeString","timeToMilliseconds","milliseconds","setCookie","cname","cvalue","exdays","d","expires","setCookieIfAllowed","type","getCookie","ca","c","getNumericCookie","rawValue","numValue","getJSONCookie","loadStyle","addToHeader","link","head","unloadStyle","mergeObjects","baseData","extendData","mergeArrays","key","baseVal","extendVal","item","extendItem","sanitizeHTML","html","excludedTags","div","exclude","tag","video","supportsVideoType","canPlay","defaultLoadConfigFunction","configUrl","defaultGetVideoIdFunction","config","defaultGetManifestUrlFunction","repoUrl","videoId","defaultGetManifestFileUrlFunction","manifestUrl","manifestFileName","defaultLoadVideoManifestFunction","videoManifestUrl","response","_player","PlayerResource","__privateAdd","__privateSet","__privateGet","createElement","attributes","children","innerText","parent","createElementWithHtmlText","htmlText","tmpElem","_element","DomClass","showMode","style","value","ProgressIndicatorIcon","Loader","ErrorIcon","ErrorContainer","message","Plugin","VideoPlugin","fileUrls","g_enabledVideoPlugins","loadVideoPlugins","loadPluginsOfType","plugin","unloadVideoPlugins","getVideoPlugins","getVideoPluginWithFileUrl","ext","p","getVideoPlugin","streamData","videoPlugins","isVolumeApiAvailable","audio","resolveTimer","Video","streamProvider","fn","PluginModule","g_pluginModule","PaellaCoreVideoFormats","packageData","getAsyncImage","img","asyncLoadAudio","AudioOnlyVideo","isMainAudio","waitReady","t","pr","previewSrc","fixAspectRatio","parentRatio","imageRatio","AudioVideoPlugin","playerContainer","HtmlVideo","crossorigin","mimetype","source","HtmlVideoPlugin","videoData","getMimeType","VideoQualityItem","label","shortLabel","isAuto","width","height","bitrate","other","updateFrame","frame","f","startTimeUpdate","timerFunc","current","interval","stopTimeUpdate","ImageVideo","q","b","ImageVideoPlugin","Mp4Video","Mp4VideoPlugin","mp4","loadCaptionsPlugins","enabledCaptionsPlugins","captions","captionsCanvas","CaptionsPlugin","Captions","l","lang","start","end","cue","instant","parseDFXP","text","doc","begin","DFXPParser","PaellaCorePlugins","DfxpManifestCaptionsPlugin","fileUrl","fetchResult","parser","UserInterfacePlugin","g_currentLang","g_defaultLanguage","g_dictionaries","defaultTranslateFunction","word","dict","defaultDict","defaultSetLanguageFunction","defaultGetLanguageFunction","defaultAddDictionaryFunction","translation","defaultGetDictionariesFunction","defaultGetDefaultLanguageFunction","g_translateFunc","g_setLanguageFunc","g_getLanguageFunc","g_defaultAddDictionary","g_defaultGetDictionaries","g_defaultGetDefaultLang","translate","keys","translated","temp","setLanguage","getLanguage","addDictionary","getDictionaries","getDefaultLanguage","setTranslateFunction","setSetLanguageFunction","setGetLanguageFunction","setAddDictionaryFunction","setGetDictionariesFunction","setGetDefaultLanguageFunction","setupDefaultLanguage","addButtonPlugin","buttonAreaElem","_b","ariaLabel","description","fixedSizeClass","id","tabIndex","button","addHiddenTimer","clearHideTimer","addHiddenClass","removeHiddenClass","getSideContainer","container","ButtonPluginObserver","prevIcon","newIcon","prevTitle","newTitle","prevText","newText","_leftSideContainer","_rightSideContainer","_updateStateCallbacks","ButtonPlugin","observer","cur","cb","callerContainer","defaultPlayIcon","defaultPauseIcon","defaultReplayIcon","PlayButtonPlugin","playIcon","pauseIcon","replayIcon","titlePlay","TIMESTAMP","CUE_TIMING","re","parseCue","line","lines","cap","j","parseWebVTT","WebVTTParser","VttManifestCaptionsPlugin","CurrentTimeLabelPlugin","updateTitle","currentTime","duration","getValidLayouts","getPluginsOfType","layout","getValidContentIds","validLayouts","lo","getAvailableContentIds","numberOfStreams","cntItem","getLayoutWithContentId","contentId","layouts","getValidContentSettings","validIds","cfg","getLayoutStructure","mainContent","selectedLayout","structure","VideoLayout","contentIds","validContent","sd","validStreams","validStreamCombination","content","videoCanvas","getCanvasButtonPlugin","stream","getCanvasButtons","CanvasButtonPlugin","CanvasButtonPosition","g_enabledCanvasPlugins","loadCanvasPlugins","unloadCanvasPlugins","getCanvasPlugin","addButton","title","className","position","click","btn","addVideoCanvasButton","layoutStructure","canvas","tabIndexStart","externalButtons","buttonElements","btnData","setTabIndex","buttons","b1","b2","b1Left","b2Left","Canvas","CanvasPlugin","videoContainer","PaellaCoreLayouts","defaultIconSwitchSide","defaultIconMaximize","defaultIconClose","defaultIconSideBySide","defaultIconPiP","DualVideoDynamicLayout","iconMaximize","iconSideBySide","iconSwitchSide","defaultIconRotate","iconClose","iconPiP","layoutData","isMinimized","isMaximized","ct1","ct2","ct1Size","ct2Size","cid","iconRotate","defaultIconMinimize","nextLayout","currentLayout","setLayout","DualVideoLayout","layoutIndex","v0","v1","switchLayout","content0","content1","pipLeft","pipRight","DualVideoPiPLayout","availableContentIds","dualVideoContentId","tmp","SingleVideoLayout","sideBySideIcon","SingleVideoDynamicLayout","getLayout","TripleVideoLayout","v2","AudioCanvas","AudioCanvasPlugin","VideoCanvas","VideoCanvasPlugin","DataPlugin","Data","ctx","context","data","PaellaCoreDataPlugins","CookieDataPlugin","keyParams","LocalStorageDataPlugin","paellaPlugins","PlayPauseButtonPlugin","PopUpButtonPlugin","caller","clickOutside","closeButton","child","popUp","titleElement","iconElement","stateTextElement","stateIconElement","stateElem","getMenuItem","itemData","buttonType","allItems","menuName","selectedItems","itemPlugin","showTitle","stateText","stateIcon","isSelected","captureEvent","prev","nextFocus","currentItem","MenuButtonPlugin","currentActiveElementId","menuItems","itemElems","arr","next","ButtonGroupPlugin","createPluginInstance","PluginClass","staticConfig","instance","importPlugin","pluginClass","pluginInstance","overwrite","currentInstance","registeredPlugin","pluginModule","module","version","importSinglePlugin","pluginData","importPlugins","pluginName","ModuleClass","moduleInstance","registerPlugins","buttonGroups","unregisterPlugins","onLoad","onPreload","dictionaries","unloadPluginsOfType","checkManifestIntegrity","manifest","check","field","error","SteramProvider","mainAudioContent","s","canvasPlugin","videoPlugin","_c","enabled","setupSyncTimer","maxSync","secPlayer","playerTime","trimmedCurrentTime","fnName","res","innerResolve","r","prevTime","returnValue","newTime","acc","val","rate","referenceQualities","quality","qualities","total","qualityFactor","streamQualities","qualityIndex","selectedQuality","track","VideoContainerMessagePosition","createMessageContainer","timeout","cssClass","VideoContainerMessage","PlayerState","getSourceWithUrl","getContainerBaseSize","enableVideos","isPresent","hideAllVideoPlayers","updateLayoutStatic","baseSize","wFactor","hFactor","videoAspectRatio","difference","resultRect","videoRect","aspectRatioData","rectAspectRatio","prevButtons","buttonData","updateLayoutDynamic","_d","_e","_f","videoContainerWidth","videoContainerHeight","isLandscape","videoCanvasAlign","canvasElements","e","maxWidth","maxHeight","videoWidth","videoHeight","landscapeContainer","VideoContainer","baseVideoRectClass","StreamProvider","layoutId","global","prevLayout","_g","_h","_i","_j","leftSideButtons","rightSideButtons","storedVolume","playbackRate","lastKnownTime","saveCurrentTime","time","remainingSeconds","ignorePlayerState","status","layoutPlugin","hideFunc","showFunc","target","element","rect","zIndex","PlayIcon","g_style","g_imgStyle","g_iconContainerStyle","g_iconStyle","g_buttonStyle","PreviewContainer","parentElement","backgroundImage","backgroundImagePortrait","mustCheckOrientation","checkOrientation","aspectRatio","landscapeElements","portraitElements","buildSectionContainer","section","g_popUpId","getPopUpId","_playbackBar","_content","_title","PlaybackBarPopUp","playbackBar","attachLeft","attachRight","currentContent","parentId","clickEvent","_popUp","_playbackBarContainer","_topContainer","_navContainer","_buttonPluginsLeft","_centerContainer","_buttonPluginsRight","_progressIndicator","_enabled","_enabledPlugins","PlaybackBar","inlineMode","createProgressIndicator","precision","frameData","allFrames","nextFrame","frameDuration","newDuration","containerSize","containerSizeClasses","getContainerSizeClass","size","CaptionCanvas","timeChanged","sizeClass","searchOptions","requestedCaptions","language","loadLogEventPlugins","unloadLogEventPlugins","EventLogPlugin","defaultGetCookieConsentCallback","defaultGetCookieDescriptionCallback","cookieObject","CookieConsent","initCallbacks","consentObject","consentElement","object","createTimeLinePreview","image","previewBox","alt","txt","normalizedX","elapsed","remaining","range","timeLinePreviewContainer","timeLinePreview","seeking","onChangeCallback","markers","getMarker","marker","progressIndicator","currentMarker","currentIndex","prevMarker","frameList","normalizedPosition","utils.secondsToTime","seekSeconds","LOG_LEVEL","g_globalLogLevel","setLogLevel","level","currentLogLevel","printMessage","msg","log","Log","defaultDictionaries","g_defaultPreferences","load","save","Preferences","currentSource","sources","overrideSkinConfig","checkLoadSkinStyleSheets","css","cssPath","loadSkinStyleSheets","unloadSkinStyleSheets","checkLoadSkinIcons","identifier","iconFullUrl","loadSkinIcons","req","iconData","Skin","skinParam","ManifestParser","manifestData","getNativeSource","hls","canvasTypes","streams","ignoreTrimming","PlayerStateNames","buildPreview","preview","previewPortrait","preLoadPlayer","urlSearch","caseInsensitiveParams","urlParamLogLevel","logLevel","postLoadPlayer","Paella","containerElement","initParams","userPlugins","resize","eventName","plugins","state","checkState","validContents","onUnloadFn","getSize","iconName","svgData","AudioTrackData","groupId","selected"],"mappings":";;;;;AACA,MAAeA,IAAA,OAAO,OAAO;AAAA,EAC5B,MAAM;AAAA,EACN,OAAO;AAAA,EACP,MAAM;AAAA,EACN,OAAO;AAAA,EACP,MAAM;AAAA,EACN,oBAAoB;AAAA,EACpB,kBAAkB;AAAA,EAClB,iBAAiB;AAAA,EACjB,gBAAgB;AAAA,EAChB,YAAY;AAAA,EACZ,kBAAkB;AAAA,EAClB,kBAAkB;AAAA,EAClB,kBAAkB;AAAA,EAClB,mBAAmB;AAAA,EACnB,cAAc;AAAA,EACd,YAAY;AAAA,EACZ,YAAY;AAAA,EACZ,iBAAiB;AAAA,EACjB,eAAe;AAAA,EACf,eAAe;AAAA,EACf,iBAAiB;AAAA,EACjB,QAAQ;AAAA,EACR,YAAY;AAAA,EACZ,gBAAgB;AAAA,EAChB,uBAAuB;AAAA,EACvB,uBAAuB;AAAA,EACvB,SAAS;AAAA,EACT,SAAS;AAAA,EACT,wBAAwB;AAAA,EACxB,KAAK;AACN,CAAC;AAEM,SAASC,EAAUC,GAAQC,GAAQC,GAAUC,IAAqB,IAAM;AAC9E,SAAAH,EAAO,qBAAqBA,EAAO,sBAAsB,CAAE,GACtD,MAAM,QAAQC,CAAM,MACxBA,IAAS,CAACA,CAAM,IAEjBA,EAAO,QAAQ,CAAAG,MAAS;AACvB,IAAAJ,EAAO,mBAAmBI,CAAK,IAAIJ,EAAO,mBAAmBI,CAAK,KAAK,CAAE,GACzEJ,EAAO,mBAAmBI,CAAK,EAAE,KAAK;AAAA,MACrC,UAAAF;AAAA,MACA,oBAAAC;AAAA,IACH,CAAG;AAAA,EACD,CAAA,GACMD;AACR;AAEO,SAASG,EAAaL,GAAQI,GAAOE,IAAS,CAAA,GAAI;AACxD,EAAAN,EAAO,sBACPA,EAAO,mBAAmBI,CAAK,KAC/BJ,EAAO,mBAAmBI,CAAK,EAAE,QAAQ,CAAAG,MAAUA,EAAO,SAASD,CAAM,CAAC;AAC3E;AAEO,SAASE,GAAeR,GAAQI,GAAOE,IAAS,CAAA,GAAI;AAC1D,EAAIN,EAAO,SACVK,EAAaL,GAAQI,GAAOE,CAAM;AAEpC;AAEO,SAASG,GAAiBT,GAAQ;AACxC,MAAKA,EAAO;AAIZ,eAAWI,KAASJ,EAAO;AAC1B,MAAAA,EAAO,mBAAmBI,CAAK,IAAIJ,EAAO,mBAAmBI,CAAK,EAAE,OAAO,CAAAG,MAAUA,EAAO,sBAAsB,EAAK,GACvHP,EAAO,IAAI,MAAM,uBAAuBA,EAAO,mBAAmBI,CAAK,CAAC;AAE1E;ACnEO,SAASM,GAAYC,GAAK;AAC7B,SAAO,IAAI,QAAQ,CAACC,GAAQC,MAAW;AACnC,UAAMF,CAAG,EACJ,KAAK,CAACG,MACIA,EAAK,KAAI,CACnB,EACA,KAAK,CAAAC,MAAO;AACT,MAAAH,EAAQG,CAAG;AAAA,IACd,CAAA,EACA,MAAM,CAAAC,MAAOH,EAAOG,CAAG,CAAC;AAAA,EAChC,CAAA;AACL;AAEO,SAASC,GAAgBC,GAAM;AAClC,QAAMC,IAAY,IAAI,gBAAgB,OAAO,SAAS,MAAM;AAC5D,SAAOA,EAAU,IAAID,CAAI,IAAIC,EAAU,IAAID,CAAI,IAAI;AACvD;AAEO,SAASE,GAAiBF,GAAM;AACnC,QAAMG,IAAS,OAAO,SAAS,KAAK,QAAQ,KAAI,GAAG,GAC7CF,IAAY,IAAI,gBAAgBE,CAAM;AAC5C,SAAOF,EAAU,IAAID,CAAI,IAAIC,EAAU,IAAID,CAAI,IAAI;AACvD;AAEO,SAASI,EAASC,GAAOC,GAAI;AAChC,QAAMC,IAAYD,KAAO;AACzB,SAAAD,IAAQA,EAAM,IAAI,CAACG,GAAMC,OACjBA,MACAD,IAAOA,EAAK,QAAQ,IAAI,OAAO,MAAMD,CAAS,GAAG,EAAE,IAEnDE,MAAUJ,EAAM,SAAS,MACzBG,IAAOA,EAAK,QAAQ,IAAI,OAAOD,IAAY,GAAG,GAAG,EAAE,IAEhDC,EACV,GACMH,EAAM,KAAKE,CAAS;AAC/B;AAEO,SAASG,GAAcC,GAAK;AAE/B,SAAO,IAAI,OAAO,mBAAmB,GAAG,EAAE,KAAKA,CAAG,KAAK,MAAM,KAAKA,CAAG;AACzE;AAEO,SAASC,GAAenB,GAAK;AAChC,MAAI;AACA,WAAO,IAAI,IAAIA,CAAG,EAAE,SAAS,MAAM,GAAG,EAAE,IAAK;AAAA,EACrD,QACc;AACN,WAAOA,EAAI,MAAM,GAAG,EAAE,IAAK;AAAA,EACnC;AACA;AAEO,SAASoB,GAAgBpB,GAAK;AACjC,SAAOA,EAAI,MAAM,GAAG,EAAE,OAAO,CAACqB,GAAGC,GAAE,GAAEC,MAAM,IAAEA,EAAE,SAAO,IAAKF,MAAO,KAAK,GAAGA,CAAE,IAAIC,CAAC,KAAKA,IAAKD,GAAI,EAAE;AACrG;AAEO,SAASG,GAAexB,GAAK;AAChC,QAAMyB,IAAS,CAACC,MAAS;AACrB,UAAMC,IAASD,EAAK,MAAM,GAAG,EAAE,OAAO,CAACL,GAAGC,GAAEM,GAAEL,MAAMK,IAAEL,EAAE,SAAO,IAAKF,MAAO,KAAK,GAAGA,CAAE,IAAIC,CAAC,KAAKA,IAAKD,GAAI,EAAE;AAC1G,YAAQK,EAAK,CAAC,MAAM,MAAM,IAAIC,CAAM,KAAKA,KAAU;AAAA,EAC3D;AAEI,MAAI;AACA,UAAME,IAAI,IAAI,IAAI7B,CAAG;AACrB,WAAO6B,EAAE,SAASJ,EAAOI,EAAE,QAAQ;AAAA,EAC3C,QACc;AACN,WAAOJ,EAAOzB,CAAG;AAAA,EACzB;AACA;AAEO,SAAS8B,GAAiB9B,GAAK;AAElC,SADamB,GAAenB,CAAG,EACnB,MAAM,GAAG,EAAE,IAAK;AAChC;AAIO,SAAS+B,EAAoB1C,GAAO6B,GAAK;AAC5C,SAAID,GAAcC,CAAG,IACVA,IAGAP,EAAS,CAACtB,EAAO,aAAa6B,CAAG,CAAC;AAEjD;AAEO,SAASc,GAAqB3C,GAAQ;AACzC,EAAAA,EAAO,sBAAsB;AACjC;AAEO,SAAS4C,GAAsB5C,GAAQ;AAC1C,EAAAA,EAAO,sBAAsB;AACjC;AAEO,SAAS6C,GAAqB7C,GAAQ8C,IAAyB,cAAc;ADjGpF,MAAAC;ACkGI,EAAA/C,EAAO,gBAAgB;AAEvB,QAAMgD,IAAoB,YAElBhD,EAAO,uBACPA,EAAO,IAAI,MAAM,qDAAqD,GAE/D,MAEFiD,EAAU,KACfjD,EAAO,IAAI,MAAM,kDAAkD,GAE5D,OAEX,MAAMA,EAAO,kBAAmB,GACzB;AAIX,GAAI+C,IAAA/C,EAAO,OAAO,OAAd,QAAA+C,EAAkB,oBAClB/C,EAAO,iBAAiB,iBAAiB,cAAc,MAAM;AACzD,IAAAgD,EAAmB;AAAA,EAC/B,CAAS;AAGL,QAAMC,IAAa,MAAM;AACrB,UAAMC,IAAS,SAAS;AACxB,YAASlD,EAAO,YAAY,QAAQ,SAASkD,CAAM,KAC3ClD,EAAO,eAAe,QAAQ,SAASkD,CAAM,MAC7C;AAAA,MACI;AAAA,MACA;AAAA,MACA;AAAA,IACpB,EAAkB,KAAK,CAAAC,MAAWD,EAAO,QAAQ,YAAYC,CAAO,CAAC,MAAM;AAAA,EAC3E,GAEUC,IAAa,YAAY;AAC3B,IAAIpD,EAAO,iBACP,aAAaA,EAAO,aAAa,GAErC,MAAMA,EAAO,kBAAmB,GAChCA,EAAO,gBAAgB,WAAW,YAAY;AAC1C,MAAAA,EAAO,gBAAgB,MAClBgD,EAAiB,KAClBI,EAAY;AAAA,IAE5B,GAAWpD,EAAO8C,CAAsB,CAAC;AAAA,EACzC;AAEI,EAAA9C,EAAO,iBAAiB,iBAAiB,aAAa,OAAOqD,MAAQ;AACjE,IAAAD,EAAY;AAAA,EACpB,CAAK,GAEDrD,EAAUC,GAAQF,EAAO,MAAM,YAAY;AACvC,IAAAsD,EAAY;AAAA,EACpB,CAAK,GAEDrD,EAAUC,GAAQF,EAAO,OAAO,YAAY;AACxC,UAAME,EAAO,kBAAmB;AAAA,EACxC,CAAK,GAEDD,EAAUC,GAAQF,EAAO,OAAO,YAAY;AACxC,UAAME,EAAO,kBAAmB;AAAA,EACxC,CAAK,GAED,SAAS,iBAAiB,WAAW,YAAW;AAC5C,IAAAoD,EAAY;AAAA,EACpB,CAAK;AAKL;AAEO,SAASE,GAAmBtD,GAAQ;AACvC,EAAIA,EAAO,kBACP,aAAaA,EAAO,aAAa,GACjC,OAAOA,EAAO;AAEtB;AAEO,SAASuD,GAAcC,GAAW;AACrC,QAAMC,IAAQ,KAAK,MAAMD,IAAY,KAAK,EAAE,GACtCE,IAAU,KAAK,MAAMF,IAAY,EAAE,IAAIC,IAAQ,IAC/CE,IAAU,KAAK,MAAMH,IAAY,EAAE;AACzC,UAASC,IAAM,IAAIA,EAAM,SAAQ,EAAG,SAAS,GAAE,GAAG,IAAI,MAAM,MACpDC,EAAQ,SAAQ,EAAG,SAAS,GAAE,GAAG,IAAI,MACrCC,EAAQ,SAAU,EAAC,SAAS,GAAE,GAAG;AAC7C;AAEO,SAASC,GAAcC,GAAY;AAEtC,QAAMvB,IADK,uCACO,KAAKuB,CAAU;AACjC,MAAIvB,GAAQ;AACR,UAAMmB,IAAQnB,EAAO,CAAC,MAAM,SAAY,OAAOA,EAAO,CAAC,CAAC,IAAI,GACtDoB,IAAU,OAAOpB,EAAO,CAAC,CAAC,GAC1BqB,IAAU,OAAOrB,EAAO,CAAC,CAAC;AAChC,WAAOmB,IAAQ,OAAOC,IAAU,KAAKC;AAAA,EAC7C;AACI,SAAO;AACX;AAEO,SAASG,GAAmBD,GAAY;AAE3C,QAAMvB,IADK,uCACO,KAAKuB,CAAU;AACjC,MAAIvB,GAAQ;AACR,UAAMmB,IAAQnB,EAAO,CAAC,MAAM,SAAY,OAAOA,EAAO,CAAC,CAAC,IAAI,GACtDoB,IAAU,OAAOpB,EAAO,CAAC,CAAC,GAC1BqB,IAAU,OAAOrB,EAAO,CAAC,CAAC,GAC1ByB,IAAezB,EAAO,CAAC,KAAK,OAAOA,EAAO,CAAC,CAAC,KAAK;AACvD,WAAOmB,IAAQ,OAAUC,IAAU,MAAQC,IAAU,MAAOI;AAAA,EACpE;AACI,SAAO;AACX;AAEO,SAASC,GAAUC,GAAOC,GAAQC,IAAS,KAAK;AACnD,MAAIC,IAAI,oBAAI,KAAM;AAClB,EAAAA,EAAE,QAAQA,EAAE,QAAS,IAAID,IAAS,KAAK,KAAK,KAAK,GAAK;AACtD,MAAIE,IAAU,WAAWD,EAAE,YAAa,CAAA;AACxC,WAAS,SAAS,GAAIH,CAAO,IAAIC,CAAQ,IAAIG,CAAO,4BAA4B,QAAQ,KAAK,UAAU,MAAM,IAAI,KAAK;AAC1H;AAEO,SAASC,GAAmBtE,GAAQuE,GAAMN,GAAOC,GAAQC,IAAS,KAAK;AAC1E,EAAInE,EAAO,cAAc,kBAAkBuE,CAAI,KAC3CP,GAAUC,GAAOC,GAAQC,CAAM;AAEvC;AAEO,SAASK,EAAUP,GAAO;AAC7B,MAAI/C,IAAO+C,IAAQ,KAEfQ,IADgB,mBAAmB,SAAS,MAAM,EAC/B,MAAM,GAAG;AAChC,WAAQlC,IAAI,GAAGA,IAAGkC,EAAG,QAAQ,EAAElC,GAAG;AAChC,QAAImC,IAAID,EAAGlC,CAAC;AACZ,WAAOmC,EAAE,OAAO,CAAC,KAAK;AACpB,MAAAA,IAAIA,EAAE,UAAU,CAAC;AAEnB,QAAIA,EAAE,QAAQxD,CAAI,KAAK;AACrB,aAAOwD,EAAE,UAAUxD,EAAK,QAAQwD,EAAE,MAAM;AAAA,EAEhD;AACI,SAAO;AACX;AAEO,SAASC,GAAiBV,GAAO;AACpC,QAAMW,IAAWJ,EAAUP,CAAK,GAC1BY,IAAW,OAAOD,CAAQ;AAChC,SAAQA,MAAa,MAAM,CAAC,MAAMC,CAAQ,IAAKA,IAAW;AAC9D;AAEO,SAASC,GAAcb,GAAO;AACjC,MAAI;AACA,WAAO,KAAK,MAAMO,EAAUP,CAAK,CAAC;AAAA,EAC1C,QACgB;AACR,WAAO;AAAA,EACf;AACA;AAEO,SAASc,GAAUpE,GAAKqE,IAAc,IAAM;AAC/C,SAAO,IAAI,QAAQ,CAAApE,MAAW;AAC1B,UAAMqE,IAAO,SAAS,cAAc,MAAM;AAC1C,IAAAA,EAAK,aAAa,OAAM,YAAY,GACpCA,EAAK,aAAa,QAAOtE,CAAG,GAC5BsE,EAAK,SAAS,MAAMrE,EAAQqE,CAAI;AAChC,UAAMC,IAAO,SAAS,qBAAqB,MAAM,EAAE,CAAC;AACpD,IAAIF,KACAE,EAAK,YAAYD,CAAI,GAEzBrE,EAAS;AAAA,EACjB,CAAK;AACL;AAEO,SAASuE,GAAYF,GAAM;AAE9B,EADa,SAAS,qBAAqB,MAAM,EAAE,CAAC,EAC/C,YAAYA,CAAI;AACzB;AAEO,SAASG,GAAaC,GAAUC,GAAYC,IAAc,IAAM;AACnE,aAAWC,KAAOF,GAAY;AAC1B,UAAMG,IAAUJ,EAASG,CAAG;AAC5B,QAAIE,IAAYJ,EAAWE,CAAG;AAE9B,IAAID,KAAe,MAAM,QAAQE,CAAO,KAAK,MAAM,QAAQC,CAAS,KAEhED,EAAQ,QAAQ,CAAAE,MAAQ;AACpB,MAAAD,IAAYA,EAAU,OAAO,CAAAE,MACrB,OAAOD,KAAU,YACjB,OAAOC,KAAgB,YACvBD,EAAK,OAAOC,EAAW,MAEvBR,GAAaO,GAAMC,GAAYL,CAAW,GACnC,MAEJ,EACV;AAAA,IACjB,CAAa,GAGDG,EAAU,QAAQ,CAAAE,MAAc;AAC5B,MAAAH,EAAQ,KAAKG,CAAU;AAAA,IACvC,CAAa,KAEI,OAAOH,KAAY,YAAYC,IACpCN,GAAaK,GAASC,GAAWH,CAAW,IAG5CF,EAASG,CAAG,IAAIF,EAAWE,CAAG;AAAA,EAE1C;AACA;AAEO,SAASK,GAAaC,GAAM,EAAE,cAAAC,IAAe,KAAI,IAAK,CAAA,GAAI;AAC7D,QAAMC,IAAM,SAAS,cAAc,KAAK;AACxC,EAAAA,EAAI,YAAYF;AAEhB,QAAMG,IAAU,CAAC,QAAQ;AACzB,SAAIF,KACAE,EAAQ,KAAK,GAAGF,CAAY,GAGhCE,EAAQ,QAAQ,CAAAC,MAAO,MAAM,KAAKF,EAAI,qBAAqBE,CAAG,CAAC,CAAC,EAC3D,QAAQ,CAAAA,MAAO;AAEZ,IADeA,EAAI,cACZ,YAAYA,CAAG;AAAA,EAClC,CAAS,GAEEF,EAAI;AACf;AAEA,IAAIG,KAAQ;AAEL,SAASC,GAAkB7B,GAAM;AACpC,MAAI,CAACA,EAAM,QAAO;AAClB,EAAK4B,OACDA,KAAQ,SAAS,cAAc,OAAO;AAG1C,MAAIE,IAAUF,GAAM,YAAY5B,CAAI;AACpC,MAAI8B,MAAY,WAAWA,MAAY;AACnC,WAAO;AAEN,MAAI,cAAc,KAAK9B,CAAI;AAC5B,WAAA8B,IAAUF,GAAM,YAAY,WAAW,GAChCE,MAAY,WAAWA,MAAY;AAElD;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACvVO,eAAeC,GAA0BC,GAAUvG,GAAQ;AAC9D,SAAAA,EAAO,IAAI,MAAM,+CAA+C,IAC/C,MAAM,MAAMuG,CAAS,GACtB,KAAM;AAC1B;AAEO,eAAeC,GAA0BC,GAAQzG,GAAQ;AAC5D,SAAAA,EAAO,IAAI,MAAM,mCAAmC,GAC7CoB,GAAiB,IAAI,KAAKH,GAAgB,IAAI,KAAKwF,EAAO;AACrE;AAEO,eAAeC,GAA8BC,GAAQC,GAAQH,GAAOzG,GAAQ;AAC/E,SAAAA,EAAO,IAAI,MAAM,uCAAuC,GACjDsB,EAAS,CAACqF,GAAQC,CAAO,CAAC;AACrC;AAEO,eAAeC,GAAkCC,GAAYC,GAAiBN,GAAOzG,GAAQ;AAChG,SAAAA,EAAO,IAAI,MAAM,2CAA2C,GACrDsB,EAAS,CAACwF,GAAYC,CAAgB,CAAC;AAClD;AAEO,eAAeC,GAAiCC,GAAiBR,GAAOzG,GAAQ;AACnF,EAAAA,EAAO,IAAI,MAAM,0CAA0C;AAC3D,QAAMkH,IAAW,MAAM,MAAMD,CAAgB;AAC7C,MAAIC,EAAS;AACT,WAAO,MAAMA,EAAS,KAAM;AAG5B,QAAM,IAAI,MAAMlH,EAAO,UAAU,uCAAuC,CAACkH,EAAS,QAAQA,EAAS,UAAU,CAAC,CAAC;AAEvH;AF/BA,IAAAC;AGAe,MAAMC,GAAe;AAAA,EAIhC,YAAYpH,GAAQ;AAFpB,IAAAqH,EAAA,MAAAF,IAAU;AAGN,IAAAG,EAAA,MAAKH,IAAUnH;AAAA,EACvB;AAAA,EAEI,IAAI,SAAS;AAAE,WAAOuH,EAAA,MAAKJ;AAAA,EAAQ;AACvC;AAPIA,KAAA;ACAG,SAASK,GAAc,EAAC,KAAAtB,IAAI,OAAM,YAAAuB,IAAW,CAAE,GAAC,UAAAC,IAAS,IAAG,WAAAC,IAAU,IAAG,QAAAC,IAAO,KAAI,GAAG;AAC1F,QAAMtF,IAAS,SAAS,cAAc4D,CAAG;AACzC,EAAA5D,EAAO,YAAYqF;AACnB,WAASnC,KAAOiC;AACZ,IAAAnF,EAAO,aAAakD,GAAIiC,EAAWjC,CAAG,CAAC;AAE3C,SAAAlD,EAAO,YAAYoF,GACfE,KACAA,EAAO,YAAYtF,CAAM,GAEtBA;AACX;AAEO,SAASuF,EAA0BC,GAASF,IAAS,MAAM;AAC9D,QAAMG,IAAU,SAAS,cAAc,KAAK;AAC5C,EAAAA,EAAQ,YAAYD;AACpB,QAAMxF,IAASyF,EAAQ,SAAS,CAAC;AACjC,SAAIH,KACAA,EAAO,YAAYtF,CAAM,GAEtBA;AACX;AJvBA,IAAA0F;AIyBO,MAAMC,UAAiBb,GAAe;AAAA,EAGzC,YAAYpH,GAAQ,EAAC,KAAAkG,IAAI,OAAM,YAAAuB,IAAW,CAAE,GAAC,UAAAC,IAAS,IAAG,QAAAE,IAAO,KAAI,GAAG;AACnE,UAAM5H,CAAM;AAHhB,IAAAqH,EAAA,MAAAW,GAAW;AAIP,IAAAV,EAAA,MAAKU,GAAWR,GAAc,EAAC,KAAAtB,GAAI,YAAAuB,GAAW,UAAAC,GAAS,QAAAE,EAAM,CAAC,IAG9D,OAAO,eAAe,MAAM1B,GAAK;AAAA,MAC7B,KAAK,MAAMqB,EAAA,MAAKS;AAAA,IAC5B,CAAS;AAAA,EACT;AAAA,EAEI,IAAI,UAAU;AACV,WAAOT,EAAA,MAAKS;AAAA,EACpB;AAAA,EAEI,IAAI,SAAS;AACT,WAAOT,EAAA,MAAKS,GAAS;AAAA,EAC7B;AAAA,EAEI,OAAO;AACH,SAAK,QAAQ,MAAM,UAAU;AAAA,EACrC;AAAA,EAEI,KAAKE,IAAW,SAAS;AACrB,SAAK,QAAQ,MAAM,UAAU;AAAA,EACrC;AAAA,EAEI,IAAI,YAAY;AACZ,UAAMC,IAAQ,OAAO,iBAAiB,KAAK,OAAO;AAClD,WAAQA,EAAM,YAAY,UAClBA,EAAM,YAAY;AAAA,EAClC;AAAA,EAEI,aAAajH,GAAKkH,GAAO;AACrB,IAAAb,EAAA,MAAKS,GAAS,aAAa9G,GAAKkH,CAAK;AAAA,EAC7C;AAAA,EAEI,mBAAmB;AJhEvB,QAAArF;AIiEQ,KAAAA,IAAAwE,EAAA,MAAKS,GAAS,kBAAd,QAAAjF,EAA6B,YAAYwE,EAAA,MAAKS;AAAA,EACtD;AAAA,EAEI,UAAUJ,GAAQ;AACd,SAAK,iBAAkB,GACvBA,EAAO,YAAYL,EAAA,MAAKS,EAAQ;AAAA,EACxC;AACA;AA9CIA,IAAA;AC3BJ,MAAAK,KAAe;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;ACMA,MAAMC,WAAeL,EAAS;AAAA,EACzC,YAAYjI,GAAQ;AAChB,UAAMA,GAAQ,EAAE,QAAQA,EAAO,iBAAgB,CAAE,GAEjD,KAAK,QAAQ,YAAY;AAAA,EACjC;AAAA,EAEI,MAAM,SAAS;AACX,IAAA6H,EAA0B,MAAMQ,EAAqB,QAAQ,KAAK,OAAO;AAAA,EACjF;AAAA,EAEI,IAAI,QAAQ;AACR,WAAO;AAAA,EACf;AACA;ACpBA,MAAAE,KAAe;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;ACOA,MAAMC,WAAuBP,EAAS;AAAA,EACjD,YAAYjI,GAAQyI,IAAU,IAAI;AAC9B,UAAMzI,GAAQ,EAAE,QAAQA,EAAO,iBAAgB,CAAE,GAEjD,KAAK,QAAQ,YAAY,mBAEzB6H,EAA0B;AAAA;AAAA,qBAEbU,EAAS;AAAA,qBACTE,CAAO;AAAA,qBACP,KAAK,OAAO;AAAA,EACjC;AACA;ACjBe,MAAMC,WAAetB,GAAe;AAAA,EAC/C,YAAYpH,GAAQkB,GAAM;AACtB,UAAMlB,CAAM,GACZ,KAAK,QAAQkB;AAAA,EACrB;AAAA,EAEI,0BAA0B;AACtB,WAAO;AAAA,EACf;AAAA,EAEI,IAAI,SAAS;AAAE,WAAO,KAAK;AAAA,EAAQ;AAAA,EAEnC,IAAI,OAAO;AAAE,WAAO;AAAA,EAAO;AAAA,EAE3B,IAAI,QAAQ;ATfhB,QAAA6B;ASekB,aAAOA,IAAA,KAAK,YAAL,gBAAAA,EAAc,UAAS;AAAA,EAAE;AAAA,EAE9C,IAAI,cAAc;ATjBtB,QAAAA;ASiBwB,aAAOA,IAAA,KAAK,YAAL,gBAAAA,EAAc,gBAAe;AAAA,EAAG;AAAA,EAE3D,IAAI,OAAO;AAAE,WAAO,KAAK;AAAA,EAAM;AAAA,EAE/B,MAAM,YAAY;ATrBtB,QAAAA;ASsBQ,YAAOA,IAAA,KAAK,WAAL,gBAAAA,EAAa;AAAA,EAC5B;AAAA,EAEI,MAAM,OAAO;AAAA,EAEjB;AAAA,EAEI,MAAM,SAAS;AAAA,EAEnB;AACA;AC3Be,MAAM4F,WAAoBD,GAAO;AAAA,EAC5C,IAAI,OAAO;AAAE,WAAO;AAAA,EAAQ;AAAA,EAE5B,IAAI,aAAa;AAAE,WAAO;AAAA,EAAM;AAAA,EAEhC,MAAM,eAA+B;AACjC,WAAO;AAAA,EACf;AAAA,EAEI,MAAM,mBAAmD;AACrD,WAAO;AAAA,EACf;AAAA,EAEI,8BAA8B;AAC1B,WAAO,CAAE;AAAA,EACjB;AAAA,EAEI,gBAAgBE,GAAU;AAAA,EAE9B;AACA;AAEA,MAAMC,KAAwB,CAAE;AAEzB,eAAeC,GAAiB9I,GAAQ;AAC3C,QAAM+I,EAAkB/I,GAAQ,SAAS,CAACgJ,MAAW;AACjD,IAAAH,GAAsB,KAAKG,CAAM;AAAA,EACzC,CAAK;AACL;AAEO,eAAeC,GAAmBjJ,GAAQ;AAC7C,EAAA6I,GAAsB,MAAM,CAAC;AACjC;AAEO,SAASK,GAAgBlJ,GAAQ;AACpC,MAAI6I,GAAsB,WAAW;AACjC,UAAM,MAAM,6GAA6G;AAE7H,SAAOA;AACX;AAEO,SAASM,GAA0BnJ,GAAQW,GAAK;AACnD,QAAMyI,IAAM3G,GAAiB9B,CAAG;AAEhC,SADqBuI,GAAsB,EACvB,KAAK,CAAAG,MACVA,EAAE,4BAA2B,EAAG,QAAQD,CAAG,MAAM,EAC3D;AACT;AAEO,eAAeE,GAAetJ,GAAQuJ,GAAY;AACrD,QAAMC,IAAeN,GAAsB;AAC3C,MAAIF,IAAS;AAEb,aAAWK,KAAKG;AACZ,QAAI,MAAMH,EAAE,aAAaE,CAAU,GAAG;AAClC,MAAAP,IAASK;AACT;AAAA,IACZ;AAGI,SAAOL;AACX;AAEO,eAAeS,KAAuB;AAUzC,SATc,MAAO,IAAI,QAAQ,CAAA7I,MAAW;AACxC,UAAM8I,IAAQ,SAAS,cAAc,OAAO,GACtCC,IAAe,WAAW,MAAM/I,EAAQ,EAAK,GAAG,GAAG;AACzD,IAAA8I,EAAM,iBAAiB,gBAAgB,CAAArG,MAAO;AAC1C,mBAAasG,CAAY,GACzB/I,EAAQ,EAAI;AAAA,IACxB,CAAS,GACD8I,EAAM,SAAS;AAAA,EACvB,CAAK;AAEL;AAEO,MAAME,WAAc3B,EAAS;AAAA,EAChC,YAAY/B,GAAKlG,GAAQ4H,GAAQ;AAC7B,UAAMH,IAAa;AAAA,MACf,OAAS;AAAA,IACZ;AACD,UAAMzH,GAAQ,EAAC,KAAAkG,GAAK,YAAAuB,GAAY,QAAAG,EAAM,CAAC,GAEvC,KAAK,kBAAkB,MACvB,KAAK,cAAc,MACnB,KAAK,SAAS;AAAA,EACtB;AAAA,EAEI,MAAM,uBAAuB;AACzB,WAAO,MAAM6B,GAAoB;AAAA,EACzC;AAAA,EAEI,IAAI,aAAa;AACb,WAAO,KAAK;AAAA,EACpB;AAAA,EAEI,IAAI,QAAQ;AACR,WAAO,KAAK;AAAA,EACpB;AAAA,EAEI,MAAM,KAAKF,GAAYM,GAAgB;AACnC,gBAAK,kBAAkBA,GACvB,KAAK,cAAcN,GACJ,MAAM,KAAK,eAAeA,CAAU;AAAA,EAE3D;AAAA,EAEI,IAAI,oBAAoB;AACpB,WAAO,KAAK,gBAAgB,oBAAoB;AAAA,EACxD;AAAA;AAAA,EAGI,aAAaO,GAAI;AACb,SAAK,sBAAsBA;AAAA,EACnC;AAAA;AAAA,EAGI,MAAM,OAAO;AACT,WAAO;AAAA,EACf;AAAA,EAEI,MAAM,QAAQ;AACV,WAAO;AAAA,EACf;AAAA,EAEI,MAAM,WAAW;AACb,WAAO;AAAA,EACf;AAAA,EAEI,IAAI,kBAAkB;AAClB,WAAO;AAAA,EACf;AAAA,EAEI,MAAM,cAAc;AAChB,WAAO;AAAA,EACf;AAAA,EAEI,MAAM,iBAAwB;AAC1B,WAAO;AAAA,EACf;AAAA,EAEI,MAAM,SAAS;AACX,WAAO;AAAA,EACf;AAAA,EAEI,MAAM,YAAmB;AACrB,WAAO;AAAA,EACf;AAAA,EAEI,WAAW7H,GAAG;AACV,SAAK,iBAAiBA;AAAA,EAC9B;AAAA,EAEI,MAAM,SAAS;AACX,WAAO;AAAA,EACf;AAAA,EAEI,MAAM,eAAe;AACjB,WAAO;AAAA,EACf;AAAA,EAEI,MAAM,kBAAkB;AACpB,WAAO;AAAA,EACf;AAAA,EAEI,MAAM,eAAe;AACjB,WAAO;AAAA,EACf;AAAA,EAEI,MAAM,aAAoB;AACtB,WAAO;AAAA,EACf;AAAA,EAEI,IAAI,iBAAiB;AACjB,WAAO;AAAA,EACf;AAAA,EAEI,MAAM,gBAAgB;AAClB,WAAO;AAAA,EACf;AAAA,EAEI,MAAM,qBAAqB;AACvB,WAAO;AAAA,EACf;AAAA,EAEI,MAAM,iBAAiB;AACnB,WAAO;AAAA,EACf;AAAA,EAEI,MAAM,uBAAuB;AAAA,EAEjC;AAAA,EAEI,IAAI,oBAAoB;AACpB,WAAO;AAAA,EACf;AAAA,EAEI,MAAM,eAAesH,GAAY;AAC7B,WAAO;AAAA,EACf;AAAA,EAEI,IAAI,YAAY;AACZ,WAAO,KAAK;AAAA,EACpB;AAAA,EAEI,MAAM,SAAS;AACX,SAAK,WAAW;AAAA,EACxB;AAAA,EAEI,MAAM,UAAU;AACZ,SAAK,WAAW;AAAA,EACxB;AACA;ACvNe,MAAMQ,WAAqB3C,GAAe;AAAA,EACrD,IAAI,aAAa;AACb,gBAAK,OAAO,IAAI,KAAK,yCAA0C,UAAY,cAAa,GACjF;AAAA,EACf;AAAA,EAEI,IAAI,gBAAgB;AAChB,gBAAK,OAAO,IAAI,KAAK,yCAA0C,UAAY,iBAAgB,GACpF;AAAA,EACf;AAAA,EAEI,MAAM,kBAAkB;AACpB,WAAO;AAAA,EACf;AACA;;;;;;;;;;;;;;;;;;;;ACdA,IAAI4C,KAAiB;AAEN,MAAMC,WAA+BF,GAAa;AAAA,EAC7D,OAAO,MAAM;AACT,WAAKC,OACDA,KAAiB,IAAIC,GAAwB,IAE1CD;AAAAA,EACf;AAAA,EAEI,IAAI,aAAa;AACb,WAAO;AAAA,EACf;AAAA,EAEI,IAAI,gBAAgB;AAChB,WAAOE,GAAY;AAAA,EAC3B;AACA;ACfA,SAASC,GAActI,GAAK;AACxB,SAAO,IAAI,QAAQ,CAACjB,GAASC,MAAW;AACpC,UAAMuJ,IAAM,IAAI,MAAO;AACvB,IAAAA,EAAI,iBAAiB,QAAQ,CAAA/G,MAAO;AAChC,MAAAzC,EAAQwJ,CAAG;AAAA,IACvB,CAAS,GACDA,EAAI,iBAAiB,SAAS,CAAA/G,MAAO;AACjC,MAAAxC,EAAO,IAAI,MAAM,mFAAmF,CAAC;AAAA,IACxG,CAAA,GACDuJ,EAAI,MAAMvI;AAAA,EAClB,CAAK;AACL;AAEA,SAASwI,GAAerK,GAAQ0J,GAAO7H,GAAK;AACxC,SAAO,IAAI,QAAQ,CAACjB,GAASC,MAAW;AACpC,IAAA6I,EAAM,YAAY,MAAM9I,EAAS,GACjC8I,EAAM,UAAU,MAAM7I,EAAO,IAAI,MAAMb,EAAO,UAAU,2BAA2B,CAAC6B,CAAG,CAAC,CAAC,CAAC,GAC1F6H,EAAM,MAAMhH,EAAoB1C,GAAQ6B,CAAG,GAC3CjB,EAAS;AAAA,EACjB,CAAK;AACL;AAGO,MAAM0J,WAAuBV,GAAM;AAAA,EACtC,YAAY5J,GAAQ4H,GAAQ2C,GAAa;AACrC,UAAM,SAASvK,GAAQ4H,CAAM,GAE7B,KAAK,cAAc2C,GACnB,KAAK,SAAS;AAAA,EACtB;AAAA,EAEI,IAAI,aAAa;AAAE,WAAO;AAAA,EAAQ;AAAA,EAElC,gBAAgB;AACZ,WAAO,IAAI,QAAQ,CAAA3J,MAAW;AAC1B,YAAM4J,IAAY,MAAM;AACpB,QAAI,KAAK,SACL5J,EAAS,IAGT,WAAW4J,GAAW,GAAG;AAAA,MAE7C;AAEY,MAAAA,EAAW;AAAA,IACd,CAAA;AAAA,EACT;AAAA,EAEI,MAAM,OAAO;AACT,UAAM,KAAK,cAAe,GAC1B,KAAK,MAAM,KAAM;AAAA,EACzB;AAAA,EAEI,MAAM,QAAQ;AACV,UAAM,KAAK,cAAe,GAC1B,KAAK,MAAM,MAAO;AAAA,EAC1B;AAAA,EAEI,MAAM,WAAW;AACb,iBAAM,KAAK,cAAe,GACnB,KAAK,MAAM;AAAA,EAC1B;AAAA,EAEI,IAAI,kBAAkB;AbnE1B,QAAAzH;AaoEQ,aAAOA,IAAA,KAAK,UAAL,gBAAAA,EAAY,gBAAe;AAAA,EAC1C;AAAA,EAEI,MAAM,cAAc;AAChB,iBAAM,KAAK,cAAe,GACnB,KAAK,MAAM;AAAA,EAC1B;AAAA,EAEI,MAAM,eAAe0H,GAAG;AACpB,UAAM,KAAK,cAAe,GAC1B,KAAK,MAAM,cAAcA;AAAA,EACjC;AAAA,EAEI,MAAM,SAAS;AACX,iBAAM,KAAK,cAAe,GACnB,KAAK,MAAM;AAAA,EAC1B;AAAA,EAEI,MAAM,UAAUxI,GAAG;AACf,UAAM,KAAK,cAAe,GAC1B,KAAK,MAAM,SAASA;AAAA,EAC5B;AAAA,EAEI,MAAM,SAAS;AACX,iBAAM,KAAK,cAAe,GACnB,KAAK,MAAM;AAAA,EAC1B;AAAA,EAEI,MAAM,eAAe;AACjB,iBAAM,KAAK,cAAe,GACnB,KAAK,MAAM;AAAA,EAC1B;AAAA,EAEI,MAAM,gBAAgByI,GAAI;AACtB,UAAM,KAAK,cAAe,GAC1B,KAAK,MAAM,eAAeA;AAAA,EAClC;AAAA;AAAA,EAII,MAAM,gBAAgB;AAClB,WAAO;AAAA,MACH,GAAG,KAAK,cAAc;AAAA,MACtB,GAAG,KAAK,cAAc;AAAA,IACzB;AAAA,EACT;AAAA,EAEI,MAAM,eAAenB,IAAa,MAAM;AACpC,SAAK,cAAc,KAAK,eAAeA,GACvC,KAAK,OAAO,IAAI,MAAM,gDAAgD;AAEtE,UAAMoB,IAAa,KAAK,OAAO,cAAc,SAAS;AACtD,QAAI,CAACA,KAAcA,KAAc;AAC7B,YAAM,IAAI,MAAM,wDAAwD;AAS5E,QAPA,KAAK,gBAAgB,MAAMR,GAAcQ,CAAU,GACnD,KAAK,kBAAkB,SAAS,cAAc,KAAK,GACnD,KAAK,gBAAgB,YAAY,mBACjC,KAAK,OAAO,YAAY,KAAK,eAAe,GAC5C,KAAK,gBAAgB,YAAY,KAAK,aAAa,GAEnD,KAAK,UAAUpB,EAAW,QAAQ,SAASA,EAAW,QAAQ,MAAM,CAAC,GACjE,CAAC,KAAK;AACN,YAAM,IAAI,MAAM,2CAA2C;AAG/D,QAAI,CAAC,KAAK;AACN,YAAM,IAAI,MAAM,8FAA8F;AAGlH,UAAMc,GAAe,KAAK,QAAQ,KAAK,OAAO,KAAK,QAAQ,GAAG;AAE9D,UAAMO,IAAiB,MAAM;AACzB,YAAMC,IACF,KAAK,OAAO,eAAe,cAAc,cACzC,KAAK,OAAO,eAAe,cAAc,cACvCC,IAAa,KAAK,cAAc,QAAQ,KAAK,cAAc;AACjE,MAAID,IAAcC,KACd,KAAK,cAAc,UAAU,IAAI,WAAW,GAC5C,KAAK,cAAc,UAAU,OAAO,UAAU,MAG9C,KAAK,cAAc,UAAU,IAAI,UAAU,GAC3C,KAAK,cAAc,UAAU,OAAO,WAAW;AAAA,IAE/D;AAEQ,IAAI,KAAK,OAAO,UAAU,OAAO,SAAS,KACtC,KAAK,MAAM,iBAAiB,cAAc,CAAAzH,MAAO;AAC7C,YAAM+G,IAAM,KAAK,OAAO,UAAU,SAAS/G,EAAI,OAAO,aAAa,EAAI;AACvE,MAAI,KAAK,cAAc,OAAO+G,EAAI,QAC9B,KAAK,cAAc,MAAMA,EAAI,KAC7B,KAAK,cAAc,SAAS,MAAMQ,EAAgB;AAAA,IAEtE,CAAa,GAGL,OAAO,iBAAiB,UAAU,CAAAvH,MAAOuH,EAAc,CAAE,GACzDA,EAAgB,GAEhB,KAAK,SAAS;AAAA,EACtB;AACA;AAEe,MAAMG,WAAyBpC,GAAY;AAAA,EACtD,0BAA0B;AACtB,WAAOsB,GAAuB,IAAK;AAAA,EAC3C;AAAA,EAEI,IAAI,OAAO;AACb,WAAO,MAAM,QAAQ;AAAA,EACvB;AAAA,EAEI,IAAI,aAAa;AACb,WAAO;AAAA,EACf;AAAA,EAEI,MAAM,aAAaV,GAAY;AAC3B,WAAOA,EAAW,QAAQ,SAAS;AAAA,EAC3C;AAAA,EAEI,MAAM,iBAAiByB,GAAiBT,GAAa;AACjD,WAAO,IAAID,GAAe,KAAK,QAAQU,GAAiBT,CAAW;AAAA,EAC3E;AAAA,EAEI,8BAA8B;AAC1B,WAAO,CAAC,OAAM,KAAK;AAAA,EAC3B;AAAA,EAEI,gBAAgB3B,GAAU;AACtB,WAAO;AAAA,MACH,OAAOA,EAAS,IAAI,CAAAjI,OAAQ;AAAA,QACxB,KAAKA;AAAA,MACrB,EAAc;AAAA,IACL;AAAA,EACT;AACA;ACzMO,MAAMsK,WAAkBrB,GAAM;AAAA,EACjC,YAAY5J,GAAQ4H,GAAQ2C,GAAa9D,GAAQ;AAC7C,UAAM,SAASzG,GAAQ4H,CAAM,GAC7B,KAAK,UAAUnB,KAAU,CAAE;AAE3B,UAAMyE,IAAc,KAAK,QAAQ,eAAe;AAChD,SAAK,QAAQ,aAAa,eAAc,EAAE,GACtCA,MAAgB,MAChB,KAAK,QAAQ,aAAa,eAAcA,CAAW,GAGvD,KAAK,cAAcX,GAGnB,KAAK,QAAQ,aAAa,YAAW,EAAE,GACvC,KAAK,QAAQ,WAAW,IAGnBA,MACD,KAAK,QAAQ,QAAQ,KAGzB,KAAK,gBAAgB;AAAA,EAC7B;AAAA,EAEI,MAAM,OAAO;AACT,QAAI,KAAK;AACL,UAAI;AACA,qBAAM,KAAK,cAAe,GACnB,KAAK,MAAM,KAAM;AAAA,MACxC,QACsB;AAAA,MAEtB;AAAA;AAGY,WAAK,oBAAoB,SAAS;AAAA,EAE9C;AAAA,EAEI,MAAM,QAAQ;AACV,QAAI,KAAK;AACL,mBAAM,KAAK,cAAe,GACnB,KAAK,MAAM,MAAO;AAGzB,SAAK,oBAAoB,SAAS;AAAA,EAE9C;AAAA,EAEI,MAAM,WAAW;AACb,WAAI,KAAK,iBACL,MAAM,KAAK,cAAe,GACnB,KAAK,MAAM,YAGX,KAAK,oBAAoB;AAAA,EAE5C;AAAA,EAEI,IAAI,kBAAkB;AAClB,WAAI,KAAK,gBACE,KAAK,QAAQ,KAAK,MAAM,cAAc,KAGtC,KAAK,oBAAoB;AAAA,EAE5C;AAAA,EAEI,MAAM,cAAc;AAChB,WAAI,KAAK,iBACL,MAAM,KAAK,cAAe,GACnB,KAAK,mBAGL,KAAK,oBAAoB;AAAA,EAE5C;AAAA,EAEI,MAAM,eAAeE,GAAG;AACpB,WAAI,KAAK,iBACL,MAAM,KAAK,cAAe,GACnB,KAAK,MAAM,cAAcA,MAGhC,KAAK,oBAAoB,cAAcA,GAChCA;AAAA,EAEnB;AAAA,EAEI,MAAM,SAAS;AACX,WAAI,KAAK,iBACL,MAAM,KAAK,cAAe,GACnB,KAAK,MAAM,UAGX,KAAK,oBAAoB;AAAA,EAE5C;AAAA,EAEI,MAAM,UAAUxI,GAAG;AACf,WAAI,KAAK,iBACL,MAAM,KAAK,cAAe,GACtBA,MAAM,IACN,KAAK,MAAM,aAAa,SAAS,EAAE,IAGnC,KAAK,MAAM,gBAAgB,OAAO,GAE/B,KAAK,MAAM,SAASA,MAG3B,KAAK,oBAAoB,SAASA,GAC3BA;AAAA,EAEnB;AAAA,EAEI,MAAM,SAAS;AACX,WAAI,KAAK,iBACL,MAAM,KAAK,cAAe,GACnB,KAAK,MAAM,UAGX,KAAK,oBAAoB;AAAA,EAE5C;AAAA,EAEI,MAAM,eAAe;AACjB,WAAI,KAAK,iBACL,MAAM,KAAK,cAAe,GACnB,MAAM,KAAK,MAAM,gBAGjB,KAAK,oBAAoB;AAAA,EAE5C;AAAA,EAEI,MAAM,gBAAgByI,GAAI;AACtB,WAAI,KAAK,iBACL,MAAM,KAAK,cAAe,GACnB,KAAK,MAAM,eAAeA,MAGjC,KAAK,oBAAoB,eAAeA,GACjCA;AAAA,EAEnB;AAAA,EAEI,MAAM,eAAe;AAAA,EAEzB;AAAA,EAEI,MAAM,aAAoB;AAAA,EAC9B;AAAA,EAEI,IAAI,iBAAiB;AACjB,WAAO;AAAA,EACf;AAAA,EAEI,MAAM,gBAAgB;AAClB,WAAI,KAAK,iBACL,MAAM,KAAK,cAAe,GACnB,EAAE,GAAG,KAAK,MAAM,YAAY,GAAG,KAAK,MAAM,YAAa,KAGvD,EAAE,GAAG,KAAK,oBAAoB,YAAY,GAAG,KAAK,oBAAoB,YAAa;AAAA,EAEtG;AAAA,EAEI,uBAAuBvE,GAAO;AAC1B,SAAK,sBAAsB;AAAA,MACvB,UAAUA,EAAM;AAAA,MAChB,QAAQA,EAAM;AAAA,MACd,YAAYA,EAAM;AAAA,MAClB,aAAaA,EAAM;AAAA,MACnB,cAAcA,EAAM;AAAA,MACpB,QAAQA,EAAM;AAAA,MACd,aAAaA,EAAM;AAAA,IAC/B;AAAA,EACA;AAAA,EAEI,MAAM,eAAeoD,IAAa,MAAM;AACpC,SAAK,cAAc,KAAK,eAAeA,GACvC,KAAK,OAAO,IAAI,MAAM,+CAA+C,GAErE,KAAK,WAAWA,EAAW,QAAQ,MACnC,KAAK,kBAAkB,GAElB,KAAK,sBACN,KAAK,MAAM,QAAQ,KAGvB,KAAK,SAAS,QAAQ,CAAC,EAAE,KAAA1H,GAAK,UAAAsJ,EAAQ,MAAO;AACzC,MAAAtJ,IAAMa,EAAoB,KAAK,QAAQb,CAAG;AAC1C,YAAMuJ,IAAS,SAAS,cAAc,QAAQ;AAC9C,MAAAA,EAAO,MAAMvJ,GACbuJ,EAAO,OAAOD,GACd,KAAK,MAAM,YAAYC,CAAM;AAAA,IACzC,CAAS,GAED,KAAK,iBAAiB,KAAK,mBAAmB,MAAM;AAChD,MAAI,OAAO,KAAK,uBAAwB,cACpC,KAAK,oBAAqB;AAAA,IAE1C,IACQ,KAAK,MAAM,iBAAiB,SAAS,KAAK,cAAc;AAIxD,QAAI;AACA,YAAM,KAAK,MAAM,KAAM;AAAA,IACnC,QACoB;AAAA,IAEpB;AACQ,UAAM,KAAK,cAAe,GAE1B,KAAK,OAAO,IAAI,MAAM,kCAAmC,KAAK,WAAW,OAAS,4BAA2B,GAC7G,KAAK,uBAAuB,KAAK,KAAK;AAAA,EAC9C;AAAA,EAEI,MAAM,kBAAkB;AACpB,SAAK,MAAM,MAAM,IACjB,KAAK,MAAM,oBAAoB,SAAS,KAAK,cAAc,GAC3D,KAAK,MAAM,oBAAoB,cAAc,KAAK,qBAAqB,GACvE,KAAK,SAAS;AAAA,EACtB;AAAA,EAEI,IAAI,YAAY;AACZ,WAAO,KAAK;AAAA,EACpB;AAAA,EAEI,MAAM,SAAS;AACX,SAAK,gBAAgB;AAAA,EAC7B;AAAA,EAEI,MAAM,UAAU;AACZ,WAAI,KAAK,cACL,KAAK,OAAO,IAAI,MAAM,kFAAkF,IAGxG,KAAK,gBAAgB,IAGlB,KAAK;AAAA,EACpB;AAAA,EAEI,gBAAgB;AACZ,WAAO,IAAI,QAAQ,CAACxK,GAAQC,MAAW;AACnC,MAAI,KAAK,MAAM,cAAY,MACvB,KAAK,SAAS,KAGd,KAAK,QACLD,EAAS,KAGT,KAAK,wBAAwB,CAAAyC,MAAO;AAChC,QAAI,KAAK,MAAM,cAAY,MACvB,KAAK,MAAM,MAAO,GAClB,KAAK,SAAS,IACdzC,EAAS;AAAA,MAEjC,GACgB,KAAK,MAAM,iBAAiB,cAAc,KAAK,qBAAqB;AAAA,IAE3E,CAAA;AAAA,EACT;AACA;AAEe,MAAMyK,WAAwB1C,GAAY;AAAA,EACrD,0BAA0B;AACtB,WAAOsB,GAAuB,IAAK;AAAA,EAC3C;AAAA,EAEI,IAAI,OAAO;AACb,WAAO,MAAM,QAAQ;AAAA,EACvB;AAAA,EAEI,IAAI,aAAa;AACb,WAAO;AAAA,EACf;AAAA,EAEI,MAAM,aAAaV,GAAY;AAC3B,UAAM,EAAE,MAAAzD,MAASyD,EAAW;AAC5B,WAAOzD,KAAQA,EAAK,KAAK,CAAAwF,MAAalF,GAAkBkF,EAAU,QAAQ,CAAC;AAAA,EACnF;AAAA,EAEI,MAAM,iBAAiBN,GAAiBT,GAAa;AACjD,WAAO,IAAIU,GAAU,KAAK,QAAQD,GAAiBT,GAAa,KAAK,MAAM;AAAA,EACnF;AAAA,EAEI,8BAA8B;AAC1B,WAAO,CAAC,OAAM,OAAM,OAAM,QAAO,KAAK;AAAA,EAC9C;AAAA,EAEI,gBAAgB3B,GAAU;AACtB,UAAM2C,IAAc,CAAC5K,MAAQ;AACzB,cAAQ8B,GAAiB9B,CAAG,GAAC;AAAA,QAC7B,KAAK;AAAA,QACL,KAAK;AACD,iBAAO;AAAA,QACX,KAAK;AACD,iBAAO;AAAA,QACX,KAAK;AAAA,QACL,KAAK;AACD,iBAAO;AAAA,QACX;AACI,iBAAO;AAAA,MACvB;AAAA,IACA;AACQ,WAAO;AAAA,MACH,MAAMiI,EAAS,IAAI,CAAAjI,OAAQ;AAAA,QACvB,KAAKA;AAAA,QACL,UAAU4K,EAAY5K,CAAG;AAAA,MACzC,EAAc;AAAA,IACd;AAAA,EACA;AACA;ACjUe,MAAM6K,GAAiB;AAAA,EAClC,YAAY,EAAE,OAAAC,GAAO,YAAAC,GAAY,QAAAC,IAAS,IAAO,OAAAhK,IAAQ,GAAG,KAAAE,IAAM,IAAI,OAAA+J,IAAQ,IAAI,QAAAC,IAAS,IAAI,SAAAC,IAAU,MAAM;AAC3G,SAAK,SAASL,GACd,KAAK,cAAcC,GACnB,KAAK,SAAS/J,GACd,KAAK,OAAOE,GACZ,KAAK,OAAO;AAAA,MACR,GAAG+J;AAAA,MACH,GAAGC;AAAA,IACf,GACQ,KAAK,WAAWC,GAChB,KAAK,UAAUH;AAAA,EACvB;AAAA,EAEI,IAAI,QAAQ;AAAE,WAAO,KAAK;AAAA,EAAO;AAAA,EACjC,IAAI,aAAa;AAAE,WAAO,KAAK;AAAA,EAAY;AAAA,EAC3C,IAAI,QAAQ;AAAE,WAAO,KAAK;AAAA,EAAO;AAAA,EACjC,IAAI,MAAM;AAAE,WAAO,KAAK;AAAA,EAAK;AAAA,EAC7B,IAAI,MAAM;AAAE,WAAO,KAAK;AAAA,EAAK;AAAA,EAC7B,IAAI,UAAU;AAAE,WAAO,KAAK;AAAA,EAAS;AAAA,EACrC,IAAI,SAAS;AAAE,WAAO,KAAK;AAAA,EAAQ;AAAA,EAEnC,IAAI,UAAU;AACV,WAAI,KAAK,KAAK,MAAM,MAAM,KAAK,KAAK,MAAM,KAC/B,KAAK,KAAK,IAAI,KAAK,KAAK,IAGxB,KAAK;AAAA,EAExB;AAAA,EAEI,QAAQI,GAAO;AACX,WAAOA,EAAM,UAAU,KAAK;AAAA,EACpC;AACA;AC9BA,SAASC,GAAYvB,GAAG;AACvB,MAAIwB,IAAQ,KAAK,eAAe,OAAO,CAAC;AACxC,OAAK,eAAe,OAAO,KAAK,CAAAC,MAAK;AACpC,QAAIA,EAAE,QAAM,KAAK;AAChB,MAAAD,IAAQC;AAAA;AAGR,aAAO;AAAA,EAEV,CAAE,GACD,KAAK,IAAI,MAAMD,EAAM;AACtB;AAEA,SAASE,KAAkB;AAC1B,OAAK,kBAAkB,KAAK,IAAK;AACjC,QAAMC,IAAY,MAAM;AACvB,SAAK,SAAS,WAAWA,GAAW,GAAG;AACvC,UAAMC,IAAU,KAAK,IAAK,GACpBC,IAAWD,IAAU,KAAK;AAChC,SAAK,gBAAgBC,IAAW,KAChC,KAAK,kBAAkBD,GACvBL,GAAY,MAAM,MAAM,CAAC,KAAK,YAAY,CAAC;AAAA,EAC7C;AAEC,EAAAI,EAAW;AACZ;AAEA,SAASG,KAAiB;AACzB,EAAI,KAAK,WACR,aAAa,KAAK,MAAM,GACxB,KAAK,SAAS;AAEhB;AAEO,MAAMC,WAAmB5C,GAAM;AAAA,EACrC,YAAY5J,GAAQ4H,GAAQ;AAC3B,UAAM,OAAO5H,GAAQ4H,CAAM,GAE3B,KAAK,eAAe,GACpB,KAAK,iBAAiB,GACtB,KAAK,gBAAgB,GACrB,KAAK,SAAS,MAEd,KAAK,QAAQ,KAAK;AAAA,EACpB;AAAA,EAEC,MAAM,OAAO;AACZ,IAAAuE,GAAgB,MAAM,IAAI;AAAA,EAC5B;AAAA,EAEC,MAAM,QAAQ;AACb,IAAAI,GAAe,MAAM,IAAI;AAAA,EAC3B;AAAA,EAEC,MAAM,WAAW;AAChB,WAAO,KAAK,eAAe;AAAA,EAC7B;AAAA,EAEC,IAAI,kBAAkB;AACrB,WAAO,KAAK;AAAA,EACd;AAAA,EAEC,MAAM,cAAc;AACnB,WAAO,KAAK;AAAA,EACd;AAAA,EAEC,MAAM,eAAe9B,GAAG;AACvB,SAAK,eAAeA,GACpBuB,GAAY,MAAM,MAAM,CAACvB,CAAC,CAAC;AAAA,EAC7B;AAAA,EAEC,MAAM,SAAS;AACd,WAAO;AAAA,EACT;AAAA,EAEC,MAAM,UAAUxI,GAAG;AAAA,EAEpB;AAAA,EAEC,MAAM,SAAS;AACd,WAAO,KAAK,WAAW;AAAA,EACzB;AAAA,EAEC,MAAM,eAAe;AACpB,WAAO,KAAK;AAAA,EACd;AAAA,EAEC,MAAM,gBAAgByI,GAAI;AACzB,SAAK,gBAAgBA;AAAA,EACvB;AAAA,EAEC,MAAM,eAAe;AACpB,WAAO,KAAK;AAAA,EACd;AAAA,EAEC,MAAM,aAAoB;AAAA,EAE3B;AAAA,EAEC,IAAI,iBAAiB;AACpB,WAAO,KAAK;AAAA,EACd;AAAA,EAEC,MAAM,gBAAgB;AACrB,WAAO,KAAK,eAAe;AAAA,EAC7B;AAAA,EAEC,MAAM,eAAenB,GAAY;AAChC,gBAAK,WAAWA,EAAW,QAAQ,OACnC,KAAK,aAAa,KAAK,SAAS,IAAI,CAAA1H,MAC5B,IAAI2J,GAAiB;AAAA,MAC3B,KAAK3J,EAAI,OAAO,CAAC,EAAE;AAAA,MACnB,OAAO,GAAGA,EAAI,IAAI,CAAC,IAAIA,EAAI,IAAI,CAAC;AAAA,MAChC,YAAY,GAAGA,EAAI,IAAI,CAAC;AAAA,MACxB,OAAOA,EAAI,IAAI;AAAA,MACf,QAAQA,EAAI,IAAI;AAAA,IACpB,CAAI,CACD,GAGD,KAAK,kBAAkB,KAAK,WAAW,SAAS,GAChD,KAAK,WAAW,QAAQ,CAAC4K,GAAE,MAAM;AAEhC,MADuB,KAAK,WAAW,KAAK,eAAe,EACxC,QAAQA,CAAC,IAAE,MAC7B,KAAK,kBAAkB;AAAA,IAE3B,CAAG,GACD,KAAK,iBAAiB,KAAK,SAAS,KAAK,eAAe,GAGxD,KAAK,SAAS,QAAQ,CAAA5K,MAAO;AAC5B,MAAAA,EAAI,OAAO,KAAK,CAACK,GAAEwK,MAAMxK,EAAE,OAAOwK,EAAE,IAAI;AAAA,IAE3C,CAAG,GAEM;AAAA,EACT;AACA;AAEe,MAAMC,WAAyBhE,GAAY;AAAA,EACzD,0BAA0B;AACnB,WAAOsB,GAAuB,IAAK;AAAA,EAC3C;AAAA,EAEC,IAAI,OAAO;AACV,WAAO,MAAM,QAAQ;AAAA,EACvB;AAAA,EAEC,IAAI,aAAa;AAChB,WAAO;AAAA,EACT;AAAA,EAEC,MAAM,aAAaV,GAAY;AAC9B,WAAOA,EAAW,QAAQ,SAAS;AAAA,EACrC;AAAA,EAEC,MAAM,iBAAiByB,GAAiBT,GAAa;AACpD,WAAO,IAAIiC,GAAW,KAAK,QAAQxB,GAAiB,KAAK,QAAQT,CAAW;AAAA,EAC9E;AACA;AChKO,MAAMqC,WAAiB3B,GAAU;AAAA,EACpC,YAAYjL,GAAQ4H,GAAQ2C,GAAa9D,GAAQ;AAC7C,UAAMzG,GAAQ4H,GAAQ2C,GAAa9D,CAAM;AAAA,EACjD;AAAA;AAAA;AAAA,EAII,MAAM,eAAe8C,IAAa,MAAM;AACpC,SAAK,cAAc,KAAK,eAAeA,GACvC,KAAK,OAAO,IAAI,MAAM,8CAA8C,GAE/D,KAAK,mBACN,KAAK,WAAW,MAChB,KAAK,kBAAkB,GAEvB,KAAK,WAAWA,EAAW,QAAQ,KACnC,KAAK,SAAS,KAAK,CAACrH,GAAEwK,MACX,OAAOxK,EAAE,IAAI,CAAC,IAAI,OAAOwK,EAAE,IAAI,CAAC,CAC1C,GACD,KAAK,kBAAkB,KAAK,SAAS,SAAS,GAC9C,KAAK,iBAAiB,KAAK,SAAS,KAAK,eAAe,IAGvD,KAAK,sBACN,KAAK,MAAM,QAAQ,KAGnB,KAAK,mBACL,KAAK,MAAM,SAAS,KAAK,gBACrB,KAAK,mBAAmB,MACxB,KAAK,MAAM,QAAQ,MAI3B,KAAK,MAAM,MAAMhK,EAAoB,KAAK,QAAQ,KAAK,eAAe,GAAG,GACzE,KAAK,iBAAiB,KAAK,mBAAmB,MAAM;AAChD,MAAI,OAAO,KAAK,uBAAwB,cACpC,KAAK,oBAAqB;AAAA,IAE1C,IACQ,KAAK,MAAM,iBAAiB,SAAS,KAAK,cAAc;AAIxD,QAAI;AACA,YAAM,KAAK,MAAM,KAAM;AAAA,IACnC,QACoB;AAAA,IAEpB;AACQ,UAAM,KAAK,cAAe,GAE1B,KAAK,OAAO,IAAI,MAAM,iCAAkC,KAAK,WAAW,OAAS,4BAA2B,GAC5G,KAAK,uBAAuB,KAAK,KAAK;AAAA,EAC9C;AACA;AAEe,MAAMmK,WAAuBlE,GAAY;AAAA,EACpD,0BAA0B;AACtB,WAAOsB,GAAuB,IAAK;AAAA,EAC3C;AAAA,EAEI,IAAI,OAAO;AACb,WAAO,MAAM,QAAQ;AAAA,EACvB;AAAA,EAEI,IAAI,aAAa;AACb,WAAO;AAAA,EACf;AAAA,EAEI,aAAaV,GAAY;AjBzE7B,QAAAxG;AiB0EQ,UAAM,EAAE,KAAA+J,MAAQvD,EAAW;AAC3B,WAAOuD,KAAO1G,IAAkBrD,IAAA+J,EAAI,CAAC,MAAL,gBAAA/J,EAAQ,QAAQ;AAAA,EACxD;AAAA,EAEI,MAAM,iBAAiBiI,GAAiBT,GAAa;AACjD,WAAO,IAAIqC,GAAS,KAAK,QAAQ5B,GAAiBT,GAAa,KAAK,MAAM;AAAA,EAClF;AAAA,EAEI,8BAA8B;AAC1B,WAAO,CAAC,OAAM,KAAK;AAAA,EAC3B;AAAA,EAEI,gBAAgB3B,GAAU;AACtB,WAAO;AAAA,MACH,KAAKA,EAAS,IAAI,CAAAjI,OAAQ;AAAA,QACtB,KAAKA;AAAA,QACL,UAAU;AAAA,MAC1B,EAAc;AAAA,IACL;AAAA,EACT;AACA;AC7FO,eAAeoM,GAAoB/M,GAAQ;AAC9C,QAAMgN,IAAyB,CAAE;AACjC,QAAMjE,EAAkB/I,GAAQ,YAAY,OAAOgJ,MAAW;AAC1D,IAAAgE,EAAuB,KAAKhE,CAAM;AAAA,EAC1C,CAAK;AAED,WAASzG,KAAKyK,GAAwB;AAElC,UAAMC,IAAW,MADFD,EAAuBzK,CAAC,EACT,YAAa,GACrC2K,IAAiBlN,EAAO;AAC9B,IAAAiN,EAAS,QAAQ,CAAAvI,MAAKwI,EAAe,YAAYxI,CAAC,CAAC;AAAA,EAC3D;AACA;AAEe,MAAMyI,WAAuBzE,GAAO;AAAA,EAC/C,IAAI,OAAO;AAAE,WAAO;AAAA,EAAW;AAAA,EAE/B,MAAM,OAAO;AACT,SAAK,OAAO,IAAI,MAAM,sBAAsB;AAAA,EACpD;AAAA,EAEI,MAAM,cAAc;AAChB,gBAAK,OAAO,IAAI,KAAK,kBAAkB,KAAK,IAAI,qCAAqC,GAC9E,CAAE;AAAA,EACjB;AACA;ACxBe,MAAM0E,GAAS;AAAA,EAC1B,IAAI,OAAO;AACP,WAAO,KAAK;AAAA,EACpB;AAAA,EAEI,IAAI,QAAQ;AACR,WAAO,KAAK;AAAA,EACpB;AAAA,EAEI,IAAI,WAAW;AACX,WAAO,KAAK;AAAA,EACpB;AAAA,EAEI,IAAI,MAAMC,GAAG;AACT,SAAK,SAASA;AAAA,EACtB;AAAA,EAEI,IAAI,SAASA,GAAG;AACZ,SAAK,QAAQA;AAAA,EACrB;AAAA,EAEI,YAAY5B,IAAQ,IAAI6B,IAAO,IAAI;AAC/B,SAAK,QAAQ,CAAE,GACf,KAAK,SAAS7B,GACd,KAAK,QAAQ6B;AAAA,EACrB;AAAA,EAEI,OAAO,EAAE,OAAA7B,IAAQ,IAAI,OAAA8B,GAAO,KAAAC,GAAK,UAAAP,KAAY;AACzC,UAAMQ,IAAM;AAAA,MACR,OAAAhC;AAAA,IACH;AAED,QAAI,OAAOwB,KAAc;AACrB,MAAAQ,EAAI,WAAW,CAACR,CAAQ;AAAA,aAEnB,MAAM,QAAQA,CAAQ;AAC3B,MAAAQ,EAAI,WAAWR;AAAA;AAGf,YAAM,MAAM,qEAAqE;AAGrF,QAAI,OAAOM,KAAW;AAClB,MAAAE,EAAI,QAAQ7J,GAAc2J,CAAK,GAC/BE,EAAI,cAAcF;AAAA,aAEb,OAAOA,KAAW;AACvB,MAAAE,EAAI,QAAQF,GACZE,EAAI,cAAclK,GAAcgK,CAAK;AAAA;AAGrC,YAAM,MAAM,kFAAkF;AAGlG,QAAI,OAAOC,KAAS;AAChB,MAAAC,EAAI,MAAM7J,GAAc4J,CAAG,GAC3BC,EAAI,YAAYD;AAAA,aAEX,OAAOA,KAAS;AACrB,MAAAC,EAAI,MAAMD,GACVC,EAAI,YAAYlK,GAAciK,CAAG;AAAA;AAGjC,YAAM,MAAM,kFAAkF;AAGlG,gBAAK,MAAM,KAAKC,CAAG,GACZA;AAAA,EACf;AAAA,EAEI,OAAOC,GAAS;AACZ,QAAI,OAAOA,KAAa;AACpB,MAAAA,IAAU9J,GAAc8J,CAAO;AAAA,aAE1B,OAAOA,KAAa;AACzB,YAAM,MAAM,yCAAyC;AAGzD,QAAIpL,IAAS;AACb,gBAAK,MAAM,KAAK,CAAAmL,MAAO;AACnB,UAAIC,KAASD,EAAI,SAASC,KAASD,EAAI;AACnC,eAAAnL,IAASmL,GACF;AAAA,IAEvB,CAAS,GACMnL;AAAA,EACf;AACA;ACvFO,SAASqL,GAAU3N,GAAQ4N,GAAM;AACpC,QAAMX,IAAW,CAAE,GAIbY,IADS,IAAI,UAAW,EACX,gBAAgBD,GAAM,UAAU;AAEnD,eAAM,KAAKC,EAAI,qBAAqB,KAAK,CAAC,EAAE,QAAQ,CAAA7H,MAAO;AACvD,UAAMsH,IAAOtH,EAAI,aAAa,UAAU,KAAK;AAC7C,IAAAiH,EAASK,CAAI,IAAIL,EAASK,CAAI,KAAK,IAAIF,GAASpN,EAAO,UAAUsN,CAAI,GAAGA,CAAI,GAE5E,MAAM,KAAKtH,EAAI,qBAAqB,GAAG,CAAC,EAAE,QAAQ,CAAAqD,MAAK;AACnD,YAAMyE,IAAQhK,GAAmBuF,EAAE,aAAa,OAAO,CAAC;AACxD,MAAA4D,EAASK,CAAI,EAAE,OAAO;AAAA,QAClB,OAAO,WAAWjE,EAAE,aAAa,QAAQ,KAAKyE,CAAK;AAAA,QACnD,OAAOA,IAAQ;AAAA,QACf,KAAKhK,GAAmBuF,EAAE,aAAa,KAAK,CAAC,IAAI;AAAA,QACjD,UAAUA,EAAE;AAAA,MAC5B,CAAa;AAAA,IACJ,CAAA;AAAA,EACJ,CAAA,GAGM4D;AACX;AAEe,MAAMc,GAAW;AAAA,EAC5B,YAAY/N,GAAQ4N,IAAO,IAAI;AAC3B,SAAK,SAAS5N,GACd,KAAK,QAAQ4N,GACb,KAAK,YAAYD,GAAU,KAAK,QAAQC,CAAI;AAAA,EACpD;AAAA,EAEI,IAAI,OAAO;AACP,WAAO,KAAK;AAAA,EACpB;AAAA,EAEI,IAAI,KAAKA,GAAM;AACX,SAAK,QAAQA,GACb,KAAK,YAAYD,GAAUC,CAAI;AAAA,EACvC;AAAA,EAEI,IAAI,WAAW;AACX,WAAO,KAAK;AAAA,EACpB;AACA;AC7CA,IAAI5D,KAAiB;AAEN,MAAMgE,WAA0BjE,GAAa;AAAA,EACxD,OAAO,MAAM;AACT,WAAKC,OACDA,KAAiB,IAAIgE,GAAmB,IAErChE;AAAAA,EACf;AAAA,EAEI,IAAI,aAAa;AACb,WAAO;AAAA,EACf;AAAA,EAEI,IAAI,gBAAgB;AAChB,WAAOE,GAAY;AAAA,EAC3B;AACA;ACbe,MAAM+D,WAAmCd,GAAe;AAAA,EACnE,0BAA0B;AACtB,WAAOa,GAAkB,IAAK;AAAA,EACtC;AAAA,EAEI,IAAI,OAAO;AACb,WAAO,MAAM,QAAQ;AAAA,EACvB;AAAA,EAEI,MAAM,YAAY;AAEd,WADgB,MAAM,MAAM,UAAW,KAE/B,KAAK,OAAO,cAAc,YAC1B,KAAK,OAAO,cAAc,SAAS,SAAO;AAAA,EAC1D;AAAA,EAEI,MAAM,cAAc;AAChB,UAAM1L,IAAS,CAAE,GACX+G,IAAI,CAAE;AACZ,gBAAK,OAAO,cAAc,SAAS,QAAQ,CAAA4D,MAAY;AACnD,MAAA5D,EAAE,KAAK,IAAI,QAAQ,OAAOzI,GAASC,MAAW;AAC1C,YAAI,QAAQ,KAAKoM,EAAS,MAAM,GAAG;AAC/B,gBAAMiB,IAAUxL,EAAoB,KAAK,QAAQuK,EAAS,GAAG,GACvDkB,IAAc,MAAM,MAAMD,CAAO;AACvC,cAAIC,EAAY,IAAI;AAChB,gBAAIP,IAAO,MAAMO,EAAY,KAAM;AAMnC,YAAAP,IAAOA,EAAK,QAAQ,uEAAuE,EAAE,GAC7FA,IAAOA,EAAK,QAAQ,YAAW,EAAE,GACjCA,IAAOA,EAAK,WAAW,QAAO,EAAE;AAEhC,kBAAMQ,IAAS,IAAIL,GAAW,KAAK,QAAQH,CAAI;AAC/C,mBAAO,QAAQQ,EAAO,QAAQ,EAAE,QAAQ,CAAC,CAACd,GAAKL,CAAQ,MAAM;AACzD,cAAA3K,EAAO,KAAK2K,CAAQ;AAAA,YAChD,CAAyB,GACDrM,EAAS;AAAA,UACjC;AAEwB,YAAAC,EAAQ;AAAA,QAEhC;AAEoB,UAAAA,EAAQ;AAAA,MAE5B,CAAa,CAAC;AAAA,IACd,CAAS,GACD,MAAM,QAAQ,WAAWwI,CAAC,GACnB/G;AAAA,EACf;AACA;AC1De,MAAM+L,WAA4B3F,GAAO;AAAA,EACpD,YAAY1I,GAAOyG,GAAOvF,GAAM;AAC5B,UAAMlB,GAAOyG,GAAOvF,CAAI,GACxB,KAAK,aAAa;AAAA,EAC1B;AAAA,EAEI,MAAM,kBAAkB;AACpB,WAAO;AAAA,EACf;AACA;ACVA,IAAIoN,KAAgB,MAChBC,KAAoB;AAExB,MAAMC,KAAiB,CACvB;AAEO,SAASC,GAAyBC,GAAM;AAC3C,QAAMC,IAAOH,GAAeF,EAAa,KAAK,CAAA,GACxCM,IAAcJ,GAAeD,EAAiB,KAAK,CAAE;AAC3D,SAAOI,EAAKD,CAAI,KAAKE,EAAYF,CAAI,KAAKA;AAC9C;AAEO,SAASG,GAA2BvB,GAAM;AAC7C,EAAAgB,KAAgBhB;AACpB;AAEO,SAASwB,KAA6B;AACzC,SAAOR;AACX;AAEO,SAASS,GAA6BzB,GAAKqB,GAAM;AAEpD,EAAAH,GAAelB,CAAI,IAAIkB,GAAelB,CAAI,KAAK,CAAE;AAEjD,aAAW9H,KAAOmJ,GAAM;AACpB,UAAMK,IAAcL,EAAKnJ,CAAG;AAC5B,IAAAgJ,GAAelB,CAAI,EAAE9H,CAAG,IAAIwJ;AAAA,EACpC;AACA;AAEO,SAASC,KAAiC;AAC7C,SAAOT;AACX;AAEO,SAASU,GAAkClP,GAAQ;AACtD,SAAOA,EAAO,OAAO,mBAAmB,UAAU;AACtD;AAEA,IAAImP,KAAkBV,IAElBW,KAAoBP,IAEpBQ,KAAoBP,IAEpBQ,KAAyBP,IAEzBQ,KAA2BN,IAE3BO,KAA0BN;AAEvB,SAASO,GAAUf,GAAMgB,IAAO,MAAM;AACzC,QAAMC,IAAaR,GAAgBT,CAAI;AACvC,MAAI,MAAM,QAAQgB,CAAI,GAAG;AACrB,QAAIpN,IAASqN;AACb,WAAAD,EAAK,QAAQ,CAAClK,GAAI7D,MAAU;AACxB,YAAMiO,IAAO,IAAIjO,IAAQ,CAAC;AAC1B,MAAAW,IAASA,EAAO,QAAQsN,GAAKpK,CAAG;AAAA,IAC5C,CAAS,GACMlD;AAAA,EACf;AAEQ,WAAOqN;AAEf;AAEO,SAASE,GAAYvC,GAAM;AAC9B,EAAA8B,GAAkB9B,CAAI;AAC1B;AAEO,SAASwC,KAAc;AAC1B,SAAOT,GAAmB;AAC9B;AAEO,SAASU,GAAczC,GAAKqB,GAAM;AACrC,EAAAW,GAAuBhC,GAAMqB,CAAI;AACrC;AAEO,SAASqB,KAAkB;AAC9B,SAAOT,GAA0B;AACrC;AAEO,SAASU,GAAmBjQ,GAAQ;AACvC,SAAOwP,GAAwBxP,CAAM;AACzC;AAEO,SAASkQ,GAAqBpG,GAAI;AACrC,EAAAqF,KAAkBrF;AACtB;AAEO,SAASqG,GAAuBrG,GAAI;AACvC,EAAAsF,KAAoBtF;AACxB;AAEO,SAASsG,GAAuBtG,GAAI;AACvC,EAAAuF,KAAoBvF;AACxB;AAEO,SAASuG,GAAyBvG,GAAI;AACzC,EAAAwF,KAAyBxF;AAC7B;AAEO,SAASwG,GAA2BxG,GAAI;AAC3C,EAAAyF,KAA2BzF;AAC/B;AAEO,SAASyG,GAA8BzG,GAAI;AAC9C,EAAA0F,KAA0B1F;AAC9B;AAEO,SAAS0G,GAAqBxQ,GAAQ;AACzC,EAAAuO,KAAoB0B,GAAmBjQ,CAAM;AACjD;AC1FO,eAAeyQ,GAAgBzH,GAAQ0H,GAAgB;AzBrB9D,MAAA3N,GAAA4N;AyBsBC,QAAM/I,IAASC,EAA0B,aAAa6I,CAAc;AACpE,EAAA9I,EAAO,SAASoB;AAChB,QAAM4H,IAAYnB,GAAUzG,EAAO,SAAS,GACtC6H,IAAcpB,GAAUzG,EAAO,WAAW,GAC1C8H,IAAiB9H,EAAO,eAAe,kBAAkB,eACzD+H,IAAK/H,EAAO,KAAK,OAAOA,EAAO,EAAE,OAAO,IACxC9H,IAAO8H,EAAO,aAAa,SAASA,EAAO,UAAU,OAAO,IAC5DgI,IAAWhI,EAAO,WAAW,cAAcA,EAAO,QAAQ,OAAO;AAEvE,MAAIA,EAAO,aAAa;AACvB,UAAMiI,IAASpJ,EAA0B;AAAA,2BAChBkJ,CAAE,GAAG7P,CAAI,UAAW4P,CAAc,IAAME,gBAAyBJ,CAAW,YAAYC,CAAa;AAAA;AAAA,KAE3HjJ,CAAM;AAET,IAAIoB,EAAO,cAAc,MACxBiI,EAAO,UAAU,IAAIjI,EAAO,SAAS,GAGtCA,EAAO,UAAUiI,GACjBjI,EAAO,aAAapB,GACpBqJ,EAAO,cAAcjI,GACrBpB,EAAO,cAAcoB,GAErBiI,EAAO,iBAAiB,SAAS,CAAC5N,MAAQ;AACzC,YAAM2F,IAASiI,EAAO;AACtB,MAAA5Q,EAAa2I,EAAO,QAAQlJ,EAAO,cAAc;AAAA,QAChD,QAAQkJ;AAAA,MACZ,CAAI,GACDA,EAAO,OAAO3F,GAAK,IAAI,GAGvBA,EAAI,gBAAiB,GAMjBA,EAAI,UAAU,KAAKA,EAAI,UAAU,KACpC,SAAS,cAAc,KAAM;AAAA,IAEjC,CAAG;AAED,QAAI6N,IAAiB;AACrB,UAAMC,IAAiB,MAAM;AAC5B,MAAID,MACH,aAAaA,CAAc,GAC3BA,IAAiB;AAAA,IAErB,GACQE,IAAiB,MAAM;AAC5B,MAAAD,EAAgB,GAChBD,IAAiB,WAAW,MAAM;AACjC,QAAIlI,EAAO,4BACVA,EAAO,kBAAkB,UAAU,IAAI,QAAQ,GAE5CA,EAAO,6BACVA,EAAO,mBAAmB,UAAU,IAAI,QAAQ,GAEjDkI,IAAiB;AAAA,MACjB,GAAE,GAAG;AAAA,IACT,GAEQG,IAAoB,MAAM;AAC/B,MAAAF,EAAgB,GACZnI,EAAO,4BACVA,EAAO,kBAAkB,UAAU,OAAO,QAAQ,GAE/CA,EAAO,6BACVA,EAAO,mBAAmB,UAAU,OAAO,QAAQ;AAAA,IAEvD;AAEE,IAAAiI,EAAO,iBAAiB,SAASI,CAAiB,GAClDJ,EAAO,iBAAiB,aAAaI,CAAiB,GACtDJ,EAAO,iBAAiB,YAAYG,CAAc,GAClDH,EAAO,iBAAiB,QAAQG,CAAc,MAEpBrO,IAAAiG,EAAO,OAAO,OAAO,kBAArB,gBAAAjG,EAAoC,uBAAsB,UAClF4N,IAAA3H,EAAO,OAAO,OAAO,kBAArB,gBAAA2H,EAAoC,oBAAmB,QAExDM,EAAO,iBAAiB,SAAS,CAAA5N,MAAO;AAEvC,MAAIA,EAAI,WAAW,MAClBA,EAAI,eAAgB;AAAA,IAEzB,CAAI,GACD4N,EAAO,iBAAiB,WAAW,CAAA5N,MAAO;AAEzC,MAAIA,EAAI,WAAW,MAClBA,EAAI,eAAgB;AAAA,IAEzB,CAAI,IAGE2F,EAAO,cAAc,MACxBiI,EAAO,UAAU,IAAIjI,EAAO,SAAS;AAAA,EAExC,OACM;AACJ,UAAMiI,IAASpJ,EAA0B;AAAA,UACjCkJ,CAAE,GAAG7P,CAAI,2BAA4B4P,CAAc,YAAcD,CAAa;AAAA;AAAA,KAEnFjJ,CAAM;AAET,IAAAoB,EAAO,UAAUiI,GACjBjI,EAAO,aAAapB,GACpBqJ,EAAO,cAAcjI,GACrBpB,EAAO,cAAcoB,GAEjBA,EAAO,cAAc,MACxBiI,EAAO,UAAU,IAAIjI,EAAO,SAAS;AAAA,EAExC;AACA;AAEA,MAAMsI,KAAmB,MAAM;AAC9B,QAAMC,IAAY,SAAS,cAAc,MAAM;AAC/C,SAAAA,EAAU,UAAU,IAAI,gBAAgB,GACxCA,EAAU,UAAU,IAAI,QAAQ,GACzBA;AACR;AAGO,MAAMC,GAAqB;AAAA,EACjC,cAAcxI,GAAOyI,GAASC,GAAS;AAAA,EAAA;AAAA,EACvC,eAAe1I,GAAO2I,GAAUC,GAAU;AAAA,EAAA;AAAA,EAC1C,eAAe5I,GAAO6I,GAASC,GAAQL,GAASC,GAAS;AAAA,EAAA;AAC1D;AzBtJA,IAAAK,GAAAC,GAAAC;AyBwJe,MAAMC,WAAqB7D,GAAoB;AAAA,EAA/C;AAAA;AA4Kd,IAAAhH,EAAA,MAAA0K,GAAqB;AAarB,IAAA1K,EAAA,MAAA2K,GAAsB;AAqCtB,IAAA3K,EAAA,MAAA4K,IAAwB,CAAE;AAAA;AAAA,EA7N1B,IAAI,OAAO;AAAE,WAAO;AAAA,EAAQ;AAAA;AAAA,EAG5B,IAAI,YAAY;AAAE,WAAO,KAAK;AAAA,EAAW;AAAA,EACzC,IAAI,SAAS;AAAE,WAAO,KAAK;AAAA,EAAQ;AAAA,EACnC,IAAI,cAAc;AAAE,WAAO;AAAA,EAAK;AAAA,EAChC,IAAI,eAAe;AAAE,WAAO;AAAA,EAAM;AAAA,EAElC,QAAQ;AACP,WAAO;AAAA,EACT;AAAA,EAEC,IAAI,KAAK;AAAE,WAAO,KAAK,OAAO,MAAM,KAAK;EAAQ;AAAA,EAEjD,gBAAgB;AACf,WAAO;AAAA,EACT;AAAA,EAEC,IAAI,aAAa;AAAE,WAAO,KAAK,OAAO,QAAQ,KAAK,cAAa,KAAM,KAAK;AAAA,EAAK;AAAA,EAEhF,IAAI,YAAY;AACf,WAAO,KAAK,OAAO,aAAa,KAAK,aAAc;AAAA,EACrD;AAAA,EAEC,eAAe;AACd,WAAO;AAAA,EACT;AAAA,EAEC,IAAI,WAAW;AACd,WAAO,KAAK,OAAO,YAAY,KAAK,YAAa;AAAA,EACnD;AAAA,EAEC,cAAc;AACb,WAAO;AAAA,EACT;AAAA,EAEC,iBAAiB;AAChB,WAAO;AAAA,EACT;AAAA,EAEC,IAAI,cAAc;AACjB,WAAO,KAAK,OAAO,eAAe,KAAK,eAAgB;AAAA,EACzD;AAAA,EAEC,IAAI,mBAAmB;AACtB,WAAO,KAAK,OAAO,oBAAoB,KAAK,oBAAqB;AAAA,EACnE;AAAA,EAEC,sBAAsB;AACrB,WAAO;AAAA,EACT;AAAA,EAEC,YAAYE,GAAU;AACrB,QAAIA,aAAoBX;AACvB,WAAK,YAAYW;AAAA,aAET,OAAOA,EAAS,iBAAkB,cAC1C,OAAOA,EAAS,kBAAmB,cACnC,OAAOA,EAAS,kBAAmB;AAEnC,WAAK,YAAYA;AAAA;AAGjB,YAAM,IAAI,MAAM,mCAAmC;AAAA,EAEtD;AAAA,EAEC,IAAI,OAAO;AACV,WAAK,KAAK,UACT,KAAK,QAAQ,KAEP,KAAK;AAAA,EACd;AAAA,EAEC,IAAI,KAAKrR,GAAM;AzBnOhB,QAAAiC;AyByOE,QALI,OAAOjC,KAAS,aACnBA,IAAO+E,GAAa/E,CAAI,IAGzB,KAAK,QAAQA,GACTA,KAAQ,KAAK,mBAAmB,aAAa;AAChD,YAAMsR,IAAM,KAAK,QAAQ,cAAc,GAAG,KAAKvK,EAA0B,WAAW,KAAK,OAAO;AAChG,MAAAuK,EAAI,YAAYtR;AAAA,IACnB,WACW,KAAK,mBAAmB,aAAY;AAC5C,YAAMsR,IAAM,KAAK,QAAQ,cAAc,GAAG;AAC1C,MAAIA,KACH,KAAK,QAAQ,YAAYA,CAAG;AAAA,IAEhC;AAEE,KAAIrP,IAAA,KAAK,cAAL,QAAAA,EAAgB,iBACnB,KAAK,UAAU,cAAc,MAAM,KAAK,OAAOjC,CAAI;AAAA,EAEtD;AAAA,EAEC,IAAI,QAAQ;AACX,WAAO,KAAK,UAAU;AAAA,EACxB;AAAA,EAEC,IAAI,MAAM,GAAG;AzB7Pd,QAAAiC;AyB+PE,QADA,KAAK,SAAS,GACV,KAAK,KAAK,mBAAmB,aAAa;AAC7C,YAAMqP,IAAM,KAAK,QAAQ,cAAc,MAAM,KAAKvK,EAA0B,6BAA8B,KAAK,SAAS,aAAc,KAAK,OAAO;AAClJ,MAAAuK,EAAI,YAAY;AAAA,IACnB,WACW,KAAK,mBAAmB,aAAY;AAC5C,YAAMA,IAAM,KAAK,QAAQ,cAAc,MAAM;AAC7C,MAAIA,KACH,KAAK,QAAQ,YAAYA,CAAG;AAAA,IAEhC;AAEE,KAAIrP,IAAA,KAAK,cAAL,QAAAA,EAAgB,kBACnB,KAAK,UAAU,eAAe,MAAM,KAAK,QAAQ,CAAC;AAAA,EAErD;AAAA;AAAA,EAGC,IAAI,YAAY;AACf,WAAO;AAAA,EACT;AAAA;AAAA,EAGC,IAAI,OAAO;AzBrRZ,QAAAA;AyBuRE,aADaA,IAAA,KAAK,WAAL,gBAAAA,EAAa,SACX;AAAA,EACjB;AAAA,EAEC,IAAI,cAAc;AACjB,WAAO,KAAK,OAAO,eAAe,KAAK,eAAgB;AAAA,EACzD;AAAA,EAEC,iBAAiB;AAChB,WAAO;AAAA,EACT;AAAA;AAAA,EAGC,IAAI,kBAAkB;AzBnSvB,QAAAA;AyBqSE,aADeA,IAAA,KAAK,WAAL,gBAAAA,EAAa,oBACX;AAAA,EACnB;AAAA,EAEC,IAAI,YAAY;AAAE,WAAO;AAAA,EAAG;AAAA,EAE5B,SAAS;AACR,SAAK,WAAW,IAChB,KAAK,KAAM;AAAA,EACb;AAAA,EAEC,UAAU;AACT,SAAK,WAAW,IAChB,KAAK,KAAM;AAAA,EACb;AAAA,EAEC,OAAO;AACN,IAAI,KAAK,YACR,KAAK,QAAQ,MAAM,UAAU;AAAA,EAEhC;AAAA,EAEC,OAAO;AACN,QAAI,KAAK,aAAa;AACrB;AAED,UAAM,EAAE,OAAA6I,EAAO,IAAG,KAAK,OAAO,YAAY;AAC1C,IAAI,KAAK,YAAYA,IAAQ,KAAK,oBAAoB,KAAK,oBAAoB,mBAC9E,KAAK,QAAQ,MAAM,UAAU;AAAA,EAEhC;AAAA,EAGC,IAAI,oBAAoB;AACvB,WAAKrE,EAAA,MAAKwK,OACTzK,EAAA,MAAKyK,GAAqBT,GAAkB,IAC5C,KAAK,UAAU,YAAY/J,EAAA,MAAKwK,EAAkB,IAE5CxK,EAAA,MAAKwK;AAAA,EACd;AAAA,EAEC,IAAI,2BAA2B;AAC9B,WAAOxK,EAAA,MAAKwK,OAAuB;AAAA,EACrC;AAAA,EAGC,IAAI,qBAAqB;AACxB,WAAKxK,EAAA,MAAKyK,OACT1K,EAAA,MAAK0K,GAAsBV,OAC3B,KAAK,UAAU,YAAY/J,EAAA,MAAKyK,EAAmB,IAE7CzK,EAAA,MAAKyK;AAAA,EACd;AAAA,EAEC,IAAI,4BAA4B;AAC/B,WAAOzK,EAAA,MAAKyK,OAAwB;AAAA,EACtC;AAAA,EAEC,IAAI,YAAY;AACf,WAAO;AAAA,EACT;AAAA,EAEC,IAAI,YAAY;AACf,WAAO;AAAA,EACT;AAAA,EAEC,SAAS,EAAE,MAAApE,IAAO,MAAM,MAAA9M,IAAO,KAAM,IAAG,IAAI;AzBtW7C,QAAAiC,GAAA4N;AyBuWE,UAAMkB,IAAW,KAAK,aAChBJ,IAAW,KAAK;AACtB,SAAK,cAAc7D,GACnB,KAAK,cAAc9M,GACnByG,EAAA,MAAK0K,IAAsB,QAAQ,CAAAI,MAAMA,EAAG,IAAI,CAAC,GAC7C,KAAK,gBACR,KAAK,OAAO,KAAK,cAEd,KAAK,gBACR,KAAK,QAAQ,KAAK,eAGnB1B,KAAA5N,IAAA,KAAK,cAAL,gBAAAA,EAAgB,mBAAhB,QAAA4N,EAAA,KAAA5N,GAAiC,MAAM8O,GAAUjE,GAAM6D,GAAU3Q;AAAA,EACnE;AAAA,EAIC,cAAcuR,GAAI;AACjB,IAAI,OAAOA,KAAO,aACjB9K,EAAA,MAAK0K,IAAsB,KAAKI,CAAE,IAGlC,KAAK,OAAO,IAAI,KAAK,iDAAiD;AAAA,EAEzE;AAAA,EAEC,MAAM,OAAOjS,GAAOkS,IAAkB,MAAM;AAAA,EAC7C;AAAA,EAEC,SAAS,EAAE,OAAA1G,GAAO,QAAAC,KAAU;AAC3B,IAAID,IAAQ,KAAK,mBAChB,KAAK,KAAM,IAGX,KAAK,KAAM;AAAA,EAEd;AAAA,EAEC,QAAQ;AzB7YT,QAAA7I;AyB8YE,KAAAA,IAAA,KAAK,WAAL,QAAAA,EAAa;AAAA,EACf;AAAA,EAEC,OAAO;AzBjZR,QAAAA;AyBkZE,KAAAA,IAAA,KAAK,WAAL,QAAAA,EAAa;AAAA,EACf;AAAA,EAEC,UAAU;AACT,WAAO,KAAK,WAAW,SAAS;AAAA,EAClC;AACA;AApFCgP,IAAA,eAaAC,IAAA,eAqCAC,KAAA;ACvXD,MAAAM,KAAe;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,GCAfC,KAAe;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,GCAfC,KAAe;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;ACSA,MAAMC,WAAyBR,GAAa;AAAA,EAC1D,0BAA0B;AACnB,WAAOlE,GAAkB,IAAK;AAAA,EACtC;AAAA,EAEC,IAAI,OAAO;AACV,WAAO,MAAM,QAAQ;AAAA,EACvB;AAAA,EAEC,MAAM,OAAO;AACZ,UAAM2E,IAAW,KAAK,OAAO,oBAAoB,KAAK,MAAK,MAAM,KAAKJ,IAChEK,IAAY,KAAK,OAAO,oBAAoB,KAAK,MAAK,OAAO,KAAKJ,IAClEK,IAAa,KAAK,OAAO,oBAAoB,KAAK,MAAK,QAAQ,KAAKJ;AAC1E,SAAK,OAAOE,GACO,KAAK,OAAO,UAAU,KAAK,OAAO,kBAAkB,OAAO;AAC9E,UAAMG,IAAY,KAAK,OAAO,UAAU,KAAK,OAAO,iBAAiB,MAAM;AAC3E,IAAA/S,EAAU,KAAK,QAAQD,EAAO,MAAM,MAAM;AACzC,WAAK,OAAO8S,GACZ,KAAK,OAAO,YAAYE,GACxB,KAAK,OAAO,QAAQ,KAAK,OAAO,kBAAkBA;AAAA,IACrD,CAAG,GACD/S,EAAU,KAAK,QAAQD,EAAO,OAAO,MAAM;AAC1C,WAAK,OAAO6S,GACZ,KAAK,OAAO,YAAYG,GACxB,KAAK,OAAO,QAAQ,KAAK,OAAO,kBAAkBA;AAAA,IACrD,CAAG,GACD/S,EAAU,KAAK,QAAQD,EAAO,OAAO,MAAM;AAC1C,WAAK,OAAO+S,GACZ,KAAK,OAAO,YAAYC,GACxB,KAAK,OAAO,QAAQ,KAAK,OAAO,kBAAkBA;AAAA,IACrD,CAAG,GACD/S,EAAU,KAAK,QAAQD,EAAO,MAAM,MAAM;AACzC,WAAK,OAAO6S,GACZ,KAAK,OAAO,YAAYG,GACxB,KAAK,OAAO,QAAQ,KAAK,OAAO,kBAAkBA;AAAA,IACrD,CAAG;AAAA,EACH;AAAA,EAEC,MAAM,SAAS;AACd,IAAI,MAAM,KAAK,OAAO,WACrB,MAAM,KAAK,OAAO,eAAe,KAAM,IAGvC,MAAM,KAAK,OAAO,eAAe,MAAO;AAAA,EAE3C;AACA;ACpDA,MAAMC,KAAY,kCACZC,KAAa,IAAID,EAAS,oBAAoBA,EAAS,KAEvDE,KAAK;AAAA,EACP,WAAW,IAAI,OAAOD,EAAU;AACpC,GAEME,KAAW,CAACjG,GAASkG,GAAK5Q,GAAE6Q,MAAU;AACxC,QAAM9Q,IAAS2Q,GAAG,UAAU,KAAKE,CAAI;AACrC,MAAI7Q,GAAQ;AACR,UAAMmJ,IAAQ2H,EAAM7Q,IAAI,CAAC,GACnB8Q,IAAM,CAAE;AACd,aAASC,IAAI,GAAG/Q,IAAE+Q,IAAEF,EAAM,UAAUA,EAAM7Q,IAAE+Q,CAAC,MAAM,IAAI,EAAEA;AACrD,MAAAD,EAAI,KAAKD,EAAM7Q,IAAE+Q,CAAC,CAAC;AAEvB,IAAArG,EAAS,OAAO;AAAA,MACZ,OAAOxB;AAAA,MACP,OAAOnJ,EAAO,CAAC;AAAA,MACf,KAAKA,EAAO,CAAC;AAAA,MACb,UAAU+Q;AAAA,IACtB,CAAS;AAAA,EACT;AACA;AAEO,SAASE,GAAY3F,GAAM;AAC9B,QAAMX,IAAW,IAAIG,GAAU;AAE/B,SAAIQ,MAAS,OACTA,IAAOA,EAAK,QAAQ,UAAS;AAAA,CAAI,GACjCA,IAAOA,EAAK,QAAQ,QAAO;AAAA,CAAI,GAE/BA,EAAK,MAAM,IAAI,EAAE,QAAQ,CAACuF,GAAK,GAAEC,MAAU;AACvC,IAAAF,GAASjG,GAASkG,GAAK,GAAEC,CAAK;AAAA,EACjC,CAAA,IAGEnG;AACX;AAEe,MAAMuG,GAAa;AAAA,EAC9B,YAAY5F,IAAO,IAAI;AACnB,SAAK,QAAQA,GACb,KAAK,YAAY2F,GAAY3F,CAAI;AAAA,EACzC;AAAA,EAEI,IAAI,OAAO;AACP,WAAO,KAAK;AAAA,EACpB;AAAA,EAEI,IAAI,KAAKA,GAAM;AACX,SAAK,QAAQA,GACb,KAAK,YAAY2F,GAAY3F,CAAI;AAAA,EACzC;AAAA,EAEI,IAAI,WAAW;AACX,WAAO,KAAK;AAAA,EACpB;AACA;ACrDe,MAAM6F,WAAkCtG,GAAe;AAAA,EAClE,0BAA0B;AACtB,WAAOa,GAAkB,IAAK;AAAA,EACtC;AAAA,EAEI,IAAI,OAAO;AACb,WAAO,MAAM,QAAQ;AAAA,EACvB;AAAA,EAEI,MAAM,YAAY;AAEd,WADgB,MAAM,MAAM,UAAW,KAE/B,KAAK,OAAO,cAAc,YAC1B,KAAK,OAAO,cAAc,SAAS,SAAO;AAAA,EAC1D;AAAA,EAEI,MAAM,cAAc;AAChB,UAAM1L,IAAS,CAAE,GACX+G,IAAI,CAAE;AACZ,gBAAK,OAAO,cAAc,SAAS,QAAQ,CAAA4D,MAAY;AACnD,MAAA5D,EAAE,KAAK,IAAI,QAAQ,OAAOzI,GAASC,MAAW;AAC1C,YAAI,OAAO,KAAKoM,EAAS,MAAM,GAAG;AAC9B,gBAAMiB,IAAUxL,EAAoB,KAAK,QAAQuK,EAAS,GAAG,GACvDkB,IAAc,MAAM,MAAMD,CAAO;AACvC,cAAIC,EAAY,IAAI;AAChB,kBAAMP,IAAO,MAAMO,EAAY,KAAM,GAC/BC,IAAS,IAAIoF,GAAa5F,CAAI;AACpC,YAAAQ,EAAO,SAAS,QAAQnB,EAAS,MACjCmB,EAAO,SAAS,WAAWnB,EAAS,MACpC3K,EAAO,KAAK8L,EAAO,QAAQ,GAC3BxN,EAAS;AAAA,UACjC;AAEwB,YAAAC,EAAQ;AAAA,QAEhC;AAEoB,UAAAA,EAAQ;AAAA,MAE5B,CAAa,CAAC;AAAA,IACd,CAAS,GACD,MAAM,QAAQ,WAAWwI,CAAC,GACnB/G;AAAA,EACf;AACA;AC9Ce,MAAMoR,WAA+BxB,GAAa;AAAA,EAC7D,0BAA0B;AACtB,WAAOlE,GAAkB,IAAK;AAAA,EACtC;AAAA,EAEI,IAAI,OAAO;AACP,WAAO;AAAA,EACf;AAAA,EAEI,MAAM,OAAO;AACT,SAAK,QAAQzK,GAAc,CAAC;AAE5B,UAAMoQ,IAAc,YAAY;AAC5B,YAAMC,IAAc,MAAM,KAAK,OAAO,eAAe,YAAa;AAClE,UAAIhC,IAAWrO,GAAcqQ,CAAW;AAExC,UAAI,KAAK,OAAO,eAAe;AAC3B,cAAMC,IAAW,MAAM,KAAK,OAAO,eAAe,SAAU;AAC5D,QAAAjC,KAAY,MAAMrO,GAAcsQ,CAAQ,CAAC;AAAA,MACzD;AAEY,WAAK,QAAQjC;AAAA,IACzB;AAEQ,SAAK,OAAO,UAAU9R,EAAO,YAAY,MAAM6T,GAAa,GAC5D,KAAK,OAAO,UAAU7T,EAAO,kBAAkB,MAAM6T,GAAa,GAClE,KAAK,OAAO,UAAU7T,EAAO,MAAM,MAAM6T,GAAa;AAAA,EAC9D;AAAA,EAEI,IAAI,cAAc;AACd,WAAO;AAAA,EACf;AAAA,EAEI,IAAI,eAAe;AACf,WAAO;AAAA,EACf;AACA;ACpCO,SAASG,GAAgB9T,GAAQuJ,GAAY;AAIhD,SAFewK,GAAiB/T,GAAQ,QAAQ,EAC3C,OAAO,CAAAgU,MAAUA,EAAO,UAAUA,EAAO,OAAO,WAAWA,EAAO,SAASzK,CAAU,CAAC;AAE/F;AAYO,SAAS0K,GAAmBjU,GAAQuJ,GAAY;AACnD,QAAM2K,IAAeJ,GAAgB9T,GAAQuJ,CAAU,GACjDjH,IAAS,CAAE;AACjB,SAAA4R,EAAa,QAAQ,CAAAC,MAAM;AACvB,IAAA7R,EAAO,KAAK,GAAG6R,EAAG,mBAAmB5K,CAAU,CAAC;AAAA,EACxD,CAAK,GACMjH;AACX;AAGO,SAAS8R,GAAuBpU,GAAQqU,GAAiB;AAC5D,QAAM/R,IAAS,CAAE;AACjB,SAAAyR,GAAiB/T,GAAQ,QAAQ,EAC5B,OAAO,CAAAgU,MAAU;AjClC1B,QAAAjR,GAAA4N;AiCmCY,SAAI5N,IAAAiR,EAAO,WAAP,QAAAjR,EAAe,aAAW4N,IAAAqD,EAAO,WAAP,QAAArD,EAAe;AACzC,aAAOqD,EAAO,OAAO,aAAa,MAAM,CAAAM,MAAWA,EAAQ,QAAQ,WAAWD,CAAe;AAAA,EAEpG,CAAA,EACA,QAAQ,CAAAL,MAAUA,EAAO,OAAO,aAAa,QAAQ,CAAAtP,MAAKpC,EAAO,KAAKoC,EAAE,OAAO,CAAC,CAAC,GAC/EpC;AACX;AAEO,SAASiS,GAAuBvU,GAAQuJ,GAAYiL,GAAW;AAClE,QAAMC,IAAUX,GAAgB9T,GAAQuJ,CAAU;AAClD,MAAIjH,IAAS;AACb,SAAAmS,EAAQ,KAAK,CAAAT,MAAU;AACnB,QAAIA,EAAO,mBAAmBzK,CAAU,EAAE,QAAQiL,CAAS,MAAM;AAC7D,aAAAlS,IAAS0R,GACF;AAAA,EAEnB,CAAK,GACM1R;AACX;AAEO,SAASoS,GAAwB1U,GAAQuJ,GAAY;AACxD,QAAM2K,IAAeJ,GAAgB9T,GAAQuJ,CAAU,GACjDoL,IAAWV,GAAmBjU,GAAQuJ,CAAU;AACtD,MAAIjH,IAAS,CAAA;AACb,SAAA4R,EAAa,QAAQ,CAAAC,MAAM;AACvB,IAAA7R,IAAS,CAAC,GAAGA,GAAO,GAAG6R,EAAG,OAAO,YAAY;AAAA,EACrD,CAAK,GAEM7R,EAAO,OAAO,CAAAsS,MACVD,EAAS,QAAQC,EAAI,EAAE,MAAM,EACvC;AACL;AAEO,SAASC,GAAmB7U,GAAQuJ,GAAYiL,GAAWM,IAAc,MAAM;AAClF,QAAMC,IAAiBR,GAAuBvU,GAAQuJ,GAAYiL,CAAS;AAC3E,MAAIO,GAAgB;AAChB,UAAMC,IAAYD,EAAe,mBAAmBxL,GAAYiL,GAAWM,CAAW;AACtF,WAAAE,EAAU,SAASD,GACZC;AAAA,EACf;AACI,SAAO;AACX;AAEe,MAAMC,WAAoB5G,GAAoB;AAAA,EAEzD,IAAI,OAAO;AAAE,WAAO;AAAA,EAAS;AAAA,EAE7B,IAAI,aAAa;AACb,WAAO;AAAA,EACf;AAAA,EAEI,mBAAmB;AACf,WAAO;AAAA,EACf;AAAA,EAEI,IAAI,gBAAgB;AjC1FxB,QAAAtL;AiC2FQ,aAAOA,IAAA,KAAK,WAAL,gBAAAA,EAAa,kBAAiB,KAAK,iBAAkB;AAAA,EACpE;AAAA;AAAA,EAGI,IAAI,aAAa;AAAE,WAAO;AAAA,EAAU;AAAA,EAEpC,IAAI,OAAO;AAAE,WAAO;AAAA,EAAW;AAAA;AAAA,EAG/B,IAAI,eAAe;AjCpGvB,QAAAA;AiCqGQ,aAAOA,IAAA,KAAK,WAAL,gBAAAA,EAAa,iBAAgB,CAAE;AAAA,EAC9C;AAAA,EAEI,IAAI,kBAAkB;AAClB,UAAMT,IAAS,CAAE;AACjB,gBAAK,aAAa,QAAQ,CAAAoC,MAAKpC,EAAO,KAAKoC,EAAE,EAAE,CAAC,GACzCpC;AAAA,EACf;AAAA;AAAA,EAGI,mBAAmBiH,GAAY;AAC3B,UAAM2L,IAAa,CAAE;AACrB,gBAAK,aAAa,QAAQ,CAAAC,MAAgB;AACtC,MAAIA,EAAa,QAAQ,MAAM,CAAAzQ,MACpB6E,EAAW,KAAK,CAAA6L,MAAM1Q,MAAM0Q,EAAG,OAAO,CAChD,KACGF,EAAW,KAAKC,EAAa,EAAE;AAAA,IAE/C,CAAS,GAEMD;AAAA,EACf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAWI,gBAAgB3L,GAAY;AACxB,UAAM8L,IAAe,CAAE;AACvB,gBAAK,aAAa,QAAQ,CAAAF,MAAgB;AACtC,UAAIG,IAAyB,CAAE;AAC/B,MAAIH,EAAa,QAAQ,MAAM,CAAAzQ,MACpB6E,EAAW,KAAK,CAAA6L,MAAM;AACzB,YAAI1Q,MAAM0Q,EAAG;AACT,iBAAAE,EAAuB,KAAKF,CAAE,GACvB;AAAA,MAEd,CAAA,CACJ,KACGC,EAAa,KAAKC,CAAsB;AAAA,IAExD,CAAS,GAEMD;AAAA,EACf;AAAA,EAEI,SAAS9L,GAAY;AACjB,WAAO,KAAK,gBAAgBA,CAAU,EAAE,SAAS;AAAA,EACzD;AAAA,EAEI,qBAA6D;AACzD,WAAO,CAAE;AAAA,EACjB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAYI,sBAAsBgM,GAASpP,GAAOqP,GAAa;AAC/C,WAAO,CAAA;AAAA,EACf;AACA;AChKO,SAASC,GAAsBzM,GAAQ;AAC1C,SAAO;AAAA,IACH,MAAMA,EAAO;AAAA,IACb,UAAUA,EAAO;AAAA,IACjB,OAAOA,EAAO;AAAA,IACd,WAAWA,EAAO;AAAA,IAClB,MAAMA,EAAO;AAAA,IACb,OAAO,OAAOuM,MAAY;AACtB,YAAMG,IAAS1M,EAAO,OAAO,eAAe,eAAe,QAAQuM,CAAO;AAC1E,YAAMvM,EAAO,OAAOuM,GAASG,KAAA,gBAAAA,EAAQ,QAAQA,KAAA,gBAAAA,EAAQ,QAAQA,KAAA,gBAAAA,EAAQ,YAAY;AAAA,IAC7F;AAAA,EACA;AACA;AAEO,eAAeC,GAAiB3V,GAAQmG,GAAO;AAClD,QAAM7D,IAAS,CAAE;AACjB,eAAMyG;AAAA,IAAkB/I;AAAA,IAAQ;AAAA,IAC5B,OAAOgJ,MAAW;AACd,MAAAhJ,EAAO,IAAI,MAAM,0BAA2BgJ,EAAO,IAAI,EAAG,GAC1D1G,EAAO,KAAK0G,CAAM;AAAA,IAC9B;AAAA,EAAS,GAEE1G,EAAO,OAAO,CAAA0G,MAENA,EAAO,QAAQ,QAAQ7C,EAAM,OAAO,MAAM,EACpD,EACA,IAAI,CAAA6C,MACMyM,GAAsBzM,CAAM,CACtC;AACT;AAGe,MAAM4M,WAA2BvH,GAAoB;AAAA,EAChE,IAAI,OAAO;AAAE,WAAO;AAAA,EAAc;AAAA,EAElC,IAAI,UAAU;AACV,WAAO,KAAK,QAAQ,WAAW,CAAC,WAAW;AAAA,EACnD;AAAA,EAEI,IAAI,YAAY;AACZ,WAAO,KAAK,QAAQ,aAAa,KAAK,aAAc;AAAA,EAC5D;AAAA,EAEI,eAAe;AACX,WAAO;AAAA,EACf;AAAA,EAEI,IAAI,WAAW;AACX,WAAO,KAAK,OAAO;AAAA,EAC3B;AAAA,EAEI,IAAI,cAAc;AACd,WAAO,KAAK,OAAO,eAAe,KAAK,eAAgB;AAAA,EAC/D;AAAA,EAEI,iBAAiB;AACb,WAAO;AAAA,EACf;AAAA,EAEI,IAAI,OAAO;AACP,WAAO,KAAK;AAAA,EACpB;AAAA,EAEI,IAAI,KAAKvN,GAAM;AACX,SAAK,QAAQA;AAAA,EACrB;AAAA,EAEI,IAAI,OAAO;AlChFf,QAAAiC;AkCiFQ,aAAOA,IAAA,KAAK,WAAL,gBAAAA,EAAa,SAAQ;AAAA,EACpC;AAAA,EAEI,IAAI,aAAa;AACb,WAAO,KAAK;AAAA,EACpB;AAAA,EAEI,IAAI,WAAW;AACX,YAAQ,KAAK,MAAI;AAAA,MACjB,KAAK;AACD,eAAO8S,EAAqB;AAAA,MAChC,KAAK;AACD,eAAOA,EAAqB;AAAA,MAChC,KAAK;AACD,eAAOA,EAAqB;AAAA,MAChC;AACI,cAAM,IAAI,MAAM,wCAAyC,KAAK,IAAM,EAAC;AAAA,IACjF;AAAA,EACA;AAAA,EAEI,MAAM,OAAON,GAAS;AAClB,SAAK,OAAO,IAAI,KAAK,kDAAmD,KAAK,IAAI,EAAG;AAAA,EAC5F;AACA;AClGA,MAAMO,KAAyB,CAAE;AAC1B,eAAeC,GAAkB/V,GAAQ;AAC5C,QAAM+I,EAAkB/I,GAAQ,UAAU,CAACgJ,MAAW;AAClD,IAAA8M,GAAuB,KAAK9M,CAAM;AAAA,EAC1C,CAAK;AACL;AAEO,eAAegN,GAAoBhW,GAAQ;AAElD;AAEO,SAASiW,GAAgBjW,GAAQ0V,GAAQ;AAC5C,MAAII,GAAuB,WAAW;AAClC,UAAM,MAAM,6GAA6G;AAE7H,MAAI9M,IAAS;AAEb,SAAA8M,GAAuB,KAAK,CAAAzM,MAAK;AAC7B,QAAIA,EAAE,aAAaqM,CAAM;AACrB,aAAA1M,IAASK,GACF;AAAA,EAEnB,CAAK,GAEML;AACX;AAEY,MAAC6M,IAAuB,OAAO,OAAO;AAAA,EAC9C,MAAM;AAAA,EACN,QAAQ;AAAA,EACR,OAAO;AACX,CAAC,GAEKK,KAAY,SAAS;AAAA,EACvB,MAAApV;AAAA,EACA,UAAAkQ;AAAA,EACA,WAAAJ;AAAA,EACA,OAAAuF;AAAA,EACA,WAAAC;AAAA,EACA,UAAAC,IAAWR,EAAqB;AAAA,EAChC,OAAAS;AAAA,EACA,SAAAf;AAAA,EACA,MAAArU;AACJ,GAAG;AACC,MAAI,CAACJ;AACD,UAAM,IAAI,MAAM,sFAAsF;AAE1G,MAAI,CAACwV;AACD,UAAM,IAAI,MAAM,sFAAsF;AAE1G,MAAI7O,IAAa,gBAAgB4O,CAAQ,GAAID,IAAY,MAAMA,IAAY,EAAE;AAC7E,EAAIxF,MACAnJ,KAAc,gBAAgBmJ,CAAS,MAEvCuF,MACA1O,KAAc,WAAW0O,CAAK,MAE9BnF,MAAa,WACbvJ,KAAc,cAAcuJ,CAAQ,MAEpC9P,MAAS,WACTuG,KAAc,UAAUvG,CAAI;AAEhC,QAAMqV,IAAM1O,EAA0B;AAAA,kBACxBJ,CAAU,wDAAyD3G,CAAM;AAAA,KACtF;AACD,cAAK,YAAY,YAAYyV,CAAG,GAChCA,EAAI,iBAAiB,SAAS,OAAOlT,OACjCA,EAAI,gBAAiB,GACrB,MAAMiT,EAAMf,CAAO,GACZ,GACV,GACMgB;AACX,GAEaC,KAAuB,OAAOxW,GAAQyW,GAAiBC,GAAQvQ,GAAOoP,MAAY;AAC3F,QAAMvM,IAASyN,EAAgB;AAC/B,MAAIE,IAAgB3N,EAAO;AAC3B,QAAM4N,IAAkB,MAAMjB,GAAiB3V,GAAQmG,CAAK,GACtD0Q,IAAiB,CAAE;AAGzB,SAFgB;AAAA,IAAC,GAAGD;AAAA,IAChB,GAAG5N,EAAO,sBAAsByN,GAAiBtQ,EAAM,SAASA,GAAOuQ,CAAM;AAAA,EAAC,EAC1E,QAAQ,CAAAI,MAAW;AACvB,IAAAA,EAAQ,WAAWH,KACnBG,EAAQ,UAAUvB;AAClB,UAAMgB,IAAML,GAAU,MAAMQ,GAAQ,CAACI,CAAO,CAAC;AAC7C,IAAAD,EAAe,KAAKN,CAAG;AAAA,EAC/B,CAAK,GAEMM;AACX,GAEaE,KAAc,CAAC/W,GAAQyW,GAAiBO,MAAY;AAC7D,MAAI,EAAE,eAAAL,MAAkBF,EAAgB;AACxC,EAAAO,EAAQ,KAAK,CAACC,GAAGC,MAAO;AACpB,UAAMC,IAASF,EAAG,sBAAqB,EAAG,MACpCG,IAASF,EAAG,sBAAqB,EAAG;AAC1C,WAAOC,IAASC;AAAA,EACxB,CAAK,EAAE,QAAQ,CAAAb,MAAO;AACd,IAAAA,EAAI,aAAa,YAAWI,GAAe;AAAA,EAC9C,CAAA;AACL;AAEO,MAAMU,WAAepP,EAAS;AAAA,EACjC,YAAY/B,GAAKlG,GAAQ4H,GAAQ;AAC7B,UAAM5H,GAAQ,EAAE,KAAAkG,GAAK,QAAA0B,EAAM,CAAE,GAC7B,KAAK,QAAQ,YAAY,gBAEzB,KAAK,YAAY,MAEjB,KAAK,eAAeC,EAA0B;AAAA;AAAA;AAAA,WAG3C,KAAK,OAAO;AAAA,EACvB;AAAA,EAEI,MAAM,WAAW7H,GAAQ;AACrB,UAAM,MAAM,GAAG,KAAK,IAAI,gCAAgC;AAAA,EAChE;AAAA,EAEI,IAAI,WAAW;AACX,WAAK,KAAK,cACN,KAAK,YAAY,SAAS,cAAc,KAAK,GAC7C,KAAK,UAAU,YAAY,aAC3B,KAAK,QAAQ,YAAY,KAAK,SAAS,IAEpC,KAAK;AAAA,EACpB;AAAA,EAEI,IAAI,cAAc;AACd,WAAO,KAAK;AAAA,EACpB;AAAA,EAEI,cAAc;AACV,SAAK,YAAY,MAAM,UAAU;AAAA,EACzC;AAAA,EAEI,cAAc;AACV,SAAK,YAAY,MAAM,UAAU;AAAA,EACzC;AACA;AAEe,MAAMsX,WAAqB5O,GAAO;AAAA,EAC7C,IAAI,OAAO;AAAE,WAAO;AAAA,EAAS;AAAA,EAE7B,IAAI,aAAa;AAAE,WAAO;AAAA,EAAG;AAAA,EAE7B,aAAagN,GAAQ;AACjB,WAAI,MAAM,QAAQA,KAAA,gBAAAA,EAAQ,MAAM,IACrBA,EAAO,OAAO,QAAQ,KAAK,UAAU,MAAM,KAG3CA,EAAO,WAAW,KAAK;AAAA,EAE1C;AAAA,EAEI,kBAAkB6B,GAAgB;AAC9B,UAAM,MAAM,GAAG,KAAK,IAAI,qDAAqD;AAAA,EACrF;AACA;ACnKA,IAAIvN,KAAiB;AAEN,MAAMwN,UAA0BzN,GAAa;AAAA,EACxD,OAAO,MAAM;AACT,WAAKC,OACDA,KAAiB,IAAIwN,EAAmB,IAErCxN;AAAAA,EACf;AAAA,EAEI,IAAI,aAAa;AACb,WAAO;AAAA,EACf;AAAA,EAEI,IAAI,gBAAgB;AAChB,WAAOE,GAAY;AAAA,EAC3B;AACA;ACpBA,MAAAuN,KAAe;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,GCAfC,KAAe;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,GCAfC,KAAe;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SCAfC,KAAe;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,GCAfC,KAAe;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;ACYA,MAAMC,WAA+B7C,GAAY;AAAA,EAC5D,0BAA0B;AACtB,WAAOuC,EAAkB,IAAK;AAAA,EACtC;AAAA,EAEI,IAAI,OAAO;AACb,WAAO,MAAM,QAAQ;AAAA,EACvB;AAAA,EAEI,IAAI,aAAa;AACb,WAAO;AAAA,EACf;AAAA,EAEI,MAAM,OAAO;AACT,SAAK,gBAAgB,KAAK,OAAO,iBAAiB,CAAE,GACpD,KAAK,kBAAkB,KAAK,OAAO,oBAAoB,SAAY,KAAK,OAAO,kBAAkB;AAAA,EACzG;AAAA,EAEI,sBAAsBf,GAAiBlB,GAASpP,GAAOqP,GAAa;AAChE,UAAMuC,IAAe,KAAK,OAAO,oBAAoB,KAAK,MAAK,cAAc,KAAKL,IAC5EM,IAAiB,KAAK,OAAO,oBAAoB,KAAK,MAAK,gBAAgB,KAAKJ,IAChFK,IAAiB,KAAK,OAAO,oBAAoB,KAAK,MAAK,gBAAgB,KAAKC,IAChFC,IAAY,KAAK,OAAO,oBAAoB,KAAK,MAAK,WAAW,KAAKR,IACtES,IAAU,KAAK,OAAO,oBAAoB,KAAK,MAAK,SAAS,KAAKP,IAClEQ,IAAa,MAAM,KAAK,gBAAgB,KAAK,CAAAlE,MAAMA,EAAG,OAAOoB,CAAO,GACpE+C,IAAc,MAAMD,EAAY,EAAC,SAAS,IAC1CE,IAAc,MAAMF,EAAY,EAAC,OAAO,IACxC/V,IAAS,CAAE;AAEjB,WAAIgW,EAAW,KAAMC,MACjBjW,EAAO,KAAK;AAAA,MACR,MAAM0V;AAAA,MACN,UAAUnC,EAAqB;AAAA,MAC/B,OAAO,KAAK,OAAO,UAAU,iBAAiB;AAAA,MAC9C,WAAW,KAAK,OAAO,UAAU,iBAAiB;AAAA,MAClD,MAAM,KAAK,OAAO;AAAA,MAClB,OAAO,YAAY;AACf,aAAK,gBAAgB,QAAQ,CAAA1B,MAAM;AAC/B,UAAAA,EAAG,OAAO;AAAA,QAClC,CAAqB,GACD,MAAM,KAAK,OAAO,eAAe,aAAc;AAAA,MACnE;AAAA,IACA,CAAa,IAGD7R,EAAO,KAAK;AAAA,MACR,MAAMyV;AAAA,MACN,UAAUlC,EAAqB;AAAA,MAC/B,OAAO,KAAK,OAAO,UAAU,gBAAgB;AAAA,MAC7C,WAAW,KAAK,OAAO,UAAU,gBAAgB;AAAA,MACjD,MAAM,KAAK,OAAO;AAAA,MAClB,OAAO,YAAY;AACf,aAAK,gBAAgB,QAAQ,CAAA1B,MAAM;AAC/B,UAAAA,EAAG,OAAOA,EAAG,OAAOoB,IAAU,KAAK;AAAA,QAC3D,CAAqB,GACD,MAAM,KAAK,OAAO,eAAe,aAAc;AAAA,MACnE;AAAA,IACA,CAAa,GAGD,KAAK,mBACLjT,EAAO,KAAK;AAAA,MACR,MAAM2V;AAAA,MACN,UAAUpC,EAAqB;AAAA,MAC/B,OAAO,KAAK,OAAO,UAAU,aAAa;AAAA,MAC1C,WAAW,KAAK,OAAO,UAAU,aAAa;AAAA,MAC9C,MAAM,KAAK,OAAO;AAAA,MAClB,OAAO,YAAY;AACf,cAAM2C,IAAM,KAAK,gBAAgB,CAAC,EAAE,IAC9BC,IAAM,KAAK,gBAAgB,CAAC,EAAE,IAC9BC,IAAU,KAAK,gBAAgB,CAAC,EAAE,MAClCC,IAAU,KAAK,gBAAgB,CAAC,EAAE;AACxC,aAAK,gBAAgB,CAAC,EAAE,KAAKF,GAC7B,KAAK,gBAAgB,CAAC,EAAE,OAAOE,GAC/B,KAAK,gBAAgB,CAAC,EAAE,KAAKH,GAC7B,KAAK,gBAAgB,CAAC,EAAE,OAAOE,GAC/B,MAAM,KAAK,OAAO,eAAe,aAAc;AAAA,MACnE;AAAA,IACA,CAAa,GAGLpW,EAAO,KAAK;AAAA,MACR,MAAM6V;AAAA,MACN,UAAUtC,EAAqB;AAAA,MAC/B,OAAO,KAAK,OAAO,UAAU,aAAa;AAAA,MAC1C,WAAW,KAAK,OAAO,UAAU,aAAa;AAAA,MAC9C,MAAM,KAAK,OAAO;AAAA,MAClB,OAAO,YAAY;AAEf,cAAMrB,IADyB,KAAK,OAAO,eAAe,gBAAgB,OAAO,CAAAoE,MAAOA,EAAI,QAAQ,GAAG,MAAM,EAAE,EACtE,KAAK,CAAAA,MAAOA,KAAOrD,CAAO;AACnE,cAAM,KAAK,OAAO,eAAe,UAAUf,CAAS;AAAA,MACpE;AAAA,IACA,CAAS,GAEG,KAAK,cAAc,SAAS,KAC5BlS,EAAO,KAAK;AAAA,MACR,MAAM8V;AAAA,MACN,UAAUvC,EAAqB;AAAA,MAC/B,OAAO,KAAK,OAAO,UAAU,oBAAoB;AAAA,MACjD,WAAW,KAAK,OAAO,UAAU,oBAAoB;AAAA,MACrD,MAAM,KAAK,OAAO;AAAA,MAClB,OAAO,YAAY;AACf,cAAMrB,IAAY,KAAK,OAAO,eAAe,gBAAgB,KAAK,CAAAoE,MAAO,KAAK,cAAc,QAAQA,CAAG,MAAM,EAAE;AAC/G,cAAM,KAAK,OAAO,eAAe,UAAUpE,GAAUe,CAAO;AAAA,MAChF;AAAA,IACa,CAAA,GAGEjT;AAAA,EACf;AAAA,EAEI,mBAAmBiH,GAAYiL,GAAWM,GAAa;AACnD,QAAI,CAAC,KAAK,iBAAiB;AACvB,YAAM,EAAE,SAAAS,MAAY,KAAK,aAAa,KAAK,CAAAA,MAAWA,EAAQ,OAAOf,CAAS;AAC9E,WAAK,kBAAkBe,EAAQ,IAAI,CAAA7Q,OACxB;AAAA,QACH,IAAIA;AAAA,QACJ,MAAM;AAAA,MAC1B,EACa;AAAA,IACb;AACQ,WAAO;AAAA,MACH,IAAI;AAAA,MACJ,QAAQ;AAAA,QACJ;AAAA,UACI,SAAS,KAAK,gBAAgB,CAAC,EAAE;AAAA,UACjC,SAAS;AAAA,UACT,MAAM,KAAK,gBAAgB,CAAC,EAAE;AAAA,QACjC;AAAA,QACD;AAAA,UACI,SAAS,KAAK,gBAAgB,CAAC,EAAE;AAAA,UACjC,SAAS;AAAA,UACT,MAAM,KAAK,gBAAgB,CAAC,EAAE;AAAA,QAClD;AAAA,MACA;AAAA,IACA;AAAA,EACA;AACA;ACrJA,MAAAmU,KAAe;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,GCAfC,KAAe;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;ACYf,IAAI9E,IAAS;AAIb,MAAMS,KAAU;AAAA;AAAA,EAEZ;AAAA,IACI,IAAI;AAAA,IACJ,QAAQ;AAAA,MACJ;AAAA,QACI,SAAQ;AAAA,QACR,MAAK;AAAA,UACD,EAAC,aAAY,QAAO,OAAM,KAAI,QAAO,KAAI,KAAI,KAAI,MAAK,IAAG;AAAA,UACzD,EAAC,aAAY,SAAQ,OAAM,KAAI,QAAO,KAAI,KAAI,KAAI,MAAK,IAAG;AAAA,UAC1D,EAAC,aAAY,OAAM,OAAM,KAAI,QAAO,KAAI,KAAI,KAAI,MAAK,IAAG;AAAA,UACxD,EAAC,aAAY,OAAM,OAAM,KAAI,QAAO,KAAI,KAAI,KAAI,MAAK,IAAG;AAAA,UACxD,EAAC,aAAY,OAAM,OAAM,KAAI,QAAO,KAAI,KAAI,KAAI,MAAK,IAAG;AAAA,QAC3D;AAAA,QACD,SAAQ;AAAA,QACR,OAAM;AAAA,MACT;AAAA,MACD;AAAA,QACI,SAAQ;AAAA,QACR,MAAK;AAAA,UACD,EAAC,aAAY,QAAO,OAAM,KAAI,QAAO,KAAI,KAAI,KAAI,MAAK,GAAE;AAAA,UACxD,EAAC,aAAY,SAAQ,OAAM,KAAI,QAAO,KAAI,KAAI,KAAI,MAAK,GAAE;AAAA,UACzD,EAAC,aAAY,OAAM,OAAM,KAAI,QAAO,KAAI,KAAI,KAAI,MAAK,GAAE;AAAA,UACvD,EAAC,aAAY,OAAM,OAAM,KAAI,QAAO,KAAI,KAAI,KAAI,MAAK,GAAE;AAAA,UACvD,EAAC,aAAY,OAAM,OAAM,KAAI,QAAO,KAAI,KAAI,IAAG,MAAK,GAAE;AAAA,QACzD;AAAA,QACD,SAAQ;AAAA,QACR,OAAM;AAAA,MACtB;AAAA,IACS;AAAA,IACD,SAAS,CAAA;AAAA,EACZ;AAAA;AAAA,EAGD;AAAA,IACI,IAAI;AAAA,IACJ,QAAO;AAAA,MACH;AAAA,QACI,SAAQ;AAAA,QACR,MAAK;AAAA,UACD,EAAC,aAAY,QAAO,MAAK,GAAE,KAAI,GAAE,OAAM,MAAK,QAAO,IAAG;AAAA,UACtD,EAAC,aAAY,SAAQ,MAAK,IAAG,KAAI,GAAE,OAAM,MAAK,QAAO,IAAG;AAAA,UACxD,EAAC,aAAY,OAAM,MAAK,IAAG,KAAI,GAAE,OAAM,MAAK,QAAO,IAAG;AAAA,UACtD,EAAC,aAAY,OAAM,MAAK,KAAI,KAAI,GAAE,OAAM,KAAI,QAAO,IAAG;AAAA,UACtD,EAAC,aAAY,OAAM,MAAK,KAAI,KAAI,GAAE,OAAM,KAAI,QAAO,IAAG;AAAA,QACzD;AAAA,QACD,SAAQ;AAAA,QACR,OAAM;AAAA,MACT;AAAA,MACD;AAAA,QACI,SAAQ;AAAA,QACR,MAAK;AAAA,UACD,EAAC,aAAY,QAAO,MAAK,IAAG,KAAI,KAAI,OAAM,KAAI,QAAO,IAAG;AAAA,UACxD,EAAC,aAAY,SAAQ,MAAK,IAAG,KAAI,KAAI,OAAM,KAAI,QAAO,IAAG;AAAA,UACzD,EAAC,aAAY,OAAM,MAAK,IAAG,KAAI,KAAI,OAAM,KAAI,QAAO,IAAG;AAAA,UACvD,EAAC,aAAY,OAAM,MAAK,IAAG,KAAI,KAAI,OAAM,KAAI,QAAO,IAAG;AAAA,UACvD,EAAC,aAAY,OAAM,MAAK,IAAG,KAAI,KAAI,OAAM,KAAI,QAAO,IAAG;AAAA,QAC1D;AAAA,QACD,SAAQ;AAAA,QACR,OAAM;AAAA,MACtB;AAAA,IACS;AAAA,IACD,SAAS,CAAA;AAAA,EACZ;AAAA;AAAA,EAGD;AAAA,IACI,IAAI;AAAA,IACJ,QAAQ;AAAA,MACJ;AAAA,QACI,SAAQ;AAAA,QACR,MAAK;AAAA,UACD,EAAC,aAAY,QAAO,MAAK,GAAE,KAAI,GAAE,OAAM,MAAK,QAAO,IAAG;AAAA,UACtD,EAAC,aAAY,SAAQ,MAAK,IAAG,KAAI,GAAE,OAAM,MAAK,QAAO,IAAG;AAAA,UACxD,EAAC,aAAY,OAAM,MAAK,IAAG,KAAI,GAAE,OAAM,MAAK,QAAO,IAAG;AAAA,UACtD,EAAC,aAAY,OAAM,MAAK,KAAI,KAAI,GAAE,OAAM,KAAI,QAAO,IAAG;AAAA,UACtD,EAAC,aAAY,OAAM,MAAK,KAAI,KAAI,GAAE,OAAM,KAAI,QAAO,IAAG;AAAA,QACzD;AAAA,QACD,SAAQ;AAAA,QACR,OAAM;AAAA,MACT;AAAA,MACD;AAAA,QACI,SAAQ;AAAA,QACR,MAAK;AAAA,UACD,EAAC,aAAY,QAAO,MAAK,KAAI,KAAI,KAAI,OAAM,KAAI,QAAO,IAAG;AAAA,UACzD,EAAC,aAAY,SAAQ,MAAK,KAAI,KAAI,KAAI,OAAM,KAAI,QAAO,IAAG;AAAA,UAC1D,EAAC,aAAY,OAAM,MAAK,KAAI,KAAI,KAAI,OAAM,KAAI,QAAO,IAAG;AAAA,UACxD,EAAC,aAAY,OAAM,MAAK,KAAI,KAAI,KAAI,OAAM,KAAI,QAAO,IAAG;AAAA,UACxD,EAAC,aAAY,OAAM,MAAK,KAAI,KAAI,KAAI,OAAM,KAAI,QAAO,IAAG;AAAA,QAC3D;AAAA,QACD,SAAQ;AAAA,QACR,OAAM;AAAA,MACtB;AAAA,IACS;AAAA,IACD,SAAS,CAAA;AAAA,EACjB;AACA;AAEA,SAASsE,GAAW5D,GAAc;AAC9BnB,SAAAA,KAAUA,IAAS,KAAKS,GAAQ,QACzBuE,GAAc7D,CAAY;AACrC;AAEA,SAAS8D,GAAU9D,GAAcxT,GAAO;AACpCqS,SAAAA,IAASrS,IAAQ8S,GAAQ,SAAS9S,IAAQqS,GACnCgF,GAAc7D,CAAY;AACrC;AAEA,SAAS6D,GAAc7D,GAAc;AACjC,MAAIJ,IAAiB,KAAK,MAAM,KAAK,UAAUN,GAAQT,CAAM,CAAC,CAAC;AAC/D,SAAAe,EAAe,OAAO,CAAC,EAAE,UAAUI,EAAa,CAAC,GACjDJ,EAAe,OAAO,CAAC,EAAE,UAAUI,EAAa,CAAC,GAC1CJ;AACX;AAEe,MAAMmE,WAAwBjE,GAAY;AAAA,EACrD,0BAA0B;AACtB,WAAOuC,EAAkB,IAAK;AAAA,EACtC;AAAA,EAEI,IAAI,OAAO;AACb,WAAO,MAAM,QAAQ;AAAA,EACvB;AAAA,EAEI,IAAI,aAAa;AAAE,WAAO;AAAA,EAAa;AAAA,EAEvC,MAAM,OAAO;AACT,QAAI2B,IAAc3U,EAAU,sBAAsB;AAClD,IAAI2U,MAAgB,OAChBnF,IAAS,OAAOmF,CAAW,IAE/B,KAAK,OAAO,IAAI,MAAM,0BAA0B;AAAA,EACxD;AAAA,EAEI,gBAAgB5P,GAAY;AAGxB,WAAO,MAAM,gBAAgBA,CAAU,EAClC,OAAO,CAAAmM,MAAUA,EAAO,WAAW,CAAC;AAAA,EACjD;AAAA,EAEI,gBAAgB;AACZ,UAAM0D,IAAK,KAAK,gBAAgB,CAAC,GAC3BC,IAAK,KAAK,gBAAgB,CAAC;AACjC,SAAK,gBAAgB,CAAC,IAAIA,GAC1B,KAAK,gBAAgB,CAAC,IAAID,GAE1B,KAAK,OAAO,eAAe,aAAc;AAAA,EACjD;AAAA,EAEI,MAAM,kBAAkB;AACpB,IAAAL,GAAW,KAAK,eAAe,GAC/B,MAAM,KAAK,OAAO,eAAe,aAAc;AAAA,EACvD;AAAA,EAEI,MAAM,cAAcxD,GAAS;AACzB,QAAI+D,IAAe;AACnB,QAAI/D,MAAY,KAAK,gBAAgB,CAAC,GAAG;AACrC,YAAM6D,IAAK,KAAK,gBAAgB,CAAC,GAC3BC,IAAK,KAAK,gBAAgB,CAAC;AACjC,WAAK,gBAAgB,CAAC,IAAIA,GAC1B,KAAK,gBAAgB,CAAC,IAAID,GAC1BE,IAAe;AAAA,IAC3B;AACQ,IAAItF,MAAW,KAAKsF,IAChBL,GAAU,KAAK,iBAAiB,CAAC,IAGjCA,GAAU,KAAK,iBAAiB,CAAC,GAErC,MAAM,KAAK,OAAO,eAAe,aAAc;AAAA,EACvD;AAAA,EAEI,MAAM,cAAc1D,GAAS;AACzB,QAAI+D,IAAe;AACnB,QAAI/D,MAAY,KAAK,gBAAgB,CAAC,GAAG;AACrC,YAAM6D,IAAK,KAAK,gBAAgB,CAAC,GAC3BC,IAAK,KAAK,gBAAgB,CAAC;AACjC,WAAK,gBAAgB,CAAC,IAAIA,GAC1B,KAAK,gBAAgB,CAAC,IAAID,GAC1BE,IAAe;AAAA,IAC3B;AACQ,IAAItF,MAAW,KAAKsF,IAChBL,GAAU,KAAK,iBAAiB,CAAC,IAGjCA,GAAU,KAAK,iBAAiB,CAAC,GAErC,MAAM,KAAK,OAAO,eAAe,aAAc;AAAA,EACvD;AAAA,EAEI,MAAM,gBAAgB;AAClB,IAAAA,GAAU,KAAK,iBAAiB,CAAC,GACjC,MAAM,KAAK,OAAO,eAAe,aAAc;AAAA,EACvD;AAAA,EAEI,IAAI,mBAAmB;AAEnB,WAAIjF,MAAW,IACJ,KAGA,KAAK,gBAAgB,CAAC;AAAA,EAEzC;AAAA,EAEI,MAAM,WAAWuB,GAAS;AAEtB,UAAMf,IADyB,KAAK,OAAO,eAAe,gBAAgB,OAAO,CAAAoE,MAAOA,EAAI,QAAQ,GAAG,MAAM,EAAE,EACtE,KAAK,CAAAA,MAAOA,KAAOrD,CAAO;AACnE,UAAM,KAAK,OAAO,eAAe,UAAUf,CAAS;AAAA,EAC5D;AAAA,EAEI,sBAAsBiC,GAAiBlB,GAASpP,GAAOqP,GAAa;AAChE,QAAIiB,EAAgB,OAAO;AAEvB,aAAO;AAAA;AAAA,QAEH;AAAA,UACI,MAAM,KAAK,OAAO,oBAAoB,KAAK,MAAK,YAAY,KAAKyB;AAAAA,UACjE,UAAUrC,EAAqB;AAAA,UAC/B,OAAO,KAAK,OAAO,UAAU,6BAA6B;AAAA,UAC1D,WAAW,KAAK,OAAO,UAAU,6BAA6B;AAAA,UAC9D,MAAM,KAAK,OAAO;AAAA,UAClB,OAAO,YAAY;AACf,kBAAM,KAAK,cAAe;AAAA,UAClD;AAAA,QACiB;AAAA;AAAA,QAGD;AAAA,UACI,MAAM,KAAK,OAAO,oBAAoB,KAAK,MAAK,cAAc,KAAK6B;AAAA,UACnE,UAAU7B,EAAqB;AAAA,UAC/B,OAAO,KAAK,OAAO,UAAU,gBAAgB;AAAA,UAC7C,WAAW,KAAK,OAAO,UAAU,gBAAgB;AAAA,UACjD,MAAM,KAAK,OAAO;AAAA,UAClB,OAAO,YAAY;AACf,kBAAM,KAAK,cAAcN,CAAO;AAAA,UACxD;AAAA,QACiB;AAAA;AAAA,QAGD;AAAA,UACI,MAAM,KAAK,OAAO,oBAAoB,KAAK,MAAK,WAAW,KAAKoC;AAAA,UAChE,UAAU9B,EAAqB;AAAA,UAC/B,OAAO,KAAK,OAAO,UAAU,aAAa;AAAA,UAC1C,WAAW,KAAK,OAAO,UAAU,aAAa;AAAA,UAC9C,MAAM,KAAK,OAAO;AAAA,UAClB,OAAO,YAAY;AACf,kBAAM,KAAK,WAAWN,CAAO;AAAA,UACrD;AAAA,QACA;AAAA,MACA;AAEa;AACD,YAAMjT,IAAS,CAAE;AAEjB,aAAIiT,MAAY,KAAK,oBACjBjT,EAAO,KAAK;AAAA,QACR,MAAM,KAAK,OAAO,oBAAoB,KAAK,MAAK,cAAc,KAAKoV;AAAA,QACnE,UAAU7B,EAAqB;AAAA,QAC/B,OAAO,KAAK,OAAO,UAAU,gBAAgB;AAAA,QAC7C,WAAW,KAAK,OAAO,UAAU,gBAAgB;AAAA,QACjD,MAAM,KAAK,OAAO;AAAA,QAClB,OAAO,YAAY;AACf,gBAAM,KAAK,cAAe;AAAA,QAClD;AAAA,MACA,CAAiB,GAEDvT,EAAO,KAAK;AAAA,QACR,MAAM,KAAK,OAAO,oBAAoB,KAAK,MAAK,gBAAgB,KAAKmV;AAAA,QACrE,UAAU5B,EAAqB;AAAA,QAC/B,OAAO,KAAK,OAAO,UAAU,iDAAiD;AAAA,QAC9E,WAAW,KAAK,OAAO,UAAU,iDAAiD;AAAA,QAClF,MAAM,KAAK,OAAO;AAAA,QAClB,OAAO,YAAY;AACf,gBAAM,KAAK,cAAcN,CAAO;AAAA,QACxD;AAAA,MACA,CAAiB,GAEDjT,EAAO,KAAK;AAAA,QACR,MAAM,KAAK,OAAO,oBAAoB,KAAK,MAAK,WAAW,KAAKqV;AAAA,QAChE,UAAU9B,EAAqB;AAAA,QAC/B,OAAO,KAAK,OAAO,UAAU,aAAa;AAAA,QAC1C,WAAW,KAAK,OAAO,UAAU,aAAa;AAAA,QAC9C,MAAM,KAAK,OAAO;AAAA,QAClB,OAAO,YAAY;AACf,gBAAM,KAAK,WAAWN,CAAO;AAAA,QACrD;AAAA,MACA,CAAiB,MAGDjT,EAAO,KAAK;AAAA,QACR,MAAM,KAAK,OAAO,oBAAoB,KAAK,MAAK,cAAc,KAAKwW;AAAA,QACnE,UAAUjD,EAAqB;AAAA,QAC/B,OAAO,KAAK,OAAO,UAAU,gBAAgB;AAAA,QAC7C,WAAW,KAAK,OAAO,UAAU,gBAAgB;AAAA,QACjD,MAAM,KAAK,OAAO;AAAA,QAClB,OAAO,YAAY;AACf,gBAAM,KAAK,cAAe;AAAA,QAClD;AAAA,MACA,CAAiB,GAEDvT,EAAO,KAAK;AAAA,QACR,MAAM,KAAK,OAAO,oBAAoB,KAAK,MAAK,gBAAgB,KAAKsV;AAAA,QACrE,UAAU/B,EAAqB;AAAA,QAC/B,OAAO,KAAK,OAAO,UAAU,6BAA6B;AAAA,QAC1D,WAAW,KAAK,OAAO,UAAU,6BAA6B;AAAA,QAC9D,MAAM,KAAK,OAAO;AAAA,QAClB,OAAO,YAAY;AACf,gBAAM,KAAK,cAAe;AAAA,QAClD;AAAA,MACA,CAAiB,GAEDvT,EAAO,KAAK;AAAA,QACR,MAAM,KAAK,OAAO,oBAAoB,KAAK,MAAK,WAAW,KAAKqV;AAAA,QAChE,UAAU9B,EAAqB;AAAA,QAC/B,OAAO,KAAK,OAAO,UAAU,aAAa;AAAA,QAC1C,WAAW,KAAK,OAAO,UAAU,aAAa;AAAA,QAC9C,MAAM,KAAK,OAAO;AAAA,QAClB,OAAO,YAAY;AACf,gBAAM,KAAK,WAAWN,CAAO;AAAA,QACrD;AAAA,MACA,CAAiB,IAEEjT;AAAA,IACnB;AAAA,EACA;AAAA,EAEI,mBAAmBiH,GAAYiL,GAAW;AACtC,QAAI,CAAC,KAAK,mBAAmB,KAAK,sBAAoBA,GAAW;AAC7D,YAAM,EAAC,SAAAe,EAAO,IAAI,KAAK,aAAa,KAAK,CAAAA,MAAWA,EAAQ,OAAOf,CAAS;AAC5E,WAAK,kBAAkBe,GACvB,KAAK,oBAAoBf;AAEzB,YAAM+E,IAAW/U,EAAU,yBAAyB,GAC9CgV,IAAWhV,EAAU,yBAAyB;AACpD,MAAI+U,MAAa,MAAMC,MAAa,MAChC,KAAK,gBAAgB,QAAQD,CAAQ,MAAM,MAC3C,KAAK,gBAAgB,QAAQC,CAAQ,MAAM,OAE3C,KAAK,gBAAgB,CAAC,IAAID,GAC1B,KAAK,gBAAgB,CAAC,IAAIC;AAAA,IAE1C;AACQ,UAAMzE,IAAiBiE,GAAc,KAAK,eAAe,GAEnD1W,IAAS;AAAA,MACX,IAAIyS,EAAe;AAAA,MACnB,QAAQ,KAAK;AAAA,MACb,MAAK,EAAC,IAAG,oCAAmC;AAAA,MAC5C,QAAO;AAAA,MACP,QAAQA,EAAe;AAAA,MACvB,SAAS,CAAA;AAAA,IACZ;AAGD,WAAA/Q,GAAU,wBAAwBgQ,CAAM,GACxChQ,GAAU,2BAA2B,KAAK,gBAAgB,CAAC,CAAC,GAC5DA,GAAU,2BAA2B,KAAK,gBAAgB,CAAC,CAAC,GAErD1B;AAAA,EACf;AACA;AChXA,MAAMmX,KAAU;AAAA,EACZ,IAAI;AAAA,EACJ,MAAM,EAAC,IAAI,sCAAqC;AAAA,EAChD,QAAQ;AAAA,EACR,QAAQ;AAAA,IACJ;AAAA,MACI,SAAS;AAAA,MACT,MAAK;AAAA,QACD,EAAC,aAAY,QAAO,MAAK,GAAE,KAAI,GAAE,OAAM,MAAK,QAAO,IAAG;AAAA,QACtD,EAAC,aAAY,SAAQ,MAAK,IAAG,KAAI,GAAE,OAAM,MAAK,QAAO,IAAG;AAAA,QACxD,EAAC,aAAY,OAAM,MAAK,IAAG,KAAI,GAAE,OAAM,MAAK,QAAO,IAAG;AAAA,QACtD,EAAC,aAAY,OAAM,MAAK,KAAI,KAAI,GAAE,OAAM,KAAI,QAAO,IAAG;AAAA,QACtD,EAAC,aAAY,OAAM,MAAK,KAAI,KAAI,GAAE,OAAM,KAAI,QAAO,IAAG;AAAA,QACtD,EAAC,aAAY,QAAO,MAAK,KAAI,KAAI,IAAG,OAAM,KAAI,QAAO,IAAG;AAAA,MAC3D;AAAA,MACD,SAAQ;AAAA,MACR,OAAM;AAAA,IACT;AAAA,IACD;AAAA,MACI,SAAS;AAAA,MACT,MAAK;AAAA,QACD,EAAC,aAAY,QAAO,MAAK,IAAG,KAAI,KAAI,OAAM,KAAI,QAAO,IAAG;AAAA,QACxD,EAAC,aAAY,SAAQ,MAAK,IAAG,KAAI,KAAI,OAAM,KAAI,QAAO,IAAG;AAAA,QACzD,EAAC,aAAY,OAAM,MAAK,IAAG,KAAI,KAAI,OAAM,KAAI,QAAO,IAAG;AAAA,QACvD,EAAC,aAAY,OAAM,MAAK,IAAG,KAAI,KAAI,OAAM,KAAI,QAAO,IAAG;AAAA,QACvD,EAAC,aAAY,OAAM,MAAK,IAAG,KAAI,KAAI,OAAM,KAAI,QAAO,IAAG;AAAA,QACvD,EAAC,aAAY,QAAO,MAAK,KAAI,KAAI,KAAI,OAAM,KAAI,QAAO,IAAG;AAAA,MAC5D;AAAA,MACD,SAAQ;AAAA,MACR,OAAM;AAAA,IAClB;AAAA,EACK;AAAA,EACD,SAAS,CAAA;AACb,GAEMC,KAAW;AAAA,EACb,IAAI;AAAA,EACJ,MAAM,EAAC,IAAI,mDAAkD;AAAA,EAC7D,QAAQ;AAAA,EACR,QAAQ;AAAA,IACJ;AAAA,MACI,SAAQ;AAAA,MACR,MAAK;AAAA,QACD,EAAC,aAAY,QAAO,MAAK,GAAE,KAAI,GAAE,OAAM,MAAK,QAAO,IAAG;AAAA,QACtD,EAAC,aAAY,SAAQ,MAAK,IAAG,KAAI,GAAE,OAAM,MAAK,QAAO,IAAG;AAAA,QACxD,EAAC,aAAY,OAAM,MAAK,IAAG,KAAI,GAAE,OAAM,MAAK,QAAO,IAAG;AAAA,QACtD,EAAC,aAAY,OAAM,MAAK,KAAI,KAAI,GAAE,OAAM,KAAI,QAAO,IAAG;AAAA,QACtD,EAAC,aAAY,OAAM,MAAK,KAAI,KAAI,GAAE,OAAM,KAAI,QAAO,IAAG;AAAA,QACtD,EAAC,aAAY,QAAO,MAAK,KAAI,KAAI,IAAG,OAAM,KAAI,QAAO,IAAG;AAAA,MAC3D;AAAA,MACD,SAAQ;AAAA,MACR,OAAM;AAAA,IACT;AAAA,IACD;AAAA,MACI,SAAQ;AAAA,MACR,MAAK;AAAA,QACD,EAAC,aAAY,QAAO,MAAK,KAAI,KAAI,KAAI,OAAM,KAAI,QAAO,IAAG;AAAA,QACzD,EAAC,aAAY,SAAQ,MAAK,KAAI,KAAI,KAAI,OAAM,KAAI,QAAO,IAAG;AAAA,QAC1D,EAAC,aAAY,OAAM,MAAK,KAAI,KAAI,KAAI,OAAM,KAAI,QAAO,IAAG;AAAA,QACxD,EAAC,aAAY,OAAM,MAAK,KAAI,KAAI,KAAI,OAAM,KAAI,QAAO,IAAG;AAAA,QACxD,EAAC,aAAY,OAAM,MAAK,KAAI,KAAI,KAAI,OAAM,KAAI,QAAO,IAAG;AAAA,QACxD,EAAC,aAAY,QAAO,MAAK,KAAI,KAAI,KAAI,OAAM,KAAI,QAAO,IAAG;AAAA,MAC5D;AAAA,MACD,SAAQ;AAAA,MACR,OAAM;AAAA,IAClB;AAAA,EACK;AAAA,EACD,SAAS,CAAA;AACb;AAEe,MAAMC,WAA2B1E,GAAY;AAAA,EACxD,0BAA0B;AACtB,WAAOuC,EAAkB,IAAK;AAAA,EACtC;AAAA,EAEI,IAAI,OAAO;AACb,WAAO,MAAM,QAAQ;AAAA,EACvB;AAAA,EAEI,IAAI,aAAa;AAAE,WAAO;AAAA,EAAiB;AAAA,EAE3C,MAAM,OAAO;AACT,SAAK,iBAAiBiC,IACtB,KAAK,sBAAsB,KAAK,OAAO,uBAAuB,CAAA;AAAA,EACtE;AAAA,EAEI,gBAAgBlQ,GAAY;AACxB,WAAO,MAAM,gBAAgBA,CAAU,EAClC,OAAO,CAAAmM,MAAUA,EAAO,WAAW,CAAC;AAAA,EACjD;AAAA,EAEI,sBAAsBe,GAAiBlB,GAASpP,GAAOqP,GAAa;AAChE,UAAM2C,IAAY,KAAK,OAAO,oBAAoB,KAAK,MAAM,WAAW,KAAKR,IACvEM,IAAiB,KAAK,OAAO,oBAAoB,KAAK,MAAM,gBAAgB,KAAKR,IACjFM,IAAe,KAAK,OAAO,oBAAoB,KAAK,MAAM,cAAc,KAAKL,IAC7EM,IAAiB,KAAK,OAAO,oBAAoB,KAAK,MAAM,gBAAgB,KAAKJ,IACjFtV,IAAS;AAAA,MACX;AAAA,QACI,MAAM6V;AAAA,QACN,UAAUtC,EAAqB;AAAA,QAC/B,OAAO,KAAK,OAAO,UAAU,aAAa;AAAA,QAC1C,WAAW,KAAK,OAAO,UAAU,aAAa;AAAA,QAC9C,MAAM,KAAK,OAAO;AAAA,QAClB,OAAO,YAAY;AAEf,gBAAMrB,IADyB,KAAK,OAAO,eAAe,gBAAgB,OAAO,CAAAoE,MAAOA,EAAI,QAAQ,GAAG,MAAM,EAAE,EACtE,KAAK,CAAAA,MAAOA,MAAQrD,CAAO;AACpE,gBAAM,KAAK,OAAO,eAAe,UAAUf,CAAS;AAAA,QACxE;AAAA,MACA;AAAA,IACS;AACD,WAAIe,MAAY,KAAK,aACjBjT,EAAO,KAAK;AAAA,MACR,MAAM2V;AAAA,MACN,UAAUpC,EAAqB;AAAA,MAC/B,OAAO,KAAK,OAAO,UAAU,aAAa;AAAA,MAC1C,WAAW,KAAK,OAAO,UAAU,aAAa;AAAA,MAC9C,MAAM,KAAK,OAAO;AAAA,MAClB,OAAO,YAAY;AACf,aAAK,WAAY,GACjB,MAAM,KAAK,OAAO,eAAe,aAAa,KAAK,UAAU;AAAA,MACjF;AAAA,IACA,CAAa,GAEDvT,EAAO,KAAK;AAAA,MACR,MAAMyV;AAAA,MACN,UAAUlC,EAAqB;AAAA,MAC/B,OAAO,KAAK,OAAO,UAAU,gBAAgB;AAAA,MAC7C,WAAW,KAAK,OAAO,UAAU,gBAAgB;AAAA,MACjD,MAAM,KAAK,OAAO;AAAA,MAClB,OAAO,YAAY;AACf,aAAK,cAAe,GACpB,MAAM,KAAK,OAAO,eAAe,aAAa,KAAK,UAAU;AAAA,MACjF;AAAA,IACa,CAAA,KAEI,KAAK,oBAAoB,SAAS,KACvCvT,EAAO,KAAK;AAAA,MACR,MAAM0V;AAAA,MACN,UAAUnC,EAAqB;AAAA,MAC/B,OAAO,KAAK,OAAO,UAAU,kBAAkB;AAAA,MAC/C,WAAW,KAAK,OAAO,UAAU,kBAAkB;AAAA,MACnD,MAAM,KAAK,OAAO;AAAA,MAClB,OAAO,YAAY;AACf,cAAM+D,IAAsB,KAAK,OAAO,eAAe,iBACjDC,IAAqB,KAAK,oBAAoB,KAAK,CAAA9I,MAC9C6I,EAAoB,QAAQ7I,CAAE,MAAM,EAC9C;AACD,QAAI8I,KACA,KAAK,OAAO,eAAe,UAAUA,CAAkB;AAAA,MAE/E;AAAA,IACa,CAAA,GAEEvX;AAAA,EACf;AAAA,EAEI,aAAa;AACT,IAAI,KAAK,eAAe,OAAO,aAC3B,KAAK,iBAAiBoX,KAGtB,KAAK,iBAAiBD;AAAA,EAElC;AAAA,EAEI,gBAAgB;AACZ,UAAMK,IAAM,KAAK;AACjB,SAAK,YAAY,KAAK,YACtB,KAAK,aAAaA;AAAA,EAC1B;AAAA,EAEI,mBAAmBvQ,GAAYiL,GAAWM,GAAa;AACnD,UAAM,EAAE,SAAAS,MAAY,KAAK,aAAa,KAAK,CAAAA,MAAWA,EAAQ,OAAOf,CAAS;AAC9E,IAAIM,KAAeS,EAAQ,KAAK,CAAAA,MAAWA,MAAYT,CAAW,KAC9D,KAAK,aAAaA,GAClB,KAAK,YAAYS,EAAQ,KAAK,CAAAA,MAAWA,MAAYT,CAAW,MAE3D,CAAC,KAAK,aAAa,CAAC,KAAK,gBAC9B,KAAK,YAAYS,EAAQ,CAAC,GAC1B,KAAK,aAAaA,EAAQ,CAAC;AAG/B,UAAMjT,IAAS,KAAK,MAAM,KAAK,UAAU,KAAK,cAAc,CAAC;AAE7D,WAAAA,EAAO,SAAS,KAAK,QACrBA,EAAO,OAAO,CAAC,EAAE,UAAU,KAAK,YAChCA,EAAO,OAAO,CAAC,EAAE,UAAU,KAAK,WAEzBA;AAAA,EACf;AACA;ACjMe,MAAMyX,WAA0B9E,GAAY;AAAA,EACvD,0BAA0B;AACtB,WAAOuC,EAAkB,IAAK;AAAA,EACtC;AAAA,EAEI,IAAI,OAAO;AACb,WAAO,MAAM,QAAQ;AAAA,EACvB;AAAA,EAEI,IAAI,aAAa;AAAE,WAAO;AAAA,EAAe;AAAA,EAEzC,MAAM,OAAO;AACT,SAAK,OAAO,IAAI,MAAM,4BAA4B,GAClD,KAAK,sBAAsB,KAAK,OAAO,uBAAuB;AAAA,MAC1D;AAAA,MACA;AAAA,MACA;AAAA,MACA;AAAA,MACA;AAAA,MACA;AAAA,IACH;AAAA,EACT;AAAA,EAEI,gBAAgBjO,GAAY;AAGxB,WAAO,MAAM,gBAAgBA,CAAU,EAClC,OAAO,CAAAmM,MAAUA,EAAO,WAAW,CAAC;AAAA,EACjD;AAAA,EAEI,sBAAsBe,GAAiBlB,GAASpP,GAAOqP,GAAa;AAChE,WAAI,KAAK,eACE;AAAA,MACH;AAAA,QACI,MAAM,KAAK,OAAO,oBAAoB,KAAK,MAAK,gBAAgB,KAAKwE;AAAAA,QACrE,UAAUnE,EAAqB;AAAA,QAC/B,OAAO,KAAK,OAAO,UAAU,gBAAgB;AAAA,QAC7C,WAAW,KAAK,OAAO,UAAU,gBAAgB;AAAA,QACjD,MAAM,KAAK,OAAO;AAAA,QAClB,OAAO,MAAM;AACT,gBAAM+D,IAAsB,KAAK,OAAO,eAAe,iBACjDC,IAAqB,KAAK,oBAAoB,KAAK,CAAA9I,MAC9C6I,EAAoB,QAAQ7I,CAAE,MAAM,EAC9C;AACD,UAAI8I,KACA,KAAK,OAAO,eAAe,UAAUA,CAAkB;AAAA,QAEnF;AAAA,MACA;AAAA,IACA,IAGmB,CAAA;AAAA,EAEnB;AAAA,EAEI,mBAAmBtQ,GAAYiL,GAAW;AACtC,UAAMW,IAAe,KAAK,aAAa,KAAK,CAAAI,MAAWA,EAAQ,OAAKf,CAAS,GACvEiC,IAAkB;AAAA,MACpB,QAAQ,KAAK;AAAA,MACb,MAAK,EAAC,IAAG,aAAY;AAAA,MACrB,QAAO;AAAA,MACP,QAAQ;AAAA,QACJ;AAAA,UACI,SAAQtB,EAAa,QAAQ,CAAC;AAAA,UAC9B,MAAK;AAAA,YACD,EAAE,aAAY,OAAM,MAAK,KAAI,KAAI,GAAE,OAAM,KAAI,QAAO,IAAK;AAAA,YACzD,EAAE,aAAY,OAAM,MAAK,KAAI,KAAI,GAAE,OAAM,KAAI,QAAO,IAAK;AAAA,YACzD,EAAE,aAAY,OAAM,MAAK,KAAI,KAAI,GAAE,OAAM,KAAI,QAAO,IAAK;AAAA,YACzD,EAAE,aAAY,OAAM,MAAK,KAAI,KAAI,GAAE,OAAM,KAAI,QAAO,IAAK;AAAA,YACzD,EAAE,aAAY,QAAO,MAAK,KAAI,KAAI,GAAE,OAAM,KAAI,QAAO,IAAK;AAAA,YAC1D,EAAE,aAAY,UAAS,MAAK,KAAI,KAAI,GAAE,OAAM,MAAK,QAAO,IAAK;AAAA,YAC7D,EAAE,aAAY,UAAS,MAAK,KAAI,KAAI,GAAE,OAAM,MAAK,QAAO,IAAK;AAAA,YAC7D,EAAE,aAAY,OAAM,MAAK,KAAI,KAAI,GAAE,OAAM,MAAK,QAAO,IAAK;AAAA,YAC1D,EAAE,aAAY,SAAQ,MAAK,IAAG,KAAI,GAAE,OAAM,MAAK,QAAO,IAAK;AAAA,YAC3D,EAAE,aAAY,OAAM,MAAK,IAAG,KAAI,GAAE,OAAM,MAAK,QAAO,IAAK;AAAA,YACzD,EAAE,aAAY,QAAO,MAAK,GAAE,KAAI,GAAE,OAAM,MAAK,QAAO,IAAK;AAAA,YACzD,EAAE,aAAY,UAAS,MAAK,GAAE,KAAI,IAAG,OAAM,MAAK,QAAO,IAAK;AAAA,YAC5D,EAAE,aAAY,UAAS,MAAK,GAAE,KAAI,IAAG,OAAM,MAAK,QAAO,IAAK;AAAA,YAC5D,EAAE,aAAY,UAAS,MAAK,GAAE,KAAI,IAAG,OAAM,MAAK,QAAO,IAAK;AAAA,YAC5D,EAAE,aAAY,UAAS,MAAK,GAAE,KAAI,KAAI,OAAM,MAAK,QAAO,IAAG;AAAA,UAC9D;AAAA,UACD,SAAQ;AAAA,UACR,OAAM;AAAA,QAC1B;AAAA,MACa;AAAA,MACD,YAAW,EAAC,SAAQ,8BAA6B,QAAO,GAAE,MAAK,EAAC,MAAK,GAAE,KAAI,GAAE,OAAM,MAAK,QAAO,IAAG,GAAE,SAAQ,IAAK,OAAM,EAAC;AAAA,MACxH,OAAM,CAAC,EAAC,SAAQ,mBAAkB,QAAO,GAAE,MAAK,EAAC,KAAI,IAAG,MAAK,IAAG,OAAM,IAAG,QAAO,GAAE,EAAC,CAAC;AAAA,MACpF,SAAS,CAAE;AAAA,MACX,SAAS,WAAW;AAAA,MAAA;AAAA,IAChC;AAEQ,WAAI5L,EAAW,SAAS,MACpB,KAAK,eAAe,KAGjBkN;AAAA,EACf;AACA;AChGe,MAAMwD,WAAiChF,GAAY;AAAA,EAC9D,0BAA0B;AACtB,WAAOuC,EAAkB,IAAK;AAAA,EACtC;AAAA,EAEI,IAAI,OAAO;AACb,WAAO,MAAM,QAAQ;AAAA,EACvB;AAAA,EAEI,IAAI,aAAa;AACb,WAAO;AAAA,EACf;AAAA,EAEI,MAAM,OAAO;AACT,SAAK,OAAO,IAAI,MAAM,oCAAoC,GAC1D,KAAK,sBAAsB,KAAK,OAAO,uBAAuB;AAAA,MAC1D;AAAA,MACA;AAAA,MACA;AAAA,MACA;AAAA,MACA;AAAA,MACA;AAAA,IACH;AAAA,EACT;AAAA,EAEI,sBAAsBf,GAAiBlB,GAASpP,GAAOqP,GAAa;AAChE,UAAMwC,IAAiB,KAAK,OAAO,oBAAoB,KAAK,MAAK,gBAAgB,KAAKJ,IAEhFtV,IAAS,CAAE;AACjB,WAAI,KAAK,gBACLA,EAAO,KAAK;AAAA,MACR,MAAM0V;AAAA,MACN,UAAUnC,EAAqB;AAAA,MAC/B,OAAO,KAAK,OAAO,UAAU,iBAAiB;AAAA,MAC9C,WAAW,KAAK,OAAO,UAAU,iBAAiB;AAAA,MAClD,MAAM,KAAK,OAAO;AAAA,MAClB,OAAO,YAAY;AACf,cAAM+D,IAAsB,KAAK,OAAO,eAAe,iBACjDC,IAAqB,KAAK,oBAAoB,KAAK,CAAA9I,MAC9C6I,EAAoB,QAAQ7I,CAAE,MAAM,EAC9C;AACD,QAAI8I,KACA,KAAK,OAAO,eAAe,UAAUA,CAAkB;AAAA,MAE/E;AAAA,IACA,CAAa,GAEEvX;AAAA,EACf;AAAA,EAEI,mBAAmBiH,GAAYiL,GAAWM,GAAa;AACnD,IAAIvL,EAAW,SAAS,MACpB,KAAK,eAAe;AAExB,UAAM,EAAE,SAAAgM,MAAY,KAAK,aAAa,KAAK,CAAAA,MAAWA,EAAQ,OAAOf,CAAS;AAC9E,gBAAK,kBAAkBe,EAAQ,IAAI,CAAA7Q,OACxB;AAAA,MACH,IAAIA;AAAA,MACJ,MAAM;AAAA,IACtB,EACS,GACM;AAAA,MACH,IAAI;AAAA,MACJ,QAAQ;AAAA,QACJ;AAAA,UACI,SAAS,KAAK,gBAAgB,CAAC,EAAE;AAAA,UACjC,SAAS;AAAA,UACT,MAAM,KAAK,gBAAgB,CAAC,EAAE;AAAA,QAClD;AAAA,MACA;AAAA,IACA;AAAA,EACA;AACA;ACzEA,MAAMsP,KAAS;AAAA,EACX,QAAQ;AAAA,IACJ;AAAA,MACI,SAAS,CAAE;AAAA,MACX,MAAK;AAAA,QACD,EAAE,aAAY,QAAO,MAAK,KAAK,KAAI,IAAI,OAAM,KAAK,QAAO,IAAG;AAAA,MAC/D;AAAA,MACD,SAAQ;AAAA,MACR,OAAM;AAAA,IACT;AAAA,IACD;AAAA,MACI,SAAS,CAAE;AAAA,MACX,MAAK;AAAA,QACD,EAAE,aAAY,QAAO,MAAK,IAAI,KAAI,KAAK,OAAM,KAAK,QAAO,IAAG;AAAA,MAC/D;AAAA,MACD,SAAQ;AAAA,MACR,OAAM;AAAA,IACT;AAAA,IACD;AAAA,MACI,SAAS,CAAE;AAAA,MACX,MAAK;AAAA,QACD,EAAE,aAAY,QAAO,MAAK,KAAK,KAAI,KAAK,OAAM,KAAK,QAAO,IAAG;AAAA,MAChE;AAAA,MACD,SAAQ;AAAA,MACR,OAAM;AAAA,IAClB;AAAA,EACK;AAAA,EACD,SAAS;AAAA,IACL;AAAA,MACI,MAAM,EAAE,MAAM,KAAK,KAAK,KAAK,OAAO,IAAI,QAAQ,GAAI;AAAA,MACpD,SAAS,SAAS5T,GAAO;AAAE,aAAK,OAAQ;AAAA,MAAG;AAAA,MAC3C,OAAM;AAAA,MACN,MAAK;AAAA,MACL,OAAO;AAAA,IACnB;AAAA,EACA;AACA;AAEA,SAAS8Z,GAAU/E,GAAc;AAC7B,MAAIJ,IAAiB,KAAK,MAAM,KAAK,UAAUf,EAAM,CAAC;AACtD,SAAAe,EAAe,OAAO,CAAC,EAAE,UAAUI,EAAa,CAAC,GACjDJ,EAAe,OAAO,CAAC,EAAE,UAAUI,EAAa,CAAC,GACjDJ,EAAe,OAAO,CAAC,EAAE,UAAUI,EAAa,CAAC,GAC1CJ;AACX;AAEe,MAAMoF,WAA0BlF,GAAY;AAAA,EACvD,0BAA0B;AACtB,WAAOuC,EAAkB,IAAK;AAAA,EACtC;AAAA,EAEI,IAAI,OAAO;AACb,WAAO,MAAM,QAAQ;AAAA,EACvB;AAAA,EAEI,IAAI,aAAa;AAAE,WAAO;AAAA,EAAe;AAAA,EAEzC,MAAM,OAAO;AACT,SAAK,OAAO,IAAI,MAAM,4BAA4B;AAAA,EAC1D;AAAA,EAEI,gBAAgBjO,GAAY;AAGxB,WAAO,MAAM,gBAAgBA,CAAU,EAClC,OAAO,CAAAmM,MAAUA,EAAO,WAAW,CAAC;AAAA,EACjD;AAAA,EAEI,gBAAgB;AACZ,UAAM0D,IAAK,KAAK,gBAAgB,CAAC,GAC3BC,IAAK,KAAK,gBAAgB,CAAC,GAC3Be,IAAK,KAAK,gBAAgB,CAAC;AACjC,SAAK,gBAAgB,CAAC,IAAIA,GAC1B,KAAK,gBAAgB,CAAC,IAAIhB,GAC1B,KAAK,gBAAgB,CAAC,IAAIC,GAE1B,KAAK,OAAO,eAAe,aAAc;AAAA,EACjD;AAAA,EAEI,mBAAmB9P,GAAYiL,GAAW;AACtC,QAAI,CAAC,KAAK,mBAAmB,KAAK,sBAAoBA,GAAW;AAC7D,WAAK,oBAAoBA;AACzB,YAAM,EAAC,SAAAe,EAAO,IAAI,KAAK,aAAa,KAAK,CAAAA,MAAWA,EAAQ,OAAOf,CAAS;AAC5E,WAAK,kBAAkBe;AAAA,IACnC;AACQ,UAAMR,IAAiBmF,GAAU,KAAK,eAAe;AAoBrD,WAlBe;AAAA,MACX,QAAQ,KAAK;AAAA,MACb,MAAK,EAAC,IAAG,sCAAqC;AAAA,MAC9C,QAAO;AAAA,MACP,QAAQnF,EAAe;AAAA,MACvB,SAAS;AAAA,QACL;AAAA,UACI,MAAMA,EAAe,QAAQ,CAAC,EAAE;AAAA,UAChC,SAAS,MAAM;AAAE,iBAAK,cAAe;AAAA,UAAG;AAAA,UACxC,OAAM;AAAA,UACN,MAAM8D;AAAA,UACN,OAAO;AAAA,UACP,WAAW;AAAA,UACX,OAAO;AAAA,QAC3B;AAAA,MACA;AAAA,IACS;AAAA,EAGT;AACA;ACjHO,MAAMwB,WAAoBhD,GAAO;AAAA,EACpC,YAAYrX,GAAQuX,GAAgB;AAChC,UAAM,OAAOvX,GAAQuX,CAAc,GACnC,KAAK,QAAQ,UAAU,IAAI,cAAc;AAAA,EACjD;AAAA,EAEI,MAAM,WAAWvX,GAAQ;AACrB,IAAAA,EAAO,QAAQ,MAAM,QAAQ,QAC7BA,EAAO,QAAQ,MAAM,SAAQ;AAAA,EACrC;AACA;AAEe,MAAMsa,WAA0BhD,GAAa;AAAA,EACxD,IAAI,OAAO;AACb,WAAO,MAAM,QAAQ;AAAA,EACvB;AAAA,EAEI,IAAI,aAAa;AAAE,WAAO;AAAA,EAAQ;AAAA,EAElC,kBAAkBC,GAAgB;AAC9B,WAAO,IAAI8C,GAAY,KAAK,QAAQ9C,CAAc;AAAA,EAC1D;AACA;ACtBO,MAAMgD,WAAoBlD,GAAO;AAAA,EACpC,YAAYrX,GAAQuX,GAAgB;AAChC,UAAM,OAAOvX,GAAQuX,CAAc;AAAA,EAC3C;AAAA,EAEI,MAAM,WAAWvX,GAAQ;AACrB,IAAAA,EAAO,QAAQ,MAAM,QAAQ,QAC7BA,EAAO,QAAQ,MAAM,SAAS;AAAA,EACtC;AACA;AAEe,MAAMwa,WAA0BlD,GAAa;AAAA,EACxD,IAAI,OAAO;AACb,WAAO,MAAM,QAAQ;AAAA,EACvB;AAAA,EAEI,IAAI,aAAa;AAAE,WAAO;AAAA,EAAQ;AAAA,EAElC,MAAM,aAAa5B,GAAQ;AACvB,WAAI,CAAC,MAAM,QAAQA,EAAO,MAAM,KAAKA,EAAO,OAAO,WAAW,IAEnD,KAGJ,MAAM,MAAM,aAAaA,CAAM;AAAA,EAC9C;AAAA,EAEI,kBAAkB6B,GAAgB;AAC9B,WAAO,IAAIgD,GAAY,KAAK,QAAQhD,CAAc;AAAA,EAC1D;AACA;AC5BO,MAAMkD,WAAmB/R,GAAO;AAAA,EACnC,IAAI,OAAO;AAAE,WAAO;AAAA,EAAO;AAAA,EAE3B,IAAI,UAAU;AAAE,WAAO,KAAK,OAAO,WAAW,CAAA;AAAA,EAAG;AAAA,EAEjD,MAAM,OAAyB;AAC3B,UAAM,MAAM,qDAAqD,KAAK,IAAI,GAAG;AAAA,EACrF;AAAA,EAEI,MAAM,QAAgC;AAClC,UAAM,MAAM,sDAAsD,KAAK,IAAI,GAAG;AAAA,EACtF;AAAA,EAEI,MAAM,SAA2B;AAC7B,UAAM,MAAM,uDAAuD,KAAK,IAAI,GAAG;AAAA,EACvF;AACA;AAEe,MAAMgS,WAAatT,GAAe;AAAA,EAC7C,YAAYpH,GAAQ;AAChB,UAAMA,CAAM,GAEZ,KAAK,eAAe,CAAA,GAEpB+I,EAAkB,KAAK,QAAQ,QAAQ,OAAOC,MAAW;ApD3BjE,UAAAjG;AoD4BY,OAAAA,IAAAiG,EAAO,YAAP,QAAAjG,EAAgB,QAAQ,CAAA4X,MAAO;AAC3B,aAAK,aAAaA,CAAG,IAAI,KAAK,aAAaA,CAAG,KAAK,CAAE,GACrD,KAAK,aAAaA,CAAG,EAAE,KAAK3R,CAAM;AAAA,MAClD;AAAA,IACS,CAAA;AAAA,EACT;AAAA,EAEI,cAAc4R,GAAS;AACnB,QAAI5R,IAAU,KAAK,aAAa4R,CAAO,KACzB,KAAK,aAAaA,CAAO,EAAE,SAAS,KACpC,KAAK,aAAaA,CAAO,EAAE,CAAC;AAM1C,QALK5R,MACDA,IAAS,KAAK,aAAa,WAClB,KAAK,aAAa,QAAW,SAAS,KACtC,KAAK,aAAa,QAAW,CAAC,IAEvC,CAACA;AACD,YAAM,MAAM,qCAAqC4R,CAAO,GAAG;AAE/D,WAAO5R;AAAA,EACf;AAAA,EAEI,eAAe4R,GAAS;AACpB,QAAI5R,IAAU,KAAK,aAAa4R,CAAO,KACzB,KAAK,aAAaA,CAAO,EAAE,SAAS,KACpC,KAAK,aAAaA,CAAO;AAMvC,QALK5R,MACDA,IAAS,KAAK,aAAa,WAClB,KAAK,aAAa,QAAW,SAAS,KACtC,KAAK,aAAa,UAE3B,CAACA;AACD,YAAM,MAAM,qCAAqC4R,CAAO,GAAG;AAE/D,WAAO5R;AAAA,EACf;AAAA,EAEI,MAAM,KAAK4R,GAASpV,GAAK;AAGrB,WADe,MADL,KAAK,cAAcoV,CAAO,EACb,KAAKA,GAASpV,CAAG;AAAA,EAEhD;AAAA,EAEI,MAAM,MAAMoV,GAASpV,GAAKqV,GAAM;AAC5B,UAAMxR,IAAI,KAAK,eAAeuR,CAAO;AACrC,QAAI,MAAM,QAAQvR,CAAC,GAAG;AAClB,UAAI/G,IAAS;AACb,eAASC,IAAI,GAAGA,IAAE8G,EAAE,QAAQ,EAAE9G;AAC1B,QAAAD,IAAS,MAAM+G,EAAE9G,CAAC,EAAE,MAAMqY,GAASpV,GAAKqV,CAAI;AAEhD,aAAOvY;AAAA,IACnB,OACa;AAAA,UAAI+G;AAEL,eADe,MAAMA,EAAE,MAAMuR,GAASpV,GAAKqV,CAAI;AAI/C,WAAK,OAAO,IAAI,KAAK,0CAA0CD,CAAO,GAAG;AAAA;AAAA,EAErF;AAAA,EAEI,MAAM,OAAOA,GAASpV,GAAK;AACvB,UAAM6D,IAAI,KAAK,eAAeuR,CAAO;AACrC,QAAIvR,EAAE,SAAO,GAAG;AACZ,UAAI/G,IAAS;AACb,eAASC,IAAI,GAAGA,IAAE8G,EAAE,QAAQ,EAAE9G;AAC1B,QAAAD,IAAS,MAAM+G,EAAE9G,CAAC,EAAE,OAAOqY,GAASpV,CAAG;AAE3C,aAAOlD;AAAA,IACnB;AAGY,aADe,MAAM+G,EAAE,OAAOuR,GAASpV,CAAG;AAAA,EAGtD;AACA;ACrGA,IAAIwE,KAAiB;AAEN,MAAM8Q,WAA8B/Q,GAAa;AAAA,EAC5D,OAAO,MAAM;AACT,WAAKC,OACDA,KAAiB,IAAI8Q,GAAuB,IAEzC9Q;AAAA,EACf;AAAA,EAEI,IAAI,aAAa;AACb,WAAO;AAAA,EACf;AAAA,EAEI,IAAI,gBAAgB;AAChB,WAAOE,GAAY;AAAA,EAC3B;AACA;ACfe,MAAM6Q,WAAyBN,GAAW;AAAA,EACrD,0BAA0B;AACtB,WAAOK,GAAsB,IAAK;AAAA,EAC1C;AAAA,EAEI,IAAI,OAAO;AACP,WAAO,MAAM,QAAQ;AAAA,EAC7B;AAAA,EAEI,aAAaF,GAAQta,GAAQ;AACzB,WAAI,OAAOA,KAAY,aACnBA,IAAS,KAAK,UAAUA,CAAM,IAE3B,GAAGsa,CAAO,IAAIta,CAAM;AAAA,EACnC;AAAA,EAEI,MAAM,KAAKsa,GAASI,GAAW;AAC3B,UAAMxV,IAAM,KAAK,aAAaoV,GAASI,CAAS;AAChD,QAAI5S,IAAQ5D,EAAUgB,CAAG;AACzB,QAAI;AACA,MAAA4C,IAAQ,KAAK,MAAMA,CAAK;AAAA,IACpC,QACkB;AAAA,IAAA;AACV,gBAAK,OAAO,IAAI,MAAM,0BAA0B5C,CAAG,EAAE,GAC9C4C;AAAA,EACf;AAAA,EAEI,MAAM,MAAMwS,GAASI,GAAWH,GAAM;AAClC,UAAMrV,IAAM,KAAK,aAAaoV,GAASI,CAAS;AAChD,QAAIH,KAAQ,OAAOA,KAAU;AACzB,UAAI;AACA,QAAAA,IAAO,KAAK,UAAUA,CAAI;AAAA,MAC1C,QACsB;AACN,aAAK,OAAO,IAAI,KAAK,2BAA2BrV,CAAG,wBAAwB,GAC3EqV,IAAO;AAAA,MACvB;AAEQ,IAAA7W,GAAUwB,GAAKqV,CAAI,GACnB,KAAK,OAAO,IAAI,MAAM,2BAA2BrV,CAAG,EAAE;AAAA,EAC9D;AAAA,EAEI,MAAM,OAAOoV,GAASI,GAAW;AAC7B,UAAMxV,IAAM,KAAK,aAAaoV,GAASI,CAAS;AAChD,IAAAhX,GAAUwB,GAAK,EAAE,GACjB,KAAK,OAAO,IAAI,MAAM,4BAA4BA,CAAG,EAAE;AAAA,EAC/D;AACA;AChDe,MAAMyV,WAA+BR,GAAW;AAAA,EAC3D,0BAA0B;AACtB,WAAOK,GAAsB,IAAK;AAAA,EAC1C;AAAA,EAEI,IAAI,OAAO;AACP,WAAO,MAAM,QAAQ;AAAA,EAC7B;AAAA,EAEI,aAAaF,GAAQta,GAAQ;AACzB,WAAI,OAAOA,KAAY,aACnBA,IAAS,KAAK,UAAUA,CAAM,IAE3B,GAAGsa,CAAO,IAAIta,CAAM;AAAA,EACnC;AAAA,EAEI,MAAM,KAAKsa,GAASI,GAAW;AAC3B,UAAMxV,IAAM,KAAK,aAAaoV,GAASI,CAAS;AAChD,QAAI5S,IAAQ,aAAa,QAAQ5C,CAAG;AACpC,QAAI;AACA,MAAA4C,IAAQ,KAAK,MAAMA,CAAK;AAAA,IACpC,QACkB;AAAA,IAAA;AACV,gBAAK,OAAO,IAAI,MAAM,gCAAgC5C,CAAG,EAAE,GACpD4C;AAAA,EACf;AAAA,EAEI,MAAM,MAAMwS,GAASI,GAAWH,GAAM;AAClC,UAAMrV,IAAM,KAAK,aAAaoV,GAASI,CAAS;AAChD,QAAIH,KAAQ,OAAOA,KAAU;AACzB,UAAI;AACA,QAAAA,IAAO,KAAK,UAAUA,CAAI;AAAA,MAC1C,QACsB;AACN,aAAK,OAAO,IAAI,KAAK,iCAAiCrV,CAAG,wBAAwB,GACjFqV,IAAO;AAAA,MACvB;AAEQ,iBAAa,QAAQrV,GAAKqV,CAAI,GAC9B,KAAK,OAAO,IAAI,MAAM,iCAAiCrV,CAAG,EAAE;AAAA,EACpE;AAAA,EAEI,MAAM,OAAOoV,GAASI,GAAW;AAC7B,UAAMxV,IAAM,KAAK,aAAaoV,GAASI,CAAS;AAChD,iBAAa,QAAQxV,GAAK,EAAE,GAC5B,KAAK,OAAO,IAAI,MAAM,kCAAkCA,CAAG,EAAE;AAAA,EACrE;AACA;AC5BA,MAAe0V,KAAA;AAAA,EACX;AAAA,IACI,QAAQnQ;AAAA,IACR,QAAQ;AAAA,MACJ,SAAS;AAAA,IACrB;AAAA,EACK;AAAA,EACD;AAAA,IACI,QAAQM;AAAA,IACR,QAAQ;AAAA,MACJ,SAAS;AAAA,IACrB;AAAA,EACK;AAAA,EACD;AAAA,IACI,QAAQsB;AAAA,IACR,QAAQ;AAAA,MACJ,SAAS;AAAA,IACrB;AAAA,EACK;AAAA,EACD;AAAA,IACI,QAAQE;AAAA,IACR,QAAQ;AAAA,MACJ,SAAS;AAAA,IACrB;AAAA,EACK;AAAA,EACD;AAAA,IACI,QAAQoB;AAAA,IACR,QAAQ;AAAA,MACJ,SAAS;AAAA,IACrB;AAAA,EACK;AAAA,EACD;AAAA,IACI,QAAQkN;AAAAA,IACR,QAAQ;AAAA,MACJ,SAAS;AAAA,IACrB;AAAA,EACK;AAAA,EACD;AAAA,IACI,QAAQ1H;AAAA,IACR,QAAQ;AAAA,MACJ,SAAS;AAAA,IACrB;AAAA,EACK;AAAA,EACD;AAAA,IACI,QAAQC;AAAA,IACR,QAAQ;AAAA,MACJ,SAAS;AAAA,IACrB;AAAA,EACK;AAAA,EACD;AAAA,IACI,QAAQoE;AAAA,IACR,QAAQ;AAAA,MACJ,SAAS;AAAA,IACrB;AAAA,EACK;AAAA,EACD;AAAA,IACI,QAAQoB;AAAA,IACR,QAAQ;AAAA,MACJ,SAAS;AAAA,IACrB;AAAA,EACK;AAAA,EACD;AAAA,IACI,QAAQS;AAAA,IACR,QAAQ;AAAA,MACJ,SAAS;AAAA,IACrB;AAAA,EACK;AAAA,EACD;AAAA,IACI,QAAQI;AAAA,IACR,QAAQ;AAAA,MACJ,SAAS;AAAA,IACrB;AAAA,EACK;AAAA,EACD;AAAA,IACI,QAAQE;AAAA,IACR,QAAQ;AAAA,MACJ,SAAS;AAAA,IACrB;AAAA,EACK;AAAA,EACD;AAAA,IACI,QAAQnC;AAAA,IACR,QAAQ;AAAA,MACJ,SAAS;AAAA,IACrB;AAAA,EACK;AAAA,EACD;AAAA,IACI,QAAQqC;AAAA,IACR,QAAQ;AAAA,MACJ,SAAS;AAAA,IACrB;AAAA,EACK;AAAA,EACD;AAAA,IACI,QAAQG;AAAA,IACR,QAAQ;AAAA,MACJ,SAAS;AAAA,IACrB;AAAA,EACK;AAAA,EACD;AAAA,IACI,QAAQE;AAAA,IACR,QAAQ;AAAA,MACJ,SAAS;AAAA,IACrB;AAAA,EACK;AAAA,EACD;AAAA,IACI,QAAQO;AAAA,IACR,QAAQ;AAAA,MACJ,SAAS;AAAA,MACT,SAAS,CAAC,SAAS;AAAA,IAC/B;AAAA,EACK;AAAA,EACD;AAAA,IACI,QAAQE;AAAA,IACR,QAAQ;AAAA,MACJ,QAAQ;AAAA,MACR,SAAS,CAAC,SAAS;AAAA,IAC/B;AAAA,EACA;AACA;ACvHe,MAAMG,WAA0BlJ,GAAa;AAAA,EAC3D,cAAc;AACb,UAAM,GAAG,SAAS,GAElB,KAAK,kBAAkB;AAAA,EACzB;AAAA,EAEC,IAAI,eAAexN,GAAG;AAAE,SAAK,kBAAkBA;AAAA,EAAE;AAAA,EAEjD,IAAI,iBAAiB;AAAE,WAAO,KAAK;AAAA,EAAgB;AAAA,EAEnD,IAAI,mBAAmB;AAAE,WAAO,KAAK,OAAO,oBAAoB,KAAK;EAAsB;AAAA,EAE3F,sBAAsB;AACrB,WAAO;AAAA,EACT;AAAA,EAEC,MAAM,OAAOrB,GAAKgY,GAAQ;AACzB,UAAM,OAAOhY,GAAKgY,CAAM,GACxB,KAAK,cAAcA,GACnB,MAAM,KAAK,UAAW;AAAA,EACxB;AAAA,EAEC,IAAI,cAAc;AACjB,WAAO,KAAK;AAAA,EACd;AAAA,EAEC,IAAI,YAAYhS,GAAG;AAClB,SAAK,eAAeA;AAAA,EACtB;AAAA,EAEC,IAAI,QAAQ;AACX,WAAO,KAAK;AAAA,EACd;AAAA,EAEC,IAAI,YAAY;AACf,WAAO,KAAK,OAAO,aAAa;AAAA,EAClC;AAAA,EAEC,IAAI,WAAW;AACd,WAAO,KAAK,OAAO,YAAY;AAAA,EACjC;AAAA,EAEC,IAAI,aAAa;AAChB,WAAO,KAAK,OAAO,cAAc;AAAA,EACnC;AAAA,EAEC,IAAI,mBAAmB;AACtB,WAAO,KAAK,OAAO,oBAAoB;AAAA,EACzC;AAAA,EAEC,IAAI,eAAe;AzDvEpB,QAAAtG,GAAA4N;AyDwEE,UAAM2K,MAAevY,IAAA,KAAK,OAAO,iBAAZ,gBAAAA,EAA0B,iBAAgB,IACzDwY,MAAc5K,IAAA,KAAK,OAAO,iBAAZ,gBAAAA,EAA0B,gBAAe;AAC7D,WAAO;AAAA,MACN,cAAA2K;AAAA,MACA,aAAAC;AAAA,IACH;AAAA,EACA;AAAA,EAEC,IAAI,iBAAiB;AACpB,WAAO,KAAK;AAAA,EACd;AAAA,EAEC,MAAM,aAAa;AAElB,WADgB1T,EAA0B,qCAAqC;AAAA,EAEjF;AAAA,EAEC,MAAM,sBAAsB;AAC3B,QAAI,KAAK,gBAAgB;AACxB,YAAM0N,IAAU,MAAM,KAAK,WAAY;AACvC,WAAK,gBAAgB,YAAY,IAChB,MAAM,KAAKA,EAAQ,QAAQ,EACnC,QAAQ,CAAAiG,MAAS,KAAK,gBAAgB,YAAYA,CAAK,CAAC;AAAA,IACpE;AAAA,EACA;AAAA,EAEC,IAAI,YAAY;AACf,WAAO,KAAK,OAAO,aAAa;AAAA,EAClC;AAAA,EAEC,YAAY;AACX,IAAK,KAAK,OAAO,YAAY,MAAM,YAClC,KAAK,OAAO,YAAY,MAAM,KAAM;AAAA,EAEvC;AAAA,EAEC,MAAM,YAAY;AACjB,IAAK,KAAK,qBACT,KAAK,mBAAmB,CAAAnY,MAAO;AAC9B,MAAIA,EAAI,QAAQ,YACf,KAAK,UAAW;AAAA,IAErB,GACG,KAAK,OAAO,iBAAiB,WAAW,KAAK,gBAAgB;AAE9D,UAAMoY,IAAQ,KAAK,OAAO,YAAY;AACtC,QAAIA,EAAM,YAAY,KAAK,eAAeA,EAAM,kBAAkB;AACjE,YAAMlG,IAAU,MAAM,KAAK,WAAY;AACvC,WAAK,kBAAkBA,GACvB,KAAK,aAAakG,EAAM,KAAK;AAAA,QAC5B,OAAO,KAAK,aAAa,KAAK;AAAA,QAC9B,SAAAlG;AAAA,QACA,aAAa,KAAK,cAAc,cAAc,KAAK,SAAS;AAAA,QAC5D,YAAY,KAAK,cAAc,cAAc,KAAK,SAAS;AAAA,QAC3D,QAAQ,KAAK;AAAA,MACjB,CAAI;AAAA,IACJ;AAEG,MAAAkG,EAAM,KAAM;AAAA,EAEf;AACA;AClIA,MAAMC,KAAe,CAACvF,MAAUA,IAAQ,4BAA4BA,CAAK,YAAY,IAC/EwF,KAAc,CAAC7a,MAASA,IAAO,wBAAwBA,CAAI,SAAS,IACpE8P,KAAY,CAACuF,MAAUA,IAAQ,eAAeA,CAAK,MAAM,IACzDyF,KAAmB,CAAChO,MAASA,IAAO,4BAA4BA,CAAI,YAAY,IAChFiO,KAAmB,CAAC/a,MAASA,IAAO,yBAAyBA,CAAI,SAAS,IAC1Egb,KAAY,CAAClO,GAAK9M,MAAS8M,KAAQ9M,IAAO,8BAA8B8a,GAAiBhO,CAAI,CAAC,GAAGiO,GAAiB/a,CAAI,CAAC,YAAY;AAEzI,SAASib,GAAYC,GAAUC,GAAY1K,GAAW2K,GAAUC,GAAUC,GAAeC,GAAY;AACpG,QAAM,EAAE,IAAAtL,IAAK,GAAG,OAAAoF,IAAQ,MAAM,MAAArV,IAAO,MAAM,WAAAwb,IAAY,IAAM,WAAAC,IAAY,MAAM,WAAAC,IAAY,KAAM,IAAGR,GAC9FhT,IAAS,MAETrD,IAAO,SAAS,cAAc,IAAI,GAClC8W,IAAaL,EAAcrL,CAAE,KAAK,IAClCE,IAASpJ,EAA0B;AAAA,mCACN4U,IAAa,cAAc,EAAE,KAAK7L,GAAUuF,CAAK,CAAC,aAAapF,CAAE,UAAU/H,EAAO,IAAI,aAAa+H,CAAE;AAAA,KACnI4K,GAAY7a,CAAI,CAAC;AAAA,KACjBwb,IAAYZ,GAAavF,CAAK,IAAI,EAAE;AAAA,KACpCoG,KAAaC,IAAYV,GAAUS,GAAWC,CAAS,IAAI,EAAE;AAAA;AAAA,EAEjE;AAGD,SAAIH,MACHA,EAAW,UAAUpL,IAGtBA,EAAO,iBAAiB,WAAW,CAAA5N,MAAO;A1D7B3C,QAAAN;A0D8BE,UAAM2Z,IAAe,MAAM;AAC1B,MAAArZ,EAAI,gBAAiB,GACrBA,EAAI,eAAgB;AAAA,IACpB;AAGD,QAAIA,EAAI,QAAQ,WAAW;AAC1B,YAAMsZ,IAAO1L,EAAO;AACpB,MAAA0L,KAAA,QAAAA,EAAM,SACND,EAAc;AAAA,IACjB,WACWrZ,EAAI,QAAQ,aAAa;AACjC,YAAMsZ,IAAO1L,EAAO;AACpB,MAAA0L,KAAA,QAAAA,EAAM,SACND,EAAc;AAAA,IACjB,WACWrZ,EAAI,QAAQ,OAAO;AAE3B,YAAMuZ,IAAYvZ,EAAI,WAAWA,EAAI,OAAO,WAAUA,EAAI,OAAO;AACjE,MAAAuZ,KAAA,QAAAA,EAAW,SACXF,EAAc;AAAA,IACjB,MACO,CAAIrZ,EAAI,QAAQ,aACf,KAAK,OAAO,YAAY,MAAM,IAAG,KAIrCN,IAAAiG,EAAO,WAAP,QAAAjG,EAAe,UAHf,KAAK,MAAO,GAKb2Z,EAAc;AAAA,EAEjB,CAAE,GACDzL,EAAO,iBAAiB,SAAS,OAAM5N,MAAO;A1D9D/C,QAAAN;A0D+DE,QAAIkZ,MAAe,SAAS;AAC3B,YAAMtW,IAAOuW,EAAS,KAAK,CAAAvW,MAAQA,EAAK,OAAOoL,CAAE;AACjD,MAAAqL,EAAcrL,CAAE,IAAI,CAACqL,EAAcrL,CAAE,GACrC/H,EAAO,aAAarD,GAAMuW,CAAQ;AAAA,IACrC,WACWD,MAAe,SAAS;AAChC,MAAAG,EAAcrL,CAAE,IAAI;AACpB,UAAIpL,IAAO;AACX,MAAAuW,EAAS,QAAQ,CAAAW,MAAe;AAC/B,QAAIA,EAAY,OAAO9L,IACtBpL,IAAOkX,IAGPT,EAAcS,EAAY,EAAE,IAAI;AAAA,MAErC,CAAI,GACD7T,EAAO,aAAarD,GAAMuW,CAAQ;AAAA,IACrC,OACO;AACJ,YAAMvW,IAAOuW,EAAS,KAAK,CAAAvW,MAAQA,EAAK,OAAOoL,CAAE;AACjD,MAAA/H,EAAO,aAAarD,GAAMuW,CAAQ;AAAA,IACrC;AAEE,UAAMlT,EAAO,oBAAqB,GAClC3F,EAAI,gBAAiB,GAEjB2F,EAAO,kBACVA,EAAO,UAAW,IAClBjG,IAAAiG,EAAO,WAAP,QAAAjG,EAAe;AAAA,EAElB,CAAE,GACD4C,EAAK,YAAYsL,CAAM,GACvBM,EAAU,YAAY5L,CAAI,GACnBA;AACR;AAEe,MAAMmX,WAAyB1B,GAAkB;AAAA,EAE/D,IAAI,gBAAgB;AACnB,WAAI,KAAK,OAAO,kBAAkB,WAC7B,KAAK,eAAe,UACvB,KAAK,OAAO,gBAAgB,KAG5B,KAAK,OAAO,gBAAgB,KAGvB,KAAK,OAAO;AAAA,EACrB;AAAA,EAEC,YAAYrK,GAAI3I,GAAO;AACtB,IAAI,KAAK,mBACR,KAAK,eAAe2I,CAAE,IAAI3I;AAAA,EAE7B;AAAA,EAEC,MAAM,aAAa;A1DvHpB,QAAArF,GAAA4N;A0DyHE,UAAMoM,KAAyBha,IAAA,SAAS,kBAAT,gBAAAA,EAAwB,IAEjDwS,IAAU1N,EAA0B,eAAe;AACzD,SAAK,WAAW0N;AAEhB,UAAMyH,IAAY,MAAM,KAAK,QAAS;AACtC,SAAK,aAAaA,GAEb,KAAK,mBACT,KAAK,iBAAiB,CAAE,GAGxB,KAAK,WAAW,QAAQ,CAAAhB,MAAY;AACnC,MAAIA,EAAS,aAAa,UAAaA,EAAS,aAAa,SAC5D,KAAK,eAAeA,EAAS,EAAE,IAAIA,EAAS;AAAA,IAEjD,CAAI;AAGF,UAAMG,IAAW,KAAK,OAAO,WAAY,GACnCc,IAAYD,EAAU,IAAI,CAAArX,MAAQoW,GAAY,MAAM,MAAM,CAACpW,GAAM,OAAO,KAAK,cAAe,aAAa,KAAK,WAAY,IAAG,KAAK,YAAY4P,GAASyH,GAAWb,GAAU,KAAK,gBAAgBxW,EAAK,MAAM,CAAC,CAAC;AACpN,WAAAsX,EAAU,QAAQ,CAACtX,GAAMpD,GAAG2a,MAAQ;AACnC,YAAMjM,IAAStL,EAAK,cAAc,QAAQ;AAC1C,UAAIwX,IAAOD,EAAI3a,IAAI,CAAC,GAChBoa,IAAOO,EAAI3a,IAAI,CAAC;AAEpB,MAAIA,MAAO2a,EAAI,SAAS,MACvBC,IAAOD,EAAI,CAAC,IAGT3a,MAAM,MACToa,IAAOO,EAAIA,EAAI,SAAS,CAAC,IAG1BjM,EAAO,WAAWkM,KAAA,gBAAAA,EAAM,cAAc,WACtClM,EAAO,WAAW0L,KAAA,gBAAAA,EAAM,cAAc;AAAA,IACzC,CAAG,GACD,KAAK,cAAahM,IAAAsM,EAAU,CAAC,MAAX,gBAAAtM,EAAc,cAAc,WAE1CoM,KACH,WAAW,MAAM;A1DjKpB,UAAAha;A0DoKI,OAAAA,IAAA,SAAS,eAAega,CAAsB,MAA9C,QAAAha,EAAiD;AAAA,IACjD,GAAE,EAAE,GAECwS;AAAA,EACT;AAAA,EAEC,IAAI,YAAY;AACf,WAAO,KAAK,OAAO,aAAa;AAAA,EAClC;AAAA,EAEC,MAAM,UAAU;AAQf,WAPc;AAAA,MACb,EAAE,IAAI,GAAG,OAAO,WAAY;AAAA,MAC5B,EAAE,IAAI,GAAG,OAAO,WAAY;AAAA,MAC5B,EAAE,IAAI,GAAG,OAAO,WAAY;AAAA,MAC5B,EAAE,IAAI,GAAG,OAAO,WAAY;AAAA,MAC5B,EAAE,IAAI,GAAG,OAAO,WAAU;AAAA,IAC1B;AAAA,EAEH;AAAA;AAAA,EAGC,IAAI,YAAY;AACf,WAAO,KAAK;AAAA,EACd;AAAA;AAAA;AAAA;AAAA,EAKC,IAAI,aAAa;AAChB,WAAO;AAAA,EACT;AAAA,EAEC,IAAI,aAAa;AAEhB,WAAO;AAAA,EACT;AAAA,EAEC,aAAayG,GAASgB,GAAW;AAChC,SAAK,OAAO,IAAI,KAAK,qBAAsB,KAAK,IAAM,6CAA4C;AAAA,EACpG;AAAA,EAEC,YAAY;AACX,SAAK,OAAO,YAAY,MAAM,KAAM;AAAA,EACtC;AAAA,EAEC,MAAM,YAAY;AAEjB,SAAK,iBAAiB,IACtB,MAAM,MAAM,UAAW,GAEnB,KAAK,OAAO,iBAAiB,KAAK,cACrC,KAAK,WAAW,MAAO;AAAA,EAE1B;AACA;ACrNe,MAAMI,WAA0BN,GAAiB;AAAA,EAC5D,IAAI,gBAAgB;AAChB,WAAO,KAAK,OAAO,iBAAiB;AAAA,EAC5C;AAAA,EAEI,MAAM,OAAO;AACT,IAAI,KAAK,cACL,KAAK,OAAO,MAAMpc,GAAY,KAAK,SAAS;AAAA,EAExD;AAAA,EAEI,MAAM,aAAa;AACf,WAAK,KAAK,mBACN,KAAK,iBAAiB,CAAE,GACxB,MAAMqI,EAAkB,KAAK,QAAO,UAAS,OAAOC,MAAW;AAC3D,WAAK,OAAO,IAAI,MAAM,6BAA6B,KAAK,SAAS,aAAa,GAC9E,KAAK,eAAe,KAAKA,CAAM,GAE/BA,EAAO,YAAY,IAAI;AAAA,IAC1B,GAAE,OAAMA,MACiBA,EAAO,oBACP,KAAK,YAChB,MAAMA,EAAO,UAAW,IAGxB,EAEd,IAEE,MAAM,MAAM,WAAY;AAAA,EACvC;AAAA,EAEI,cAAcA,GAAOyI,GAASC,GAAS;AAAA,EAE3C;AAAA,EAEI,eAAe1I,GAAO2I,GAAUC,GAAU;AAAA,EAE9C;AAAA,EAEI,eAAe5I,GAAO6I,GAASC,GAAQL,GAASC,GAAS;AAAA,EAE7D;AAAA,EAEI,IAAI,YAAY;A3DlDpB,QAAA3O;A2DmDQ,aAAOA,IAAA,KAAK,WAAL,gBAAAA,EAAa,cAAa;AAAA,EACzC;AAAA,EAEI,IAAI,YAAY;AACZ,WAAO;AAAA,EACf;AAAA,EAEI,iBAAiB;AACb,WAAO;AAAA,EACf;AAAA,EAEI,aAAa;AACT,WAAO;AAAA,EACf;AAAA,EAEI,MAAM,UAAU;AACZ,WAAO,KAAK,eAAe,IAAI,CAAAiG,OACpB;AAAA,MACH,IAAIA,EAAO;AAAA,MACX,OAAOA,EAAO,SAASA,EAAO;AAAA,MAC9B,MAAMA,EAAO;AAAA,MACb,QAAAA;AAAA,IAChB,EACS;AAAA,EACT;AAAA,EAEI,aAAagT,GAAUgB,GAAW;AAC9B,UAAMhU,IAAS,KAAK,eAAe,KAAK,CAAAA,MAAUA,EAAO,SAASgT,EAAS,EAAE;AAC7E,QAAIhT,GAAQ;AACR,YAAM5I,IAAQ,IAAI,MAAM,kBAAkB;AAC1C,MAAA4I,EAAO,OAAO5I,GAAO,KAAK,cAAc;AAAA,IACpD;AAAA,EACA;AAAA,EAEI,MAAM,YAAY;A3DrFtB,QAAA2C;A2DsFE,UAAM,MAAM,UAAW,GAEjB,WAAW,MAAM;AACb,MAAI,KAAK,cACL,KAAK,WAAW,MAAO;AAAA,IAE9B,GAAE,EAAE,IAELA,IAAA,KAAK,YAAL,QAAAA,EAAc,QAAQ,CAAAwT,MAAO;AACzB,MAAIA,EAAI,MAAM,YAAY,SACtB,KAAK,oBAAoBA,CAAG,IAG5B,KAAK,oBAAoBA,CAAG;AAAA,IAE5C;AAAA,EACA;AAAA,EAEI,IAAI,UAAU;AACV,WAAO,KAAK,YAAY,MAAM,KAAK,KAAK,SAAS,uBAAuB,eAAe,CAAC;AAAA,EAChG;AAAA,EAEI,oBAAoBA,GAAK;A3D5G7B,QAAAxT;A2D6GQ,UAAMwO,KAAYxO,IAAAwT,EAAI,eAAJ,gBAAAxT,EAAgB;AAClC,IAAIwO,MACAA,EAAU,MAAM,UAAU;AAAA,EAEtC;AAAA,EAEI,oBAAoBgF,GAAK;A3DnH7B,QAAAxT;A2DoHQ,UAAMwO,KAAYxO,IAAAwT,EAAI,eAAJ,gBAAAxT,EAAgB;AAClC,IAAIwO,MACAA,EAAU,MAAM,UAAU;AAAA,EAEtC;AACA;ACrHO,MAAM8L,KAAuB,CAACC,GAAatd,GAAQkB,GAAMqc,IAAe,CAAA,MAAO;AAClF,QAAMC,IAAW,IAAIF,EAAYtd,GAAQkB,CAAI;AAG7C,SADAA,IAAOsc,EAAS,QAAQtc,GACnBA,KAKGlB,EAAO,OAAO,WAAWA,EAAO,OAAO,QAAQkB,CAAI,KACnDkE,GAAamY,GAAcvd,EAAO,OAAO,QAAQkB,CAAI,GAAG,EAAK,GAEjEsc,EAAS,UAAUD,GACZC,MARPxd,EAAO,IAAI,KAAK,uBAAuBsd,EAAY,IAAI,kHAAkH,GAClK;AASf;AAEA,SAASG,GAAazd,GAAQ0d,GAAaC,GAAgBL,GAAaM,IAAY,IAAO;AACvF,QAAMrZ,IAAOoZ,EAAe;AAC5B,MAAIE,IAAkB;AACtB,MAAI7d,EAAO,eAAe,gBAAgBuE,CAAI,KAC1CvE,EAAO,eAAe,gBAAgBuE,CAAI,EAAE,KAAK,CAACuZ,GAAiBvb,MAAM;AACrE,QAAIub,EAAiB,SAASH,EAAe;AACzC,aAAAE,IAAkBtb,GACX;AAAA,EAEvB,CAAS,KACD,CAACqb,GACL;AACI,IAAA5d,EAAO,IAAI,KAAK,UAAU2d,EAAe,IAAI,YAAYpZ,CAAI,sBAAsB;AACnF;AAAA,EACR;AACI,EAAAvE,EAAO,eAAe,cAAc0d,CAAW,IAAIJ,GACnDtd,EAAO,eAAe,gBAAgBuE,CAAI,IAAIvE,EAAO,eAAe,gBAAgBuE,CAAI,KAAK,CAAE,GAC3FsZ,MAAoB,MACpB7d,EAAO,eAAe,gBAAgBuE,CAAI,EAAE,OAAOsZ,GAAiB,CAAC,GAEzE7d,EAAO,eAAe,gBAAgBuE,CAAI,EAAE,KAAKoZ,CAAc,GAE/D3d,EAAO,kBAAkBA,EAAO,mBAAmB,CAAE;AACrD,QAAM+d,IAAeJ,EAAe,wBAAyB;AAC7D,MAAII,MACAA,EAAa,UAAUA,EAAa,WAAW/d,GAC3C,CAACA,EAAO,gBAAgB,KAAK,CAAAge,MACtBA,EAAO,YAAY,SAASD,EAAa,YAAY,IAC/D,IAAG;AACA,UAAM7c,IAAO6c,EAAa,YACpBE,IAAUF,EAAa;AAC7B,IAAA/d,EAAO,IAAI,MAAM,2BAA4BkB,OAAY+c,CAAO,EAAG,GACnEje,EAAO,gBAAgB,KAAK+d,CAAY;AAAA,EACpD;AAEA;AAEO,SAASG,GAAmBle,GAAOme,GAAY;AAClD,MAAIb,IAAc,MACd7W,IAAS,EAAE,SAAS,GAAM;AAW9B,MAVI,OAAO0X,KAAgB,aACvBb,IAAca,IAET,OAAOA,KAAgB,YACzB,OAAOA,EAAW,UAAY,eAEjCb,IAAca,EAAW,QACzB1X,IAAS0X,EAAW,SAGpB,CAACb;AACD,IAAAtd,EAAO,IAAI,KAAK,2FAA2F;AAAA,OAE1G;AACD,UAAM2d,IAAiBN,GAAqBC,GAAatd,GAAQ,MAAMyG,CAAM;AAC7E,QAAI,CAACkX;AACD,MAAA3d,EAAO,IAAI,KAAK,8CAA8Csd,EAAY,IAAI,EAAE;AAAA,SAE/E;AACD,YAAMlH,IAAYuH,EAAe,YAAY;AAC7C,MAAAF,GAAazd,GAAQoW,GAAWuH,GAAgBL,GAAa,EAAI;AAAA,IAC7E;AAAA,EACA;AACA;AAEO,SAASc,GAAcpe,GAAO4a,GAAS;AAC1C,QAAMnU,IAASzG,EAAO;AACtB,EAAA4a,EAAQ,KAAI,EAAG,QAAQ,CAAApV,MAAO;AAC1B,UAAMwY,IAASpD,EAAQpV,CAAG,GACpB6Y,IAAa7Y,EAAI,UAAU,GAAEA,EAAI,SAAS,CAAC;AACjD,QAAIiB,EAAO,QAAQ4X,CAAU,GAAG;AAC5B,YAAMf,IAAcU,EAAO,SACrBL,IAAiBN,GAAqBC,GAAatd,GAAQqe,GAAY,CAAA,CAAE;AAC/E,MAAAZ,GAAazd,GAAQwF,GAAKmY,GAAgBL,GAAa,EAAK;AAAA,IACxE,WAEiB,eAAe,KAAKe,CAAU,GAAG;AACtC,MAAAre,EAAO,kBAAkBA,EAAO,mBAAmB,CAAE;AACrD,YAAMse,IAAcN,EAAO,SACrBO,IAAiB,IAAID,EAAYte,CAAM;AAC7C,UAAI,CAACA,EAAO,gBAAgB,KAAK,CAAAge,MACtBA,EAAO,YAAY,SAASO,EAAe,YAAY,IACjE,GAAG;AACA,cAAMrd,IAAOqd,EAAe,YACtBN,IAAUM,EAAe;AAC/B,QAAAve,EAAO,IAAI,MAAM,2BAA4BkB,OAAY+c,CAAO,EAAG,GACnEje,EAAO,gBAAgB,KAAKue,CAAc;AAAA,MAC1D;AAAA,IACA;AAAA,EACA,CAAK;AACL;AAEO,SAASC,GAAgBxe,GAAQ;AACpC,QAAMyG,IAASzG,EAAO;AAOtB,MANAA,EAAO,iBAAiBA,EAAO,kBAAkB;AAAA,IAC7C,eAAe,CAAE;AAAA,IACjB,iBAAiB,CAAA;AAAA,EACpB,GAGGA,EAAO,eAAe,cAAc,WAAW,EAAG;AAKtD;AAAA,IACI,GAAGkb;AAAA,IACH,GAAGlb,EAAO,WAAW;AAAA,EAC7B,EAAM,QAAQ,CAAAme,MAAc;AAChB,IAAAD,GAAmBle,GAAQme,CAAU;AAAA,EACjD,CAAS;AAGL,QAAM,EAAE,cAAAM,EAAY,IAAKhY;AACzB,EAAIgY,KACAA,EAAa,QAAQ,CAAC3H,GAAQvU,MAAM;AAEhC,UAAMrB,IAAO,gBAAgBqB,CAAC,IACxBib,IAAWH,GAAqBD,IAAmBpd,GAAQkB,GAAM4V,CAAO;AAC9E,IAAA0G,EAAS,YAAYlc,EAAS,CAACtB,EAAO,oBAAoB8W,EAAQ,IAAI,CAAC,GACvE2G,GAAazd,GAAQwd,EAAS,MAAMA,GAAU,oBAAoBjb,CAAC,IAAI,EAAK;AAAA,EACxF,CAAS,GAGLvC,EAAO,IAAI,MAAM,+BAA+B;AACpD;AAEO,SAAS0e,GAAkB1e,GAAQ;AACtC,SAAOA,EAAO;AAClB;AAEO,SAAS+T,GAAiB/T,GAAOuE,GAAM;A5DxJ9C,MAAAxB;A4DyJI,WAAOA,IAAA/C,EAAO,mBAAP,gBAAA+C,EAAuB,gBAAgBwB,OAAS,CAAE;AAC7D;AAEO,eAAewE,EAAkB/I,GAAOuE,GAAKoa,IAAO,MAAKC,IAAU,MAAM;AAC5E,MAAI,CAAC5e,EAAO,eAAe,gBAAgBuE,CAAI,GAAG;AAC9C,IAAAvE,EAAO,IAAI,KAAK,yCAAyCuE,CAAI,GAAG;AAChE;AAAA,EACR;AAGI,EAAAvE,EAAO,eAAe,gBAAgBuE,CAAI,EAAE,KAAK,CAACrC,GAAEwK,MAAMxK,EAAE,QAAQwK,EAAE,KAAK,GAC3E1M,EAAO,eAAe,gBAAgBuE,CAAI,EAAE,QAAQ,CAAA8E,MAAKrJ,EAAO,IAAI,MAAM,SAASuE,CAAI,WAAW8E,EAAE,IAAI,EAAE,CAAC,GAEvG,OAAOuV,KAAe,eACtBA,IAAY,eAAe5V,GAAQ;AAC/B,WAAO,MAAMA,EAAO,UAAW;AAAA,EAC3C;AAGI,aAAWzG,KAAKvC,EAAO,eAAe,gBAAgBuE,CAAI,GAAG;AACzD,UAAMyE,IAAShJ,EAAO,eAAe,gBAAgBuE,CAAI,EAAEhC,CAAC;AAE5D,QADgB,MAAMqc,EAAU5V,CAAM,GACzB;AACT,UAAIA,EAAO,YAAY;AACnB,cAAM6V,IAAe,MAAM7V,EAAO,gBAAiB;AACnD,YAAI,OAAO6V,KAAkB;AACzB,qBAAWvR,KAAQuR,GAAc;AAC7B,kBAAMlQ,IAAOkQ,EAAavR,CAAI;AAC9B,YAAAtN,EAAO,cAAcsN,GAAKqB,CAAI;AAAA,UACtD;AAAA,MAEA;AAEY,MAAI,OAAOgQ,KAAY,cACnB,MAAMA,EAAO3V,CAAM,GAEvB,MAAMA,EAAO,KAAM;AAAA,IAC/B;AAAA,EACA;AACA;AAEO,eAAe8V,GAAoB9e,GAAOuE,GAAM;A5DlMvD,MAAAxB;A4DmMI,GAAAA,IAAA/C,EAAO,eAAe,gBAAgBuE,CAAI,MAA1C,QAAAxB,EAA6C,QAAQ,OAAMiG,MAAU;AACjE,UAAMA,EAAO,OAAQ;AAAA,EACxB;AACL;ACjMO,SAAS+V,GAAuBC,GAAU;A7DLjD,MAAAjc;A6DMC,QAAMkc,IAAQ,CAACC,GAAOC,MAAU;AAC/B,QAAI,CAACD;AACJ,YAAM,IAAI,MAAM,2BAA2BC,CAAK,EAAE;AAAA,EAErD;AAEC,EAAAF,EAAMD,EAAS,SAAS,2BAA2B,GACnDC,EAAMD,EAAS,QAAQ,SAAO,GAAG,+BAA+B,GAChEC,GAAMlc,IAAAic,EAAS,aAAT,gBAAAjc,EAAmB,SAAS,2CAA2C;AAC9E;AAEe,MAAMqc,WAAuBhY,GAAe;AAAA,EAC1D,YAAYpH,GAAQuX,GAAgB;AACnC,UAAMvX,GAAQuX,CAAc,GAC5B,KAAK,kBAAkBA,GACvB,KAAK,cAAc,MACnB,KAAK,WAAW,MAChB,KAAK,WAAW,CAAE,GAElB,KAAK,mBAAmB,MAExB,KAAK,mBAAmB,MAExB,KAAK,YAAY;AAAA,MAChB,SAAS;AAAA,MACT,OAAO;AAAA,MACP,KAAK;AAAA,IACR;AAAA,EACA;AAAA,EAEC,MAAM,KAAKhO,GAAY;AACtB,SAAK,cAAcA,GACnB,KAAK,WAAW,CAAE;AAElB,QAAI8V,IAAmB,KAAK,OAAO,OAAO,sBAAsB;AAChE,IAAI,KAAK,YAAY,WAAW,MAC/BA,IAAmB,KAAK,YAAY,CAAC,EAAE,UAExC9V,EAAW,KAAK,CAAA+V,MAAK;AACpB,UAAIA,EAAE,SAAS;AACd,eAAAD,IAAmBC,EAAE,SACd;AAAA,IAEX,CAAG,GAGD,KAAK,OAAO,IAAI,MAAM,kCAAkC,GAExD,MAAMvJ,GAAkB,KAAK,MAAM;AAGnC,eAAWL,KAAU,KAAK,aAAa;AACtC,YAAM6J,IAAetJ,GAAgB,KAAK,QAAQP,CAAM;AACxD,UAAI,CAAC6J;AACJ,cAAM,MAAM,4BAA6B7J,EAAO,MAAQ,EAAC;AAG1D,YAAMnL,IAAcmL,EAAO,YAAY2J,GACjCG,IAAc,MAAMlW,GAAe,KAAK,QAAQoM,CAAM;AAC5D,UAAI,CAAC8J;AACJ,cAAM,MAAM,6BAA8B9J,EAAO,OAAS,EAAC;AAG5D,WAAK,SAASA,EAAO,OAAO,IAAI;AAAA,QAC/B,QAAAA;AAAA,QACA,aAAAnL;AAAA,QACA,aAAAiV;AAAA,QACA,cAAAD;AAAA,MACJ;AAAA,IACA;AAEE,eAAWhK,KAAW,KAAK,UAAU;AACpC,YAAM,IAAI,KAAK,SAASA,CAAO;AAC/B,QAAE,SAAS,MAAM,EAAE,aAAa,kBAAkB,KAAK,eAAe,GACtE,EAAE,SAAS,MAAM,EAAE,YAAY,iBAAiB,EAAE,OAAO,SAAS,EAAE,WAAW,GAC3E8J,MAAmB9J,KACtB,KAAK,mBAAmB,EAAE,QAC1B,EAAE,OAAO,WAAW,CAAC,KAGrB,EAAE,OAAO,WAAW,CAAC,GAGtB,MAAM,EAAE,OAAO,KAAK,EAAE,QAAQ,IAAI,GAClC,MAAM,EAAE,OAAO,WAAW,EAAE,MAAM,GAClC,EAAE,OAAO,aAAa,MAAM;AAG3B,aAAK,cAAc,OAAO,GAG1B,KAAK,cAAc,kBAAkB,CAAC,GAGtC/U,GAAe,KAAK,QAAQV,EAAO,KAAK;AAAA,MACxC,CAAA,GACD,KAAK,SAAS,KAAK,EAAE,MAAM;AAAA,IAC9B;AAEE,QAAI,KAAK,oBAAoB;AAC5B,iBAAK,OAAO,IAAI,MAAM,gOAAgO,GAChP,IAAI,MAAM,sEAAsE;AAAA,EAEzF;AAAA,EAEC,MAAM,SAAS;AACd,SAAK,eAAgB,GACrB,MAAMkW,GAAoB,KAAK,MAAM;AAAA,EACvC;AAAA,EAEC,IAAI,UAAU;AACb,WAAO,KAAK;AAAA,EACd;AAAA;AAAA,EAGC,IAAI,aAAa;AAChB,WAAO,KAAK;AAAA,EACd;AAAA;AAAA;AAAA,EAIC,IAAI,UAAU;AACb,WAAO,KAAK;AAAA,EACd;AAAA,EAEC,IAAI,kBAAkB;AACrB,WAAO,KAAK;AAAA,EACd;AAAA,EAEC,IAAI,gBAAgB;A7DvIrB,QAAAjT,GAAA4N,GAAA8O;A6DwIE,aAAO1c,IAAA,KAAK,cAAL,gBAAAA,EAAgB,cACtB4N,IAAA,KAAK,cAAL,gBAAAA,EAAgB,SAAM8O,IAAA,KAAK,cAAL,gBAAAA,EAAgB;AAAA,EACzC;AAAA,EAEC,IAAI,YAAY;A7D5IjB,QAAA1c;A6D6IE,YAAOA,IAAA,KAAK,cAAL,gBAAAA,EAAgB;AAAA,EACzB;AAAA,EAEC,IAAI,UAAU;A7DhJf,QAAAA;A6DiJE,YAAOA,IAAA,KAAK,cAAL,gBAAAA,EAAgB;AAAA,EACzB;AAAA,EAEC,MAAM,YAAY,EAAE,SAAA2c,GAAS,OAAAnS,GAAO,KAAAC,EAAG,GAAI;AAC1C,QAAID,KAAOC;AACV,YAAM,MAAM,uCAAwCD,CAAK,iCAAmCC,CAAG,EAAG;AAEnG,SAAK,YAAY;AAAA,MAChB,SAAAkS;AAAA,MACA,OAAAnS;AAAA,MACA,KAAAC;AAAA,IACA;AACD,UAAMoG,IAAc,MAAM,KAAK,YAAW;AAC1C,IAAApT,GAAe,KAAK,QAAQV,EAAO,YAAY,EAAE,aAAa4f,IAAUnS,IAAQqG,IAAcA,EAAW,CAAE;AAAA,EAC7G;AAAA,EAEC,kBAAkB;AACjB,SAAK,YAAY;AACjB,UAAM+L,IAAiB,YAAY;AAClC,UAAI,CAAC,KAAK,SAAS,QAAQ;AAC1B,aAAK,OAAO,IAAI,KAAK,gDAAgD;AACrE;AAAA,MACJ;AAEG,UAAI/L,IAAc,KAAK,gBAAgB;AACvC,YAAMgM,IAAU;AAEhB,UAAI,KAAK,QAAQ,SAAO;AACvB,iBAASrd,IAAI,GAAGA,IAAE,KAAK,QAAQ,QAAQ,EAAEA,GAAG;AAC3C,gBAAMsd,IAAY,KAAK,QAAQtd,CAAC;AAChC,cAAIsd,MAAc,KAAK,iBAAiB;AACvC,kBAAMC,IAAaD,EAAU;AAC7B,YAAI,KAAK,IAAIjM,IAAckM,CAAU,IAAIF,MACxC,KAAK,OAAO,IAAI,MAAM,iCAAiC,GACvDC,EAAU,eAAejM,CAAW;AAAA,UAE3C;AAAA,QACA;AAIG,UAAI,KAAK,eAAe;AACvB,YAAImM,IAAqBnM,IAAc,KAAK;AAC5C,YAAI,KAAK,WAASA,GAAa;AAC9B,gBAAM,KAAK,cAAc,OAAO,GAChC,MAAM,KAAK,eAAe,CAAC,GAC3B,KAAK,eAAgB,GACrBA,IAAc,GACdpT,GAAe,KAAK,QAAQV,EAAO,OAAO,CAAA,CAAE;AAC5C;AAAA,QACL,MACS,CAAI8T,IAAY,KAAK,cACzB,MAAM,KAAK,eAAe,CAAC,GAC3BA,IAAc,KAAK,WACnBmM,IAAqB;AAGtB,QAAAvf,GAAe,KAAK,QAAQV,EAAO,YAAY,EAAE,aAAaigB,GAAoB,GAClF,KAAK,mBAAmB,WAAW,MAAM;AACxC,UAAI,KAAK,aACRJ,EAAgB;AAAA,QAEjB,GAAE,GAAG;AAAA,MACV,MACQ,CAAI,KAAK,cACbnf,GAAe,KAAK,QAAQV,EAAO,YAAY,EAAE,aAAA8T,GAAa,GAC9D,KAAK,mBAAmB,WAAW,MAAM;AACxC,QAAA+L;MACA,GAAE,GAAG;AAAA,IAEV;AACE,IAAAA,EAAgB;AAAA,EAClB;AAAA,EAEC,iBAAiB;AAChB,SAAK,YAAY,IACb,KAAK,oBACR,aAAa,KAAK,gBAAgB;AAAA,EAErC;AAAA,EAEC,cAAcK,GAAQ1f,IAAS,IAAI;AAIlC,WAAK,MAAM,QAAQA,CAAM,MACxBA,IAAS,CAACA,CAAM,IAEV,IAAI,QAAQ,CAACM,MAAY;AAC/B,UAAIqf,IAAM,CAAE,GACR5W,IAAI,CAAE;AACV,WAAK,QAAQ,QAAQ,CAAArJ,MAAU;AAC9B,QAAAqJ,EAAE,KAAK,IAAI,QAAQ,CAAA6W,MAAgB;AAClC,UAAAlgB,EAAOggB,CAAM,EAAE,GAAG1f,CAAM,EAAE,KAAK,CAAA6f,MAAK;AACnC,YAAAF,EAAI,KAAKE,CAAC,GACVD,EAAc;AAAA,UACd,CAAA;AAAA,QACN,CAAK,CAAC;AAAA,MACF,CAAA,GAED,QAAQ,WAAW7W,CAAC,EAAE,KAAK,MAAMzI,EAAQqf,CAAG,CAAC;AAAA,IAC7C,CAAA;AAAA,EACH;AAAA,EAEC,IAAI,eAAe;AAClB,WAAO,KAAK,YAAY,KAAK,CAAA7K,MAAM,MAAM,KAAK,OAAO,KAAKA,EAAG,OAAO,CAAC,EAAE,QAAQ,SAAS,MAAM,EAAE;AAAA,EAClG;AAAA,EAEC,MAAM,OAAO;AACZ,gBAAK,gBAAiB,GACP,MAAM,KAAK,cAAc,MAAM;AAAA,EAEhD;AAAA,EAEC,MAAM,QAAQ;AACb,gBAAK,eAAgB,GACN,MAAM,KAAK,cAAc,OAAO;AAAA,EAEjD;AAAA,EAEC,MAAM,OAAO;AACZ,SAAK,eAAc,GACnB,MAAM,KAAK,cAAc,OAAO,GAChC,MAAM,KAAK,cAAc,kBAAkB,CAAC;AAAA,EAC9C;AAAA,EAEC,MAAM,SAAS;AACd,YAAQ,MAAM,KAAK,cAAc,QAAQ,GAAG,CAAC;AAAA,EAC/C;AAAA,EAEC,MAAM,eAAe3K,GAAG;AACvB,UAAMoJ,IAAW,MAAM,KAAK,SAAU;AAChC,IAAIpJ,IAAI,IACJA,IAAI,IAECA,IAAIoJ,MACTpJ,IAAIoJ;AAGd,UAAMuM,KAAY,MAAM,KAAK,cAAc,aAAa,GAAG,CAAC;AAC5D,QAAIC,IAAc;AAElB,QAAI,KAAK,eAAe;AACvB,MAAA5V,IAAIA,IAAI,KAAK,WACbA,IAAIA,KAAK,KAAK,UAAU,KAAK,UAAUA;AACvC,YAAMnI,KAAU,MAAM,KAAK,cAAc,kBAAkB,CAACmI,CAAC,CAAC,GAAG,CAAC,GAC5D6V,KAAW,MAAM,KAAK,cAAc,aAAa,GAAG,CAAC;AAC3D,MAAAD,IAAc;AAAA,QACb,QAAA/d;AAAA,QACA,UAAU8d,IAAW,KAAK;AAAA,QAC1B,SAASE,IAAU,KAAK;AAAA,MAC5B;AAAA,IACA,OACO;AACJ,YAAMhe,KAAU,MAAM,KAAK,cAAc,kBAAkB,CAACmI,CAAC,CAAC,GAAG,CAAC,GAC5D6V,KAAW,MAAM,KAAK,cAAc,aAAa,GAAG,CAAC;AAC3D,MAAAD,IAAc,EAAE,QAAA/d,GAAQ,UAAA8d,GAAU,SAAAE,EAAS;AAAA,IAC9C;AAEE,UAAM1M,IAAc,MAAM,KAAK,YAAa;AAC5C,WAAApT,GAAe,KAAK,QAAQV,EAAO,YAAY,EAAE,aAAa8T,GAAa,GAEpEyM;AAAA,EACT;AAAA,EAEC,MAAM,cAAc;AACnB,UAAMzM,IAAc,MAAM,KAAK,gBAAgB,YAAa;AAC5D,WAAI,KAAK,gBACDA,IAAc,KAAK,YAGnBA;AAAA,EAEV;AAAA,EAEC,MAAM,8BAA8B;AAEnC,WADoB,MAAM,KAAK,gBAAgB,YAAa;AAAA,EAE9D;AAAA,EAEC,MAAM,SAAS;AACd,WAAI,KAAK,kBACD,MAAM,KAAK,gBAAgB,OAAQ,KAGlC,MAAM,KAAK,cAAc,QAAQ,GAAG,CAAC;AAAA,EAEhD;AAAA,EAEC,MAAM,UAAU3R,GAAG;AAClB,WAAI,KAAK,kBACD,MAAM,KAAK,gBAAgB,UAAUA,CAAC,KAGrC,MAAM,KAAK,cAAc,aAAY,CAACA,CAAC,CAAC,GAAG,CAAC;AAAA,EAEvD;AAAA,EAEC,MAAM,WAAW;AAChB,WAAI,KAAK,gBACD,KAAK,UAAU,KAAK,YAGpB,MAAM,KAAK,yBAA0B;AAAA,EAE/C;AAAA,EAEC,MAAM,2BAA2B;AAEhC,YADgB,MAAM,KAAK,cAAc,UAAU,GAAG,OAAO,CAACse,GAAKC,MAAQ,KAAK,IAAID,GAAKC,CAAG,GAAG,OAAO,SAAS;AAAA,EAEjH;AAAA,EAEC,MAAM,eAAe;AACpB,YAAQ,MAAM,KAAK,cAAc,cAAc,GAAG,CAAC;AAAA,EACrD;AAAA,EAEC,MAAM,gBAAgBC,GAAM;AAC3B,YAAQ,MAAM,KAAK,cAAc,mBAAkB,CAACA,CAAI,CAAC,GAAG,CAAC;AAAA,EAC/D;AAAA,EAEC,MAAM,4BAA4B;AACjC,QAAIzgB,IAAS,MACT0gB,IAAqB,CAAE;AAC3B,QAAI,OAAO,KAAK,KAAK,OAAO,EAAE,SAAO;AACpC,iBAAWnL,KAAW,KAAK,SAAS;AACnC,cAAMG,IAAS,KAAK,QAAQH,CAAO,GAC7B9I,IAAK,MAAMiJ,EAAO,OAAO,aAAc,KAAK,CAAE;AACpD,QAAI,CAAC1V,KAAUyM,EAAE,SAASiU,EAAmB,WAC5CA,IAAqBjU,GACrBzM,IAAS0V,EAAO;AAAA,MAErB;AAEE,WAAO1V,KAAU,KAAK;AAAA,EACxB;AAAA,EAEC,MAAM,oBAAoB;AACzB,YAAQ,MAAM,KAAK,0BAAyB,GAAI;AAAA,EAClD;AAAA,EAEC,MAAM,eAAe;AAEpB,WAAO,OADQ,MAAM,KAAK,0BAA2B,GACjC,aAAc;AAAA,EACpC;AAAA,EAEC,MAAM,WAAW2gB,GAAS;AAGzB,UAAMC,IAAY,OAFH,MAAM,KAAK,0BAA2B,GAEtB,aAAc,GACvCC,IAAQD,EAAU;AACxB,QAAIjf,IAAQ;AAQZ,QAPAif,EAAU,KAAK,CAACnU,GAAElK,OACboe,EAAQ,UAAUlU,EAAE,UACvB9K,IAAQY,IAEFZ,MAAU,GACjB,GAEGA,KAAO,GAAG;AACb,YAAMmf,IAAgBnf,IAAQkf;AAC9B,iBAAWtL,KAAW,KAAK,SAAS;AACnC,cAAMG,IAAS,KAAK,QAAQH,CAAO,GAC7BwL,IAAmB,MAAMrL,EAAO,OAAO,aAAc,KAAK,CAAE;AAElE,YADA,KAAK,OAAO,IAAI,MAAMqL,CAAe,GACjCA,EAAgB,SAAO,GAAG;AAC7B,gBAAMC,IAAe,KAAK,MAAMD,EAAgB,SAASD,CAAa,GAChEG,IAAkBF,EAAgBC,CAAY;AACpD,gBAAMtL,EAAO,OAAO,WAAWuL,CAAe;AAAA,QACnD;AAAA,MACA;AAAA,IACA;AAAA,EACA;AAAA,EAEC,MAAM,qBAAqB;AAC1B,WAAO,KAAK,gBAAgB,mBAAoB;AAAA,EAClD;AAAA,EAEC,MAAM,iBAAiB;AACtB,WAAO,KAAK,gBAAgB,eAAgB;AAAA,EAC9C;AAAA,EAEC,MAAM,qBAAqBC,GAAO;AACjC,WAAO,KAAK,gBAAgB,qBAAqBA,CAAK;AAAA,EACxD;AAAA,EAEC,IAAI,oBAAoB;AACvB,WAAO,KAAK,gBAAgB;AAAA,EAC9B;AACA;AChbY,MAACC,IAAgC,OAAO,OAAO;AAAA,EACvD,UAAU;AAAA,EACV,YAAY;AAAA,EACZ,WAAW;AAAA,EACX,aAAa;AAAA,EACb,eAAe;AAAA,EACf,cAAc;AAAA,EACd,aAAa;AAAA,EACb,eAAe;AAAA,EACf,cAAc;AAClB,CAAC,GAEKC,IAAyB,CAACtgB,GAAM8M,GAAMyT,GAASC,GAAU1Z,MAAW;AACtE,EAAA0Z,IAAWA,KAAY,IACvBD,IAAUA,KAAW;AACrB,QAAM/e,IAASuF,EAA0B;AAAA,sCACNyZ,CAAU;AAAA,cAClCxgB,IAAO,mBAAoBA,CAAM,SAAQ,EAAE;AAAA,cAC3C8M,IAAO,mBAAoBA,CAAM,SAAQ,EAAE;AAAA;AAAA,KAErD;AAED,SAAAhG,EAAO,YAAY,IACnBA,EAAO,YAAYtF,CAAM,GACrBsF,EAAO,UACP,aAAaA,EAAO,KAAK,GACzBA,EAAO,QAAQ,OAEnBA,EAAO,QAAQ,WAAW,MAAM;AAC5B,IAAAA,EAAO,YAAYtF,CAAM;AAAA,EAC5B,GAAE+e,CAAO,GACH/e;AACX;AAEe,MAAMif,WAA8BtZ,EAAS;AAAA,EACxD,YAAYjI,GAAQ4H,GAAQ;AACxB,UAAMH,IAAa,EAAE,OAAS,0BAA2B;AACzD,UAAMzH,GAAQ,EAAE,YAAAyH,GAAY,QAAAG,EAAM,CAAE,GAEpC,KAAK,oBAAoBC,EAA0B,0CAA0C,KAAK,OAAO,GACzG,KAAK,sBAAsBA,EAA0B,4CAA4C,KAAK,OAAO,GAC7G,KAAK,qBAAqBA,EAA0B,2CAA2C,KAAK,OAAO,GAC3G,KAAK,uBAAuBA,EAA0B,6CAA6C,KAAK,OAAO,GAC/G,KAAK,yBAAyBA,EAA0B,+CAA+C,KAAK,OAAO,GACnH,KAAK,wBAAwBA,EAA0B,8CAA8C,KAAK,OAAO,GACjH,KAAK,uBAAuBA,EAA0B,6CAA6C,KAAK,OAAO,GAC/G,KAAK,yBAAyBA,EAA0B,+CAA+C,KAAK,OAAO,GACnH,KAAK,wBAAwBA,EAA0B,8CAA8C,KAAK,OAAO;AAAA,EACzH;AAAA,EAEI,KAAK,EAAE,MAAA/G,IAAO,MAAM,MAAA8M,IAAO,IAAI,SAAAyT,IAAU,KAAM,UAAAhL,IAAW8K,EAA8B,eAAe,UAAAG,IAAW,GAAE,GAAI;AACpH,YAAQjL,GAAQ;AAAA,MAChB,KAAK8K,EAA8B;AAC/B,QAAAC,EAAuB,MAAM,MAAM,CAACtgB,GAAM8M,GAAMyT,GAASC,GAAU,KAAK,iBAAiB,CAAC;AAC1F;AAAA,MACJ,KAAKH,EAA8B;AAC/B,QAAAC,EAAuB,MAAM,MAAM,CAACtgB,GAAM8M,GAAMyT,GAASC,GAAU,KAAK,mBAAmB,CAAC;AAC5F;AAAA,MACJ,KAAKH,EAA8B;AAC/B,QAAAC,EAAuB,MAAM,MAAM,CAACtgB,GAAM8M,GAAMyT,GAASC,GAAU,KAAK,kBAAkB,CAAC;AAC3F;AAAA,MACJ,KAAKH,EAA8B;AAC/B,QAAAC,EAAuB,MAAM,MAAM,CAACtgB,GAAM8M,GAAMyT,GAASC,GAAU,KAAK,oBAAoB,CAAC;AAC7F;AAAA,MACJ,KAAKH,EAA8B;AAC/B,QAAAC,EAAuB,MAAM,MAAM,CAACtgB,GAAM8M,GAAMyT,GAASC,GAAU,KAAK,sBAAsB,CAAC;AAC/F;AAAA,MACJ,KAAKH,EAA8B;AAC/B,QAAAC,EAAuB,MAAM,MAAM,CAACtgB,GAAM8M,GAAMyT,GAASC,GAAU,KAAK,qBAAqB,CAAC;AAC9F;AAAA,MACJ,KAAKH,EAA8B;AAC/B,QAAAC,EAAuB,MAAM,MAAM,CAACtgB,GAAM8M,GAAMyT,GAASC,GAAU,KAAK,oBAAoB,CAAC;AAC7F;AAAA,MACJ,KAAKH,EAA8B;AAC/B,QAAAC,EAAuB,MAAM,MAAM,CAACtgB,GAAM8M,GAAMyT,GAASC,GAAU,KAAK,sBAAsB,CAAC;AAC/F;AAAA,MACJ,KAAKH,EAA8B;AAC/B,QAAAC,EAAuB,MAAM,MAAM,CAACtgB,GAAM8M,GAAMyT,GAASC,GAAU,KAAK,qBAAqB,CAAC;AAC9F;AAAA,IACH;AAAA,EACT;AACA;AClFK,MAACE,IAAc,OAAO,OAAO;AAAA,EAC9B,UAAU;AAAA,EACV,kBAAkB;AAAA,EAClB,UAAU;AAAA,EACV,gBAAgB;AAAA,EAChB,QAAQ;AAAA,EACR,oBAAoB;AAAA,EACpB,kBAAkB;AAAA,EAClB,OAAO;AACX,CAAC;ACSM,SAASC,GAAiBzhB,GAAOW,GAAK;AACzC,SAAK,MAAM,QAAQA,CAAG,MAClBA,IAAM,CAACA,CAAG,IAECwI,GAA0BnJ,GAAQW,CAAG,EACtC,gBAAgBA,CAAG;AACrC;AAEO,eAAe+gB,GAAqB1hB,GAAQ;AAG/C,SAAO,EAAE,GAAG,MAAM,GAAG,IAAG;AAC5B;AAEA,eAAe2hB,GAAalL,GAAiB;AhEhC7C,MAAA1T;AgEiCI,aAAWwS,KAAW,KAAK,eAAe,SAAS;AAC/C,UAAMqM,MAAY7e,IAAA0T,KAAA,gBAAAA,EAAiB,WAAjB,gBAAA1T,EAAyB,KAAK,CAAAoD,MAASA,EAAM,YAAYoP,OAAY,MACjFpP,IAAQ,KAAK,eAAe,QAAQoP,CAAO;AAEjD,IAAIqM,KAAa,CAACzb,EAAM,OAAO,YAC3B,MAAMA,EAAM,OAAO,OAAQ,IAEtB,CAACyb,KAAazb,EAAM,OAAO,aAChC,MAAMA,EAAM,OAAO,QAAS;AAAA,EAExC;AACA;AAEA,SAAS0b,KAAsB;AAG3B,aAAWrc,KAAO,KAAK,eAAe,SAAS;AAC3C,UAAM8F,IAAY,KAAK,eAAe,QAAQ9F,CAAG;AACjD,IAAA8F,EAAU,OAAO,QAAQ,MAAM,UAAU,QACzC,KAAK,cAAc,YAAYA,EAAU,OAAO,OAAO;AAAA,EAC/D;AACA;AAEA,eAAewW,KAAqB;AhExDpC,MAAA/e,GAAA4N;AgEyDI,QAAM8F,IAAkB5B,GAAmB,KAAK,QAAQ,KAAK,eAAe,YAAY,KAAK,WAAW,KAAK,kBAAkB;AAE/H,QAAM8M,GAAa,MAAM,MAAM,CAAElL,CAAe,CAAE,GAElDoL,GAAoB,MAAM,IAAI;AAG9B,QAAME,IAAW,MAAML,GAAqB,KAAK,MAAM,GACjDM,IAAU,MAAMD,EAAS,GACzBE,IAAU,MAAMF,EAAS;AAK/B,MAJA,KAAK,cAAc,UAAU,OAAO,SAAS,GAC7C,KAAK,cAAc,UAAU,IAAI,QAAQ,IAGrChf,IAAA0T,KAAA,gBAAAA,EAAiB,WAAjB,QAAA1T,EAAyB,QAAQ;AACjC,UAAM8T,IAAiB,CAAE;AACzB,eAAW1Q,KAASsQ,EAAgB,QAAQ;AACxC,YAAMnL,IAAY,KAAK,eAAe,QAAQnF,EAAM,OAAO,GACrD,EAAE,QAAAuP,GAAQ,QAAA1V,GAAQ,QAAA0W,EAAQ,IAAGpL,GAC7B2U,IAAM,MAAMjgB,EAAO,cAAe,GAClCkiB,IAAmBjC,EAAI,IAAIA,EAAI;AACrC,UAAIkC,IAAa,OAAO,WACpBC,IAAa;AAEjB,MAAA1L,EAAO,YAAY,YAAY,IAC/BG,EAAe,KAAK,MAAML,GAAqB,KAAK,QAAQC,GAAiBC,GAAQvQ,GAAOA,EAAM,OAAO,CAAC,GAE1GA,EAAM,KAAK,QAAQ,CAACkc,MAAc;AAC9B,cAAMC,IAAkB,2BAA2B,KAAKD,EAAU,WAAW,GACvEE,IAAkBD,IAAkB,OAAOA,EAAgB,CAAC,CAAC,IAAI,OAAOA,EAAgB,CAAC,CAAC,IAAI,GAC9Fle,IAAI,KAAK,IAAI8d,IAAmBK,CAAe;AACrD,QAAIne,IAAI+d,MACJC,IAAaC,GACbF,IAAa/d;AAAA,MAEjC,CAAa,GAEDsS,EAAO,QAAQ,MAAM,UAAU,SAC/BA,EAAO,QAAQ,MAAM,WAAW,YAChCA,EAAO,QAAQ,MAAM,OAAO,IAAI0L,KAAA,gBAAAA,EAAY,QAAOJ,CAAO,KAC1DtL,EAAO,QAAQ,MAAM,MAAM,IAAI0L,KAAA,gBAAAA,EAAY,OAAMH,CAAO,KACxDvL,EAAO,QAAQ,MAAM,QAAQ,IAAI0L,KAAA,gBAAAA,EAAY,SAAQJ,CAAO,KAC5DtL,EAAO,QAAQ,MAAM,SAAS,IAAI0L,KAAA,gBAAAA,EAAY,UAASH,CAAO,KAC9DvL,EAAO,QAAQ,MAAM,SAASvQ,EAAM,OAEpC,KAAK,cAAc,YAAYuQ,EAAO,OAAO;AAAA,IACzD;AAEQ,eAAW,MAAM;AACb,MAAAK,GAAY,KAAK,QAAQN,GAAiBI,EAAe,KAAI,CAAE;AAAA,IAClE,GAAE,GAAG;AAAA,EACd;AAEI,QAAM2L,IAAc,KAAK,cAAc,uBAAuB,qBAAqB;AACnF,eAAM,KAAKA,CAAW,EAAE,QAAQ,CAAAjM,MAAO,KAAK,cAAc,YAAYA,CAAG,CAAC,IAC1E5F,IAAA8F,KAAA,gBAAAA,EAAiB,YAAjB,QAAA9F,EAA0B,QAAQ,CAAA8R,MAAc;AAC5C,UAAMxR,IAASzJ,GAAc;AAAA,MACzB,KAAK;AAAA,MACL,YAAY;AAAA,QACR,OAAS;AAAA,QACT,cAAciI,GAAUgT,EAAW,SAAS;AAAA,QAC5C,OAAShT,GAAUgT,EAAW,KAAK;AAAA,QACnC,OAAO;AAAA,4BACKA,EAAW,KAAK,OAAOT,CAAO;AAAA,2BAC/BS,EAAW,KAAK,MAAMR,CAAO;AAAA,6BAC3BQ,EAAW,KAAK,QAAQT,CAAO;AAAA,8BAC9BS,EAAW,KAAK,SAASR,CAAO;AAAA,+BAC9BQ,EAAW,KAAO;AAAA;AAAA,MAErC;AAAA,MACD,QAAQ,KAAK;AAAA,MACb,UAAUA,EAAW;AAAA,IACjC,CAAS;AACD,IAAAxR,EAAO,SAASwF,GAChBxF,EAAO,eAAewR,EAAW,SACjCxR,EAAO,iBAAiB,SAAS,OAAO5N,MAAQ;AAC5C,MAAAhD,EAAa,KAAK,QAAQP,EAAO,cAAc;AAAA,QAC3C,QAAQ2W,EAAgB;AAAA,QACxB,iBAAiBA;AAAA,MACjC,CAAa,GACD,MAAMpT,EAAI,OAAO,aAAa,MAAMA,EAAI,OAAO,MAAM,GACrDA,EAAI,gBAAiB;AAAA,IACjC,CAAS,GACD,KAAK,eAAe,KAAK4N,CAAM;AAAA,EACvC,IAEW;AACX;AAEA,eAAeyR,KAAsB;AhElJrC,MAAA3f,GAAA4N,GAAA8O,GAAAkD,GAAAC,GAAAC;AgEmJI,QAAMpM,IAAkB5B,GAAmB,KAAK,QAAQ,KAAK,eAAe,YAAY,KAAK,WAAW,KAAK,kBAAkB;AAE/H,QAAM8M,GAAa,MAAM,MAAM,CAAElL,CAAe,CAAE,GAElDoL,GAAoB,MAAM,IAAI,GAE9B,KAAK,cAAc,UAAU,IAAI,SAAS,GAC1C,KAAK,cAAc,UAAU,OAAO,QAAQ,GAC5C,KAAK,cAAc,YAAY;AAG/B,QAAMiB,IAAsB,KAAK,QAAQ,aACnCC,IAAuB,KAAK,QAAQ,cACpCC,IAAcF,IAAsBC;AAO1C,MANA,KAAK,cAAc,UAAU,OAAO,cAAc,GAClD,KAAK,cAAc,UAAU,OAAO,WAAW,GAC/C,KAAK,cAAc,UAAU,OAAO,cAAc,GAClD,KAAK,cAAc,UAAU,OAAO,YAAY,GAChD,KAAK,cAAc,UAAU,OAAO,aAAa,GAE7CC,GAAa;AACb,UAAMC,MAAmBtS,KAAA5N,IAAA,KAAK,OAAO,OAAO,mBAAnB,gBAAAA,EAAmC,kBAAnC,gBAAA4N,EAAkD,+BAA8B;AACzG,SAAK,cAAc,UAAU,OAAO,UAAU,GAC9C,KAAK,cAAc,UAAU,IAAI,WAAW,GAC5C,KAAK,cAAc,UAAU,IAAIsS,CAAgB;AAAA,EACzD,OACS;AACD,UAAMA,MAAmBN,KAAAlD,IAAA,KAAK,OAAO,OAAO,mBAAnB,gBAAAA,EAAmC,kBAAnC,gBAAAkD,EAAkD,gCAA+B;AAC1G,SAAK,cAAc,UAAU,IAAI,UAAU,GAC3C,KAAK,cAAc,UAAU,OAAO,WAAW,GAC/C,KAAK,cAAc,UAAU,IAAIM,CAAgB;AAAA,EACzD;AACI,QAAMrX,IAAQ,KAAK,cAAc,aAC3BC,IAAS,KAAK,QAAQ;AAE5B,QAAI+W,IAAAnM,KAAA,gBAAAA,EAAiB,WAAjB,gBAAAmM,EAAyB,YAAW,GAAG;AACvC,UAAMM,IAAiB,CAAE,GACnBrM,IAAiB,CAAE,GACnB1Q,IAAQsQ,EAAgB,OAAO,CAAC,GAChCnL,IAAY,KAAK,eAAe,QAAQnF,EAAM,OAAO,GACrD,EAAE,QAAAnG,GAAQ,QAAA0W,EAAM,IAAKpL;AAE3B,IAAAoL,EAAO,YAAY,YAAY,IAC/BG,EAAe,KAAK,MAAML,GAAqB,KAAK,QAAQC,GAAiBC,GAAQvQ,GAAOA,EAAM,OAAO,CAAC,GAE1GuQ,EAAO,QAAQ,QAAQ,CAAE,GACzBA,EAAO,QAAQ,MAAM,UAAU,SAC/BA,EAAO,QAAQ,MAAM,QAAQ,QAC7BA,EAAO,QAAQ,MAAM,SAAS,QAC9BA,EAAO,QAAQ,MAAM,WAAW,UAChCA,EAAO,QAAQ,MAAM,WAAW,YAChCwM,EAAe,KAAKxM,EAAO,OAAO,GAClCA,EAAO,QAAQ,YAAY,GAC3BwM,EAAe,QAAQ,CAAAC,MAAK,KAAK,cAAc,YAAYA,CAAC,CAAC,GAC7D,WAAW,MAAM;AACb,MAAApM,GAAY,KAAK,QAAQN,GAAiBI,EAAe,KAAI,CAAE;AAAA,IAClE,GAAE,GAAG;AAAA,EACd,YACagM,IAAApM,KAAA,gBAAAA,EAAiB,WAAjB,QAAAoM,EAAyB,QAAQ;AACtC,QAAItgB,IAAI;AACR,UAAM2gB,IAAiB,CAAE,GACnBrM,IAAiB,CAAE;AACzB,eAAW1Q,KAASsQ,EAAgB,QAAQ;AACxC,YAAMnL,IAAY,KAAK,eAAe,QAAQnF,EAAM,OAAO,GACrD,EAAE,QAAAnG,GAAQ,QAAA0W,EAAM,IAAKpL,GACrB2U,IAAM,MAAMjgB,EAAO,cAAe,GAClCkiB,IAAmBjC,EAAI,IAAIA,EAAI,GAC/BmD,IAAWxX,GACXyX,IAAYxX,GACZkW,KAAYiB,IAAcI,IAAWC,KAAald,EAAM,OAAO;AACrE,UAAImd,IAAa,KAAK,MAAMN,IAAcjB,IAAWA,IAAWG,CAAgB,GAC5EqB,IAAc,KAAK,MAAMP,IAAcjB,IAAWG,IAAmBH,CAAQ;AACjF,MAAIuB,IAAWF,MACXE,IAAaF,GACbG,IAAc,KAAK,MAAMD,IAAapB,CAAgB,IAEtDqB,IAAYF,MACZE,IAAcF,GACdC,IAAa,KAAK,MAAMC,IAAcrB,CAAgB,IAI1DxL,EAAO,YAAY,YAAY,IAC/BG,EAAe,KAAK,MAAML,GAAqB,KAAK,QAAQC,GAAiBC,GAAQvQ,GAAOA,EAAM,OAAO,CAAC,GAE1GuQ,EAAO,QAAQ,QAAQ,CAAE,GACzBA,EAAO,QAAQ,MAAM,UAAU,SAC/BA,EAAO,QAAQ,MAAM,QAAQ,GAAG4M,CAAU,MAC1C5M,EAAO,QAAQ,MAAM,SAAS,GAAG6M,CAAW,MAC5C7M,EAAO,QAAQ,MAAM,WAAW,UAChCA,EAAO,QAAQ,MAAM,WAAW,YAChCA,EAAO,QAAQ,YAAYnU,KAC3B2gB,EAAe,KAAKxM,EAAO,OAAO;AAAA,IAC9C;AACQ,QAAIsM,GAAa;AACb,YAAMQ,IAAqB3b,EAA0B,2CAA2C,KAAK,aAAa;AAClH,MAAAqb,EAAe,QAAQ,CAAAC,MAAKK,EAAmB,YAAYL,CAAC,CAAC;AAAA,IACzE;AAEY,MAAAD,EAAe,QAAQ,CAAAC,MAAK,KAAK,cAAc,YAAYA,CAAC,CAAC;AAEjE,eAAW,MAAM;AACb,MAAApM,GAAY,KAAK,QAAQN,GAAiBI,EAAe,KAAI,CAAE;AAAA,IAClE,GAAE,GAAG;AAAA,EACd;AAEI,SAAO;AACX;AAEe,MAAM4M,WAAuBxb,EAAS;AAAA,EAEjD,YAAYjI,GAAQ4H,GAAQ;AhElQhC,QAAA7E;AgEmQQ,UAAM2gB,IAAqB,mBAErBjc,IAAa;AAAA,MACf,OAAS;AAAA,IACZ;AAED,KAAI1E,IAAA/C,EAAO,OAAO,mBAAd,QAAA+C,EAA8B,oBAC9B0E,EAAW,SAAS;AAGxB,UAAMC,IAAW;AAAA,0BACEgc,CAAoB;AAAA;AAAA;AAGvC,UAAM1jB,GAAQ,EAAC,YAAAyH,GAAY,UAAAC,GAAU,QAAAE,EAAM,CAAC,GAE5C,KAAK,gBAAgB,KAAK,QAAQ,uBAAuB,yBAAyB,EAAE,CAAC,GACrF,KAAK,iBAAiB,KAAK,QAAQ,uBAAuB8b,CAAkB,EAAE,CAAC,GAC/E,KAAK,QAAQ,iBAAiB,SAAS,YAAY;AAC/C,MAAI,MAAM,KAAK,WACX,MAAM,KAAK,KAAM,IAGjB,MAAM,KAAK,MAAO;AAAA,IAElC,CAAS,GAED,KAAK,SAAS,IAEd,KAAK,WAAW,CAAE,GAElB,KAAK,kBAAkB,IAAIC,GAAe,KAAK,QAAQ,KAAK,aAAa;AAAA,EACjF;AAAA,EAEI,IAAI,WAAW;AACX,WAAO,KAAK;AAAA,EACpB;AAAA,EAEI,IAAI,oBAAoB;AACpB,WAAO,KAAK;AAAA,EACpB;AAAA,EAEI,MAAM,UAAUC,GAAS9O,IAAc,MAAM;AhE7SjD,QAAA/R,GAAA4N;AgE8SQ,QAAI,KAAK,gBAAgB,QAAQiT,CAAQ,MAAM;AAC3C,aAAO;AAEN;AACD,YAAMC,KAASlT,KAAA5N,IAAA,KAAK,OAAO,OAAO,mBAAnB,gBAAAA,EAAmC,uBAAnC,gBAAA4N,EAAuD;AACtE,YAAM,KAAK,OAAO,YAAY,IAAI,eAAeiT,GAAU,EAAE,QAAAC,GAAQ,GACrE,MAAM,KAAK,OAAO,YAAY,IAAI,0BAA0B/O,GAAa,EAAE,QAAA+O,GAAQ;AACnF,YAAMC,IAAa,KAAK;AACxB,WAAK,YAAYF,GACjB,KAAK,qBAAqB9O,GAC1B,MAAM,KAAK,aAAc,GACrBgP,MAAeF,KACfvjB,EAAa,KAAK,QAAQP,EAAO,gBAAgB,EAAE,YAAAgkB,GAAY,UAAAF,GAAU;AAAA,IAEzF;AAAA,EACA;AAAA,EAEI,IAAI,kBAAkB;AAClB,WAAO,KAAK;AAAA,EACpB;AAAA,EAEI,IAAI,uBAAuB;AACvB,WAAO,KAAK;AAAA,EACpB;AAAA,EAEI,IAAI,eAAe;AACf,WAAO9P,GAAgB,KAAK,QAAQ,KAAK,UAAU;AAAA,EAC3D;AAAA,EAEI,IAAI,aAAa;AACb,WAAO,KAAK;AAAA,EACpB;AAAA,EAEI,IAAI,gBAAgB;AAChB,WAAO,KAAK;AAAA,EACpB;AAAA,EAEI,IAAI,iBAAiB;AACjB,WAAO,KAAK;AAAA,EACpB;AAAA,EAEI,MAAM,SAAS;AACX,SAAK,eAAe,MAAM,UAAU,QAEpC,MAAM/K,EAAkB,KAAK,QAAQ,QAAQ,GAE7C,MAAMD,GAAiB,KAAK,MAAM;AAAA,EAC1C;AAAA,EAEI,MAAM,KAAKS,GAAY;AhE/V3B,QAAAxG,GAAA4N,GAAA8O,GAAAkD,GAAAC,GAAAC,GAAAkB,GAAAC,GAAAC,GAAAC;AgEkWQ,QAFA,KAAK,cAAc3a,IAEfoH,KAAA5N,IAAA,KAAK,OAAO,OAAO,mBAAnB,gBAAAA,EAAmC,uBAAnC,QAAA4N,EAAuD,SAAS;AAChE,YAAMkT,KAASlB,KAAAlD,IAAA,KAAK,OAAO,OAAO,mBAAnB,gBAAAA,EAAmC,uBAAnC,gBAAAkD,EAAuD;AACtE,WAAK,YAAY,MAAM,KAAK,OAAO,YAAY,IAAI,eAAe,EAAE,QAAAkB,EAAM,CAAE,KAAK,KAAK,OAAO,OAAO,eACpG,KAAK,qBAAqB,MAAM,KAAK,OAAO,YAAY,IAAI,0BAA0B,EAAE,QAAAA,EAAQ,CAAA,KAAK;AAAA,IACjH;AAEY,WAAK,YAAY,KAAK,OAAO,OAAO,eACpC,KAAK,qBAAqB;AAI9B,UAAM,KAAK,eAAe,KAAKta,CAAU,GAGzC,KAAK,mBAAmB0K,GAAmB,KAAK,QAAQ1K,CAAU,GAElE,KAAK,wBAAwBmL,GAAwB,KAAK,QAAQnL,CAAU,GAG5E,MAAM,KAAK,aAAa,MAAM,EAAI;AAElC,UAAM4a,IAAkBtc;AAAA,MACpB;AAAA,MAAgD,KAAK;AAAA,IACxD,GACKuc,IAAmBvc;AAAA,MACrB;AAAA,MAAiD,KAAK;AAAA,IACzD;AACD,SAAK,iBAAiB,CAAEsc,GAAiBC,CAAkB,GAG3D,KAAK,OAAO,IAAI,MAAM,uCAAuC,GAC7D,MAAMrb,EAAkB,KAAK,QAAO,UAAS,OAAOC,MAAW;AAC3D,WAAK,OAAO,IAAI,MAAM,mBAAoBA,EAAO,IAAI,EAAG,GACpDA,EAAO,SAAS,SAChB,MAAMyH,GAAgBzH,GAAQmb,CAAe,IAExCnb,EAAO,SAAS,WACrB,MAAMyH,GAAgBzH,GAAQob,CAAgB;AAAA,IAErD,GAAE,OAAMpb,MACDA,EAAO,oBAAoB,mBACpB,MAAMA,EAAO,UAAW,IAGxB,EAEd,GAED,KAAK,eAAe,MAAM,UAAU;AAGpC,UAAMqb,IAAe,MAAM,KAAK,OAAO,YAAY,IAAI,UAAU,EAAE,QAAQ,IAAM,GAC3EC,IAAe,MAAM,KAAK,OAAO,YAAY,IAAI,gBAAgB,EAAE,QAAQ,IAAM,GACjFC,IAAgB,MAAM,KAAK,OAAO,YAAY,IAAI,iBAAiB,EAAE,QAAQ,IAAO;AAa1F,SAXI3B,IAAA,KAAK,OAAO,OAAO,mBAAnB,QAAAA,EAAmC,iBAAiByB,MAAiB,QAAQA,MAAiB,UAC9F,MAAM,KAAK,eAAe,UAAUA,CAAY,IAEhDxB,IAAA,KAAK,OAAO,OAAO,mBAAnB,QAAAA,EAAmC,uBAAuByB,MAAiB,QAAQA,MAAiB,UACpG,MAAM,KAAK,eAAe,gBAAgBA,CAAY,GAGtD,KAAK,OAAO,cAAc,YAC1B,MAAM,KAAK,OAAO,eAAe,YAAY,KAAK,OAAO,cAAc,QAAQ,IAG/EN,KAAAD,IAAA,KAAK,OAAO,OAAO,mBAAnB,gBAAAA,EAAmC,oBAAnC,QAAAC,EAAoD,WAAW,CAAC,KAAK,eAAe,cACxF;AACI,YAAMQ,IAAkB,YAAY;AAEhC,YAAI,CADW,MAAM,KAAK,OAAQ,GACrB;AACT,gBAAM5Q,IAAc,MAAM,KAAK,YAAa;AAC5C,gBAAM,KAAK,OAAO,YAAY,IAAI,iBAAiBA,GAAa,EAAE,QAAQ,IAAO;AAAA,QACrG;AACgB,mBAAW4Q,GAAiB,GAAI;AAAA,MAChD;AAEY,UAAID,GAAe;AACf,cAAME,IAAO,MAAM,KAAK,OAAO,YAAY,IAAI,iBAAiB,EAAE,QAAQ,IAAO,GAC3E5Q,IAAW,MAAM,KAAK,SAAU,GAChC6Q,KAAmBR,KAAAD,IAAA,KAAK,OAAO,OAAO,mBAAnB,gBAAAA,EAAmC,oBAAnC,gBAAAC,EAAoD;AAC7E,QAAKrQ,IAAW4Q,IAAQC,KACpB,MAAM,KAAK,eAAeD,CAAI;AAAA,MAElD;AAEY,MAAAD,EAAiB;AAAA,IAC7B;AAEQ,SAAK,oBAAoB,IAAIjD,GAAsB,KAAK,QAAQ,KAAK,OAAO,GAE5E,KAAK,SAAS;AAAA,EACtB;AAAA,EAEI,MAAM,SAAS;AACX,SAAK,iBAAkB,GAIvB,MAAMzC,GAAoB,KAAK,QAAQ,QAAQ,GAE/C,MAAM7V,GAAmB,KAAK,MAAM,GAEpC,MAAM,KAAK,eAAe,OAAQ;AAAA,EAC1C;AAAA;AAAA,EAGI,MAAM,aAAa6L,IAAc,MAAM;AAEnC,UAAM6P,IAAoB,UAAU,CAAC;AAKrC,QAHI7P,MACA,KAAK,qBAAqBA,IAE1B,CAAC6P,KAAqB,KAAK,OAAO,UAAUnD,EAAY;AACxD;AAGJ,QAAI,KAAK;AACL,kBAAK,OAAO,IAAI,KAAK,kCAAkC,GAChD;AAEX,SAAK,oBAAoB;AAEzB,QAAIoD,IAAS;AAEb,SAAK,iBAAiB,CAAE,IAGpB,CAAC,KAAK,aAAa,KAAK,iBAAiB,QAAQ,KAAK,SAAS,MAAM,QACrE,KAAK,YAAY,KAAK,OAAO,OAAO,eACpC,KAAK,qBAAqB,MAGtB,KAAK,iBAAiB,QAAQ,KAAK,SAAS,MAAM,OAClD,KAAK,YAAY,KAAK,iBAAiB,CAAC,IAE5CA,IAAS;AAGb,UAAMC,IAAetQ,GAAuB,KAAK,QAAQ,KAAK,eAAe,YAAY,KAAK,SAAS;AACvG,WAAIsQ,EAAa,eAAe,WAC5BD,IAAS9C,GAAmB,MAAM,IAAI,IAEjC+C,EAAa,eAAe,cACjCD,IAASlC,GAAoB,MAAM,IAAI,IAG3C,KAAK,oBAAoB,IAClBkC;AAAA,EACf;AAAA,EAEI,oBAAoB;AAChB,QAAI,KAAK,kBAAkB,KAAK,gBAAgB;AAC5C,WAAK,OAAO,IAAI,MAAM,qCAAqC;AAC3D,YAAME,IAAW,CAAA7T,MAAU;AACvB,QAAAA,EAAO,eAAeA,EAAO,MAAM,SACnCA,EAAO,MAAM,UAAU;AAAA,MACvC;AACY,WAAK,eAAe,QAAQ6T,CAAQ,GACpC,KAAK,eAAe,QAAQA,CAAQ;AACpC,iBAAWvP,KAAW,KAAK,eAAe;AAEtC,QADe,KAAK,eAAe,QAAQA,CAAO,EAC3C,OAAO,YAAa;AAAA,IAE3C;AAAA,EACA;AAAA,EAEI,oBAAoB;AAChB,QAAI,KAAK,kBAAkB,KAAK,gBAAgB;AAC5C,YAAMwP,IAAW,CAAA9T,MAAUA,EAAO,MAAM,UAAUA,EAAO,gBAAgB;AACzE,WAAK,eAAe,QAAQ8T,CAAQ,GACpC,KAAK,eAAe,QAAQA,CAAQ;AACpC,iBAAWxP,KAAW,KAAK,eAAe;AAEtC,QADe,KAAK,eAAe,QAAQA,CAAO,EAC3C,OAAO,YAAa;AAAA,IAE3C;AAAA,EACA;AAAA,EAEI,IAAI,UAAU;AACV,WAAO,KAAK;AAAA,EACpB;AAAA,EAEI,IAAI,cAAc;AACd,WAAO,EAAE,GAAG,KAAK,QAAQ,aAAa,GAAG,KAAK,QAAQ,aAAc;AAAA,EAC5E;AAAA,EAEI,IAAI,QAAQ;AACR,WAAO,KAAK;AAAA,EACpB;AAAA,EAEI,IAAI,eAAe;AACf,WAAO,KAAK,eAAe;AAAA,EACnC;AAAA,EAEI,MAAM,OAAO;AACT,UAAMjT,IAAS,MAAM,KAAK,eAAe,KAAM;AAC/C,WAAAjC,EAAa,KAAK,QAAQP,EAAO,IAAI,GAC9BwC;AAAA,EACf;AAAA,EAEI,MAAM,QAAQ;AACV,UAAMA,IAAS,MAAM,KAAK,eAAe,MAAO;AAChD,WAAAjC,EAAa,KAAK,QAAQP,EAAO,KAAK,GAC/BwC;AAAA,EACf;AAAA,EAEI,MAAM,OAAO;AACT,SAAK,eAAe,KAAM,GAC1BjC,EAAa,KAAK,QAAQP,EAAO,IAAI;AAAA,EAC7C;AAAA,EAEI,MAAM,SAAS;AACX,WAAO,KAAK,eAAe,OAAQ;AAAA,EAC3C;AAAA,EAEI,MAAM,eAAe2K,GAAG;AACpB,UAAMnI,IAAS,MAAM,KAAK,eAAe,eAAemI,CAAC;AACzD,WAAApK,EAAa,KAAK,QAAQP,EAAO,MAAM,EAAE,UAAUwC,EAAO,UAAU,SAASA,EAAO,QAAO,CAAE,GACtFA,EAAO;AAAA,EACtB;AAAA,EAEI,MAAM,cAAc;AAChB,WAAO,KAAK,eAAe,YAAa;AAAA,EAChD;AAAA,EAEI,MAAM,SAAS;AACX,WAAO,KAAK,eAAe,OAAQ;AAAA,EAC3C;AAAA,EAEI,MAAM,UAAUL,GAAG;AACf,UAAMK,IAAS,MAAM,KAAK,eAAe,UAAUL,CAAC;AACpD,WAAA5B,EAAa,KAAK,QAAQP,EAAO,gBAAgB,EAAE,QAAQmC,GAAG,GAC9D,MAAM,KAAK,OAAO,YAAY,IAAI,UAAUA,GAAG,EAAE,QAAQ,IAAM,GACxDK;AAAA,EACf;AAAA,EAEI,MAAM,WAAW;AACb,WAAO,MAAM,KAAK,eAAe,SAAU;AAAA,EACnD;AAAA,EAEI,MAAM,eAAe;AACjB,WAAO,MAAM,KAAK,eAAe,aAAc;AAAA,EACvD;AAAA,EAEI,MAAM,gBAAgB6d,GAAG;AACrB,UAAM7d,IAAS,MAAM,KAAK,eAAe,gBAAgB6d,CAAC;AAC1D,WAAA9f,EAAa,KAAK,QAAQP,EAAO,uBAAuB,EAAE,iBAAiBqgB,GAAG,GAC9E,MAAM,KAAK,OAAO,YAAY,IAAI,gBAAgBA,GAAG,EAAE,QAAQ,IAAM,GAC9D7d;AAAA,EACf;AAAA,EAEI,IAAI,gBAAgB;AAChB,WAAO,KAAK,eAAe;AAAA,EACnC;AAAA,EAEI,IAAI,YAAY;AACZ,WAAO,KAAK,eAAe;AAAA,EACnC;AAAA,EAEI,IAAI,UAAU;AACV,WAAO,KAAK,eAAe;AAAA,EACnC;AAAA,EAEI,MAAM,YAAY,EAAE,SAAAod,GAAS,OAAAnS,GAAO,KAAAC,EAAG,GAAI;AACvC,UAAMlL,IAAS,MAAM,KAAK,eAAe,YAAY;AAAA,MACjD,SAAAod;AAAA,MACA,OAAAnS;AAAA,MACA,KAAAC;AAAA,IACZ,CAAS;AACD,WAAAnN,EAAa,KAAK,QAAQP,EAAO,kBAAkB;AAAA,MAC/C,SAAA4f;AAAA,MACA,OAAAnS;AAAA,MACA,KAAAC;AAAA,IACZ,CAAS,GACMlL;AAAA,EACf;AAAA,EAEI,aAAa0iB,IAAS,MAAM;AhEznBhC,QAAAjiB,GAAA4N;AgE0nBQ,QAAIsU,IAAU,KAAK;AACnB,QAAI,OAAOD,KAAY;AAGnB,UAFAC,KAAUliB,IAAA,KAAK,eAAe,QAAQiiB,CAAM,MAAlC,gBAAAjiB,EAAqC,OAAO,SAElD,CAACkiB;AACD,oBAAK,OAAO,IAAI,KAAK,gDAAgDD,CAAM,yBAAyB,OAAO,KAAK,KAAK,eAAe,OAAO,EAAE,KAAK,IAAI,CAAC,EAAE,GACzJ,KAAK,OAAO,IAAI,KAAK,uLAAuL,GACrM;AAAA,UAGV,CAAIA,MAAW,MAChBC,KAAUtU,IAAA,KAAK,eAAe,QAAQ,OAAO,KAAK,KAAK,eAAe,OAAO,EAAE,CAAC,CAAC,MAAvE,gBAAAA,EAA0E,OAAO;AAG/F,WAAO;AAAA,MACH,GAAGsU,KAAA,gBAAAA,EAAS;AAAA,MACZ,GAAGA,KAAA,gBAAAA,EAAS;AAAA,MACZ,OAAOA,KAAA,gBAAAA,EAAS;AAAA,MAChB,QAAQA,KAAA,gBAAAA,EAAS;AAAA,MACjB,SAAAA;AAAA,IACH;AAAA,EACT;AAAA,EAEI,YAAYA,GAASC,IAAO,MAAMC,IAAS,GAAG;AAC1C,QAAID,GAAM;AACN,YAAM,EAAE,OAAAtZ,GAAO,QAAAC,MAAW,KAAK,aAAc;AAC7C,MAAAqZ,EAAK,IAAIA,EAAK,IAAI,MAAMtZ,GACxBsZ,EAAK,QAAQA,EAAK,QAAQ,MAAMtZ,GAChCsZ,EAAK,IAAIA,EAAK,IAAI,MAAMrZ,GACxBqZ,EAAK,SAASA,EAAK,SAAS,MAAMrZ,GAClCoZ,EAAQ,MAAM,WAAW,YACzBA,EAAQ,MAAM,OAAO,GAAIC,EAAK,CAAC,KAC/BD,EAAQ,MAAM,MAAM,GAAIC,EAAK,CAAC,KAC9BD,EAAQ,MAAM,QAAQ,GAAIC,EAAK,KAAK,KACpCD,EAAQ,MAAM,SAAS,GAAIC,EAAK,MAAM,KAClCC,MAAS,SAAMF,EAAQ,MAAM,SAASE;AAAA,IACtD;AACQ,gBAAK,cAAc,YAAYF,CAAO,GAC/BA;AAAA,EACf;AAAA,EAEI,YAAYA,GAAS;AACjB,SAAK,cAAc,YAAYA,CAAO;AAAA,EAC9C;AACA;ACvqBA,MAAAG,KAAe;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,GCGTC,KAAU;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,GAYVC,KAAa;AAAA;AAAA,GAIbC,KAAuB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,GAYvBC,KAAc;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,GAQdC,KAAgB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAUP,MAAMC,WAAyBzd,EAAS;AAAA,EACnD,YAAYjI,GAAQ2lB,GAAcC,GAAgBC,GAAyB;AACvE,UAAMpe,IAAa;AAAA,MACf,OAAS;AAAA,MACT,OAAS4d;AAAA,MACT,MAAQ;AAAA,MACR,cAAc;AAAA,IACjB;AACD,UAAMrlB,GAAQ,EAAC,YAAAyH,GAAY,QAAQke,EAAa,CAAC,GAEjD,KAAK,OAAO9d,EAA0B;AAAA,sBACxByd,EAAU;AAAA,cACjBM,IAAkB,eAAeN,EAAU,UAAUM,CAAe,+CAA+C,EAAE;AAAA,cACrHC,IAA0B,eAAeP,EAAU,UAAUO,CAAuB,8CAA8C,EAAE;AAAA,0BACxHN,EAAsB;AAAA,iCAChBE,EAAa;AAAA,0DACaD,EAAW,KAAOJ,EAAU;AAAA;AAAA;AAAA;AAAA,WAI5E,KAAK,OAAO,GAEf,KAAK,QAAQ,aAAa,MAAK,0BAA0B,GACzD,KAAK,QAAQ,iBAAiB,SAAS,CAAC/hB,MAAQ;AAC5C,MAAArD,EAAO,KAAM;AAAA,IACzB,CAAS;AAED,UAAM8lB,IAAuBF,KAAmBC,GAC1CE,IAAmB,MAAM;AAC3B,UAAID,GAAsB;AACtB,cAAME,IAAc,KAAK,QAAQ,cAAc,KAAK,QAAQ,cACtDC,IAAoB,MAAM,KAAK,KAAK,QAAQ,uBAAuB,yBAAyB,CAAC,GAC7FC,IAAmB,MAAM,KAAK,KAAK,QAAQ,uBAAuB,wBAAwB,CAAC;AACjG,QAAIF,KAAa,KACbC,EAAkB,QAAQ,CAAA9C,MAAKA,EAAE,MAAM,UAAU,EAAE,GACnD+C,EAAiB,QAAQ,CAAA/C,MAAKA,EAAE,MAAM,UAAU,MAAM,MAGtD8C,EAAkB,QAAQ,CAAA9C,MAAKA,EAAE,MAAM,UAAU,MAAM,GACvD+C,EAAiB,QAAQ,CAAA/C,MAAKA,EAAE,MAAM,UAAU,EAAE;AAAA,MAEtE;AAAA,IACA;AAEQ,WAAO,iBAAiB,UAAU,MAAM;AACpC,MAAA4C,EAAkB;AAAA,IAC9B,CAAS,GAEDA,EAAkB;AAAA,EAC1B;AAAA,EAEI,oBAAoBlkB,GAAK;AACrB,SAAK,KAAK,aAAa,OAAMA,CAAG;AAAA,EACxC;AACA;ACrGA,MAAMskB,KAAwB,CAACve,MAAW;AACtC,QAAMwe,IAAU,SAAS,cAAc,SAAS;AAChD,SAAAA,EAAQ,UAAU,IAAI,QAAQ,GAI9BA,EAAQ,YAAY;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OAapBxe,EAAO,YAAYwe,CAAO,GAE1BA,EAAQ,WAAW,CAACjQ,MAAU;AAC1B,IAAAiQ,EAAQ,cAAc,wBAAwB,EAAE,cAAcjQ;AAAA,EACjE,GAEDiQ,EAAQ,YAAY,MAAMA,EAAQ,cAAc,4BAA4B,GAE5EA,EAAQ,eAAe,CAAClmB,MAAa;AACjC,IAAIkmB,EAAQ,kBACRA,EAAQ,UAAS,EAAG,oBAAoB,SAASA,EAAQ,cAAc,GAE3EA,EAAQ,iBAAiBlmB,GACzBkmB,EAAQ,UAAW,EAAC,iBAAiB,SAASlmB,CAAQ;AAAA,EACzD,GAEDkmB,EAAQ,gBAAgB,MAAMA,EAAQ,UAAS,EAAG,MAAM,UAAU,QAElEA,EAAQ,gBAAgB,MAAMA,EAAQ,UAAS,EAAG,MAAM,UAAU,IAElEA,EAAQ,aAAa,CAAC7Q,MAAY;AAC9B,IAAA6Q,EAAQ,cAAc,oBAAoB,EAAE,YAAY,IACxDA,EAAQ,cAAc,oBAAoB,EAAE,YAAY7Q,CAAO;AAAA,EAClE,GAEM6Q;AACX;AAEA,IAAIC,KAAY;AAChB,SAASC,KAAa;AAClB,SAAO,EAAED;AACb;AnEnDA,IAAAE,IAAAve,GAAAwe,GAAAC;AmEqDe,MAAMC,GAAiB;AAAA,EAMlC,YAAYC,GAAa;AALzB,IAAAtf,EAAA,MAAAkf,IAAe;AACf,IAAAlf,EAAA,MAAAW,GAAW;AACX,IAAAX,EAAA,MAAAmf,GAAW,CAAE;AACb,IAAAnf,EAAA,MAAAof,IAAS;AAGL,IAAAnf,EAAA,MAAKif,IAAeI,IACpBrf,EAAA,MAAKU,GAAW,SAAS,cAAc,KAAK,IAC5CT,EAAA,MAAKS,GAAS,YAAY,kBAC1B2e,EAAY,QAAQ,QAAQpf,EAAA,MAAKS,EAAQ,GACzCT,EAAA,MAAKS,GAAS,UAAU,IAAI,QAAQ,GACpCT,EAAA,MAAKS,GAAS,iBAAiB,SAAS,CAAA3E,MAAOA,EAAI,iBAAiB,GACpEkE,EAAA,MAAKgf,IAAa,QAAQ,iBAAiB,SAAS,CAACljB,MAAQ;AACzD,MAAAA,EAAI,gBAAiB,GACrB,KAAK,KAAM;AAAA,IACvB,CAAS;AAAA,EACT;AAAA,EAEI,IAAI,QAAQ;AACR,WAAOkE,EAAA,MAAKkf;AAAA,EACpB;AAAA,EAEI,IAAI,MAAMtQ,GAAO;AACb,IAAA7O,EAAA,MAAKmf,IAAStQ;AAAA,EAEtB;AAAA,EAEI,IAAI,iBAAiB;AACjB,WAAO5O,EAAA,MAAKif,GAAS,UAAUjf,EAAA,MAAKif,GAASjf,EAAA,MAAKif,GAAS,SAAS,CAAC;AAAA,EAC7E;AAAA,EAEI,IAAI,mBAAmB;AnErF3B,QAAAzjB;AmEsFQ,aAAOA,IAAA,KAAK,mBAAL,gBAAAA,EAAqB,kBAAiB;AAAA,EACrD;AAAA,EAEI,KAAK,EAAE,SAAAwS,GAAS,OAAAY,IAAQ,IAAI,QAAAvO,IAAS,MAAM,YAAAgf,IAAa,IAAO,aAAAC,IAAc,GAAK,GAAI;AAClF,QAAI,CAACtR;AACD,YAAM,IAAI,MAAM,+CAA+C;AAGnE,IAAAA,EAAQ,aAAa,0BAA0B+Q,IAAY,GAC3D/Q,EAAQ,gBAAgBA,EAAQ,aAAa,wBAAwB;AACrE,UAAMuR,IAAiBvf,EAAA,MAAKif,GAAS,UAAUjf,EAAA,MAAKif,GAASjf,EAAA,MAAKif,GAAS,SAAS,CAAC,GAC/EO,IAAWnf,KAAUA,EAAO,aAAa,wBAAwB;AAEvE,IAAIkf,KAAkBA,EAAe,aAAa,wBAAwB,MAAMC,KAE5Exf,EAAA,MAAKS,GAAS,YAAY,IAC1BV,EAAA,MAAKkf,GAAW,CAAE,MAEbM,KACLA,EAAe,UAAU,UAAU,IAAI,KAAK,GAGhDvf,EAAA,MAAKif,GAAS,KAAKjR,CAAO,GAE1BhO,EAAA,MAAKgf,IAAa,QAAQ,UAAU,IAAI,eAAe,GACvDhf,EAAA,MAAKS,GAAS,UAAU,OAAO,QAAQ;AAEvC,UAAMuJ,IAAY4U,GAAsB5e,EAAA,MAAKS,EAAQ;AACrD,WAAAuJ,EAAU,SAAS4E,CAAK,GACxBZ,EAAQ,YAAYhE,GAEhBqV,MAAe,KACfrf,EAAA,MAAKS,GAAS,UAAU,IAAI,MAAM,IAGlCT,EAAA,MAAKS,GAAS,UAAU,OAAO,MAAM,GAGrC6e,MAAgB,KAChBtf,EAAA,MAAKS,GAAS,UAAU,IAAI,OAAO,IAGnCT,EAAA,MAAKS,GAAS,UAAU,OAAO,OAAO,GAE1CuJ,EAAU,WAAWgE,CAAO,GACxBhO,EAAA,MAAKif,GAAS,SAAS,IACvBjV,EAAU,aAAa,MAAM;AACzB,MAAAhK,EAAA,MAAKif,GAAS,IAAK,GACnBjf,EAAA,MAAKif,GAASjf,EAAA,MAAKif,GAAS,SAAS,CAAC,EAAE,UAAU,UAAU,OAAO,KAAK,GACxEjf,EAAA,MAAKS,GAAS,YAAYuJ,CAAS;AAAA,IACnD,CAAa,IAGDA,EAAU,cAAe,GAG7B,KAAK,QAAQ4E,GAENZ,EAAQ;AAAA,EACvB;AAAA,EAEI,MAAM;AACF,QAAIhO,EAAA,MAAKS,GAAS,iBAAiB,SAAS,EAAE,WAAW;AACrD,kBAAK,KAAM,GACJ;AAGX,UAAMgf,IAAa,IAAI,MAAM,OAAO;AAEpC,WADmBzf,EAAA,MAAKS,GAAS,cAAc,gCAAgC,EACpE,cAAcgf,CAAU,GAC5B;AAAA,EACf;AAAA,EAEI,OAAO;AACH,IAAAzf,EAAA,MAAKgf,IAAa,QAAQ,UAAU,OAAO,eAAe,GAC1Dhf,EAAA,MAAKS,GAAS,UAAU,IAAI,QAAQ;AAAA,EAC5C;AAAA,EAEI,IAAI,WAAW;AACX,WAAOT,EAAA,MAAKS,GAAS,UAAU,SAAS,QAAQ;AAAA,EACxD;AACA;AAjHIue,KAAA,eACAve,IAAA,eACAwe,IAAA,eACAC,KAAA;AnEzDJ,IAAAQ,IAAAC,IAAAC,IAAAC,GAAAC,IAAAC,IAAAC,IAAAC,GAAAC,IAAAC;AoEMe,MAAMC,WAAoB1f,EAAS;AAAA,EAYjD,YAAYjI,GAAO4H,GAAQ;ApElB5B,QAAA7E;AoEmBE,UAAM6kB,MAAa7kB,IAAA/C,EAAO,OAAO,sBAAd,gBAAA+C,EAAiC,eAAc;AAElE,UAAM/C,GAAQ,EAAE,YADG,EAAE,OAAS,yBAA0B,GAC5B,QAAA4H,EAAM,CAAE;AAdrC,IAAAP,EAAA,MAAA4f,IAAS;AACT,IAAA5f,EAAA,MAAA6f,IAAwB;AACxB,IAAA7f,EAAA,MAAA8f,IAAgB;AAChB,IAAA9f,EAAA,MAAA+f,GAAgB;AAChB,IAAA/f,EAAA,MAAAggB,IAAqB;AACrB,IAAAhgB,EAAA,MAAAigB,IAAmB;AACnB,IAAAjgB,EAAA,MAAAkgB,IAAsB;AACtB,IAAAlgB,EAAA,MAAAmgB,GAAqB;AACrB,IAAAngB,EAAA,MAAAogB,IAAW;AACX,IAAApgB,EAAA,MAAAqgB,IAAkB,CAAA;AAOjB,IAAApgB,EAAA,MAAK2f,IAAS,IAAIP,GAAiB,IAAI,IAEvC,KAAK,QAAQ,iBAAiB,cAAc,MAAM/jB,GAAqB3C,CAAM,CAAC,GAC9E,KAAK,QAAQ,iBAAiB,cAAc,MAAM4C,GAAsB5C,CAAM,CAAC,GAG/EsH,EAAA,MAAK4f,IAAwBrf,EAA0B,4CAA4C,KAAK,OAAO,IAC/GP,EAAA,MAAK6f,IAAgBtf,EAA0B,aAAa,IAC5DP,EAAA,MAAK8f,GAAgBvf,EAA0B,aAAa,IAE5DP,EAAA,MAAK+f,IAAqBxf,EAA0B,aAAaN,EAAA,MAAK6f,EAAa,IACnF9f,EAAA,MAAKggB,IAAmBzf,EAA0B,eAAeN,EAAA,MAAK6f,EAAa,IACnF9f,EAAA,MAAKigB,IAAsB1f,EAA0B,aAAaN,EAAA,MAAK6f,EAAa;AAEpF,UAAMS,IAA0B7nB,EAAO,YAAY,sBAE7C6T,IAAW,KACXD,IAAc,GACdkU,IAAY;AAClB,IAAIF,IACHtgB,EAAA,MAAKkgB,GAAqBK,EAAwB,EAAE,WAAWtgB,EAAA,MAAK+f,KAAkB,QAAAtnB,GAAQ,UAAA6T,GAAU,aAAAD,GAAa,WAAAkU,EAAS,CAAE,MAGhIvgB,EAAA,MAAK2f,IAAsB,YAAY3f,EAAA,MAAK4f,GAAa,GACzD7f,EAAA,MAAKkgB,GAAqBK,EAAwB,EAAE,WAAWtgB,EAAA,MAAK4f,KAAe,QAAAnnB,GAAQ,UAAA6T,GAAU,aAAAD,GAAa,WAAAkU,EAAS,CAAE,KAE9HvgB,EAAA,MAAKigB,GAAmB,SAAS,OAAO5T,MAAgB;AACvD,YAAM5T,EAAO,eAAe,eAAe4T,CAAW;AAAA,IACzD,CAAG,GAEDrM,EAAA,MAAK2f,IAAsB,YAAY3f,EAAA,MAAK6f,EAAa;AAAA,EAC3D;AAAA,EAEC,IAAI,QAAQ;AACX,WAAO7f,EAAA,MAAK0f;AAAA,EACd;AAAA,EAEC,IAAI,UAAU;AACb,WAAO1f,EAAA,MAAKkgB;AAAA,EACd;AAAA,EAEC,IAAI,QAAQtE,GAAG;AACd,IAAA7b,EAAA,MAAKmgB,IAAWtE,IACX5b,EAAA,MAAKkgB,MAIT,KAAK,kBAAmB,IAHxB,KAAK,KAAM;AAAA,EAKd;AAAA,EAEC,MAAM,OAAO;AACZ,IAAAngB,EAAA,MAAKogB,IAAkB,CAAE,IAEzB,KAAK,OAAO,IAAI,MAAM,wBAAwB,GAC9C,MAAM3e,EAAkB,KAAK,QAAO,UAAS,OAAOC,MAAW;AAC9D,WAAK,OAAO,IAAI,MAAM,mBAAoBA,EAAO,IAAI,EAAG,GACxDzB,EAAA,MAAKmgB,IAAgB,KAAK1e,CAAM,GAC5BA,EAAO,SAAS,SACnB,MAAMyH,GAAgBzH,GAAQ,KAAK,iBAAiB,IAE5CA,EAAO,SAAS,WACxB,MAAMyH,GAAgBzH,GAAQ,KAAK,kBAAkB;AAAA,IAEtD,GAAE,OAAMA,MACJA,EAAO,oBAAoB,gBACvB,MAAMA,EAAO,UAAW,IAGxB,EAER;AAED,UAAM6K,IAAW,MAAM,KAAK,OAAO,eAAe,SAAU;AAC5D,IAAAtM,EAAA,MAAKigB,GAAmB,YAAY3T,CAAQ,GAE5C,KAAK,OAAO,UAAU,OAAO,QAAQ,CAACkU,GAAWxlB,GAAGylB,MAAc;AACjE,YAAMC,IAAYD,EAAUzlB,IAAI,CAAC,GAC3B2lB,IAAgBD,IAAYA,EAAU,OAAOF,EAAU,OAAOlU,IAAWkU,EAAU;AACzF,MAAAxgB,EAAA,MAAKigB,GAAmB,UAAU,EAAE,MAAMO,EAAU,MAAM,UAAAlU,GAAU,eAAAqU,GAAe;AAAA,IAEtF,CAAG,GAED,KAAK,OAAO,UAAU,CAAC,KAAK,OAAO,OAAO,YAAY,KAAK,OAAO,OAAO,IAAI,GAAG,CAAC9nB,MAAU;AAC1F,MAAAmH,EAAA,MAAKigB,GAAmB,eAAepnB,EAAM,WAAWA,EAAM,WAAW;AAAA,IAC5E,CAAG,GAED,KAAK,OAAO,UAAU,KAAK,OAAO,OAAO,kBAAkB,OAAOA,MAAU;AAC3E,YAAM+nB,IAAc/nB,EAAM,MAAMA,EAAM;AACtC,MAAAmH,EAAA,MAAKigB,GAAmB,YAAYW,CAAW;AAC/C,YAAMvU,IAAc,MAAM,KAAK,OAAO,eAAe,YAAa;AAClE,MAAArM,EAAA,MAAKigB,GAAmB,eAAe5T,CAAW;AAAA,IACrD,CAAG,GAED,KAAK,SAAU;AAAA,EACjB;AAAA,EAEC,MAAM,SAAS;AAEd,SAAK,iBAAkB,GAGvB,MAAMkL,GAAoB,KAAK,QAAQ,QAAQ,GAC/CvX,EAAA,MAAK8f,IAAmB,YAAY,IACpC9f,EAAA,MAAKggB,IAAoB,YAAY;AAAA,EACvC;AAAA,EAEC,oBAAoB;AACnB,SAAK,OAAO,IAAI,MAAM,kCAAkC,GACxD,KAAK,KAAM;AAAA,EACb;AAAA,EAEC,oBAAoB;ApEvIrB,QAAAxkB;AoEwIE,QAAIwE,EAAA,MAAKkgB,KAAU;AAElB,YAAMvf,MADanF,IAAA,KAAK,OAAO,OAAO,sBAAnB,gBAAAA,EAAsC,eAAc,KACzC,SAAS;AACvC,WAAK,KAAKmF,CAAQ,GAClB,KAAK,SAAU;AAAA,IAClB;AAAA,EACA;AAAA,EAEC,IAAI,qBAAqB;AACxB,WAAOX,EAAA,MAAKggB;AAAA,EACd;AAAA,EAEC,IAAI,oBAAoB;AACvB,WAAOhgB,EAAA,MAAK8f;AAAA,EACd;AAAA,EAEC,IAAI,oBAAoB;AACvB,WAAO9f,EAAA,MAAKigB;AAAA,EACd;AAAA,EAEC,IAAI,gBAAgB;AACnB,UAAM5b,IAAQ,KAAK,QAAQ,aACrBC,IAAS,KAAK,QAAQ;AAC5B,WAAO,EAAE,OAAAD,GAAO,QAAAC,EAAQ;AAAA,EAC1B;AAAA,EAEC,WAAW;AACV,UAAM,EAAE,eAAAuc,EAAa,IAAK;AAC1B,IAAA7gB,EAAA,MAAKmgB,IAAgB,QAAQ,CAAA1e,MAAUA,EAAO,SAASof,CAAa,CAAC;AAAA,EACvE;AACA;AA/JCnB,KAAA,eACAC,KAAA,eACAC,KAAA,eACAC,IAAA,eACAC,KAAA,eACAC,KAAA,eACAC,KAAA,eACAC,IAAA,eACAC,KAAA,eACAC,KAAA;ACZD,MAAMW,KAAuB;AAAA,EACzB,EAAE,UAAU,KAAK,WAAW,SAAU;AAAA,EACtC,EAAE,UAAU,KAAK,WAAW,SAAU;AAAA,EACtC,EAAE,UAAU,KAAK,WAAW,SAAU;AAAA,EACtC,EAAE,UAAU,MAAM,WAAW,UAAW;AAAA,EACxC,EAAE,WAAW,WAAU;AAC3B,GACMC,KAAwB,CAACC,MACpBF,GACF,KAAK,CAAA1iB,MAAQA,EAAK,YAAYA,EAAK,YAAU4iB,KAAQ5iB,EAAK,aAAa,MAAS,EAAE;AAG5E,MAAM6iB,WAAsBvgB,EAAS;AAAA,EAChD,YAAYjI,GAAO4H,GAAQ;AACvB,UAAMH,IAAa;AAAA,MACf,OAAS;AAAA,IACZ;AACD,UAAMzH,GAAQ,EAAE,KAAK,OAAO,YAAAyH,GAAY,QAAAG,GAAQ,GAEhD,KAAK,qBAAqBC,EAA0B;AAAA;AAAA;AAAA,WAGjD,KAAK,OAAO,GAEf,KAAK,YAAY,CAAE,GAEnB,KAAK,KAAM,GAEX,KAAK,mBAAmB;AAExB,UAAM4gB,IAAc,OAAMplB,MAAO;AAE7B,YAAMohB,KADSzkB,EAAO,eAAe,gBAAgBA,EAAO,eAAe,YAAY,MAChEqD,EAAI,eAAeA,EAAI,WAAW;AACzD,UAAI,KAAK,kBAAkB;AACvB,cAAMoK,IAAM,KAAK,iBAAiB,OAAOgX,CAAI;AAC7C,aAAK,mBAAmB,YAAY,IACpChX,KAAOA,EAAI,SAAS,QAAQ,CAAA/I,MAAK;AAC7B,eAAK,mBAAmB,aAAaA,GACrC,KAAK,mBAAmB,aAAa;AAAA,QACzD,CAAiB,GACD+I,IAAM,KAAK,mBAAmB,MAAM,UAAU,OAAO,KAAK,mBAAmB,MAAM,UAAU,QAC7F,KAAK,OAAQ;AAAA,MAC7B;AAAA,IACS;AAED,IAAA1N,EAAU,KAAK,QAAQD,EAAO,YAAY2oB,CAAW,GACrD1oB,EAAU,KAAK,QAAQD,EAAO,MAAM2oB,CAAW,GAC/C1oB,EAAU,KAAK,QAAQD,EAAO,QAAQ,MAAM,KAAK,QAAQ,GACzDC,EAAU,KAAK,QAAQD,EAAO,SAAS,MAAM,KAAK,QAAQ,UAAU,IAAI,YAAY,CAAC,GACrFC,EAAU,KAAK,QAAQD,EAAO,SAAS,MAAM,KAAK,QAAQ,UAAU,OAAO,YAAY,CAAC;AAAA,EAChG;AAAA,EAEI,MAAM,OAAO;AACT,UAAMiN,GAAoB,KAAK,MAAM;AAAA,EAC7C;AAAA,EAEI,SAAS;AAAA,EACb;AAAA,EAEI,SAAS;AACL,UAAM2b,IAAYJ,GAAsB,KAAK,mBAAmB,WAAW;AAC3E,IAAAD,GAAqB,QAAQ,CAAA3jB,MAAK,KAAK,QAAQ,UAAU,OAAOA,EAAE,SAAS,CAAC,GAC5E,KAAK,QAAQ,UAAU,IAAIgkB,CAAS;AAAA,EAC5C;AAAA,EAEI,YAAYzb,GAAU;AAClB,SAAK,UAAU,KAAKA,CAAQ,GAC5B5M,EAAa,KAAK,QAAQP,EAAO,kBAAkB,EAAE,UAAU,KAAK,WAAW;AAAA,EACvF;AAAA,EAEI,IAAI,WAAW;AACX,WAAO,KAAK;AAAA,EACpB;AAAA,EAEI,IAAI,kBAAkB;AAClB,WAAO,KAAK;AAAA,EACpB;AAAA,EAEI,YAAY,EAAE,OAAA2L,GAAO,OAAA9J,GAAO,MAAA2L,EAAI,GAAI;AAChC,QAAI7B,MAAU,UAAa9J,MAAU,UAAa2L,MAAS;AACvD,YAAM,MAAM,gFAAgF;AAGhG,WAAI3L,MAAU,SACH,KAAK,UAAUA,CAAK,IAGpB,KAAK,UAAU,KAAK,CAAA+C,MAAK;AAC5B,UAAI+G,MAAU;AACV,eAAO/G,EAAE,UAAU+G;AAElB,UAAI6B,MAAS;AACd,eAAO5I,EAAE,aAAa4I;AAAA,IAE1C,CAAa;AAAA,EAEb;AAAA,EAEI,eAAeqb,GAAe;AAC1B,UAAMC,IAAoB,KAAK,YAAYD,CAAa;AACxD,QAAIC,MAAsB,KAAK,qBAC3B,KAAK,mBAAmBA,GACpB,KAAK,kBAAiB;AACtB,YAAM,EAAE,UAAAC,GAAU,OAAApd,EAAO,IAAG,KAAK;AACjC,MAAApL,EAAa,KAAK,QAAQP,EAAO,kBAAkB,EAAE,UAAA+oB,GAAU,OAAApd,EAAO,CAAA;AAAA,IACtF;AAEQ,SAAK,KAAM;AAAA,EACnB;AAAA,EAEI,kBAAkB;AACd,IAAI,KAAK,mBACLpL,EAAa,KAAK,QAAQP,EAAO,iBAAiB,GAEtD,KAAK,mBAAmB,MACxB,KAAK,KAAM;AAAA,EACnB;AACA;ACrHO,eAAegpB,GAAoB9oB,GAAQ;AAC9C,QAAM+I,EAAkB/I,GAAQ,YAAY,OAAOgJ,MAAW;AAC1D,IAAAA,EAAO,OAAO,QAAQ,CAAA5I,MAAS;AAC3B,MAAAL,EAAUC,GAAQI,GAAO,OAAOE,MAAW;AACvC,cAAM0I,EAAO,QAAQ5I,GAAOE,CAAM;AAAA,MACrC,CAAA;AAAA,IACJ,CAAA;AAAA,EACT,CAAK;AACL;AAEO,eAAeyoB,GAAsB/oB,GAAQ;AAEpD;AAEe,MAAMgpB,WAAuBtgB,GAAO;AAAA,EAC/C,IAAI,OAAO;AAAE,WAAO;AAAA,EAAW;AAAA,EAE/B,IAAI,SAAS;AACT,WAAO,CAAE;AAAA,EACjB;AAAA,EAEI,MAAM,QAAQtI,GAAOE,GAAQ;AACzB,SAAK,OAAO,IAAI,KAAK,GAAG,KAAK,IAAI,0CAA0C;AAAA,EACnF;AACA;AC1BY,MAAC2oB,KAAkC,CAAC1kB,MACrC,IAGE2kB,KAAsC,CAACC,MACzCA,EAAa;AAGT,MAAMC,GAAc;AAAA,EAC/B,YAAYppB,GAAOqpB,GAAe;AAC9B,SAAK,UAAUrpB,GAEf,KAAK,qBAAqBA,EAAO,OAAO,iBAAiB,CAAE,GAE3D,KAAK,sBAAsBqpB,EAAc,cAAcJ,IACvD,KAAK,0BAA0BI,EAAc,kBAAkBH,IAE/D,KAAK,mBAAmB,QAAQ,CAAAI,MAAiB;AAC7C,MAAAA,EAAc,cAAc,KAAK,wBAAwBA,CAAa;AAAA,IAClF,CAAS,GAED,KAAK,kBAAmB;AAAA,EAChC;AAAA,EAEI,oBAAoB;AAChB,SAAK,mBAAmB,QAAQ,CAAAC,MAAkB;AAC9C,MAAAA,EAAe,QAAQ,KAAK,oBAAoBA,EAAe,IAAI,KAAKA,EAAe;AAAA,IACnG,CAAS,GACDlpB,EAAa,KAAK,SAASP,EAAO,wBAAwB,EAAE,eAAe,MAAQ;AAAA,EAC3F;AAAA,EAEI,kBAAkByE,GAAM;AACpB,UAAMilB,IAAS,KAAK,mBAAmB,KAAK,CAAA9kB,MAAKA,EAAE,SAASH,CAAI;AAChE,YAAOilB,KAAA,gBAAAA,EAAQ,UAAS;AAAA,EAChC;AACA;ACrCO,SAASC,GAAsB,EAAE,WAAAlY,KAAa;AACjD,EAAAA,EAAU,YAAY;AAAA;AAAA;AAAA;AAAA;AAAA;AAOtB,QAAMmY,IAAQnY,EAAU,cAAc,KAAK,GACrC3D,IAAO2D,EAAU,cAAc,GAAG,GAClCoY,IAAapY,EAAU,cAAc,mBAAmB;AAkC9D,SAhCwB;AAAA,IACpB,SAAS1P,GAAI+nB,GAAK;AACd,MAAI/nB,MAAQ6nB,EAAM,QACdA,EAAM,MAAM7nB,GACZ6nB,EAAM,MAAME;AAAA,IAEnB;AAAA,IAED,QAAQC,GAAK;AACT,MAAAjc,EAAK,YAAYic;AAAA,IACpB;AAAA,IAED,YAAYC,GAAa;AACrB,MAAIA,IAAc,OACdH,EAAW,MAAM,OAAO,IACxBA,EAAW,MAAM,QAAQ,GAAG,MAAMG,IAAc,GAAG,QAGnDH,EAAW,MAAM,QAAQ,IACzBA,EAAW,MAAM,OAAO,GAAGG,IAAc,GAAG;AAAA,IAEnD;AAAA,IAED,OAAO;AACH,MAAAH,EAAW,UAAU,OAAO,QAAQ;AAAA,IACvC;AAAA,IAED,OAAO;AACH,MAAAA,EAAW,UAAU,IAAI,QAAQ;AAAA,IAC7C;AAAA,EACA;AAGA;AC1CO,SAAS9B,GAAwB,EAAE,WAAAtW,GAAW,QAAAvR,GAAQ,UAAA6T,IAAW,KAAK,aAAAD,IAAc,GAAG,WAAAkU,IAAY,IAAG,GAAG;AAC5G,EAAAvW,EAAU,UAAU,IAAI,oBAAoB,GAC5CA,EAAU,UAAU,IAAI,2BAA2B,GACnDA,EAAU,YAAY;AAAA;AAAA;AAAA;AAAA;AAAA,+CAKqBsC,IAAWiU,CAAS,YAAYlU,IAAckU,CAAS;AAAA;AAAA;AAAA;AAKlG,QAAMiC,IAAUxY,EAAU,cAAc,UAAU,GAC5CyY,IAAYzY,EAAU,cAAc,YAAY,GAChD0Y,IAAQ1Y,EAAU,cAAc,SAAS,GAEzC2Y,IAA2B3Y,EAAU,cAAc,6BAA6B,GAChF4Y,IAAkBV,GAAsB,EAAE,WAAWS,EAAwB,CAAE;AAIrF,MAAIE,IAAU,IAEVC,IAAmB;AACvB,QAAMC,IAAU,CAAE,GACZC,IAAY,CAAC9F,MAAI;AzE7B3B,QAAA1hB;AyE6BgC,YAAAA,IAAAunB,EAAQ,KAAK,CAAAE,MAAUA,EAAO,OAAO/F,KAAQ+F,EAAO,OAAOA,EAAO,iBAAiB/F,CAAI,MAAvF,gBAAA1hB,EAA0F;AAAA,KAChH0nB,IAAoB;AAAA,IACtB,QAAAzqB;AAAA,IACA,SAAA+pB;AAAA,IACA,WAAAC;AAAA,IACA,OAAAC;AAAA,IACA,iBAAAE;AAAA,IAEA,kBAAkB5Y,EAAU,cAAc,oBAAoB;AAAA,IAE9D,UAAU,EAAE,MAAAkT,GAAM,UAAA5Q,GAAU,eAAAqU,EAAa,GAAI;AACzC,YAAMsC,IAAS3iB,EAA0B;AAAA;AAAA;AAAA,kBAGnC;AACN,MAAA2iB,EAAO,MAAM,OAAO,GAAG/F,IAAO5Q,IAAW,GAAG,KAC5C2W,EAAO,MAAM,QAAQ,QAAQtC,IAAgBrU,IAAW,GAAG,YAC3D,KAAK,iBAAiB,YAAY2W,CAAM,GACxCF,EAAQ,KAAK;AAAA,QACT,QAAAE;AAAA,QACA,MAAA/F;AAAA,QACA,eAAAyD;AAAA,MACH,CAAA;AAAA,IACJ;AAAA,IAED,kBAAkB;AACd,YAAM7R,IAAW,KAAK,MAAM,QAAQ,KAAK,MAAM,MAAM;AACrD,WAAK,QAAQ,MAAM,QAAQ,GAAGA,CAAQ,KACtC,KAAK,UAAU,MAAM,QAAQ,GAAG,MAAMA,CAAQ;AAE9C,YAAMqU,IAAgBH,EAAU,KAAK,MAAM,QAAQzC,CAAS,GACtD6C,IAAeL,EAAQ,UAAU,CAAAE,MAAUA,EAAO,WAAWE,CAAa;AAChF,MAAAJ,EAAQ,QAAQ,CAACE,GAAQ7oB,MAAU;AAC/B,YAAIA,IAAQgpB;AACR,UAAAH,EAAO,OAAO,cAAc,UAAU,EAAE,MAAM,QAAQ,QACtDA,EAAO,OAAO,cAAc,YAAY,EAAE,MAAM,QAAQ;AAAA,iBAEnD7oB,MAAUgpB,GAAc;AAC7B,gBAAMZ,KAAW,KAAK,MAAM,QAAQjC,IAAY0C,EAAO,QAAQA,EAAO,gBAAgB;AACtF,UAAAA,EAAO,OAAO,cAAc,UAAU,EAAE,MAAM,QAAQ,GAAGT,CAAO,KAChES,EAAO,OAAO,cAAc,YAAY,EAAE,MAAM,QAAQ,GAAG,MAAMT,CAAO;AAAA,QAC5F;AAEoB,UAAAS,EAAO,OAAO,cAAc,UAAU,EAAE,MAAM,QAAQ,MACtDA,EAAO,OAAO,cAAc,YAAY,EAAE,MAAM,QAAQ;AAAA,MAE5E,CAAa;AAAA,IACJ;AAAA,IAED,YAAY3W,GAAU;AAClB,MAAKuW,MACD,KAAK,MAAM,MAAMvW,IAAWiU,GAC5B,KAAK,gBAAiB;AAAA,IAE7B;AAAA,IAED,eAAelU,GAAa;AACxB,MAAKwW,MACD,KAAK,MAAM,QAAQxW,IAAckU,GACjC,KAAK,gBAAiB;AAAA,IAE7B;AAAA,IAED,SAAS5nB,GAAU;AACf,MAAAmqB,IAAmBnqB;AAAA,IAC/B;AAAA,EACK;AAED,EAAA+pB,EAAM,iBAAiB,eAAe,MAAM;AACxC,IAAAG,IAAU;AAAA,EAClB,CAAK;AAED,MAAIQ,IAAa;AACjB,EAAAX,EAAM,iBAAiB,aAAa,OAAO7pB,MAAU;AzEtGzD,QAAA2C;AyEuGQ,UAAM8nB,MAAY9nB,IAAA/C,EAAO,cAAP,gBAAA+C,EAAkB,WAAU,CAAE;AAChD,QAAiB8nB,EAAU,QAAQ;AAC/B,YAAMhX,IAAW,MAAM7T,EAAO,eAAe,SAAU,GACjD4L,IAAQxL,EAAM,OAAO,aAErB0qB,IADW1qB,EAAM,SACewL,GAChC6Y,IAAOqG,IAAqBjX,GAC5B5H,IAAQ4e,EAAU,OAAO,CAAA5e,OAASA,GAAM,QAAQwY,CAAI,EAAE,IAAK,GAC3D9jB,KAAMsL,MAAUA,EAAM,SAASA,EAAM,MACrC2B,KAAO3B,KAAS8e,GAAoBlX,IAAWiX,CAAkB,GACjEN,KAASD,EAAU9F,CAAI;AAC7B,MAAI+F,OAAWI,KAAcA,MAAe,QACxCA,EAAW,UAAU,OAAO,QAAQ,GAExCJ,MAAUA,GAAO,UAAU,IAAI,QAAQ,GACvCI,IAAaJ,IAEbL,EAAgB,SAASxpB,IAAKiN,EAAI,GAClCuc,EAAgB,QAAQvc,EAAI,GAC5Buc,EAAgB,YAAYW,CAAkB,GAE9CX,EAAgB,KAAM;AAAA,IAClC;AAAA,EACA,CAAK,GAEDF,EAAM,iBAAiB,cAAc,MAAM;AACvC,IAAAE,EAAgB,KAAM,GACtBS,KAAcA,EAAW,UAAU,OAAO,QAAQ;AAAA,EAC1D,CAAK,GAEDX,EAAM,iBAAiB,aAAa,MAAM;AACtC,IAAAG,IAAU,IACN,OAAOC,KAAsB,cAC7BA,EAAiBJ,EAAM,QAAQnC,CAAS;AAAA,EAEpD,CAAK,GAEDmC,EAAM,iBAAiB,SAAS,MAAM;AAClC,IAAAQ,EAAkB,gBAAiB;AAAA,EAC3C,CAAK;AAED,QAAMO,IAAc,OAAOrnB,MAAY;AACnC,UAAMiQ,IAAc,MAAM5T,EAAO,eAAe,YAAa;AAC7D,UAAMA,EAAO,eAAe,eAAe4T,IAAcjQ,CAAO;AAAA,EACxE;AAEI,SAAAsmB,EAAM,iBAAiB,WAAW,CAAA5mB,MAAO;AACrC,IAAIA,EAAI,QAAQ,eACZ2nB,EAAY,GAAG,GACf3nB,EAAI,eAAgB,GACpBA,EAAI,gBAAiB,KAEhBA,EAAI,QAAQ,iBACjB2nB,EAAY,EAAE,GACd3nB,EAAI,eAAgB,GACpBA,EAAI,gBAAiB;AAAA,EAGjC,CAAK,GAEDonB,EAAkB,gBAAiB,GAE5BA;AACX;ACrKY,MAACQ,IAAY,OAAO,OAAO;AAAA,EACnC,UAAU;AAAA,EACV,OAAO;AAAA,EACP,MAAM;AAAA,EACN,MAAM;AAAA,EACN,OAAO;AAAA,EACP,SAAS;AACb,CAAC;AAID,IAAIC,KAAmBD,EAAU;AAE1B,MAAME,KAAc,CAAC9d,GAAErN,IAAS,SAAS;AAC5C,QAAMorB,IAAQ,OAAO/d,KAAO,WAAW4d,EAAU5d,EAAE,YAAa,CAAA,IAAIA;AAEpE,MAAI+d,IAAMH,EAAU,YAAYG,IAAMH,EAAU;AAC5C,UAAM,MAAM,kCAAmCG,CAAO,EAAC;AAE3D,EAAIprB,KACAA,EAAO,gBAAgBA,EAAO,iBAAiB,CAAE,GACjDA,EAAO,cAAc,WAAWorB,KAGhCF,KAAmBE;AAE3B,GAEaC,KAAkB,CAACrrB,IAAS,SAC9BA,IAASA,EAAO,cAAc,WAAWkrB,IAGvCI,KAAe,CAAC;AAAA,EACzB,KAAAC;AAAA,EACA,OAAAH,IAAQH,EAAU;AAAA,EAClB,QAAAjrB,IAAS;AAAA,EACT,SAAA4a,IAAU;AACd,MAAM;AACF,EAAI5a,KAAU,CAACA,EAAO,iBAClBmrB,GAAYnrB,GAAQirB,EAAU,IAAI;AAGtC,QAAM5e,IAAUgf,GAAgBrrB,CAAM;AACtC,MAAIorB,IAAMH,EAAU;AAChB,UAAM,MAAM,mCAAoCG,CAAO,EAAC;AAO5D,MAJIprB,KACAK,EAAaL,GAAQF,EAAO,KAAK,EAAE,UAAUsrB,GAAO,SAAAxQ,GAAS,SAAS2Q,GAAK,iBAAiBlf,EAAO,CAAE,GAGrG+e,KAAO/e;AACP,YAAQ+e,GAAK;AAAA,MACb,KAAKH,EAAU;AACX,gBAAQ,MAAM,GAAIrQ,CAAO,aAAc2Q,CAAG,EAAE;AAC5C;AAAA,MACJ,KAAKN,EAAU;AACX,gBAAQ,KAAK,GAAIrQ,CAAO,eAAgB2Q,CAAG,EAAE;AAC7C;AAAA,MACJ,KAAKN,EAAU;AACX,gBAAQ,KAAK,GAAIrQ,CAAO,YAAa2Q,CAAG,EAAE;AAC1C;AAAA,MACJ,KAAKN,EAAU;AACX,gBAAQ,MAAM,GAAIrQ,CAAO,aAAc2Q,CAAG,EAAE;AAC5C;AAAA,MACJ,KAAKN,EAAU;AACX,gBAAQ,IAAI,GAAIrQ,CAAO,eAAgB2Q,CAAG,EAAE;AAC5C;AAAA,IACZ;AAEA,GAEaC,IAAM;AAAA,EACf,UAAU,CAACJ,GAAOprB,IAAS,SAAS;AAChC,IAAAmrB,GAAYC,GAAOprB,CAAM;AAAA,EAC5B;AAAA,EAED,cAAc,CAACA,IAAS,SACbqrB,GAAgBrrB,CAAM;AAAA,EAGjC,OAAO,CAACurB,GAAKvrB,IAAS,MAAM4a,IAAU,kBAAkB;AACpD,IAAA0Q,GAAa;AAAA,MACT,KAAAC;AAAA,MACA,OAAON,EAAU;AAAA,MACjB,QAAAjrB;AAAA,MACA,SAAA4a;AAAA,IACZ,CAAS;AAAA,EACJ;AAAA,EAED,MAAM,CAAC2Q,GAAKvrB,IAAS,MAAM4a,IAAU,kBAAkB;AACnD,IAAA0Q,GAAa;AAAA,MACT,KAAAC;AAAA,MACA,OAAON,EAAU;AAAA,MACjB,QAAAjrB;AAAA,MACA,SAAA4a;AAAA,IACZ,CAAS;AAAA,EACJ;AAAA,EAED,MAAM,CAAC2Q,GAAKvrB,IAAS,MAAM4a,IAAU,kBAAkB;AACnD,IAAA0Q,GAAa;AAAA,MACT,KAAAC;AAAA,MACA,OAAON,EAAU;AAAA,MACjB,QAAAjrB;AAAA,MACA,SAAA4a;AAAA,IACZ,CAAS;AAAA,EACJ;AAAA,EAED,OAAO,CAAC2Q,GAAKvrB,IAAS,MAAM4a,IAAU,kBAAkB;AACpD,IAAA0Q,GAAa;AAAA,MACT,KAAAC;AAAA,MACA,OAAON,EAAU;AAAA,MACjB,QAAAjrB;AAAA,MACA,SAAA4a;AAAA,IACZ,CAAS;AAAA,EACJ;AAAA,EAED,SAAS,CAAC2Q,GAAKvrB,IAAS,MAAM4a,IAAU,kBAAkB;AACtD,IAAA0Q,GAAa;AAAA,MACT,KAAAC;AAAA,MACA,OAAON,EAAU;AAAA,MACjB,QAAAjrB;AAAA,MACA,SAAA4a;AAAA,IACZ,CAAS;AAAA,EACT;AACA;AAGe,MAAM6Q,GAAI;AAAA,EACrB,YAAYzrB,GAAQ4a,IAAU,eAAe;AACzC,SAAK,UAAU5a,GACf,KAAK,WAAW4a;AAAA,EACxB;AAAA,EAEI,IAAI,UAAU;AACV,WAAO,KAAK;AAAA,EACpB;AAAA,EAEI,IAAI,SAAS;AACT,WAAO,KAAK;AAAA,EACpB;AAAA,EAEI,SAASwQ,GAAO;AACZ,IAAAI,EAAI,SAASJ,GAAO,KAAK,OAAO;AAAA,EACxC;AAAA,EAEI,eAAe;AACX,WAAOI,EAAI,aAAa,KAAK,OAAO;AAAA,EAC5C;AAAA,EAEI,MAAMD,GAAK3Q,IAAU,MAAM;AACvB,IAAA4Q,EAAI,MAAMD,GAAK,KAAK,SAAS3Q,KAAW,KAAK,QAAQ;AAAA,EAC7D;AAAA,EAEI,KAAK2Q,GAAK3Q,IAAU,MAAM;AACtB,IAAA4Q,EAAI,KAAKD,GAAK,KAAK,SAAS3Q,KAAW,KAAK,QAAQ;AAAA,EAC5D;AAAA,EAEI,KAAK2Q,GAAK3Q,IAAU,MAAM;AACtB,IAAA4Q,EAAI,KAAKD,GAAK,KAAK,SAAS3Q,KAAW,KAAK,QAAQ;AAAA,EAC5D;AAAA,EAEI,MAAM2Q,GAAK3Q,IAAU,MAAM;AACvB,IAAA4Q,EAAI,MAAMD,GAAK,KAAK,SAAS3Q,KAAW,KAAK,QAAQ;AAAA,EAC7D;AAAA,EAEI,QAAQ2Q,GAAK3Q,IAAU,MAAM;AACzB,IAAA4Q,EAAI,QAAQD,GAAK,KAAK,SAAS3Q,KAAW,KAAK,QAAQ;AAAA,EAC/D;AACA;AC1KA,MAAM8Q,KAAsB,CAAE,GCGxBC,KAAuB;AAE7B,eAAeC,KAAO;AAClB,UAAQ,KAAK,OAAO,MAAI;AAAA,IACxB,KAAK;AACD,UAAI;AACA,eAAO,KAAK,MAAMpnB,EAAU,aAAa,CAAC;AAAA,MACtD,QACoB;AACR,eAAO,KAAK,MAAMmnB,EAAoB;AAAA,MAClD;AAAA,IACI,KAAK;AACD,UAAI;AAEA,eADa,MAAM,KAAK,OAAO,KAAK,KAAK,KAAK,OAAO,SAAS,EAAE,KACjD,KAAK,MAAMA,EAAoB;AAAA,MAC1D,QACoB;AACR,eAAO,KAAK,MAAMA,EAAoB;AAAA,MAClD;AAAA,EACA;AACA;AAEA,eAAeE,GAAKhR,GAAM;AACtB,UAAQ,KAAK,OAAO,MAAI;AAAA,IACxB,KAAK;AACD,MAAAvW,GAAmB,KAAK,QAAQ,KAAK,OAAO,aAAa,eAAe,KAAK,UAAUuW,CAAI,CAAC;AAC5F;AAAA,IACJ,KAAK;AACD,YAAM,KAAK,OAAO,KAAK,MAAM,KAAK,OAAO,SAAS,CAAE,GAAEA,CAAI;AAC1D;AAAA,EACR;AACA;AAEe,MAAMiR,WAAoB1kB,GAAe;AAAA,EACpD,YAAYpH,GAAQ;AAChB,UAAMA,CAAM;AACZ,UAAM,EAAE,eAAA+rB,GAAe,SAAAC,EAAO,IAAKhsB,EAAO,OAAO,eAAe;AAAA,MAC5D,eAAe;AAAA,MACf,SAAS;AAAA,QACL,QAAQ;AAAA,UACJ,aAAa;AAAA,QACjC;AAAA,MACA;AAAA,IACS;AAKD,QAJA,KAAK,SAASgsB,EAAQD,CAAa,GACnC,KAAK,OAAO,OAAOA,GACnB,KAAK,UAAU,IAEX,CAAC,KAAK;AACN,YAAM,MAAM,qEAAqE;AAAA,EAE7F;AAAA,EAEI,MAAM,IAAIvmB,GAAK4C,GAAO,EAAE,QAAAyb,IAAS,GAAO,IAAG,IAAI;AAC3C,UAAMhJ,IAAO,MAAM+Q,GAAK,MAAM,IAAI;AAClC,IAAI/H,IACAhJ,EAAK,OAAOrV,CAAG,IAAI4C,KAGnByS,EAAK,OAAO,KAAK,OAAO,OAAO,IAAIA,EAAK,OAAO,KAAK,OAAO,OAAO,KAAK,CAAE,GACzEA,EAAK,OAAO,KAAK,OAAO,OAAO,EAAErV,CAAG,IAAI4C,IAE5C,MAAMyjB,GAAK,MAAM,MAAM,CAAChR,CAAI,CAAC;AAAA,EACrC;AAAA,EAEI,MAAM,IAAIrV,GAAK,EAAE,QAAAqe,IAAS,GAAK,IAAK,CAAA,GAAI;AACpC,UAAMhJ,IAAO,MAAM+Q,GAAK,MAAM,IAAI;AAClC,WAAI/H,IACOhJ,EAAK,OAAOrV,CAAG,IAGfqV,EAAK,OAAO,KAAK,OAAO,OAAO,KAAKA,EAAK,OAAO,KAAK,OAAO,OAAO,EAAErV,CAAG,KAAK;AAAA,EAEhG;AACA;ACvEO,SAASymB,GAAmBxlB,GAAQ;A7EN3C,MAAA1D;A6EOI,GAAIA,IAAA,KAAK,cAAL,QAAAA,EAAgB,mBAChBqC,GAAaqB,GAAQ,KAAK,UAAU,eAAe;AAE3D;AAEA,eAAeylB,KAA2B;A7EZ1C,MAAAnpB;A6EaI,OAAIA,IAAA,KAAK,cAAL,QAAAA,EAAgB,aAAa;AAC7B,UAAMsG,IAAI,CAAE;AACZ,SAAK,UAAU,YAAY,QAAQ,CAAA8iB,MAAO;AACtC,UAAI,QAAO,KAAKA,CAAG,EAEd,KAAI,KAAK,2BAA2B;AACrC,cAAMC,IAAU9qB,EAAS,CAAC,KAAK,UAAU6qB,CAAG,CAAC;AAC7C,QAAA9iB,EAAE,KAAK,IAAI,QAAQ,OAAMzI,MAAW;AAChC,gBAAMmE,GAAUqnB,GAAS,EAAK,GAC9BxrB,EAAS;AAAA,QAC7B,CAAiB,CAAC;AAAA,MAClB;AAEgB,cAAM,IAAI,MAAM,mDAAmD;AAAA,IAEnF,CAAS,GACD,MAAM,QAAQ,WAAWyI,CAAC;AAAA,EAClC;AACA;AAEO,eAAegjB,KAAsB;A7EjC5C,MAAAtpB;A6EmCI,MADA,KAAK,OAAO,sBAAsB,KAAK,OAAO,uBAAuB,CAAE,IACnEA,IAAA,KAAK,cAAL,QAAAA,EAAgB,aAAa;AAC7B,UAAMsG,IAAI,CAAE;AACZ,SAAK,UAAU,YAAY,QAAQ,CAAA8iB,MAAO;AACtC,UAAI,OAAO,KAAKA,CAAG;AACf,QAAA9iB,EAAE,KAAK,IAAI,QAAQ,CAAAzI,MAAW;AAC1B,gBAAMuH,IAAQ,SAAS,cAAc,OAAO;AAC5C,UAAAA,EAAM,YAAYgkB,GAClB,KAAK,OAAO,oBAAoB,KAAKhkB,CAAK,GAC1C,SAAS,KAAK,YAAYA,CAAK,GAC/BvH,EAAS;AAAA,QAC7B,CAAiB,CAAC;AAAA,WAED;AACD,cAAMwrB,IAAU9qB,EAAS,CAAC,KAAK,UAAU6qB,CAAG,CAAC;AAC7C,QAAA9iB,EAAE,KAAK,IAAI,QAAQ,OAAMzI,MAAW;AAChC,gBAAMqE,IAAO,MAAMF,GAAUqnB,CAAO;AACpC,eAAK,OAAO,oBAAoB,KAAKnnB,CAAI,GACzCrE,EAAS;AAAA,QAC7B,CAAiB,CAAC;AAAA,MAClB;AAAA,IACA,CAAS,GACD,MAAM,QAAQ,WAAWyI,CAAC;AAAA,EAClC;AACA;AAEO,SAASijB,KAAwB;AACpC,OAAK,OAAO,sBAAsB,KAAK,OAAO,uBAAuB,CAAE,GACvE,KAAK,OAAO,oBAAoB,QAAQ,CAAArnB,MAAQ;AAC5C,IAAAE,GAAYF,CAAI;AAAA,EACxB,CAAK,GACD,KAAK,OAAO,sBAAsB,CAAE;AACxC;AAEO,eAAesnB,KAAqB;A7EpE3C,MAAAxpB;A6EqEI,EAAI,MAAM,SAAQA,IAAA,KAAK,cAAL,gBAAAA,EAAgB,KAAK,KACnC,MAAM,QAAQ,IAAI,KAAK,UAAU,MAAM,IAAI,CAAC,EAAE,QAAAiG,GAAQ,YAAAwjB,GAAY,MAAA1rB,EAAI,MAC3D,IAAI,QAAQ,OAAOF,GAAQC,MAAW;AACzC,UAAMmF,IAAM,SAAS,cAAc,KAAK;AAExC,QADAA,EAAI,YAAYlF,GACZkF,EAAI,SAAS,CAAC,KAAKA,EAAI,SAAS,CAAC,EAAE,YAAY;AAE/C,MAAApF;aAEK,KAAK,2BAA2B;AACrC,YAAM6rB,IAAcnrB,EAAS,CAAC,KAAK,UAAUR,CAAI,CAAC;AAElD,OADY,MAAM,MAAM2rB,CAAW,GAC3B,KACJ7rB,EAAS,IAGTC,EAAO,IAAI,MAAM,+BAAgC4rB,CAAW,GAAI,CAAC;AAAA,IAEzF;AAEoB,YAAM,IAAI,MAAM,mDAAmD;AAAA,EAE1E,CAAA,CACJ,CAAC;AAEV;AAEO,eAAeC,KAAgB;A7EhGtC,MAAA3pB;A6EiGI,EAAI,MAAM,SAAQA,IAAA,KAAK,cAAL,gBAAAA,EAAgB,KAAK,KACnC,MAAM,QAAQ,IAAI,KAAK,UAAU,MAAM,IAAI,CAAC,EAAE,QAAAiG,GAAQ,YAAAwjB,GAAY,MAAA1rB,EAAI,MAC3D,IAAI,QAAQ,OAAOF,GAAQC,MAAW;AACzC,UAAMmF,IAAM,SAAS,cAAc,KAAK;AAExC,QADAA,EAAI,YAAYlF,GACZkF,EAAI,SAAS,CAAC,KAAKA,EAAI,SAAS,CAAC,EAAE,YAAY;AAC/C,WAAK,OAAO,oBAAoBgD,GAAQwjB,GAAY1rB,CAAI,GACxDF,EAAS;AAAA,SAER;AACD,YAAM6rB,IAAcnrB,EAAS,CAAC,KAAK,UAAUR,CAAI,CAAC,GAC5C6rB,IAAM,MAAM,MAAMF,CAAW;AACnC,UAAIE,EAAI,IAAI;AACR,cAAMC,IAAW,MAAMD,EAAI,KAAM;AACjC,aAAK,OAAO,oBAAoB3jB,GAAQwjB,GAAYI,CAAQ,GAC5DhsB,EAAS;AAAA,MACjC;AAEwB,QAAAC,EAAO,IAAI,MAAM,+BAAgC4rB,CAAW,GAAI,CAAC;AAAA,IAEzF;AAAA,EACa,CAAA,CACJ,CAAC;AAEV;AAGe,MAAMI,GAAK;AAAA,EACtB,YAAY7sB,GAAQ;AAChB,SAAK,UAAUA;AAAA,EACvB;AAAA,EAEI,IAAI,SAAS;AACT,WAAO,KAAK;AAAA,EACpB;AAAA,EAEI,MAAM,SAAS8sB,GAAW;AACtB,QAAI,OAAOA,KAAe,UAAU;AAEhC,WAAK,WAAW3qB,GAAe2qB,CAAS,GACxC,KAAK,4BAA4B;AACjC,YAAMH,IAAM,MAAM,MAAMG,CAAS;AACjC,UAAI,CAACH,EAAI;AACL,cAAM,IAAI,MAAM,+BAA+BG,CAAS,EAAE;AAE9D,WAAK,YAAY,MAAMH,EAAI,KAAM;AAAA,IAC7C,MACa,CAAI,OAAOG,KAAe,aAC3B,KAAK,WAAW,IAChB,KAAK,4BAA4B,IACjC,KAAK,YAAYA;AAGrB,QAAI;AAEA,YAAMZ,GAAyB,MAAM,IAAI,GACzC,MAAMK,GAAmB,MAAM,IAAI,IAG/B,KAAK,QAAQ,UAAU/K,EAAY,UACnC,KAAK,QAAQ,UAAUA,EAAY,aAEnC,MAAM,KAAK,QAAQ,OAAQ;AAAA,IAE3C,SACexgB,GAAK;AACR,iBAAK,WAAW,IAChB,KAAK,4BAA4B,IACjC,KAAK,YAAY,CAAE,GACbA;AAAA,IAClB;AAAA,EACA;AAAA,EAEI,aAAa;A7E1KjB,QAAA+B,GAAA4N;A6E4KQ,IAAI,MAAM,SAAQ5N,IAAA,KAAK,cAAL,gBAAAA,EAAgB,KAAK,OACnC4N,IAAA,KAAK,cAAL,QAAAA,EAAgB,MAAM,QAAQ,CAAC,EAAE,QAAA3H,GAAQ,YAAAwjB,QAAiB;AACtD,WAAK,OAAO,uBAAuBxjB,GAAQwjB,CAAU;AAAA,IACrE,KAGQ,KAAK,WAAW,MAChB,KAAK,YAAY,CAAE,IAEf,KAAK,QAAQ,UAAUhL,EAAY,UACnC,KAAK,QAAQ,UAAUA,EAAY,aAEnC,KAAK,QAAQ,OAAQ;AAAA,EAEjC;AACA;AC3Le,MAAMuL,GAAe;AAAA,EAChC,YAAYC,GAAchtB,GAAQ;AAC9B,SAAK,UAAUA,GACf,KAAK,iBAAiB,KAAK,MAAM,KAAK,UAAUgtB,CAAY,CAAC,GAE7D,KAAK,YAAY,KAAK,eAAe,YAAY,CAAE,GACnD,KAAK,WAAW,CAAE,GAClB,KAAK,aAAa,CAAE,GACpB,KAAK,YAAY,KAAK,eAAe,UACrC,KAAK,YAAY,KAAK,eAAe,UACrC,KAAK,mBAAmB,KAAK,eAAe;AAE5C,aAASC,IAAkB;AACvB,UAAI,KAAK,QAAQ,WAAW;AACxB,eAAO;AAEX,UAAI,KAAK;AACL,eAAO,KAAK,gBAAgB;AAEhC,YAAMvX,IAAS,KAAK,QAAQ,CAAC;AAE7B,UAAI,EADWA,EAAO,QAAQ,OAAOA,EAAO,QAAQ,OAAOA,EAAO,QAAQ;AAEtE,eAAO;AAEX,YAAMvP,IAAQ,SAAS,cAAc,OAAO;AAC5C,UAAIuP,EAAO,QAAQ,OACfA,EAAO,QAAQ,IAAI,UACnBvP,EAAM,YAAYuP,EAAO,QAAQ,IAAI,CAAC,EAAE,YAAY,WAAW,MAAM;AAGrE,eAAOA,EAAO,QAAQ,IAAI,CAAC,EAAE;AAEjC,YAAMwX,IAAMxX,EAAO,QAAQ,OAAOA,EAAO,QAAQ;AACjD,aAAIwX,KACAA,EAAI,UACJ/mB,EAAM,YAAY+mB,EAAI,CAAC,EAAE,YAAY,+BAA+B,MAAM,MAC1E,UAAU,KAAK,UAAU,SAAS,IAE3BA,EAAI,CAAC,EAAE,MAEX;AAAA,IACnB;AAEQ,SAAK,WAAW;AAAA,MACZ,SAAS,KAAK,eAAe;AAAA,MAC7B,IAAI,WAAW;AACX,eAAO,KAAK,QAAQ,IAAI,OAAK,EAAE,OAAO;AAAA,MACzC;AAAA,MACD,UAAU3X,GAAS;AACf,eAAO,KAAK,QAAQ,KAAK,CAAA+J,MAAKA,EAAE,YAAY/J,CAAO;AAAA,MACtD;AAAA,MACD,eAAeA,GAAS;AACpB,cAAMG,IAAS,KAAK,UAAUH,CAAO;AACrC,eAAOG,KAAU,OAAO,KAAKA,EAAO,OAAO,KAAK;AAAA,MACnD;AAAA,MACD,eAAeH,GAAS;AACpB,cAAMG,IAAS,KAAK,UAAUH,CAAO;AACrC,eAAOG,IAASA,EAAO,UAAU,CAAC,OAAO,IAAI;AAAA,MAChD;AAAA,MACD,IAAI,cAAc;AAEd,cAAMH,IAAU,KAAK,SAAS,WAAW,KAAK,KAAK,SAAS,CAAC,GACvD4X,IAAc5X,KAAW,KAAK,eAAeA,CAAO,KAAK,CAAE,GAC3D6X,IAAU,KAAK,UAAU7X,CAAO;AACtC,eAAO4X,EAAY,WAAW,KAC1BA,EAAY,CAAC,MAAM,WACnBC,EAAQ,QAAQ,SAASA,EAAQ,QAAQ,MAAM,SAAS;AAAA,MAC/D;AAAA,MACD,IAAI,kBAAkB;AAClB,eAAK,KAAK,cAGH,KAAK,UAAU,KAAK,SAAS,CAAC,CAAC,EAAE,QAAQ,MAAM,CAAC,IAF5C;AAAA,MAGd;AAAA,MACD,IAAI,qBAAqB;AACrB,eAAOH,EAAgB,MAAM,IAAI,MAAM;AAAA,MAC1C;AAAA,MACD,IAAI,eAAe;AACf,eAAOA,EAAgB,MAAM,IAAI;AAAA,MACpC;AAAA,MACD,IAAI,aAAa;AACb,eAAK,KAAK,qBAGH,KAAK,cAAc,UAAU,UAFzB;AAAA,MAGd;AAAA,MACD,IAAI,eAAe;AACf,cAAM1oB,IAAO,KAAK;AAClB,YAAIA,GAAM;AACN,gBAAMvE,IAAS,SAAS,cAAcuE,CAAI;AAC1C,iBAAAvE,EAAO,MAAM,KAAK,cACXA;AAAA,QAC3B;AAEoB,iBAAO;AAAA,MAE3B;AAAA,IACS,GAEG,KAAK,eAAe,aACpB,CAAC,MAAM,QAAQ,KAAK,eAAe,SAAS,KAC5C,OAAO,KAAK,eAAe,aAAe,YAC1C,OAAO,KAAK,eAAe,UAAU,iBAAmB,YACxD,MAAM,QAAQ,KAAK,eAAe,UAAU,MAAM,IAElD,KAAK,aAAa,KAAK,eAAe,YAEjC,MAAM,QAAQ,KAAK,eAAe,SAAS,IAChD,KAAK,aAAa;AAAA,MACd,eAAe;AAAA,MACf,QAAQ,KAAK,eAAe;AAAA,IAC5C,IAGY,KAAK,aAAa;AAAA,MACd,eAAe;AAAA,MACf,QAAQ,CAAA;AAAA,IACxB,GAGQ,KAAK,WAAW,OAAO,KAAK,CAACkC,GAAEwK,MAAMxK,EAAE,OAAOwK,EAAE,IAAI,GAEpD,KAAK,WAAW,WAAW,CAAC+X,GAAM4I,IAAiB,OAAU;A9E1HrE,UAAAtqB,GAAA4N;A8E2HY,cAAI5N,IAAA,KAAK,YAAL,QAAAA,EAAc,kBAAkB,KAAK,QAAQ,gBAAgB,iBAAiB,CAACsqB,IAC/E5I,KAAQ,KAAK,QAAQ,eAAe,YAE/B,GAAC9T,IAAA,KAAK,YAAL,QAAAA,EAAc,oBAAmB,CAAC0c,KACxC,QAAQ,KAAK,0FAA0F,GAGpG,CAAC,GAAG,KAAK,WAAW,MAAM,EAC5B,KAAK,CAACnrB,GAAEwK,MAAMA,EAAE,OAAOxK,EAAE,IAAI,EAC7B,KAAK,CAAAgK,MAAKA,EAAE,OAAOuY,CAAI;AAAA,IACxC,GAEQ,OAAO,eAAe,KAAK,YAAY,WAAW;AAAA,MAC9C,MAAM;AACF,eAAO,MAAM,QAAQuI,EAAa,SAAS,KAAKA,EAAa,UAAU,WAAW,KAC1E,CAACA,EAAa;AAAA,MACtC;AAAA,IACA,CAAS,GAGD,OAAO,OAAO,KAAK,SAAS,GAC5B,OAAO,OAAO,KAAK,QAAQ,GAC3B,OAAO,OAAO,KAAK,SAAS,GAC5B,OAAO,OAAO,KAAK,SAAS;AAAA,EACpC;AAAA,EAEI,IAAI,WAAW;AACX,WAAO,KAAK;AAAA,EACpB;AAAA,EAEI,IAAI,UAAU;AACV,WAAO,KAAK;AAAA,EACpB;AAAA,EAEI,IAAI,YAAY;AACZ,WAAO,KAAK;AAAA,EACpB;AAAA,EAEI,IAAI,WAAW;AACX,WAAO,KAAK;AAAA,EACpB;AAAA,EAEI,IAAI,WAAW;AACX,WAAO,KAAK;AAAA,EACpB;AAAA,EAEI,IAAI,kBAAkB;AAClB,WAAO,KAAK;AAAA,EACpB;AACA;ACzGY,MAACM,IAAmB,OAAO,OAAO;AAAA,EAC1C;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AACJ,CAAC;AAED,SAASC,KAAe;A/E9ExB,MAAAxqB,GAAA4N,GAAA8O,GAAAkD,GAAAC,GAAAC,GAAAkB,GAAAC;A+E+EI,QAAMwJ,MAAW7c,KAAA5N,IAAA,KAAK,kBAAL,gBAAAA,EAAoB,aAApB,gBAAA4N,EAA8B,YAAWjO,EAAoB,OAAMigB,KAAAlD,IAAA,KAAK,kBAAL,gBAAAA,EAAoB,aAApB,gBAAAkD,EAA8B,OAAO,KAAM,KAAK,qBAC9H8K,MAAmB5K,KAAAD,IAAA,KAAK,kBAAL,gBAAAA,EAAoB,aAApB,gBAAAC,EAA8B,oBAAmBngB,EAAoB,OAAMshB,KAAAD,IAAA,KAAK,kBAAL,gBAAAA,EAAoB,aAApB,gBAAAC,EAA8B,eAAe,KAAM,KAAK;AAC5J,OAAK,oBAAoB,IAAI0B,GAAiB,MAAM,KAAK,mBAAmB8H,GAASC,CAAe;AACxG;AAMA,eAAeC,KAAgB;AAC3B,OAAK,eAAelM,EAAY,kBAChC,KAAK,kBAAkB,IAEvB,KAAK,IAAI,MAAM,uBAAuB,GACtC,KAAK,UAAU,MAAM,KAAK,WAAW,WAAW,KAAK,WAAU,IAAI,GAGnEyK,GAAmB,MAAM,KAAK,MAAM,CAAC,KAAK,OAAO,CAAC,GAElDzb,GAAqB,IAAI,GAEzB,KAAK,uBAAuB,KAAK,QAAQ,uBAAuB,KAAK,YAAY,uBAAuB,IACxG,KAAK,+BAA+B,KAAK,QAAQ,+BAA+B,KAAK,YAAY,+BAA+B,IAEhI,KAAK,iBAAiB,IAAI4Y,GAAc,MAAM;AAAA,IAC1C,YAAY,KAAK,YAAY;AAAA,IAC7B,gBAAgB,KAAK,YAAY;AAAA,EACzC,CAAK,GAED,KAAK,eAAe,IAAI0C,GAAY,IAAI;AAExC,QAAM6B,IAAY,IAAI,gBAAgB,OAAO,SAAS,MAAM,GACtDC,IAAwB,IAAI,gBAAiB;AACnD,aAAW,CAAC1sB,GAAMkH,CAAK,KAAKulB;AACxB,IAAAC,EAAsB,OAAO1sB,EAAK,YAAW,GAAIkH,CAAK;AAE1D,QAAMylB,IAAmBD,EAAsB,IAAI,UAAU,GACvDE,IAAYD,KAAoB,MAAM,KAAK,OAAO,KAAK5C,CAAS,CAAC,EAAE,QAAQ4C,EAAiB,YAAW,CAAE,MAAM,KACjHA,IACA,KAAK,QAAQ,YAAY;AAC7B,OAAK,KAAK,SAASC,CAAQ,GAG3B,MAAM,KAAK,YAAY,iBAAiB,IAAI,GAE5CtP,GAAgB,IAAI,GAGpB,MAAMsK,GAAoB,IAAI,GAG9B,KAAK,kBAAkB,IAAIrF,GAAe,MAAM,KAAK,iBAAiB,GAGtE,MAAM,KAAK,eAAe,OAAQ;AAGlC,aAAWzF,KAAU,KAAK,eAAe;AACrC,UAAMrP,IAAOqP,EAAO,mBAAmB,MAAMA,EAAO,gBAAiB;AACrE,QAAIrP;AACA,iBAAWrB,KAAQqB;AACf,QAAAoB,GAAczC,GAAMqB,EAAKrB,CAAI,CAAC;AAAA,EAG9C;AACA;AAGA,eAAeygB,KAAiB;A/EnJhC,MAAAhrB,GAAA4N;A+EoJI,OAAK,IAAI,MAAM,wBAAwB,GACvC,KAAK,IAAI,MAAM,KAAK,aAAa,GAGjC,KAAK,QAAQ,IAAI+J,GAAK,IAAI;AAG1B,aAAWpN,KAAQoe,IAAqB;AACpC,UAAM/c,IAAO+c,GAAoBpe,CAAI;AACrC,IAAAyC,GAAczC,GAAMqB,CAAI;AAAA,EAChC;AAMI,MAJA,KAAK,eAAe6S,EAAY,UAChCnhB,EAAa,MAAMP,EAAO,eAAe,IAGpC6Q,KAAA5N,IAAA,KAAK,kBAAL,gBAAAA,EAAoB,aAApB,QAAA4N,EAA8B;AAI/B,IAAA4c,GAAa,MAAM,IAAI;AAAA;AAHvB,UAAM,IAAI,MAAM,iFAAiF;AAMrG,EAAAxO,GAAuB,KAAK,cAAc;AAC9C;AAEe,MAAMiP,GAAO;AAAA,EAExB,YAAYC,GAAkBC,IAAa,IAAI;AAC3C,SAAK,OAAO,IAAIzC,GAAI,IAAI,GAExB,KAAK,eAAevhB,IAIpB,KAAK,KAAK,SAAS+gB,EAAU,OAAO,GAGpC,OAAO,uBAAuB,OAAO,wBAAwB,CAAE,GAC/D,OAAO,qBAAqB,KAAK,IAAI,GAErC,KAAK,IAAI,MAAM,4BAA4B,GAGvC,OAAOgD,KAAsB,aAC7BA,IAAmB,SAAS,eAAeA,CAAgB,IAG/DA,EAAiB,UAAU,IAAI,kBAAkB,GAEjD,KAAK,IAAI,MAAM,sBAAsB,GACrC,KAAK,QAAQ,IAAIpB,GAAK,IAAI,GAE1B,KAAK,oBAAoBoB,GACzB,KAAK,cAAcC,GAGnB,KAAK,YAAY,mBAAmB,KAAK,YAAY,oBAAoB,aACzE,KAAK,YAAY,aAAa,KAAK,YAAY,cAAc5nB,IAC7D,KAAK,YAAY,aAAa,KAAK,YAAY,cAAcE,IAC7D,KAAK,YAAY,iBAAiB,KAAK,YAAY,kBAAkBE,IACrE,KAAK,YAAY,qBAAqB,KAAK,YAAY,sBAAsBG,IAC7E,KAAK,YAAY,oBAAoB,KAAK,YAAY,qBAAqBG,IAC3E,KAAK,YAAY,sBAAsB,KAAK,YAAY,uBAAuB,CAAE,GACjF,KAAK,YAAY,oBAAoB,KAAK,YAAY,qBAAqByH,IAC3E,KAAK,YAAY,sBAAsB,KAAK,YAAY,uBAAuBK,IAC/E,KAAK,YAAY,sBAAsB,KAAK,YAAY,uBAAuBD,IAC/E,KAAK,YAAY,wBAAwB,KAAK,YAAY,yBAAyBE,IACnF,KAAK,YAAY,0BAA0B,KAAK,YAAY,2BAA2BE,IACvF,KAAK,YAAY,6BAA6B,KAAK,YAAY,8BAA8BC,IAC7F,KAAK,YAAY,SAAS,KAAK,YAAY,gBAAgB5G,IAC3D,KAAK,YAAY,2BAA2B,KAAK,YAAY,4BAA4B2gB,IACzF,KAAK,YAAY,+BAA+B,KAAK,YAAY,gCAAgCC,IACjG,KAAK,YAAY,uBAAuB,KAAK,YAAY,wBAAwBrB,IAEjF,KAAK,YAAY,mBAAmB,KAAK,YAAY,oBAAoB,eAAe7nB,GAAQ;AAC5F,MAAA+P,GAAc,MAAM;AAAA,QAChB,OAAS;AAAA,QACT,OAAS;AAAA,MACzB,CAAa,GAEDA,GAAc,MAAM;AAAA,QAChB,OAAS;AAAA,QACT,OAAS;AAAA,MACzB,CAAa,GAEDF,GAAY,UAAU,SAAS,UAAU,GAAE,CAAC,CAAC;AAAA,IACzD;AAEQ,UAAMse,IAAc,KAAK,YAAY,WAAW,CAAE;AAClD,SAAK,YAAY,UAAU;AAAA,MACvB,GAAGA;AAAA,IACf,GAEQje,GAAqB,KAAK,YAAY,iBAAiB,GACvDC,GAAuB,KAAK,YAAY,mBAAmB,GAC3DC,GAAuB,KAAK,YAAY,mBAAmB,GAC3DC,GAAyB,KAAK,YAAY,qBAAqB,GAC/DC,GAA2B,KAAK,YAAY,uBAAuB,GACnEC,GAA8B,KAAK,YAAY,0BAA0B,GAEzE,KAAK,UAAU,MACf,KAAK,uBAAuB,IAC5B,KAAK,+BAA+B,IACpC,KAAK,WAAW,MAChB,KAAK,eAAe,MACpB,KAAK,mBAAmB,MACxB,KAAK,gBAAgB,MACrB,KAAK,iBAAiB,MAGtB,KAAK,gBAAgB;AAErB,UAAM6d,IAAS,MAAM;AACjB,WAAK,OAAQ;AAAA,IACzB;AACQ,WAAO,iBAAiB,UAAUA,CAAM,GAExC,KAAK,iBAAiB,iBAAiB,oBAAoB,MAAM;AAC7D,MAAA/tB,EAAa,MAAMP,EAAO,oBAAoB,EAAE,QAAQ,KAAK,cAAc,GAC3E,KAAK,eAAeO,EAAa,MAAMP,EAAO,gBAAgB,IAAIO,EAAa,MAAMP,EAAO,eAAe;AAAA,IACvH,CAAS,GAED,KAAK,eAAe0hB,EAAY,UAEhC,KAAK,qBAAqB,CAAE;AAAA,EACpC;AAAA,EAEI,IAAI,UAAU;AACV,WAAO,KAAK,aAAa;AAAA,EACjC;AAAA,EAEI,IAAI,gBAAgB;AAChB,WAAO,KAAK,mBAAmB,CAAE;AAAA,EACzC;AAAA,EAEI,IAAI,MAAM;AACN,WAAO,KAAK;AAAA,EACpB;AAAA,EAEI,IAAI,QAAQ;AACR,WAAO,KAAK,iBAAiBA,EAAY;AAAA,EACjD;AAAA,EAEI,IAAI,QAAQ;AACR,WAAO,KAAK;AAAA,EACpB;AAAA,EAEI,IAAI,YAAY;AACZ,WAAO8L,EAAiB,KAAK,KAAK;AAAA,EAC1C;AAAA,EAEI,IAAI,SAAS;AACT,WAAOxtB;AAAA,EACf;AAAA,EAEI,IAAI,cAAc;AACd,WAAO,KAAK;AAAA,EACpB;AAAA,EAEI,IAAI,OAAO;AACP,WAAO,KAAK;AAAA,EACpB;AAAA,EAEI,IAAI,gBAAgB;AAChB,WAAO,KAAK,iBAAiB,SAAS,SAAS,aAAa;AAAA,EACpE;AAAA,EAEI,UAAU4O,GAAMgB,IAAO,MAAM;AACzB,WAAOD,GAAUf,GAAMgB,CAAI;AAAA,EACnC;AAAA,EAEI,YAAYpC,GAAM;AACd,IAAAuC,GAAYvC,CAAI;AAAA,EACxB;AAAA,EAEI,cAAc;AACV,WAAOwC,GAAa;AAAA,EAC5B;AAAA,EAEI,cAAcxC,GAAKqB,GAAM;AACrB,IAAAoB,GAAczC,GAAKqB,CAAI;AAAA,EAC/B;AAAA,EAEI,kBAAkB;AACd,WAAOqB,GAAiB;AAAA,EAChC;AAAA,EAEI,qBAAqB;AACjB,WAAOC,GAAmB,IAAI;AAAA,EACtC;AAAA,EAEI,UAAUoe,GAAWvkB,GAAI3J,IAAqB,IAAM;AAChD,IAAAJ,EAAU,MAAMsuB,GAAW,CAAAxT,MAAQ/Q,EAAG+Q,CAAI,GAAG1a,CAAkB;AAAA,EACvE;AAAA,EAEI,eAAe;AACX,WAAO,aAAa,IAAI;AAAA,EAChC;AAAA,EAEI,wBAAwB;AACpB,WAAO,sBAAsB,IAAI;AAAA,EACzC;AAAA,EAEI,yBAAyB;AACrB,WAAO,uBAAuB,IAAI;AAAA,EAC1C;AAAA,EAEI,UAAUe,GAAMqD,IAAO,MAAM;AACzB,QAAIA,GAAM;AACN,YAAM+pB,IAAU,KAAK,eAAe,gBAAgB/pB,CAAI;AACxD,UAAI+pB;AACA,eAAOA,EAAQ,KAAK,CAAAjlB,MAAK;AACrB,cAAIA,EAAE,SAASnI;AACX,mBAAOmI;AAAA,QAE/B,CAAiB;AAAA,IAEjB,OACa;AACD,YAAM/G,IAAS,CAAE;AACjB,iBAAWmI,KAAK,KAAK,eAAe,iBAAiB;AAEjD,cAAMpB,IADY,KAAK,eAAe,gBAAgBoB,CAAC,EACnC,KAAK,CAAApB,MAAK;AAC1B,cAAIA,EAAE,SAASnI;AACX,mBAAOmI;AAAA,QAE/B,CAAiB;AACD,QAAIA,MACA/G,EAAOmI,CAAC,IAAIpB;AAAA,MAEhC;AACY,aAAO/G;AAAA,IACnB;AAAA,EACA;AAAA,EAEI,IAAI,aAAa;AACb,WAAO,KAAK;AAAA,EACpB;AAAA,EAEI,IAAI,WAAWke,GAAK;AAChB,SAAK,cAAcA;AAAA,EAC3B;AAAA,EAEI,IAAI,gBAAgB;AAAE,WAAO,EAAE,GAAG,KAAK,kBAAkB,aAAa,GAAG,KAAK,kBAAkB,aAAY;AAAA,EAAG;AAAA,EAE/G,IAAI,mBAAmB;AAAE,WAAO,KAAK;AAAA,EAAkB;AAAA,EAEvD,IAAI,aAAa;AAAE,WAAO,KAAK;AAAA,EAAY;AAAA,EAE3C,IAAI,gBAAgB;AAAE,WAAO,KAAK;AAAA,EAAe;AAAA;AAAA;AAAA,EAIjD,IAAI,eAAe;AACf,WAAO,KAAK,cAAc;AAAA,EAClC;AAAA;AAAA,EAGI,IAAI,sBAAsB;AACtB,WAAO,KAAK,kBAAkB;AAAA,EACtC;AAAA;AAAA,EAGI,IAAI,cAAc;A/E5ZtB,QAAAzd;A+E6ZQ,aAAOA,IAAA,KAAK,mBAAL,gBAAAA,EAAqB,UAAS;AAAA,EAC7C;AAAA;AAAA,EAGI,IAAI,eAAe;AACf,WAAO,KAAK;AAAA,EACpB;AAAA,EAEI,IAAI,qBAAqB;A/Era7B,QAAAA;A+EsaQ,aAAOA,IAAA,KAAK,gBAAL,gBAAAA,EAAkB,uBAAsB;AAAA,EACvD;AAAA,EAEI,IAAI,YAAY;A/EzapB,QAAAA;A+E0aQ,aAAOA,IAAA,KAAK,gBAAL,gBAAAA,EAAkB,cAAa;AAAA,EAC9C;AAAA,EAEI,IAAI,SAAS;AACT,WAAO,KAAK;AAAA,EACpB;AAAA,EAEI,IAAI,sBAAsB;AACtB,WAAO,KAAK;AAAA,EACpB;AAAA,EAEI,IAAI,8BAA8B;AAC9B,WAAO,KAAK;AAAA,EACpB;AAAA,EAEI,IAAI,UAAU;AACV,WAAO,KAAK;AAAA,EACpB;AAAA;AAAA,EAGI,IAAI,gBAAgB;A/E9bxB,QAAAA,GAAA4N;A+E+bQ,aAAO5N,IAAA,KAAK,gBAAL,gBAAAA,EAAkB,oBAAiB4N,IAAA,KAAK,WAAL,gBAAAA,EAAa,kBAAiB;AAAA,EAChF;AAAA;AAAA,EAGI,IAAI,cAAc;AACd,WAAO,KAAK;AAAA,EACpB;AAAA;AAAA,EAGI,IAAI,mBAAmB;A/Exc3B,QAAA5N,GAAA4N;A+EycQ,aAAO5N,IAAA,KAAK,WAAL,gBAAAA,EAAa,uBAAoB4N,IAAA,KAAK,gBAAL,gBAAAA,EAAkB,qBAAoB;AAAA,EACtF;AAAA;AAAA,EAGI,IAAI,kBAAkB;AAClB,WAAO,KAAK;AAAA,EACpB;AAAA;AAAA,EAGI,IAAI,gBAAgB;AAChB,WAAO,KAAK;AAAA,EACpB;AAAA,EAEI,IAAI,mBAAmB;AACnB,WAAO,KAAK;AAAA,EACpB;AAAA,EAEI,IAAI,iBAAiB;AACjB,WAAO,KAAK;AAAA,EACpB;AAAA,EAEI,IAAI,cAAc;AACd,WAAO,KAAK;AAAA,EACpB;AAAA,EAEI,IAAI,iBAAiB;AACjB,WAAO,KAAK;AAAA,EACpB;AAAA,EAEI,IAAI,OAAO;AACP,WAAO,KAAK;AAAA,EACpB;AAAA,EAEI,IAAI,cAAc;AACd,WAAO6Q;AAAA,EACf;AAAA,EAEI,IAAI,mBAAmB;AACnB,WAAO8L;AAAA,EACf;AAAA;AAAA,EAGI,IAAI,WAAW;A/EnfnB,QAAAvqB;A+EofQ,aAAOA,IAAA,KAAK,oBAAL,gBAAAA,EAAsB,aAAY,CAAE;AAAA,EACnD;AAAA,EAEI,IAAI,UAAU;A/EvflB,QAAAA;A+EwfQ,aAAOA,IAAA,KAAK,oBAAL,gBAAAA,EAAsB,YAAW,CAAE;AAAA,EAClD;AAAA,EAEI,IAAI,YAAY;A/E3fpB,QAAAA;A+E4fQ,aAAOA,IAAA,KAAK,oBAAL,gBAAAA,EAAsB,cAAa,CAAE;AAAA,EACpD;AAAA,EAEI,IAAI,WAAW;A/E/fnB,QAAAA;A+EggBQ,aAAOA,IAAA,KAAK,oBAAL,gBAAAA,EAAsB,aAAY,CAAE;AAAA,EACnD;AAAA,EAEI,IAAI,WAAW;A/EngBnB,QAAAA;A+EogBQ,aAAOA,IAAA,KAAK,oBAAL,gBAAAA,EAAsB,aAAY,CAAE;AAAA,EACnD;AAAA,EAEI,IAAI,kBAAkB;A/EvgB1B,QAAAA;A+EwgBQ,aAAOA,IAAA,KAAK,oBAAL,gBAAAA,EAAsB,oBAAmB;AAAA,EACxD;AAAA,EAEI,UAAUwrB,GAAO;AACb,WAAO,IAAI,QAAQ,CAAC3tB,GAASC,MAAW;AACpC,YAAM2tB,IAAa,MAAM;AACrB,QAAI,KAAK,UAAUD,IACf3tB,EAAS,IAGT,WAAW4tB,GAAY,EAAE;AAAA,MAE7C;AACY,MAAI,OAAOD,KAAW,aAClBA,IAAQ/M,EAAY+M,CAAK,KAGzBA,IAAM,KAAKA,IAAM,OAAO,OAAO/M,CAAW,EAAE,WAC5C3gB,EAAO,MAAM,yBAAyB0tB,CAAK,GAAG,CAAC,GAGnDC,EAAY;AAAA,IACf,CAAA;AAAA,EACT;AAAA,EAEI,MAAM,QAAQ7tB,GAAK,EAAE,OAAAwV,GAAO,UAAAtC,GAAU,SAAA2Z,GAAS,iBAAAC,EAAiB,IAAG,IAAI;AACnE,QAAI,KAAK,iBAAiBjM,EAAY;AAClC,YAAM,IAAI,MAAM,KAAK,UAAU,+CAA+C,CAAC8L,EAAiB,KAAK,YAAY,CAAC,CAAC,CAAC;AAExH,QAAI,KAAK;AACL,YAAM,IAAI,MAAM,KAAK,UAAU,+CAA+C,CAACA,EAAiB,KAAK,YAAY,CAAC,CAAC,CAAC;AAExH,QAAI,CAAC3sB;AACD,YAAM,IAAI,MAAM,KAAK,UAAU,8BAA8B,CAAC;AAGlE,IAAK,MAAM,QAAQA,CAAG,MAClBA,IAAM,CAACA,CAAG,IAGTwV,MACDA,IAAQrU,GAAenB,EAAI,CAAC,CAAC,GAC7B,KAAK,IAAI,KAAK,0EAA0E;AAG5F,QAAI;AAGA,UAFA,MAAM+sB,GAAc,MAAM,IAAI,GAE1B,CAACF,MAAY,KAAK,wBAAwB,MAAM,KAAK,gCAAgC;AACrF,QAAAA,IAAU,KAAK,qBACfC,IAAkB,KAAK,6BACvB,KAAK,IAAI,KAAK,4EAA4E;AAAA,eAErF,CAACD,KAAW,CAACC;AAClB,cAAM,IAAI,MAAM,uFAAuF;AAG3G,WAAK,WAAW1rB,GAAgBD,GAAenB,EAAI,CAAC,CAAC,CAAC,GAEtD,KAAK,eAAewB,GAAexB,EAAI,CAAC,CAAC,GACzC,KAAK,mBAAmBA,EAAI,CAAC,GAE7B,KAAK,IAAI,MAAM,kCAAkC,KAAK,OAAO,eAAe,KAAK,eAAe,GAAG;AAEnG,YAAM8tB,IAAgBra,GAAuB,MAAMzT,EAAI,MAAM,EAAE,CAAC;AAChE,WAAK,iBAAiB;AAAA,QAClB,UAAU;AAAA,UACN,UAAAkT;AAAA,UACA,OAAAsC;AAAA,UACA,SAAAqX;AAAA,UACA,iBAAAC;AAAA,QACH;AAAA,QAED,SAAS9sB,EAAI,IAAI,CAAC6B,GAAED,OAET;AAAA,UACH,SAFYkf,GAAiB,MAAMjf,CAAC;AAAA,UAGpC,SAASisB,EAAclsB,CAAC;AAAA,UACxB,MAAMA,MAAM,IAAI,cAAc;AAAA,QACjC,EACJ;AAAA,MACJ,GAED,MAAMwrB,GAAe,MAAM,IAAI;AAAA,IAC3C,SACe/sB,GAAK;AACR,iBAAK,eAAewgB,EAAY,OAChC,KAAK,IAAI,MAAMxgB,CAAG,GAClB,KAAK,kBAAkB,IAAIwH,GAAe,MAAM,KAAK,UAAUxH,EAAI,OAAO,CAAC,GACrEA;AAAA,IAClB;AAAA,EACA;AAAA,EAEI,MAAM,eAAe;AACjB,QAAI,KAAK,iBAAiBwgB,EAAY;AAClC,YAAM,IAAI,MAAM,KAAK,UAAU,oDAAoD,CAAC8L,EAAiB,KAAK,YAAY,CAAC,CAAC,CAAC;AAE7H,QAAI,MAAK;AAET,UAAI;AAIA,YAHA,MAAMI,GAAc,MAAM,IAAI,GAE9B,KAAK,WAAW,MAAM,KAAK,WAAW,WAAW,KAAK,SAAS,IAAI,GAC/D,KAAK,YAAY;AACjB,gBAAM,IAAI,MAAM,+BAA+B;AAGnD,aAAK,eAAe,MAAM,KAAK,WAAW,eAAe,KAAK,eAAc,KAAK,SAAQ,KAAK,SAAQ,IAAI,GAE1G,KAAK,mBAAmB,MAAM,KAAK,WAAW,mBAAmB,KAAK,cAAc,KAAK,kBAAiB,KAAK,SAAQ,IAAI,GAE3H,KAAK,IAAI,MAAM,kCAAkC,KAAK,OAAO,eAAe,KAAK,eAAe,GAAG,GAEnG,KAAK,iBAAiB,MAAM,KAAK,WAAW,kBAAkB,KAAK,iBAAgB,KAAK,SAAQ,IAAI,GACpG,KAAK,eAAe,WAAW,KAAK,eAAe,YAAY,CAAE,GAC7D,CAAC,KAAK,eAAe,SAAS,YAAY,KAAK,wBAAwB,MAAM,KAAK,gCAAgC,QAClH,KAAK,eAAe,SAAS,UAAU,KAAK,qBAC5C,KAAK,eAAe,SAAS,kBAAkB,KAAK,6BACpD,KAAK,IAAI,KAAK,4EAA4E,IAG9F,KAAK,kBAAkB,IAAIX,GAAe,KAAK,eAAe,IAAI,GAGlET,GAAsB,MAAM,KAAK,IAAI,GACrC,MAAMI,GAAc,MAAM,KAAK,IAAI,GAGnC,MAAML,GAAoB,MAAM,KAAK,IAAI,GAEzC,MAAM0B,GAAe,MAAM,IAAI;AAAA,MAC3C,SACe/sB,GAAK;AACR,mBAAK,eAAewgB,EAAY,OAChC,KAAK,IAAI,MAAMxgB,CAAG,GAClB,KAAK,kBAAkB,IAAIwH,GAAe,MAAM,KAAK,UAAUxH,EAAI,OAAO,CAAC,GACrEA;AAAA,MAClB;AAAA,EACA;AAAA,EAEI,MAAM,aAAa;A/EppBvB,QAAA+B,GAAA4N,GAAA8O;A+EqpBQ,QAAI;AAGA,UAFA,KAAK,kBAAkB,IAAI+I,GAAc,MAAM,KAAK,iBAAiB,GAEjE,KAAK,iBAAiBhH,EAAY;AAClC,cAAM,IAAI,MAAM,KAAK,UAAU,kDAAkD,CAAC8L,EAAiB,KAAK,YAAY,CAAC,CAAC,CAAC;AAG3H,WAAK,eAAe9L,EAAY,iBAEhCze,IAAA,KAAK,sBAAL,QAAAA,EAAwB,oBAExB,KAAK,UAAU,IAAI,KAAK,WAAW,OAAO,IAAI,GAC9C,MAAM,KAAK,QAAQ,OAAQ,GAE3B,MAAM,KAAK,eAAe,MAAK4N,IAAA,KAAK,kBAAL,gBAAAA,EAAoB,OAAO,GAE1DtQ,EAAa,MAAMP,EAAO,aAAa,GAEvC,KAAK,eAAe,IAAI6nB,GAAY,MAAM,KAAK,gBAAgB,GAE/D,MAAM,KAAK,aAAa,KAAM,GAG9B,KAAK,gBAAclI,IAAA,KAAK,OAAO,OAAZ,gBAAAA,EAAgB,gBAAe,KAClD5c,GAAqB,IAAI,GAEzB,KAAK,gBAAgB,KAAM,GAE3B,KAAK,eAAe2e,EAAY,QAGhC,MAAM,KAAK,eAAe,aAAc,GAExCnhB,EAAa,MAAMP,EAAO,aAAa,GAElB,EAAE,KAAK,cAAc,SAAS,mBAAmB,OAElE,KAAK,YAAY,kBAAkB,aAAc,GAGhD,KAAK,QAAQ,UACd,KAAK,QAAQ,iBAAkB,GAC/B,KAAK,UAAU;AAAA,IAG/B,SACekB,GAAK;AACR,iBAAK,eAAewgB,EAAY,OAC5B,KAAK,YACL,KAAK,QAAQ,iBAAkB,GAC/B,KAAK,UAAU,OAEnB,KAAK,kBAAkB,IAAIhZ,GAAe,MAAMxH,EAAI,OAAO,GACrDA;AAAA,IAClB;AAAA,EACA;AAAA,EAEI,MAAM,OAAO;AACT,YAAQ,KAAK,OAAK;AAAA,MAClB,KAAKwgB,EAAY;AACb,cAAM,KAAK,aAAc,GACzB,MAAM,KAAK,WAAY;AACvB;AAAA,MACJ,KAAKA,EAAY;AACb,cAAM,KAAK,WAAY;AACvB;AAAA,MACJ,KAAKA,EAAY;AACb;AAAA,MACJ;AACI,cAAM,IAAI,MAAM,KAAK,UAAU,2DAA2D,CAAC8L,EAAiB,KAAK,KAAK,CAAC,CAAC,CAAC;AAAA,IACrI;AAAA,EACA;AAAA,EAEI,MAAM,SAAS;AACX,YAAQ,KAAK,OAAK;AAAA,MAClB,KAAK9L,EAAY;AACb;AAAA,MACJ,KAAKA,EAAY;AACb,cAAM,KAAK,eAAgB;AAC3B;AAAA,MACJ,KAAKA,EAAY;AAAA,MACjB,KAAKA,EAAY;AACb,cAAM,KAAK,aAAc,GACzB,MAAM,KAAK,eAAgB;AAC3B;AAAA,MACJ;AACI,cAAM,IAAI,MAAM,KAAK,UAAU,6DAA6D,CAAC8L,EAAiB,KAAK,KAAK,CAAC,CAAC,CAAC;AAAA,IACvI;AAAA,EACA;AAAA,EAEI,MAAM,iBAAiB;A/E/uB3B,QAAAvqB;A+EgvBQ,QAAI,KAAK,iBAAiBye,EAAY,YAAY,KAAK,iBAAiBA,EAAY;AAChF,YAAM,IAAI,MAAM,KAAK,UAAU,sDAAsD,CAAC8L,EAAiB,KAAK,YAAY,CAAC,CAAC,CAAC;AAE/H,IAAI,KAAK,oBACL,KAAK,gBAAgB,iBAAkB,GACvC,KAAK,kBAAkB,OAE3B,KAAK,eAAe9L,EAAY,oBAEhC,KAAK,IAAI,MAAM,yBAAyB,GAGxC,MAAMuH,GAA0B,GAEhC,MAAMrK,GAAkB,IAAI,GAE5B,KAAK,kBAAkB,KACvB3b,IAAA,KAAK,sBAAL,QAAAA,EAAwB,oBACxB,KAAK,eAAe,MACpB,KAAK,eAAeye,EAAY,UAGhC8K,GAAsB,MAAM,KAAK,IAAI;AAAA,EAC7C;AAAA,EAEI,MAAM,eAAe;A/EzwBzB,QAAAvpB,GAAA4N,GAAA8O,GAAAkD,GAAAC;A+E0wBQ,QAAI,KAAK,iBAAiBpB,EAAY,UAAU,KAAK,iBAAiBA,EAAY;AAC9E,YAAM,IAAI,MAAM,KAAK,UAAU,sDAAsD,CAAC8L,EAAiB,KAAK,YAAY,CAAC,CAAC,CAAC;AAE/H,IAAI,KAAK,oBACL,KAAK,gBAAgB,iBAAkB,GACvC,KAAK,kBAAkB,OAE3B,KAAK,eAAe9L,EAAY,kBAEhC,QAAMze,IAAA,KAAK,oBAAL,gBAAAA,EAAsB,WAC5B,KAAK,kBAAkB,MAEvB,QAAM4N,IAAA,KAAK,iBAAL,gBAAAA,EAAmB,WACzB,KAAK,eAAe,OAEpB8O,IAAA,KAAK,oBAAL,QAAAA,EAAsB,UACtB,KAAK,kBAAkB,MAEvBnc,GAAmB,IAAI,GAEvBjD,EAAa,MAAMP,EAAO,eAAe,IAErC8iB,KAAAD,IAAA,KAAK,kBAAL,gBAAAA,EAAoB,aAApB,QAAAC,EAA8B,WAC9B2K,GAAa,MAAM,IAAI,GAG3B9sB,GAAiB,IAAI,GACrB,KAAK,eAAe+gB,EAAY;AAAA,EACxC;AAAA,EAEI,MAAM,OAAOkN,IAAa,MAAM;AAC5B,YAAQ,KAAK,OAAK;AAAA,MAClB,KAAKlN,EAAY;AACb;AAAA,MACJ,KAAKA,EAAY;AACb,cAAM,KAAK,eAAgB;AAC3B;AAAA,MACJ,KAAKA,EAAY;AACb,cAAM,KAAK,OAAQ;AACnB;AAAA,IACZ;AAEQ,IAAI,OAAOkN,KAAgB,cACvB,MAAMA,EAAY,GAEtB,MAAM,KAAK,KAAM;AAAA,EACzB;AAAA,EAEI,MAAM,SAAS;A/E1zBnB,QAAA3rB,GAAA4N;A+E8zBQ,SAHA5N,IAAA,KAAK,mBAAL,QAAAA,EAAqB,iBACrB4N,IAAA,KAAK,gBAAL,QAAAA,EAAkB,YAEd,KAAK,gBAAgB;AACrB,YAAMge,IAAU,OACL;AAAA,QACH,GAAG,KAAK,eAAe,QAAQ;AAAA,QAC/B,GAAG,KAAK,eAAe,QAAQ;AAAA,MACnD;AAEY,MAAAtuB,EAAa,MAAMP,EAAO,QAAQ,EAAE,MAAM6uB,EAAO,GAAI,GAEjD,KAAK,mBACL,aAAa,KAAK,eAAe,GAGrC,KAAK,kBAAkB,WAAW,MAAM;AACpC,QAAAtuB,EAAa,MAAMP,EAAO,YAAY,EAAE,MAAM6uB,EAAO,GAAI;AAAA,MAC5D,GAAE,GAAI;AAAA,IACnB;AAAA,EACA;AAAA,EAEI,MAAM,oBAAoB;A/Ej1B9B,QAAA5rB,GAAA4N,GAAA8O;A+Ek1BQ,IAAM,QAAM1c,IAAA,KAAK,mBAAL,gBAAAA,EAAqB,cAC7B,KAAK,YAAY,KACjB4N,IAAA,KAAK,mBAAL,QAAAA,EAAqB,sBACrB8O,IAAA,KAAK,gBAAL,QAAAA,EAAkB,qBAClBpf,EAAa,MAAMP,EAAO,OAAO;AAAA,EAE7C;AAAA,EAEI,MAAM,oBAAoB;A/E11B9B,QAAAiD,GAAA4N;A+E21BQ,KAAA5N,IAAA,KAAK,mBAAL,QAAAA,EAAqB,sBACrB4N,IAAA,KAAK,gBAAL,QAAAA,EAAkB,qBAClB,KAAK,aAAatQ,EAAa,MAAMP,EAAO,OAAO,GACnD,KAAK,YAAY;AAAA,EACzB;AAAA;AAAA,EAGI,MAAM,OAAO;AACT,IAAK,KAAK,eAAe,SACrB,MAAM,KAAK,WAAY,GAG3B,MAAM,KAAK,eAAe,KAAM;AAAA,EACxC;AAAA,EAEI,MAAM,QAAQ;A/E12BlB,QAAAiD;A+E22BQ,YAAMA,IAAA,KAAK,mBAAL,gBAAAA,EAAqB;AAAA,EACnC;AAAA,EAEI,MAAM,SAAS;AACX,WAAK,KAAK,iBAIC,KAAK,eAAe,OAAQ,IAH5B;AAAA,EAKnB;AAAA,EAEI,MAAM,OAAO;A/Ev3BjB,QAAAA;A+Ew3BQ,YAAMA,IAAA,KAAK,mBAAL,gBAAAA,EAAqB;AAAA,EACnC;AAAA,EAEI,wBAAwB;AACpB,WAAO,KAAK,iBAAiB,qBACzB,KAAK,iBAAiB;AAAA,EAClC;AAAA,EAEI,MAAM,kBAAkB;AACpB,QAAIT,IAAS;AACb,WAAI,KAAK,iBAAiB,oBACtBA,IAAS,KAAK,iBAAiB,kBAAmB,IAE7C,KAAK,iBAAiB,4BAC3B,KAAK,IAAI,MAAM,yBAAyB,GACxCA,IAAS,KAAK,iBAAiB,wBAAyB,IAE5D,WAAW,MAAM,KAAK,OAAM,GAAI,GAAG,GAC5BA;AAAA,EACV;AAAA,EAED,MAAM,iBAAiB;AACnB,QAAI,SAAS,kBAAkB,KAAK;AAChC,aAAO,SAAS,eAAgB;AAE/B,QAAI,SAAS,0BAA0B,KAAK;AAC7C,kBAAK,IAAI,MAAM,wBAAwB,GAChC,SAAS,uBAAwB;AAAA,EAEpD;AAAA,EAEI,IAAI,eAAe;AACf,WAAQ,SAAS,sBAAsB,KAAK,oBACpC,SAAS,4BAA4B,KAAK;AAAA,EAC1D;AAAA,EAEI,oBAAoB+b,GAAYuQ,GAAUC,GAAS;AAC/C,SAAK,mBAAmB,GAAGxQ,CAAU,IAAIuQ,CAAQ,EAAE,IAAIC;AAAA,EAC/D;AAAA,EAEI,uBAAuBxQ,GAAYuQ,GAAU;AACzC,SAAK,mBAAmB,GAAGvQ,CAAU,IAAIuQ,CAAQ,EAAE,IAAI;AAAA,EAC/D;AAAA,EAEI,oBAAoBvQ,GAAYuQ,GAAU;AACtC,gBAAK,wBAAwB,KAAK,yBAAyB,CAAE,GACxD,KAAK,sBAAsB,KAAK,CAAAjpB,MAAQA,EAAK,eAAe0Y,KAAc1Y,EAAK,aAAaipB,CAAQ,KACrG,KAAK,sBAAsB,KAAK;AAAA,MAC5B,YAAAvQ;AAAA,MACA,UAAAuQ;AAAA,IAChB,CAAa,GAEE,KAAK,mBAAmB,GAAGvQ,CAAU,IAAIuQ,CAAQ,EAAE;AAAA,EAClE;AAAA,EAEI,IAAI,uBAAuB;AACvB,WAAO,KAAK,yBAAyB,CAAE;AAAA,EAC/C;AACA;ACl7Be,MAAME,GAAe;AAAA,EAChC,YAAY;AAAA,IACR,IAAA/d;AAAA,IACA,MAAA7P;AAAA,IACA,SAAA6tB,IAAU;AAAA,IACV,UAAAlG,IAAW;AAAA,IACX,UAAAmG,IAAW;AAAA,EACnB,GAAO;AACC,SAAK,MAAMje,GACX,KAAK,QAAQ7P,GACb,KAAK,WAAW6tB,GAChB,KAAK,QAAQlG,GACb,KAAK,YAAYmG;AAAA,EACzB;AAAA,EAEI,IAAI,KAAK;AACL,WAAO,KAAK;AAAA,EACpB;AAAA,EAEI,IAAI,OAAO;AACP,WAAO,KAAK;AAAA,EACpB;AAAA,EAEI,IAAI,UAAU;AACV,WAAO,KAAK;AAAA,EACpB;AAAA,EAEI,IAAI,WAAW;AACX,WAAO,KAAK;AAAA,EACpB;AAAA,EAEI,IAAI,WAAW;AACX,WAAO,KAAK;AAAA,EACpB;AAAA,EAEI,IAAI,SAAS1P,GAAG;AACZ,SAAK,YAAYA;AAAA,EACzB;AACA;"}