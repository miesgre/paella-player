(function(c,f){typeof exports=="object"&&typeof module<"u"?f(exports):typeof define=="function"&&define.amd?define(["exports"],f):(c=typeof globalThis<"u"?globalThis:c||self,f(c["paella-slide-plugins"]={}))})(this,function(c){"use strict";var f=t=>{throw TypeError(t)},z=(t,e,n)=>e.has(t)||f("Cannot "+n),u=(t,e,n)=>(z(t,e,"read from private field"),n?n.call(t):e.get(t)),T=(t,e,n)=>e.has(t)?f("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(t):e.set(t,n),k=(t,e,n,i)=>(z(t,e,"write to private field"),e.set(t,n),n);const v=Object.freeze({PLAY:"paella:play",PAUSE:"paella:pause",STOP:"paella:stop",ENDED:"paella:ended",SEEK:"paella:seek",FULLSCREEN_CHANGED:"paella:fullscreenchanged",ENTER_FULLSCREEN:"paella:enterfullscreen",EXIT_FULLSCREEN:"paella:exitfullscreen",VOLUME_CHANGED:"paella:volumeChanged",TIMEUPDATE:"paella:timeupdate",TRIMMING_CHANGED:"paella:trimmingChanged",CAPTIONS_CHANGED:"paella:captionsChanged",CAPTIONS_ENABLED:"paella:captionsEnabled",CAPTIONS_DISABLED:"paella:captionsDisabled",BUTTON_PRESS:"paella:buttonPress",SHOW_POPUP:"paella:showPopUp",HIDE_POPUP:"paella:hidePopUp",MANIFEST_LOADED:"paella:manifestLoaded",STREAM_LOADED:"paella:streamLoaded",PLAYER_LOADED:"paella:playerLoaded",PLAYER_UNLOADED:"paella:playerUnloaded",RESIZE:"paella:resize",RESIZE_END:"paella:resizeEnd",LAYOUT_CHANGED:"paella:layoutChanged",PLAYBACK_RATE_CHANGED:"paella:playbackRateChanged",VIDEO_QUALITY_CHANGED:"paella:videoQualityChanged",HIDE_UI:"paella:hideUI",SHOW_UI:"paella:showUI",COOKIE_CONSENT_CHANGED:"paella:cookieConsentChanged",LOG:"paella:log"});function C(t,e,n,i=!0){return t.__eventListeners__=t.__eventListeners__||{},Array.isArray(e)||(e=[e]),e.forEach(s=>{t.__eventListeners__[s]=t.__eventListeners__[s]||[],t.__eventListeners__[s].push({callback:n,unregisterOnUnload:i})}),n}function le(t){return new Promise((e,n)=>{fetch(t).then(i=>i.text()).then(i=>{e(i)}).catch(i=>n(i))})}function ce(t){const e=new URLSearchParams(window.location.search);return e.has(t)?e.get(t):null}function ue(t){const e=window.location.hash.replace("#","?"),n=new URLSearchParams(e);return n.has(t)?n.get(t):null}function G(t,e){const n=e||"/";return t=t.map((i,s)=>(s&&(i=i.replace(new RegExp("^"+n),"")),s!==t.length-1&&(i=i.replace(new RegExp(n+"$"),"")),i)),t.join(n)}function W(t){return new RegExp("^([a-z]+://|//)","i").test(t)||/^\//.test(t)}function Z(t){try{return new URL(t).pathname.split("/").pop()}catch{return t.split("/").pop()}}function de(t){return t.split(".").reduce((e,n,i,s)=>i<s.length-1?e!==""?`${e}.${n}`:n:e,"")}function he(t){const e=n=>{const i=n.split("/").reduce((s,r,o,l)=>o<l.length-1?s!==""?`${s}/${r}`:r:s,"");return(n[0]==="/"?`/${i}`:i)+"/"};try{const n=new URL(t);return n.origin+e(n.pathname)}catch{return e(t)}}function pe(t){return Z(t).split(".").pop()}function ge(t,e){return W(e)?e:G([t.manifestUrl,e])}function me(t){t.__hideTimerPaused__=!0}function fe(t){t.__hideTimerPaused__=!1}function ve(t,e="hideUiTime"){var n;t.__hideTimer__=null;const i=async()=>t.__hideTimerPaused__?(t.log.debug("UI not hidden because the auto hide timer is paused"),!1):s()?(t.log.debug("UI not hidden because there is a focused element"),!1):(await t.hideUserInterface(),!0);(n=t.config.ui)!=null&&n.hideOnMouseLeave&&t.containerElement.addEventListener("mouseleave",()=>{i()});const s=()=>{const o=document.activeElement;return(t.playbackBar.element.contains(o)||t.videoContainer.element.contains(o))&&["input","textarea","button"].find(l=>o.tagName.toLowerCase(l))!==-1},r=async()=>{t.__hideTimer__&&clearTimeout(t.__hideTimer__),await t.showUserInterface(),t.__hideTimer__=setTimeout(async()=>{t.__hideTimer__=null,i()||r()},t[e])};t.containerElement.addEventListener("mousemove",async o=>{r()}),C(t,v.PLAY,async()=>{r()}),C(t,v.PAUSE,async()=>{await t.showUserInterface()}),C(t,v.ENDED,async()=>{await t.showUserInterface()}),document.addEventListener("keydown",async()=>{r()})}function _e(t){t.__hideTimer__&&(clearTimeout(t.__hideTimer__),delete t.__hideTimer__)}function ye(t){const e=Math.floor(t/60/60),n=Math.floor(t/60)-e*60,i=Math.floor(t%60);return(e>0?e.toString().padStart(2,"0")+":":"")+n.toString().padStart(2,"0")+":"+i.toString().padStart(2,"0")}function be(t){const e=/^(?:(\d+):){0,1}(\d+):(\d+)(\.\d+)?$/.exec(t);if(e){const n=e[1]!==void 0?Number(e[1]):0,i=Number(e[2]),s=Number(e[3]);return n*3600+i*60+s}return null}function Ce(t){const e=/^(?:(\d+):){0,1}(\d+):(\d+)\.(\d+)?$/.exec(t);if(e){const n=e[1]!==void 0?Number(e[1]):0,i=Number(e[2]),s=Number(e[3]),r=e[4]&&Number(e[4])||0;return n*36e5+i*6e4+s*1e3+r}return null}function V(t,e,n=365){let i=new Date;i.setTime(i.getTime()+n*24*60*60*1e3);let s=`expires=${i.toUTCString()}`;document.cookie=`${t}=${e};${s};path=/;SameSite=None;`+(/Apple/.test(navigator.vendor)?"":"Secure;")}function Ee(t,e,n,i,s=365){t.cookieConsent.getConsentForType(e)&&V(n,i,s)}function x(t){let e=t+"=",n=decodeURIComponent(document.cookie).split(";");for(let i=0;i<n.length;++i){let s=n[i];for(;s.charAt(0)==" ";)s=s.substring(1);if(s.indexOf(e)==0)return s.substring(e.length,s.length)}return""}function Le(t){const e=x(t),n=Number(e);return e!==""&&!isNaN(n)?n:null}function Te(t){try{return JSON.parse(x(t))}catch{return null}}function we(t,e=!0){return new Promise(n=>{const i=document.createElement("link");i.setAttribute("rel","stylesheet"),i.setAttribute("href",t),i.onload=()=>n(i);const s=document.getElementsByTagName("head")[0];e&&s.appendChild(i),n()})}function Pe(t){document.getElementsByTagName("head")[0].removeChild(t)}function M(t,e,n=!0){for(const i in e){const s=t[i];let r=e[i];n&&Array.isArray(s)&&Array.isArray(r)?(s.forEach(o=>{r=r.filter(l=>typeof o=="object"&&typeof l=="object"&&o.id===l.id?(M(o,l,n),!1):!0)}),r.forEach(o=>{s.push(o)})):typeof s=="object"&&r?M(s,r,n):t[i]=e[i]}}function Y(t,{excludedTags:e=null}={}){const n=document.createElement("div");n.innerHTML=t;const i=["script"];return e&&i.push(...e),i.flatMap(s=>Array.from(n.getElementsByTagName(s))).forEach(s=>{s.parentElement.removeChild(s)}),n.innerHTML}let w=null;function Se(t){if(!t)return!1;w||(w=document.createElement("video"));let e=w.canPlayType(t);if(e==="maybe"||e==="probably")return!0;if(/video\/mp4/i.test(t))return e=w.canPlayType("video/mp4"),e==="maybe"||e==="probably"}const Ie=Object.freeze(Object.defineProperty({__proto__:null,clearAutoHideTimer:_e,getCookie:x,getFileExtension:pe,getHashParameter:ue,getJSONCookie:Te,getNumericCookie:Le,getUrlFileName:Z,getUrlParameter:ce,isAbsoluteUrl:W,joinPath:G,loadStyle:we,loadSvgIcon:le,mergeObjects:M,pauseAutoHideUiTimer:me,removeExtension:de,removeFileName:he,resolveResourcePath:ge,resumeAutoHideUiTimer:fe,sanitizeHTML:Y,secondsToTime:ye,setCookie:V,setCookieIfAllowed:Ee,setupAutoHideUiTimer:ve,supportsVideoType:Se,timeToMilliseconds:Ce,timeToSeconds:be,unloadStyle:Pe},Symbol.toStringTag,{value:"Module"}));var P;let q=class{constructor(e){T(this,P,null),k(this,P,e)}get player(){return u(this,P)}};P=new WeakMap;function d(t,e=null){const n=document.createElement("div");n.innerHTML=t;const i=n.children[0];return e&&e.appendChild(i),i}class K extends q{constructor(e,n){super(e),this._name=n}getPluginModuleInstance(){return null}get config(){return this._config}get type(){return"none"}get order(){var e;return((e=this._config)==null?void 0:e.order)||0}get description(){var e;return((e=this._config)==null?void 0:e.description)||""}get name(){return this._name}async isEnabled(){var e;return(e=this.config)==null?void 0:e.enabled}async load(){}async unload(){}}class Ae extends q{get moduleName(){return this.player.log.warn(`Incomplete player module definition: '${__filename}.moduleName'`),"-"}get moduleVersion(){return this.player.log.warn(`Incomplete player module definition: '${__filename}.moduleVersion'`),"0.0.0"}async getDictionaries(){return null}}class J extends K{constructor(e,n,i){super(e,n,i),this.__uiPlugin=!0}async getDictionaries(){return null}}const Q=()=>{const t=document.createElement("span");return t.classList.add("side-container"),t.classList.add("hidden"),t};class Ne{onIconChanged(e,n,i){}onTitleChanged(e,n,i){}onStateChanged(e,n,i,s,r){}}var g,m,S;class Ue extends J{constructor(){super(...arguments),T(this,g,null),T(this,m,null),T(this,S,[])}get type(){return"button"}get container(){return this._container}get button(){return this._button}get interactive(){return!0}get dynamicWidth(){return!1}getId(){return null}get id(){return this.config.id||this.getId()}getButtonName(){return null}get buttonName(){return this.config.name||this.getButtonName()||this.name}get ariaLabel(){return this.config.ariaLabel||this.getAriaLabel()}getAriaLabel(){return""}get tabIndex(){return this.config.tabIndex||this.getTabIndex()}getTabIndex(){return null}getDescription(){return""}get description(){return this.config.description||this.getDescription()}get minContainerSize(){return this.config.minContainerSize||this.getMinContainerSize()}getMinContainerSize(){return 0}setObserver(e){if(e instanceof Ne)this._observer=e;else if(typeof e.onIconChanged=="function"||typeof e.onTitleChanged=="function"||typeof e.onStateChanged=="function")this._observer=e;else throw new Error("Invalid observer for ButtonPlugin")}get icon(){return this._icon||(this._icon=""),this._icon}set icon(e){var n;if(typeof e=="string"&&(e=Y(e)),this._icon=e,e&&this._button instanceof HTMLElement){const i=this._button.querySelector("i")||d("<i></i>",this._button);i.innerHTML=e}else if(this._button instanceof HTMLElement){const i=this._button.querySelector("i");i&&this._button.removeChild(i)}(n=this._observer)!=null&&n.onIconChanged&&this._observer.onIconChanged(this,this._icon,e)}get title(){return this._title||""}set title(e){var n;if(this._title=e,e&&this._button instanceof HTMLElement){const i=this._button.querySelector("span")||d(`<span class="button-title-${this.titleSize}"></span>`,this._button);i.innerHTML=e}else if(this._button instanceof HTMLElement){const i=this._button.querySelector("span");i&&this._button.removeChild(i)}(n=this._observer)!=null&&n.onTitleChanged&&this._observer.onTitleChanged(this,this._title,e)}get titleSize(){return"medium"}get side(){var e;return((e=this.config)==null?void 0:e.side)||"left"}get closePopUps(){return this.config.closePopUps||this.getClosePopUps()}getClosePopUps(){return!0}get parentContainer(){var e;return((e=this.config)==null?void 0:e.parentContainer)||"playbackBar"}get className(){return""}enable(){this._enabled=!0,this.show()}disable(){this._enabled=!1,this.hide()}hide(){this._button&&(this._button.style.display="none")}show(){if(this._enabled===!1)return;const{width:e}=this.player.playbackBar.containerSize;this._button&&(e>this.minContainerSize||this.parentContainer!=="playbackBar")&&(this._button.style.display=null)}get leftSideContainer(){return u(this,g)||(k(this,g,Q()),this.container.appendChild(u(this,g))),u(this,g)}get leftSideContainerPresent(){return u(this,g)!==null}get rightSideContainer(){return u(this,m)||(k(this,m,Q()),this.container.appendChild(u(this,m))),u(this,m)}get rightSideContainerPresent(){return u(this,m)!==null}get stateText(){return null}get stateIcon(){return null}setState({text:e=null,icon:n=null}={}){var i,s;const r=this._statusText,o=this._statusIcon;this._statusText=e,this._statusIcon=n,u(this,S).forEach(l=>l(this)),this._statusIcon&&(this.icon=this._statusIcon),this._statusText&&(this.title=this._statusText),(s=(i=this._observer)==null?void 0:i.onStateChanged)==null||s.call(i,this,r,e,o,n)}onStateChange(e){typeof e=="function"?u(this,S).push(e):this.player.log.warn("Invalid callback for ButtonPlugin.onStateChange")}async action(e,n=null){}onResize({width:e,height:n}){e<this.minContainerSize?this.hide():this.show()}focus(){var e;(e=this.button)==null||e.focus()}blur(){var e;(e=this.button)==null||e.blur()}isFocus(){return this.button===document.activeElement}}g=new WeakMap,m=new WeakMap,S=new WeakMap;class X extends J{get type(){return"canvasButton"}get content(){return this._config.content||["presenter"]}get ariaLabel(){return this._config.ariaLabel||this.getAriaLabel()}getAriaLabel(){return""}get tabIndex(){return this.config.tabIndex}get description(){return this.config.description||this.getDescription()}getDescription(){return""}get icon(){return this._icon}set icon(e){this._icon=e}get side(){var e;return((e=this.config)==null?void 0:e.side)||"left"}get buttonName(){return this.name}get position(){switch(this.side){case"left":return B.LEFT;case"center":return B.CENTER;case"right":return B.RIGHT;default:throw new Error(`Invalid CanvasButtonPlugin side set: ${this.side}`)}}async action(e){this.player.log.warn(`Action not implemented in canvas button plugin ${this.name}`)}}const B=Object.freeze({LEFT:"left",CENTER:"center",RIGHT:"right"});class ke extends Ue{constructor(){super(...arguments),this._refreshContent=!0}set refreshContent(e){this._refreshContent=e}get refreshContent(){return this._refreshContent}get closeParentPopUp(){return this.config.closeParentPopUp||this.getCloseParentPopUp()}getCloseParentPopUp(){return!1}async action(e,n){super.action(e,n),this.parentPopUp=n,await this.showPopUp()}get parentPopUp(){return this._parentPopUp}set parentPopUp(e){this._parentPopUp=e}get popUp(){return this._popUp}get menuTitle(){return this.config.menuTitle||null}get moveable(){return this.config.moveable??!1}get resizeable(){return this.config.resizeable??!1}get customPopUpClass(){return this.config.customPopUpClass??""}get closeActions(){var e,n;const i=((e=this.config.closeActions)==null?void 0:e.clickOutside)??!0,s=((n=this.config.closeActions)==null?void 0:n.closeButton)??!1;return{clickOutside:i,closeButton:s}}get currentContent(){return this._currentContent}async getContent(){return d("<p>Pop Up Button Plugin Content</p>")}async checkRefreshContent(){if(this.refreshContent){const e=await this.getContent();this._currentContent.innerHTML="",Array.from(e.children).forEach(n=>this._currentContent.appendChild(n))}}get popUpType(){return this.config.popUpType||"modal"}hidePopUp(){this.player.playbackBar.popUp.isHidden||this.player.playbackBar.popUp.hide()}async showPopUp(){this._keyEventHandler||(this._keyEventHandler=n=>{n.key==="Escape"&&this.hidePopUp()},this.button.addEventListener("keydown",this._keyEventHandler));const e=this.player.playbackBar.popUp;if(e.isHidden||this._contentId!==e.currentContentId){const n=await this.getContent();this._currentContent=n,this._contentId=e.show({title:this.menuTitle||this.description,content:n,attachRight:this.popUpType==="timeline"||this.side==="right",attachLeft:this.popUpType==="timeline"||this.side==="left",parent:this.parentPopUp})}else e.hide()}}class xe extends K{get type(){return"eventLog"}get events(){return[]}async onEvent(e,n){this.player.log.warn(`${this.name}: onEvent() function is not overwritten.`)}}Object.freeze({DISABLED:0,ERROR:1,WARN:2,INFO:3,DEBUG:4,VERBOSE:5}).INFO;function D(t){return E(t).length>0}function E(t){var n;const e=((n=t.frameList)==null?void 0:n.frames)||[];return e.sort((i,s)=>i.time-s.time),e}async function R(t){const e=E(t),{videoContainer:n}=t,i=n.isTrimEnabled?n.trimStart:0,s=i+Math.trunc(await n.duration()),r=i+Math.trunc(await n.currentTime());let o=null;e.some(l=>(l.time>r&&l.time<s&&(o=l),o!==null)),o&&await t.videoContainer.setCurrentTime(o.time-i)}async function O(t){const e=E(t),{videoContainer:n}=t,i=n.isTrimEnabled?n.trimStart:0,s=Math.trunc(await n.currentTime())+i;let r=null;if(e.some(o=>(o.time<s&&(r=o),o.time>=s)),r){const o=r.time<i?i:r.time;await t.videoContainer.setCurrentTime(o-i)}}const ee={name:"@asicupv/paella-slide-plugins",version:"2.0.0-beta.1",exports:{".":"./dist/paella-slide-plugins.js","./paella-slide-plugins.css":"./dist/paella-slide-plugins.css"},description:"Slide plugins for Paella Player",main:"./dist/paella-slide-plugins.js",type:"module",module:"./dist/paella-slide-plugins.js",files:["dist/paella-slide-plugins.css","dist/paella-slide-plugins.js","dist/paella-slide-plugins.js.map","dist/paella-slide-plugins.umd.cjs","dist/paella-slide-plugins.umd.cjs.map"],scripts:{dev:"vite",build:"vite build --emptyOutDir"},repository:{type:"git",url:"git+https://github.com/polimediaupv/paella-slide-plugins.git"},author:"Fernando Serrano Carpena <ferserc1@gmail.com>",license:"SEE LICENSE IN license.txt",bugs:{url:"https://github.com/polimediaupv/paella-player"},homepage:"https://github.com/polimediaupv/paella-player#readme",devDependencies:{vite:"^6.0.11"},dependencies:{"@asicupv/paella-core":"^2.0.0-beta.5"}},Me={es:{"Show slides":"Mostrar diapositivas del vídeo","go to":"ir a","Seek video to the next slide":"Ir a la siguiente diapositiva","Seek video to the previous slide":"Ir a la diapositiva anterior"},en:{"Show slides":"Show slides","go to":"go to","Seek video to the next slide":"Go to the next slide","Seek video to the previous slide":"Go to the previous slide"},de:{"Show slides":"Folien anzeigen","go to":"gehe zu","Seek video to the next slide":"nächste Folie","Seek video to the previous slide":"vorherige Folie"}};let H=null;class _ extends Ae{static Get(){return H||(H=new _),H}get moduleName(){return ee.name}get moduleVersion(){return ee.version}async getDictionaries(){return Me}}const $=`<svg width="100%" height="100%" viewBox="0 0 512 512" version="1.1" style="fill-rule:evenodd;clip-rule:evenodd;stroke-linejoin:round;stroke-miterlimit:2;">
    <g transform="matrix(4.38063e-16,11.4236,8.46191,-3.24491e-16,68.8773,-7740.5)">
        <g id="arrow-right" serif:id="arrow right">
            <path d="M698.36,2.82C698.726,2.08 699.341,1.636 700,1.636C700.659,1.636 701.274,2.08 701.64,2.82C705.27,10.172 713.981,27.811 717.958,35.864C718.361,36.68 718.398,37.73 718.055,38.595C717.712,39.46 717.045,40 716.318,40L683.682,40C682.955,40 682.288,39.46 681.945,38.595C681.602,37.73 681.639,36.68 682.042,35.864C686.019,27.811 694.73,10.172 698.36,2.82Z"/>
        </g>
    </g>
</svg>`,F=`<svg width="100%" height="100%" viewBox="0 0 512 512" version="1.1" style="fill-rule:evenodd;clip-rule:evenodd;stroke-linejoin:round;stroke-miterlimit:2;">
    <g transform="matrix(-1.83705e-15,-11.4236,-8.46191,1.36078e-15,452.158,8252.5)">
        <g id="arrow-right" serif:id="arrow right">
            <path d="M698.36,2.82C698.726,2.08 699.341,1.636 700,1.636C700.659,1.636 701.274,2.08 701.64,2.82C705.27,10.172 713.981,27.811 717.958,35.864C718.361,36.68 718.398,37.73 718.055,38.595C717.712,39.46 717.045,40 716.318,40L683.682,40C682.955,40 682.288,39.46 681.945,38.595C681.602,37.73 681.639,36.68 682.042,35.864C686.019,27.811 694.73,10.172 698.36,2.82Z"/>
        </g>
    </g>
</svg>`;class te extends xe{getPluginModuleInstance(){return _.Get()}get name(){return super.name||"es.upv.paella.arrowSlidesNavigator"}get events(){return[v.PLAYER_LOADED]}async onEvent(e){var p;const n=this.player.getCustomPluginIcon(this.name,"arrowLeftIcon")||$,i=this.player.getCustomPluginIcon(this.name,"arrowRightIcon")||F;console.debug("Loading arrow slides navigation plugin");const s=Array.isArray(this.config.target)?this.config.target:[this.config.target],r=this.player.videoContainer.streamProvider.streams,o=s.find(y=>r[y]!==null),l=r[o];if(this.frames=E(this.player),l&&((p=this.frames)!=null&&p.length)){const y=d('<div class="arrow-slides-navigator"></div>',l.canvas.userArea);d(`
            <button class="button-prev"><i>${n}</i></button>
            `,y).addEventListener("click",async L=>{L.stopPropagation(),await O(this.player)}),d(`
            <button class="button-next"><i>${i}</i></button>
            `,y).addEventListener("click",async L=>{L.stopPropagation(),await R(this.player)})}else console.warn("No matching stream content or frames found for arrow slides navigator plugin")}}const Be=`<svg width="100%" height="100%" viewBox="0 0 33 30" version="1.1" style="fill-rule:evenodd;clip-rule:evenodd;stroke-linejoin:round;stroke-miterlimit:1.41421;">
    <path d="M23,29.888L0,29.888L0,7.888L23,7.888L23,29.888ZM11,6.888L8.903,6.888L10.5,0L33,5.817L27,27.888L24,27.388L23.994,20.288L27,20.888L30.519,7.199L11.933,2.394L11,6.888ZM21,9.888L1.969,9.888L1.969,23.888L21,23.888L21,9.888ZM7.912,19.349L10.236,15.813L12.561,18.017L15.757,13.49L19,21.888L3.939,21.888L6.169,17.726L7.912,19.349ZM6.473,15.608C5.647,15.608 4.977,14.966 4.977,14.173C4.977,13.381 5.647,12.739 6.473,12.739C7.299,12.739 7.969,13.381 7.969,14.173C7.969,14.966 7.299,15.608 6.473,15.608Z"/>
</svg>`;function ne(t,e){if(e==null||e.forEach(r=>r.classList.remove("selected")),t.classList.add("selected"),this._autoScrollPaused)return;const n=t.parentElement,i=n.getBoundingClientRect(),s=t.getBoundingClientRect();s.left<i.left?n.scrollLeft-=i.left-s.left:s.right>i.right&&(n.scrollLeft+=s.right-i.right)}let ie=class extends ke{getPluginModuleInstance(){return _.Get()}get name(){return super.name||"es.upv.paella.frameControlButtonPlugin"}getAriaLabel(){return"Show slides"}getDescription(){return this.getAriaLabel()}get popUpType(){return"timeline"}async isEnabled(){var n,i,s;const e=await super.isEnabled();return this.frames=(n=this.player.frameList)==null?void 0:n.frames,(i=this.frames)==null||i.sort((r,o)=>r.time-o.time),e&&((s=this.frames)==null?void 0:s.length)}async action(){await super.action();const e=await this.player.videoContainer.currentTime();let n=null;this.frameElements.some(i=>(n=i,i.__data.time>e)),n&&n.focus()}async getContent(){const e=this.player.getCustomPluginIcon(this.name,"arrowLeftIcon")||$,n=this.player.getCustomPluginIcon(this.name,"arrowRightIcon")||F,i=this.player.frameList.targetContent||this.config.targetContent||"presentation",s=d('<div class="frame-control-plugin-container"></div>'),r=d(`<button class="btn-left"><i class="button-icon">${e}</i></button>`,s),o=d('<div class="image-list"></div>',s),l=d(`<button class="btn-right"><i class="button-icon">${n}</i></button>`,s),{videoContainer:p}=this.player,y=await p.duration();let I=null;o.addEventListener("scroll",async a=>{this._autoScrollPaused=!0,I&&clearTimeout(I),I=setTimeout(()=>{this._autoScrollPaused=!1},2e3)});const A=p.isTrimEnabled?p.trimStart:0,L=p.isTrimEnabled?p.trimEnd:y,je=a=>(a=this.player.videoContainer.isTrimEnabled?a-this.player.videoContainer.trimStart:a,Ie.secondsToTime(a<0?0:a)),j=a=>{a.key==="Escape"&&(a.preventDefault(),a.stopPropagation(),this.hidePopUp(),this.button.focus())};this.frameElements=this.frames.filter((a,N)=>{const h=this.frames[N+1];return((h==null?void 0:h.time)>=A||a.time>=A)&&a.time<=L}).map(a=>{const N=`${this.player.translate("go to")} ${je(a.time)}`,h=d(`
                <button id="frame_${a.id}" aria-label="${N}" title="${N}"><img src="${a.thumb}" alt="${a.id}"/></button>
                `,o);return h.__data=a,h.addEventListener("click",async U=>{const b=U.currentTarget.__data.time-A;await this.player.videoContainer.setCurrentTime(b>=0?b:0),ne.apply(this,[U.currentTarget,this.frameElements])}),h.addEventListener("keydown",j),h.addEventListener("mouseover",async U=>{this._currentFrame&&this.player.videoContainer.removeChild(this._currentFrame);const b=document.createElement("img");b.className="frame-control-preview",b.src=a.url;const ze=this.player.videoContainer.getVideoRect(i);this._currentFrame=this.player.videoContainer.appendChild(b,ze)}),h.addEventListener("mouseout",async U=>{this._currentFrame&&(this.player.videoContainer.removeChild(this._currentFrame),this._currentFrame=null)}),h});const ae=()=>this.frameElements&&this.frameElements[0]?this.frameElements[0].offsetWidth:0;return r.addEventListener("click",()=>{o.scrollLeft-=ae()}),l.addEventListener("click",()=>{o.scrollLeft+=ae()}),r.addEventListener("keydown",j),l.addEventListener("keydown",j),setTimeout(()=>this.frameElements[0]&&this.frameElements[0].focus(),50),s}async load(){this.icon=this.player.getCustomPluginIcon(this.name,"photoIcon")||Be;const e=3;C(this.player,v.TIMEUPDATE,async n=>{var r;const i=this.player.videoContainer.isTrimEnabled?this.player.videoContainer.trimStart:0;let s=this.frameElements&&this.frameElements[0];(r=this.frameElements)==null||r.some(o=>{if(o.__data.time>Math.floor(n.currentTime+i+e))return!0;s=o}),s&&ne.apply(this,[s,this.frameElements])}),C(this.player,v.TRIMMING_CHANGED,n=>{this.refreshContent=!0})}};class se extends X{getPluginModuleInstance(){return _.Get()}get name(){return super.name||"es.upv.paella.nextSlideNavigatorButton"}getAriaLabel(){return this.getDescription()}getDescription(){return this.player.translate("Seek video to the next slide")}async isEnabled(){return await super.isEnabled()&&D(this.player)}async load(){this.icon=this.player.getCustomPluginIcon(this.name,"arrowRightIcon")||F}async action(){await R(this.player)}}class re extends X{getPluginModuleInstance(){return _.Get()}get name(){return super.name||"es.upv.paella.prevSlideNavigatorButton"}getAriaLabel(){return this.getDescription()}getDescription(){return this.player.translate("Seek video to the previous slide")}async isEnabled(){return await super.isEnabled()&&D(this.player)}async load(){this.icon=this.player.getCustomPluginIcon(this.name,"arrowLeftIcon")||$}async action(){await O(this.player)}}const oe=[{plugin:te,config:{enabled:!1}},{plugin:ie,config:{enabled:!1}},{plugin:se,config:{enabled:!1}},{plugin:re,config:{enabled:!1}}],De=oe,Re=te,Oe=ie,He=se,$e=re,Fe={nextSlide:R,previousSlide:O,checkSlides:D,getFrames:E};c.ArrowSlidesPlugin=Re,c.FrameControlButtonPlugin=Oe,c.NextSlideNavigatorButtonPlugin=He,c.PrevSlideNavigatorButtonPlugin=$e,c.allPlugins=De,c.slidePlugins=oe,c.utils=Fe,Object.defineProperty(c,Symbol.toStringTag,{value:"Module"})});
//# sourceMappingURL=paella-slide-plugins.umd.cjs.map
